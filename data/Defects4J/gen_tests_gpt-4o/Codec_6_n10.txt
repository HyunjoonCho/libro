
import org.apache.commons.codec.binary.Base64InputStream;
import org.junit.Test;
import java.io.ByteArrayInputStream;
import java.io.IOException;
import java.io.InputStreamReader;

import static org.junit.Assert.assertEquals;

public class Base64InputStreamTest {

    @Test
    public void testBase64InputStreamRead() throws IOException {
        byte[] encodedData = "YWJj".getBytes(); // "abc" in Base64
        ByteArrayInputStream byteArrayInputStream = new ByteArrayInputStream(encodedData);
        Base64InputStream base64InputStream = new Base64InputStream(byteArrayInputStream, true);
        InputStreamReader inputStreamReader = new InputStreamReader(base64InputStream);

        char[] buffer = new char[3];
        int bytesRead = inputStreamReader.read(buffer);
        
        assertEquals(3, bytesRead); // "abc" should result in 3 bytes read
        
        // Continue reading to ensure no incorrect zero-byte returns
        bytesRead = inputStreamReader.read(buffer);
        
        assertEquals(-1, bytesRead); // End of stream expected
    }
}
