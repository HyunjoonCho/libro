
import javax.script.ScriptEngine;
import javax.script.ScriptEngineManager;
import javax.script.ScriptException;

import static org.junit.Assert.assertNotNull;
import static org.junit.Assert.assertTrue;

import org.junit.Test;

public class FooPrototypeTest {

    @Test
    public void testPrototypeAssignment() throws ScriptException {
        ScriptEngineManager manager = new ScriptEngineManager();
        ScriptEngine engine = manager.getEngineByName("nashorn"); // Use "nashorn" or "javascript"

        String script =
                "/** @constructor */\n" +
                "function Foo() {}\n" +
                "(function() {\n" +
                "    Foo.prototype = {\n" +
                "        alert: function() {\n" +
                "            return 'hello world';\n" +
                "        }\n" +
                "    };\n" +
                "})();\n" +
                "Foo.prototype.alert;";

        Object result = engine.eval(script);
        
        assertNotNull("The alert function should be defined on Foo.prototype", result);
        assertTrue("The alert function should not be undefined", result instanceof ScriptObjectMirror);
    }
}
