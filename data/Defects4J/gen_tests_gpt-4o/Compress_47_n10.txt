public void testZipArchiveInputStreamWithUnknownCompressedSize() throws Exception {
    ByteArrayInputStream byteArrayInputStream = new ByteArrayInputStream(new byte[0]);
    ZipArchiveInputStream zipInputStream = new ZipArchiveInputStream(byteArrayInputStream);

    ZipArchiveEntry mockEntry = new ZipArchiveEntry("testEntry");
    mockEntry.setMethod(ZipMethod.BZIP2.getCode());
    mockEntry.setCompressedSize(ArchiveEntry.SIZE_UNKNOWN);

    ZipArchiveInputStream.ZipEntrySupplier entrySupplier = () -> mockEntry;
    zipInputStream.initEntry(entrySupplier);

    try {
        zipInputStream.getNextZipEntry();
        fail("Expected an IllegalStateException due to unknown compressed size");
    } catch (IllegalStateException e) {
        assertEquals("Compressed size is unknown for method BZIP2", e.getMessage());
    }
}