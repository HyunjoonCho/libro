public void testBZip2TruncatedFileRead() throws IOException {
    byte[] truncatedData = new byte[770];
    // Populate truncatedData with 770 bytes of valid BZip2 content.
    // For the purpose of this test, assume this byte array is
    // correctly filled with a truncated BZip2 data.

    ByteArrayInputStream byteArrayInputStream = new ByteArrayInputStream(truncatedData);
    BZip2CompressorInputStream bZip2InputStream = new BZip2CompressorInputStream(byteArrayInputStream, true);

    byte[] buffer = new byte[1024];
    int bytesRead = 0;
    int totalBytesRead = 0;
    while ((bytesRead = bZip2InputStream.read(buffer)) != -1) {
        totalBytesRead += bytesRead;
    }
    bZip2InputStream.close();

    assertEquals(770, totalBytesRead);
}