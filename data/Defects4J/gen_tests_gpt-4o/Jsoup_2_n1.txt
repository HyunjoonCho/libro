
import org.jsoup.Jsoup;
import org.jsoup.nodes.Document;
import org.jsoup.parser.Parser;
import org.junit.Test;

import static org.junit.Assert.assertEquals;

public class HtmlParserBugTest {

    @Test
    public void testUnadornedTextFollowingDataOnlyTags() {
        String htmlInput = "<html>\n" +
                           "<body>\n" +
                           "<script type=\"text/javascript\">\n" +
                           "var inside = true;\n" +
                           "</script>\n" +
                           "this should be outside.\n" +
                           "</body>\n" +
                           "</html>";

        Document doc = Jsoup.parse(htmlInput, "", Parser.htmlParser());

        String expectedOutput = "<html>\n" +
                                " <head></head>\n" +
                                " <body>\n" +
                                "  <script type=\"text/javascript\">\n" +
                                "   var inside = true;\n" +
                                "  </script> \n" +
                                "  this should be outside.\n" +
                                " </body>\n" +
                                "</html>";

        String actualOutput = doc.toString();

        assertEquals(expectedOutput.trim(), actualOutput.trim());
    }
}
