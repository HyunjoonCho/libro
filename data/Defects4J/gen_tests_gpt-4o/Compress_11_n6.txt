
import org.apache.commons.compress.archivers.ArchiveException;
import org.apache.commons.compress.archivers.ArchiveInputStream;
import org.apache.commons.compress.archivers.ArchiveStreamFactory;
import org.junit.Test;

import java.io.ByteArrayInputStream;
import java.io.IOException;

import static org.junit.Assert.assertTrue;
import static org.junit.Assert.assertNull;

public class ArchiveStreamFactoryTest {

    @Test
    public void testShortTextFileDetectionAsTar() throws IOException {
        ArchiveStreamFactory factory = new ArchiveStreamFactory();

        String shortText = "This is a short text file.";
        ByteArrayInputStream input = new ByteArrayInputStream(shortText.getBytes());

        try {
            ArchiveInputStream archiveInputStream = factory.createArchiveInputStream(input);
            String archiveType = archiveInputStream.getArchiveEntry().getName();
            
            // We expect that a short text file should not be detected as a Tar archive
            assertNull("Detected non-archive file as: " + archiveType, archiveType);

        } catch (ArchiveException e) {
            // If an exception is thrown, it means it was not detected as a tar or any known archive
        }
    }
}
