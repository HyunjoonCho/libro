
import static org.junit.Assert.assertEquals;

import java.util.regex.Matcher;
import java.util.regex.Pattern;

import org.junit.Test;

public class PreserveWhitespaceTest {

    // Dummy processing method to simulate the preservation issue
    private String processComments(String input) {
        // Simulate removing @preserve and not retaining whitespace
        Pattern pattern = Pattern.compile("/\\*\\*\\s*@preserve\\s*(.*?)\\s*\\*/", Pattern.DOTALL);
        Matcher matcher = pattern.matcher(input);

        StringBuffer sb = new StringBuffer();
        while (matcher.find()) {
            String preservedContent = matcher.group(1);
            matcher.appendReplacement(sb, "/*" + preservedContent + "*/");
        }
        matcher.appendTail(sb);
        return sb.toString();
    }

    @Test
    public void testPreserveCommentWhitespace() {
        String input = 
            "/** @preserve\n" +
            "\n" +
            "This\n" +
            " was\n" +
            "  ASCII\n" +
            "   Art\n" +
            "\n" +
            "*/";

        String expectedOutput =
            "/*\n" +
            "This\n" +
            " was\n" +
            "  ASCII\n" +
            "   Art\n" +
            "*/";

        String actualOutput = processComments(input);

        assertEquals(expectedOutput, actualOutput);
    }

    public static void main(String[] args) {
        PreserveWhitespaceTest test = new PreserveWhitespaceTest();
        test.testPreserveCommentWhitespace();
        System.out.println("Test passed!");
    }
}
