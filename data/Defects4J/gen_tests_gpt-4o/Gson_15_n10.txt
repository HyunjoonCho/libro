
import com.google.gson.stream.JsonWriter;
import org.junit.Test;

import java.io.IOException;
import java.io.StringWriter;

import static org.junit.Assert.assertEquals;

public class JsonWriterTest {

    @Test
    public void testNumberValueLenientMode() throws IOException {
        StringWriter stringWriter = new StringWriter();
        JsonWriter writer = new JsonWriter(stringWriter);
        
        // Set lenient mode
        writer.setLenient(true);
        
        // Write NaN as a Number
        writer.beginArray();
        writer.value((Number) Double.valueOf(Double.NaN)); // This should work in lenient mode
        writer.endArray();
        
        writer.close();
        
        // Check the output
        assertEquals("[NaN]", stringWriter.toString());
    }
    
    @Test(expected = IllegalArgumentException.class)
    public void testDoubleValueLenientMode() throws IOException {
        StringWriter stringWriter = new StringWriter();
        JsonWriter writer = new JsonWriter(stringWriter);
        
        // Set lenient mode
        writer.setLenient(true);
        
        // Attempt to write NaN directly as a double
        writer.beginArray();
        writer.value(Double.NaN); // This will throw an exception
        writer.endArray();
        
        writer.close();
    }
}
