
import com.fasterxml.jackson.annotation.JsonProperty;
import com.fasterxml.jackson.core.JsonProcessingException;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.databind.exc.UnrecognizedPropertyException;
import org.junit.Test;

import static org.junit.Assert.assertEquals;

public class JsonPropertyAccessTest {

    public static class TestPojo {
        private String firstName;
        private String lastName;

        @JsonProperty(access = JsonProperty.Access.READ_ONLY)
        public String getFullName() {
            return firstName + " " + lastName;
        }

        public String getFirstName() {
            return firstName;
        }

        public void setFirstName(String firstName) {
            this.firstName = firstName;
        }

        public String getLastName() {
            return lastName;
        }

        public void setLastName(String lastName) {
            this.lastName = lastName;
        }
    }

    @Test(expected = UnrecognizedPropertyException.class)
    public void testReadOnlyFullName() throws JsonProcessingException {
        ObjectMapper objectMapper = new ObjectMapper();

        // Creating a JSON string that includes "fullName"
        String json = "{\"firstName\":\"John\",\"lastName\":\"Doe\",\"fullName\":\"Jane Doe\"}";

        // Attempt to deserialize the JSON string into a TestPojo object
        // The deserialization should throw an UnrecognizedPropertyException because fullName should be ignored
        TestPojo pojo = objectMapper.readValue(json, TestPojo.class);
        
        // If no exception is thrown, checking the deserialized values (this shouldn't be reached)
        assertEquals("John", pojo.getFirstName());
        assertEquals("Doe", pojo.getLastName());
        assertEquals("John Doe", pojo.getFullName());
    }
}
