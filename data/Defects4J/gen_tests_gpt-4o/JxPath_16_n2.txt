
import org.apache.commons.jxpath.JXPathContext;
import org.apache.commons.jxpath.dom.DOMNodePointer;
import org.apache.commons.jxpath.xml.DocumentContainer;
import org.jdom2.Document;
import org.jdom2.Element;
import org.jdom2.input.SAXBuilder;
import org.junit.Test;
import org.w3c.dom.Node;

import java.io.StringReader;

import static org.junit.Assert.assertTrue;
import static org.junit.Assert.assertFalse;

public class NodePointerTest {

    private static final String XML_DATA = "<root><child>text</child><!-- Comment --></root>";

    @Test
    public void testDOMNodePointer() throws Exception {
        DocumentContainer docContainer = new DocumentContainer(new InputSource(new StringReader(XML_DATA)));
        org.w3c.dom.Document domDocument = (org.w3c.dom.Document) docContainer.getValue();

        JXPathContext context = JXPathContext.newContext(domDocument);

        boolean elementNode = (Boolean) context.getValue("node()/element()/name() != ''");
        boolean textNode = (Boolean) context.getValue("node()/text() != ''");
        boolean commentNode = (Boolean) context.getValue("node()/comment() != ''");

        // Expect true for all types of nodes
        assertTrue(elementNode);
        assertTrue(textNode);
        assertTrue(commentNode);
    }

    @Test
    public void testJDOMNodePointer() throws Exception {
        SAXBuilder builder = new SAXBuilder();
        Document jdomDocument = builder.build(new StringReader(XML_DATA));

        JXPathContext context = JXPathContext.newContext(jdomDocument);

        boolean elementNode = (Boolean) context.getValue("//node()/element()");
        boolean textNode = (Boolean) context.getValue("//node()/text()");
        boolean commentNode = (Boolean) context.getValue("//node()/comment()");

        // Expect true for all types of nodes
        assertTrue(elementNode);
        assertTrue(textNode);
        assertTrue(commentNode);
    }
}
