
import org.jsoup.Jsoup;
import org.jsoup.nodes.Document;
import org.jsoup.safety.Safelist;
import org.junit.Test;

import static org.junit.Assert.assertTrue;
import static org.junit.Assert.assertFalse;

public class JsoupCidTest {

    @Test
    public void testCidReferencePreservation() {
        // Sample HTML with a cid reference
        String htmlInput = "<html><body><img src=\"cid:image12345\"></body></html>";

        // Clean the HTML using a basic Safelist
        String cleanedHtml = Jsoup.clean(htmlInput, Safelist.basicWithImages());

        // Check if the cid: reference is preserved
        assertTrue("The output should still contain the cid reference",
                cleanedHtml.contains("cid:image12345"));

        // Assert it doesn't become an empty src in img tag
        assertFalse("The output should not contain an empty image src",
                cleanedHtml.contains("<img src=\"\">"));
    }
}
