public void testTypeHierarchyAdapterRuntimeCheck() {
    GsonBuilder gsonBuilder = new GsonBuilder();
    gsonBuilder.registerTypeHierarchyAdapter(Vehicle.class, new VehicleTypeAdapter());
    Gson gson = gsonBuilder.create();

    String carJson = "{\"type\":\"Car\",\"wheels\":4}";
    String truckJson = "{\"type\":\"Truck\",\"wheels\":6}";

    try {
        Car car = gson.fromJson(carJson, Car.class);
        assertEquals("Car", car.getType());
    } catch (JsonParseException e) {
        fail("Expected Car to be parsed correctly, but failed with exception: " + e.getMessage());
    }
    
    try {
        gson.fromJson(truckJson, Car.class);
        fail("Expected exception when parsing Truck JSON as Car, but none was thrown.");
    } catch (JsonParseException e) {
        // Expected exception thrown, test should pass
    }
}