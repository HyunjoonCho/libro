public void testPearsonsCorrelationPValuePrecision() {
    PearsonsCorrelation correlation = new PearsonsCorrelation();
    double[][] correlationMatrix = {
        {1.0, 0.9},
        {0.9, 1.0}
    };
    RealMatrix matrix = MatrixUtils.createRealMatrix(correlationMatrix);
    RealMatrix pValuesMatrix = correlation.getCorrelationPValues(matrix);
    double pValue = pValuesMatrix.getEntry(0, 1);
    double expectedPValue = 2 * new TDistribution(9).cumulativeProbability(-10.0);

    assertTrue("P-value should not be zero", expectedPValue > 2.2e-16);
    assertEquals(expectedPValue, pValue, 1e-10);
}