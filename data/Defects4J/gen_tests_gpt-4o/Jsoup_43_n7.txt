
import org.jsoup.Jsoup;
import org.jsoup.nodes.Document;
import org.jsoup.nodes.Element;
import org.junit.Test;
import static org.junit.Assert.*;

public class ElementSiblingIndexTest {

    @Test
    public void testElementSiblingIndexBehavior() {
        String html = "<table>" +
                      "  <tr><td>Cell1</td><td>Cell2</td></tr>" +
                      "  <tr><td>Cell1</td><td>Cell2</td></tr>" +
                      "  <tr><td>Cell1</td><td>Cell2</td></tr>" +
                      "  <tr><td>Cell1</td><td>Cell2</td></tr>" +
                      "  <tr><td>Cell1</td><td>Cell2</td></tr>" +
                      "</table>";

        Document document = Jsoup.parse(html);
        Element row2 = document.select("tr").get(1);
        Element row5 = document.select("tr").get(4);

        // Get the element sibling index for both rows
        int indexRow2 = row2.elementSiblingIndex();
        int indexRow5 = row5.elementSiblingIndex();

        // Verify that their element sibling indexes are the same
        assertEquals(indexRow2, indexRow5);

        // Verify that the element at the sibling index for row2 is indeed row2
        assertTrue(row2.parent().children().get(indexRow2).equals(row2));

        // However, this does not guarantee the same object reference due to two identical elements
        assertNotSame(row2.parent().children().get(indexRow2), row2);
    }
}
