public void testPolymorphicTypeLostWithJsonValue() throws Exception {
    ObjectMapper mapper = new ObjectMapper();
    mapper.configure(SerializationFeature.FAIL_ON_EMPTY_BEANS, false);
    mapper.enableDefaultTyping();

    CommandAPDU original = new CommandAPDU(new byte[]{1, 2, 3, 4});
    String json = mapper.writeValueAsString(original);
    
    CommandAPDU deserialized = mapper.readValue(json, CommandAPDU.class);

    assertArrayEquals(original.getBytes(), deserialized.getBytes());
    assertEquals(CommandAPDU.class, deserialized.getClass());
}