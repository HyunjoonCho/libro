public void testPearsonsCorrelationPValuePrecision() {
    double[][] dataSet = new double[2][100];
    for (int i = 0; i < 100; i++) {
        dataSet[0][i] = i + 1;
        dataSet[1][i] = 100 - i; 
    }
        
    PearsonsCorrelation pc = new PearsonsCorrelation(dataSet);
    RealMatrix pValuesMatrix = pc.getCorrelationPValues();

    double pValue = pValuesMatrix.getEntry(0, 1);
    assertTrue(pValue > 0 && pValue < 2.2e-16, "P-value should be greater than 0 but less than 2.2e-16");

    double t = Math.sqrt(pc.getCorrelationMatrix().getEntry(0, 1) / (1 - pc.getCorrelationMatrix().getEntry(0, 1)));
    TDistribution tDistribution = new TDistribution(dataSet[0].length - 2);
    double expectedPValue = 2 * tDistribution.cumulativeProbability(-Math.abs(t));
    
    assertEquals(expectedPValue, pValue, 1e-16, "The calculated p-value should match the expected value");
}