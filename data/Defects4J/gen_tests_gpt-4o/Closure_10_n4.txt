public void testTernaryOperatorWithMixedTypes() {
    String script = "var a = (Math.random()>0.5? '1' : 2 ) + 3 + 4;";
    Compiler compiler = new Compiler();

    CompilerOptions options = new CompilerOptions();
    CompilationLevel.SIMPLE_OPTIMIZATIONS.applyTo(options);

    SourceFile extern = SourceFile.fromCode("externs", "");
    SourceFile input = SourceFile.fromCode("input", script);

    Result result = compiler.compile(extern, input, options);
    String compiledCode = compiler.toSource();

    assertFalse(result.success);
    assertTrue("Invalid transformation", compiledCode.contains("(0.5 < Math.random() ? '1' : 2) + 3 + 4"));
}