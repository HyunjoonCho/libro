public void testExternExportWithTypedef() {
    String source = ""
        + "/** @externs */\n"
        + "\n"
        + "/**\n"
        + " * @param {MyType=} opt_param\n"
        + " */\n"
        + "function someFunction(opt_param) {}\n"
        + "\n"
        + "/**\n"
        + " * @typedef {Object}\n"
        + " */\n"
        + "var MyType;\n"
        + "\n"
        + "/**\n"
        + " * @param {MyType=} anotherParam\n"
        + " */\n"
        + "function anotherFunction(anotherParam) {}\n";

    Compiler compiler = new Compiler();
    CompilerOptions options = new CompilerOptions();
    options.setExternExports(true);

    compiler.compile(SourceFile.fromCode("externs.js", ""), 
                     SourceFile.fromCode("test.js", source), 
                     options);

    String externs = compiler.toSource();
    assertFalse("Unexpected truncation with '...'", externs.contains("..."));
}