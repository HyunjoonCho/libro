public void testCVE20187489() {
    ObjectMapper mapper = new ObjectMapper();
    mapper.enableDefaultTyping();
    String json = "[\"com.mchange.v2.c3p0.JndiRefForwardingDataSource\",{\"jndiName\":\"rmi://localhost:1099/Exploit\"}]";
    try {
        mapper.readValue(json, Object.class);
        fail("Deserialization should fail due to blocked class.");
    } catch (IOException e) {
        assertTrue(e.getMessage().contains("illegal type"));
    }
}