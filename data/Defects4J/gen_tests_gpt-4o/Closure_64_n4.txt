public void testMultipleStrictUse() throws Exception {
    // Prepare the JS files
    File getNumFile = new File("get_num.js");
    FileWriter writer1 = new FileWriter(getNumFile);
    writer1.write("var getNum = function() { return 5; };");
    writer1.close();

    File alertFile = new File("alert.js");
    FileWriter writer2 = new FileWriter(alertFile);
    writer2.write("alert(getNum());");
    writer2.close();

    // Run closure compiler with the specified options
    ProcessBuilder processBuilder = new ProcessBuilder(
        "java", "-jar", "compiler.jar",
        "--language_in=ECMASCRIPT5_STRICT",
        "--compilation_level=ADVANCED_OPTIMIZATIONS",
        "--warning_level=VERBOSE",
        "--js", getNumFile.getPath(),
        "--js", alertFile.getPath()
    );
    Process process = processBuilder.start();
    ByteArrayOutputStream byteArrayOutputStream = new ByteArrayOutputStream();
    int data;
    while ((data = process.getInputStream().read()) != -1) {
        byteArrayOutputStream.write(data);
    }
    String output = byteArrayOutputStream.toString();

    // Cleanup
    getNumFile.delete();
    alertFile.delete();

    // Validate the output
    assertTrue("Output should not contain more than one 'use strict'", output.indexOf("'use strict'") == output.lastIndexOf("'use strict'"));
}