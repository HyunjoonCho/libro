
import org.apache.commons.cli2.CommandLine;
import org.apache.commons.cli2.Group;
import org.apache.commons.cli2.Option;
import org.apache.commons.cli2.OptionException;
import org.apache.commons.cli2.builder.ArgumentBuilder;
import org.apache.commons.cli2.builder.DefaultOptionBuilder;
import org.apache.commons.cli2.builder.GroupBuilder;
import junit.framework.TestCase;

public class Bug27575Test extends TestCase {
    public void testRequiredOptions() {
        DefaultOptionBuilder optionBuilder = new DefaultOptionBuilder();
        ArgumentBuilder argumentBuilder = new ArgumentBuilder();
        GroupBuilder groupBuilder = new GroupBuilder();

        Option helpOption = optionBuilder.withShortName("h").withDescription("Print help").create();
        Option configOption = optionBuilder.withShortName("c")
                                           .withArgument(argumentBuilder.withName("arg").create())
                                           .withDescription("Config file")
                                           .create();

        Group options = groupBuilder.withOption(helpOption)
                                    .withOption(configOption)
                                    .withRequired(true)
                                    .create();

        String[] args = {"-c", "myconfig.cfg"};

        try {
            CommandLine commandLine = options.process(args);
            // Failing the test if help option is not present
            assertTrue("Help option should be present", commandLine.hasOption(helpOption));
        } catch (OptionException e) {
            fail("Processing of options failed: " + e.getMessage());
        }
    }
}
