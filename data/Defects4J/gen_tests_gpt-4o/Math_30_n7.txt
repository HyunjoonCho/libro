
import org.apache.commons.math3.stat.inference.MannWhitneyUTest;
import org.junit.Test;
import static org.junit.Assert.assertFalse;

public class MannWhitneyUTestOverflow {

    @Test
    public void testMannWhitneyUOverflow() {
        // Generate two large data sets of 1500 elements each.
        double[] sample1 = new double[1500];
        double[] sample2 = new double[1500];

        for (int i = 0; i < 1500; i++) {
            sample1[i] = i + 1; // sample1 = [1, 2, 3, ..., 1500]
            sample2[i] = 1500 + i + 1; // sample2 = [1501, 1502, 1503, ..., 3000]
        }

        MannWhitneyUTest test = new MannWhitneyUTest();

        // Perform the Mann-Whitney U Test
        double pValue = test.mannWhitneyUTest(sample1, sample2);

        // Assert that the p-value is not NaN or infinite, indicating possible overflow
        assertFalse("Expected valid p-value, but found NaN or Infinite", Double.isNaN(pValue) || Double.isInfinite(pValue));
    }
}
