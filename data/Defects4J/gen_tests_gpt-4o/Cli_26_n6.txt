
import org.apache.commons.cli.Option;
import org.apache.commons.cli.OptionBuilder;
import org.junit.Test;

import static org.junit.Assert.fail;

public class OptionBuilderTest {

    @Test
    public void testOptionBuilderResetAfterIAE() {
        try {
            // Attempt to create an Option with invalid parameters, which should throw an IllegalArgumentException
            OptionBuilder.hasArg();
            OptionBuilder.create("");
            fail("Expected IllegalArgumentException not thrown");
        } catch (IllegalArgumentException e) {
            // Expected exception caught, now verify if OptionBuilder is properly reset
            try {
                // Try to create a valid Option afterward to see if the state is clean
                Option option = OptionBuilder.withDescription("Valid Option").create("v");
                // If the creation succeeds without any issues, the builder is reset correctly
            } catch (Exception ex) {
                fail("OptionBuilder was not reset properly after IllegalArgumentException: " + ex.getMessage());
            }
        }
    }
}
