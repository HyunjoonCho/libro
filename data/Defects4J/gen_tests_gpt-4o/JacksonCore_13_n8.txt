
import com.fasterxml.jackson.core.JsonFactory;
import com.fasterxml.jackson.core.JsonGenerator;
import com.fasterxml.jackson.databind.ObjectMapper;
import org.junit.Test;

import java.io.ByteArrayOutputStream;
import java.io.IOException;

import static org.junit.Assert.assertEquals;

public class Utf8JsonGeneratorTest {

    @Test
    public void testQuoteFieldNamesToggle() throws IOException {
        ObjectMapper mapper = new ObjectMapper(new JsonFactory());
        
        // Test with QUOTE_FIELD_NAMES enabled
        ByteArrayOutputStream out1 = new ByteArrayOutputStream();
        JsonGenerator generator1 = mapper.getFactory().createGenerator(out1);
        generator1.writeStartObject();
        generator1.writeStringField("field", "value");
        generator1.writeEndObject();
        generator1.close();
        String jsonWithQuotes = out1.toString("UTF-8");

        assertEquals("{\"field\":\"value\"}", jsonWithQuotes);

        // Test with QUOTE_FIELD_NAMES disabled
        ByteArrayOutputStream out2 = new ByteArrayOutputStream();
        JsonFactory factory = new JsonFactory();
        factory.disable(JsonGenerator.Feature.QUOTE_FIELD_NAMES);
        JsonGenerator generator2 = factory.createGenerator(out2);
        generator2.writeStartObject();
        generator2.writeStringField("field", "value");
        generator2.writeEndObject();
        generator2.close();
        String jsonWithoutQuotes = out2.toString("UTF-8");

        assertEquals("{field:\"value\"}", jsonWithoutQuotes);
    }
}
