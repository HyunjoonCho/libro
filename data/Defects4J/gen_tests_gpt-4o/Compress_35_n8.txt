public void testTarChecksumRightAligned() throws IOException {
    byte[] tarHeader = new byte[512];
    String checksumField = "0001760";
    // Insert checksum field at the expected position in the TAR header (offset 148)
    System.arraycopy(checksumField.getBytes(StandardCharsets.UTF_8), 0, tarHeader, 148, checksumField.length());
    
    // Insert ASCII space to fill remaining checksum spots and to align for checksum calculation
    for (int i = 148 + checksumField.length(); i < 156; i++) {
        tarHeader[i] = ' ';
    }

    int correctChecksum = calculateChecksumForHeader(tarHeader);
    assertNotEquals("Checksum is invalid due to right alignment", -1, correctChecksum);
}

private int calculateChecksumForHeader(byte[] header) {
    int sum = 0;
    for (int i = 0; i < header.length; i++) {
        if (i >= 148 && i < 156) {
            sum += ' '; // simulate treating the checksum field as spaces
        } else {
            sum += header[i];
        }
    }
    return sum;
}