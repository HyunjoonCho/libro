
import org.apache.commons.compress.archivers.tar.TarArchiveEntry;
import org.apache.commons.compress.archivers.tar.TarArchiveOutputStream;
import org.junit.Test;

import java.io.ByteArrayOutputStream;
import java.io.IOException;

public class TarArchiveLongDirectoryNameTest {

    @Test(expected = IOException.class)
    public void testLongDirectoryNameInTarArchive() throws IOException {
        ByteArrayOutputStream byteArrayOutputStream = new ByteArrayOutputStream();
        TarArchiveOutputStream tarOutput = new TarArchiveOutputStream(byteArrayOutputStream);

        // Create a directory name longer than 100 bytes
        String longDirectoryName = "a".repeat(101) + "/";

        // Create a TarArchiveEntry with the long directory name
        TarArchiveEntry entry = new TarArchiveEntry(longDirectoryName);
        entry.setSize(0);

        // Try to add the entry to the TAR output stream
        tarOutput.putArchiveEntry(entry);
        
        // Close the entry
        tarOutput.closeArchiveEntry();
        tarOutput.close();
    }
}
