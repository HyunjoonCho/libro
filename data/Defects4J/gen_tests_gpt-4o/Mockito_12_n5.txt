
import org.junit.Test;
import org.mockito.ArgumentCaptor;
import org.mockito.Mockito;

import static org.junit.Assert.assertArrayEquals;
import static org.mockito.ArgumentMatchers.any;
import static org.mockito.Mockito.doNothing;
import static org.mockito.Mockito.mock;

public class ArgumentCaptorVarargsTest {

    interface VarargsService {
        void performAction(String... inputs);
    }

    @Test
    public void testArgumentCaptorWithVarargs() {
        // Step 1: Create a mock of the VarargsService
        VarargsService varargsService = mock(VarargsService.class);

        // Step 2: Use ArgumentCaptor to capture the arguments passed to the performAction method
        ArgumentCaptor<String[]> argumentCaptor = ArgumentCaptor.forClass(String[].class);

        // Step 3: Set up the mock to do nothing when performAction is called
        doNothing().when(varargsService).performAction(any());

        // Step 4: Call the performAction method with varargs
        varargsService.performAction("first", "second", "third");

        // Step 5: Verify that performAction was called and capture the arguments
        Mockito.verify(varargsService).performAction(argumentCaptor.capture());

        // Step 6: Assert that the captured arguments match the expected values
        assertArrayEquals(new String[]{"first", "second", "third"}, argumentCaptor.getValue());
    }
}
