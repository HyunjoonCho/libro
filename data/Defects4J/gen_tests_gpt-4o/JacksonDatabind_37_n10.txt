
import com.fasterxml.jackson.annotation.JsonTypeInfo;
import com.fasterxml.jackson.core.JsonProcessingException;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.databind.exc.UnrecognizedPropertyException;
import org.junit.Test;

import static org.junit.Assert.assertEquals;
import static org.junit.Assert.fail;

class JsonSchema {
    public String name;
}

@JsonTypeInfo(
    use = JsonTypeInfo.Id.NAME,
    include = JsonTypeInfo.As.PROPERTY,
    property = "type",
    defaultImpl = JsonMapSchema.class
)
class JsonMapSchema extends JsonSchema {
    public Object tables; // simplified attribute
}

class JsonRoot {
    public JsonMapSchema[] schemas;
}

public class JsonDeserializationTest {

    @Test
    public void testInheritedFieldDeserialization() {
        String jsonString = "{ \"schemas\": [ { \"name\": \"FoodMart\", \"tables\": [] } ] }";
        
        ObjectMapper objectMapper = new ObjectMapper();

        try {
            JsonRoot root = objectMapper.readValue(jsonString, JsonRoot.class);
            assertEquals("FoodMart", root.schemas[0].name);
        } catch (UnrecognizedPropertyException e) {
            fail("Unrecognized property: " + e.getPropertyName());
        } catch (JsonProcessingException e) {
            fail("JsonProcessingException: " + e.getMessage());
        }
    }
}
