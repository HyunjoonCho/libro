
import org.apache.commons.cli.Option;
import org.apache.commons.cli.OptionBuilder;
import org.junit.Test;

import static org.junit.Assert.assertEquals;
import static org.junit.Assert.assertNull;

public class OptionBuilderTest {

    @Test
    public void testOptionBuilderResetAfterException() {
        // Setting the OptionBuilder with a mandatory argument
        OptionBuilder.withArgName("arg");
        OptionBuilder.hasArg();
        
        // Attempt to create an option with an invalid character, which should throw an IllegalArgumentException
        try {
            OptionBuilder.create('@');
        } catch (IllegalArgumentException e) {
            // Expected exception
        }
        
        // Attempting to create a valid option should not have the previous argument settings
        Option validOption = OptionBuilder.create('v');
        
        // Validate that the new option does not incorrectly retain previous argument settings
        assertEquals("v", validOption.getOpt());
        assertNull(validOption.getArgName());
        assertEquals(0, validOption.getArgs());
    }
}
