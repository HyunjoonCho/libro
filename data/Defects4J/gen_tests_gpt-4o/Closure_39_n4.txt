public void testExternExportWithTypedef() {
    String jsSource = 
        "/** @typedef {(string|boolean)} */\n" + 
        "var MyType;\n" + 
        "/**\n" + 
        " * @param {?MyType=} opt_param\n" + 
        " * @return {void}\n" + 
        " */\n" + 
        "function testFunction1(opt_param) {}\n" + 
        "testFunction1();\n" + 
        "/**\n" + 
        " * @param {?MyType=} opt_param\n" + 
        " * @return {void}\n" + 
        " */\n" + 
        "function testFunction2(opt_param) {}\n" + 
        "testFunction2();";

    Compiler compiler = new Compiler();
    CompilerOptions options = new CompilerOptions();
    options.setExternExports(true);

    compiler.compile(
        CommandLineRunner.getBuiltinExterns(CompilerOptions.Environment.BROWSER),
        SourceFile.fromCode("test.js", jsSource),
        options);

    String externExports = compiler.toSource();
    assertFalse("Externs should not contain truncated typedef", externExports.contains("..."));
}