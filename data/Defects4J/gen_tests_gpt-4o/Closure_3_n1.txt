public void testOptimizationFailsWithVariableInCatchClause() {
    String code = "function getStack() {"
                + "  var getErrorObject = function() {"
                + "    try {"
                + "      throw Error('');"
                + "    } catch(err) {"
                + "      return err;"
                + "    }"
                + "  };"
                + "  return getErrorObject().stack;"
                + "}"
                + "window['getStackTrace'] = getStack;";

    CompilerOptions options = new CompilerOptions();
    CompilationLevel.SIMPLE_OPTIMIZATIONS.setOptionsForCompilationLevel(options);

    Compiler compiler = new Compiler();
    compiler.compile(SourceFile.fromCode("externs", ""), SourceFile.fromCode("test", code), options);

    String optimizedCode = compiler.toSource();
    assertFalse("Optimized code should not reference 'a': " + optimizedCode, optimizedCode.contains("return a.stack"));
}