
import org.jsoup.helper.DataUtil;
import org.jsoup.nodes.Document;
import org.junit.Test;

import java.io.ByteArrayInputStream;
import java.nio.charset.StandardCharsets;

import static org.junit.Assert.assertEquals;

public class DataUtilTest {

    @Test
    public void testUTF16BOMHandling() throws Exception {
        // UTF-16 encoded string with BOM
        byte[] utf16BytesWithBOM = new byte[] {
            (byte) 0xFE, (byte) 0xFF, // UTF-16 Big Endian BOM
            0x00, 0x3C, 0x00, 0x68, 0x00, 0x74, 0x00, 0x6D, 0x00, 0x6C, 0x00, 0x3E, // "<html>"
        };

        ByteArrayInputStream inputStream = new ByteArrayInputStream(utf16BytesWithBOM);

        // Invoke the method under test
        Document doc = DataUtil.parseByteData(inputStream, StandardCharsets.UTF_16.name(), "", DataUtil.defaultSettings());

        // Verify that the document is parsed correctly
        // Check for the root element's tag name to confirm parsing
        assertEquals("html", doc.child(0).tagName());
    }
}
