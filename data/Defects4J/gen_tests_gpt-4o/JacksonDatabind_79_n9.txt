public void testJsonIdentityReferenceOnClass() throws Exception {
    ObjectMapper mapper = new ObjectMapper();

    @JsonIdentityInfo(generator = ObjectIdGenerators.IntSequenceGenerator.class, property = "id")
    @JsonIdentityReference(alwaysAsId = true)
    class AlwaysReferencedAsId {
        public int id = 1;
        public int value;

        public AlwaysReferencedAsId(int value) {
            this.value = value;
        }
    }

    class Container {
        public AlwaysReferencedAsId reference = new AlwaysReferencedAsId(42);
    }

    Container container = new Container();
    String json = mapper.writeValueAsString(container);
    assertEquals("{\"reference\":1}", json);
}