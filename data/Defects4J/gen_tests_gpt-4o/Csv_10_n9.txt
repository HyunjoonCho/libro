
import org.apache.commons.csv.CSVFormat;
import org.apache.commons.csv.CSVPrinter;

import java.io.BufferedReader;
import java.io.IOException;
import java.nio.file.Files;
import java.nio.file.Paths;

import org.junit.Test;
import static org.junit.Assert.assertEquals;

public class CSVFormatTest {

    @Test
    public void testCSVPrinterWithHeader() throws IOException {
        String filePath = "data.csv";

        CSVPrinter csvPrinter = CSVFormat.TDF
                .withHeader("x")
                .print(Files.newBufferedWriter(Paths.get(filePath)));

        csvPrinter.printRecord(42);
        csvPrinter.close();

        try (BufferedReader reader = Files.newBufferedReader(Paths.get(filePath))) {
            assertEquals("Header line does not match", "x", reader.readLine());
            assertEquals("Record line does not match", "42", reader.readLine());
        }
    }
}
