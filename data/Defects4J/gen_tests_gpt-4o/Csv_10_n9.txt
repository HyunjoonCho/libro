public void testCSVFormatWithHeader() throws IOException {
    Path tempFile = Files.createTempFile("test", ".csv");
    CSVPrinter csvPrinter = CSVFormat.TDF
        .withHeader("x")
        .print(Files.newBufferedWriter(tempFile));
    
    csvPrinter.printRecord(42);
    csvPrinter.close();
    
    List<String> lines = Files.readAllLines(tempFile);
    Files.delete(tempFile);

    assertEquals("x", lines.get(0).trim());
    assertEquals("42", lines.get(1).trim());
}