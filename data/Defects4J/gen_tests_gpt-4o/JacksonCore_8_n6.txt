
import com.fasterxml.jackson.core.util.BufferRecycler;
import com.fasterxml.jackson.core.util.TextBuffer;
import org.junit.Test;
import static org.junit.Assert.assertEquals;
import static org.junit.Assert.assertNotNull;
import static org.junit.Assert.assertArrayEquals;

public class TextBufferTest {

    @Test
    public void testGetTextBufferInconsistency() {
        TextBuffer buffer = new TextBuffer(new BufferRecycler());
        buffer.resetWithEmpty();

        // First call to getTextBuffer(), expected to return null
        char[] firstCall = buffer.getTextBuffer();
        assertEquals("Expected getTextBuffer to return null initially", null, firstCall);

        // Call to contentsAsString(), expected to return empty string
        String contentAsString = buffer.contentsAsString();
        assertEquals("Expected contentsAsString to return empty string", "", contentAsString);

        // Second call to getTextBuffer(), expected to return empty array
        char[] secondCall = buffer.getTextBuffer();
        assertNotNull("Expected getTextBuffer to not return null after calling contentsAsString", secondCall);
        assertArrayEquals("Expected getTextBuffer to return empty array after contentsAsString", new char[0], secondCall);
    }
}
