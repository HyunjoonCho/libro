public void testOverzealousOptimization() {
    String jsCode = ""
        + "var uid;"
        + "function reset() {"
        + "  uid = Math.random();"
        + "}"
        + "function doStuff() {"
        + "  reset();"
        + "  var _uid = uid;"
        + "  if (uid < 0.5) {"
        + "    doStuff();"
        + "  }"
        + "  if (_uid !== uid) {"
        + "    throw 'reset() was called';"
        + "  }"
        + "}"
        + "doStuff();";

    // Assuming 'compileJavaScript' is a method that compiles JS code with advanced optimizations
    String optimizedCode = compileJavaScript(jsCode, CompilationLevel.ADVANCED_OPTIMIZATIONS);

    // Run the optimized code and capture the output
    try {
        executeJavaScript(optimizedCode);
        fail("The optimized code should throw an exception, but it did not.");
    } catch (Exception e) {
        assertEquals("reset() was called", e.getMessage());
    }
}