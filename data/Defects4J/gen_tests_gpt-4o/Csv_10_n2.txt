public void testCSVPrinterWithHeader() throws IOException {
    Path tempFile = Files.createTempFile("data", ".csv");
    CSVPrinter csvPrinter = CSVFormat.TDF
        .withHeader("x")
        .print(Files.newBufferedWriter(tempFile));

    csvPrinter.printRecord(42);
    csvPrinter.close();

    List<String> lines = Files.readAllLines(tempFile);
    assertEquals(2, lines.size());
    assertEquals("x", lines.get(0));
    assertEquals("42", lines.get(1));

    Files.deleteIfExists(tempFile);
}