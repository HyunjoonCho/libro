
import org.apache.commons.csv.CSVFormat;
import org.apache.commons.csv.CSVPrinter;
import org.junit.Test;

import java.io.BufferedReader;
import java.io.IOException;
import java.nio.file.Files;
import java.nio.file.Path;
import java.nio.file.Paths;

import static org.junit.Assert.assertEquals;

public class CSVPrinterTest {

    @Test
    public void testCSVPrinterWithHeader() throws IOException {
        Path filePath = Paths.get("data.csv");

        // Create a CSVPrinter with header
        CSVPrinter csvPrinter = CSVFormat.TDF
                .withHeader("x")
                .print(Files.newBufferedWriter(filePath));
        
        csvPrinter.printRecord(42);
        csvPrinter.close();
        
        // Read and verify the contents of the file
        try (BufferedReader reader = Files.newBufferedReader(filePath)) {
            String headerLine = reader.readLine();
            String dataLine = reader.readLine();

            assertEquals("x", headerLine);
            assertEquals("42", dataLine);
        } finally {
            Files.deleteIfExists(filePath); // Clean up the file after the test
        }
    }
}
