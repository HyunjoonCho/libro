@Test
public void testGetLegendItemsForNullDataset() {
    AbstractCategoryItemRenderer renderer = new AbstractCategoryItemRenderer() {
        // Implement abstract methods if necessary for the test
    };

    CategoryPlot mockPlot = mock(CategoryPlot.class);
    when(mockPlot.getIndexOf(renderer)).thenReturn(0);
    when(mockPlot.getDataset(0)).thenReturn(null);

    renderer.setPlot(mockPlot);

    // Call getLegendItems() and expect no exception due to NPE
    LegendItemCollection result = renderer.getLegendItems();

    // Expecting the result to be an empty LegendItemCollection
    assertNotNull(result);
    assertTrue(result.getItemCount() == 0);
}