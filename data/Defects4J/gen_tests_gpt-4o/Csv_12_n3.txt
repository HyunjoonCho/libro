
import org.apache.commons.csv.CSVFormat;
import org.apache.commons.csv.CSVParser;
import org.apache.commons.csv.CSVRecord;
import org.junit.Test;

import java.io.StringReader;
import java.util.List;

import static org.junit.Assert.assertEquals;
import static org.junit.Assert.assertNotNull;

public class CSVFormatTest {

    @Test
    public void testExcelFormatIgnoresEmptyHeaderNames() throws Exception {
        String csvData = "A,B,C,,\na,b,c,d,e";

        // Create a CSVParser with the EXCEL format
        CSVParser parser = CSVFormat.EXCEL.withHeader().parse(new StringReader(csvData));
        List<CSVRecord> records = parser.getRecords();

        // Validate the parsed results
        assertNotNull(records);
        assertEquals(1, records.size());

        CSVRecord record = records.get(0);
        assertEquals("a", record.get("A"));
        assertEquals("b", record.get("B"));
        assertEquals("c", record.get("C"));
        
        // Expectation: Empty header columns are ignored
        // "d" and "e" should not be assignable to valid headers, so further processing or verification on empty headers is omitted
    }
}
