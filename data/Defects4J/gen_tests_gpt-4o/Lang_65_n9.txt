
import org.apache.commons.lang3.time.DateUtils;
import org.junit.Test;

import java.util.Calendar;
import java.util.Date;
import java.util.TimeZone;

import static org.junit.Assert.assertEquals;

public class DateUtilsTest {

    @Test
    public void testTruncateDuringDSTSwitching() {
        // Set timezone to Mountain Daylight Time (MDT)
        TimeZone timeZone = TimeZone.getTimeZone("America/Denver");
        Calendar calendar = Calendar.getInstance(timeZone);

        // 2004-10-31 01:00:00 MDT
        calendar.set(2004, Calendar.OCTOBER, 31, 1, 0, 0);
        calendar.set(Calendar.MILLISECOND, 0);
        Date oct31_01MDT = calendar.getTime();

        // Truncate by hour
        Date result = DateUtils.truncate(oct31_01MDT, Calendar.HOUR_OF_DAY);

        // Assert that the truncated date equals the initial date
        assertEquals(oct31_01MDT, result);
    }
}
