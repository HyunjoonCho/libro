
import org.apache.commons.io.IOUtils;
import org.junit.Test;

import java.io.File;
import java.io.IOException;

import static org.junit.Assert.assertTrue;
import static org.junit.Assert.fail;

public class ClosureCompilerVersionTest {

    @Test
    public void testVersionFlag() {
        try {
            // Adjust the path to point to compiler.jar based on your environment
            File compilerJar = new File("path/to/compiler.jar");
            ProcessBuilder processBuilder = new ProcessBuilder(
                "java", "-jar", compilerJar.getAbsolutePath(), "--version"
            );
            processBuilder.redirectErrorStream(true);
            Process process = processBuilder.start();

            String output = IOUtils.toString(process.getInputStream(), "UTF-8");
            process.waitFor();

            // Check if the output contains version information as expected
            assertTrue("The version output did not contain expected version information.", 
                       output.contains("Version: 698"));
            assertTrue("The output should not contain an error message.", 
                       !output.toLowerCase().contains("option \"--version\" requires operand"));
            
        } catch (IOException | InterruptedException e) {
            fail("An error occurred while trying to execute the Closure Compiler: " + e.getMessage());
        }
    }
}
