
import org.junit.Test;
import java.io.File;
import java.io.IOException;

import static org.junit.Assert.fail;

public class ClosureCompilerTest {

    @Test
    public void testStackOverflowErrorWithClosureCompiler() {
        // Path to the Closure Compiler jar
        String compilerJarPath = "path/to/compiler.jar";
        // Path to the large/deep JS source file that causes the issue
        String jsFilePath = "path/to/AdMedia.eam.js";
        String jsOutputFilePath = "path/to/AdMedia.eam.min.js";

        ProcessBuilder processBuilder = new ProcessBuilder(
            "java", "-jar", compilerJarPath, "--js", jsFilePath, "--js_output_file", jsOutputFilePath
        );

        processBuilder.redirectErrorStream(true);

        try {
            Process process = processBuilder.start();
            int exitCode = process.waitFor();

            if (exitCode != 0) {
                fail("Closure Compiler process failed with exit code: " + exitCode);
            }
        } catch (IOException | InterruptedException e) {
            fail("Exception occurred during Closure Compiler execution: " + e.getMessage());
        }
    }
}
