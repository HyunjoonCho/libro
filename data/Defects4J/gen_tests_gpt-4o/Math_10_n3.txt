
import static org.junit.Assert.assertEquals;

import org.apache.commons.math3.analysis.differentiation.DerivativeStructure;
import org.junit.Test;

public class DerivativeStructureAtan2Test {

    @Test
    public void testAtan2SpecialCases() {
        // Create DerivativeStructure instances representing +/-0.0
        DerivativeStructure posZero = new DerivativeStructure(1, 1, 0.0);
        DerivativeStructure negZero = new DerivativeStructure(1, 1, -0.0);

        double tolerance = 1e-15; // Define a tolerance for floating-point comparisons

        // Compare DerivativeStructure.atan2 with Math.atan2 for special cases
        // (+0.0, +0.0)
        assertEquals(Math.atan2(0.0, 0.0), posZero.atan2(posZero).getValue(), tolerance);
        // (-0.0, +0.0)
        assertEquals(Math.atan2(-0.0, 0.0), negZero.atan2(posZero).getValue(), tolerance);
        // (+0.0, -0.0)
        assertEquals(Math.atan2(0.0, -0.0), posZero.atan2(negZero).getValue(), tolerance);
        // (-0.0, -0.0)
        assertEquals(Math.atan2(-0.0, -0.0), negZero.atan2(negZero).getValue(), tolerance);
    }
}
