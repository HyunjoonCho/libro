public void testDerivativeStructureAtan2SpecialCases() {
    double[][] testCases = {{0.0, 0.0}, {0.0, -0.0}, {-0.0, 0.0}, {-0.0, -0.0}};
    for (double[] testCase : testCases) {
        double y = testCase[0];
        double x = testCase[1];
        DerivativeStructure dsY = new DerivativeStructure(1, 1, 0, y);
        DerivativeStructure dsX = new DerivativeStructure(1, 1, 0, x);
        double expected = Math.atan2(y, x);
        assertEquals(expected, dsY.atan2(dsX).getValue(), 1e-15);
    }
}