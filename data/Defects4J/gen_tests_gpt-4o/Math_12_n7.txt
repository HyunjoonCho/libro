
import org.apache.commons.math3.distribution.GammaDistribution;
import org.apache.commons.math3.random.Well19937c;
import org.junit.Test;

import java.io.*;

import static org.junit.Assert.assertEquals;

public class GammaDistributionSerializationTest {

    @Test
    public void testGammaDistributionSerialization() throws IOException, ClassNotFoundException {
        // Create a GammaDistribution instance with specific parameters
        GammaDistribution originalDistribution = new GammaDistribution(new Well19937c(12345), 2.0, 2.0);
        
        // Sample a random number using the original distribution
        double originalSample = originalDistribution.sample();
        
        // Serialize the original distribution
        ByteArrayOutputStream byteOutStream = new ByteArrayOutputStream();
        ObjectOutputStream objectOutStream = new ObjectOutputStream(byteOutStream);
        objectOutStream.writeObject(originalDistribution);
        objectOutStream.close();
        
        // Deserialize to get a cloned distribution
        ByteArrayInputStream byteInStream = new ByteArrayInputStream(byteOutStream.toByteArray());
        ObjectInputStream objectInStream = new ObjectInputStream(byteInStream);
        GammaDistribution clonedDistribution = (GammaDistribution) objectInStream.readObject();
        objectInStream.close();
        
        // Sample a random number using the cloned distribution
        double clonedSample = clonedDistribution.sample();
        
        // Assert that samples from both distributions should be the same
        assertEquals("Samples from original and cloned distribution should match", originalSample, clonedSample, 1e-9);
    }
}
