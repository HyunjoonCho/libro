
import com.google.javascript.jscomp.CommandLineRunner;
import com.google.javascript.jscomp.CompilerOptions;
import com.google.javascript.jscomp.Result;
import com.google.javascript.jscomp.SourceFile;
import org.junit.Test;
import java.util.ArrayList;
import java.util.List;

import static org.junit.Assert.assertEquals;

public class ClosureCompilerTest {

    @Test
    public void testECMAScript5StrictCompilation() throws Exception {
        // Input JavaScript files as SourceFile objects
        SourceFile getNumJs = SourceFile.fromCode("get_num.js", "var getNum = function() { return 5; };");
        SourceFile alertJs = SourceFile.fromCode("alert.js", "alert(getNum());");

        List<SourceFile> inputFiles = new ArrayList<>();
        inputFiles.add(getNumJs);
        inputFiles.add(alertJs);

        // Prepare compiler options
        CompilerOptions options = new CompilerOptions();
        options.setLanguageIn(CompilerOptions.LanguageMode.ECMASCRIPT5_STRICT);
        options.setCompilationLevel(CompilerOptions.CompilationLevel.ADVANCED_OPTIMIZATIONS);

        // Run the compiler with the given options and input files
        com.google.javascript.jscomp.Compiler compiler = new com.google.javascript.jscomp.Compiler();
        Result result = compiler.compile(new ArrayList<SourceFile>(), inputFiles, options);

        // Expected output
        String expectedOutput = "'use strict';alert(5);";

        // Verify that the output is as expected
        assertEquals(expectedOutput, compiler.toSource());
    }
}
