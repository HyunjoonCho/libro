public void testExternExportWithTypedef() {
    String sourceCode = "/** @typedef {function(number, string=): boolean} */\n" +
                        "var MyType;\n" +
                        "/** @type {MyType} */\n" +
                        "var myFunc1;\n" +
                        "/** @type {MyType} */\n" +
                        "var myFunc2 = function(num, optStr) { return true; };\n" +
                        "myFunc1(1);\n" +
                        "myFunc2(2, 'test');";

    Compiler compiler = new Compiler();
    CompilerOptions options = new CompilerOptions();
    options.setLanguageIn(CompilerOptions.LanguageMode.ECMASCRIPT5);
    options.setExternExports(true);

    Result result = compiler.compile(SourceFile.fromCode("externs.js", ""), 
                                     SourceFile.fromCode("input.js", sourceCode), options);

    String externExports = compiler.toSource();
    
    assertFalse("Extern exports should not contain truncated typedef body", externExports.contains("..."));
    // Additional checks can be made here to ensure proper extern export format.
}