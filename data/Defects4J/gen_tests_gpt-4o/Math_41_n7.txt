
import org.apache.commons.math3.stat.descriptive.moment.Variance;
import org.junit.Test;

import static org.junit.Assert.assertEquals;

public class VarianceTest {

    @Test
    public void testVarianceEvaluateWithLength() {
        double[] values = {1.0, 2.0, 3.0, 4.0, 5.0};
        double[] weights = {1.0, 1.0, 1.0, 1.0, 1.0};
        int begin = 1;
        int length = 3; // Only values[1] to values[3] should be considered: {2.0, 3.0, 4.0}
        double expectedMean = 3.0; // Mean of {2.0, 3.0, 4.0} is 3.0

        Variance variance = new Variance();
        double result = variance.evaluate(values, weights, expectedMean, begin, length);
        
        // Calculate expected variance: (1/3) * ((2-3)^2 + (3-3)^2 + (4-3)^2) = (1/3) * (1 + 0 + 1) = 2/3
        double expectedVariance = 2.0 / 3.0;

        assertEquals("Variance calculated should consider only the specified subset of values", expectedVariance, result, 1e-9);
    }
}
