
import org.junit.Test;
import java.io.ByteArrayOutputStream;
import java.io.PrintStream;

import static org.junit.Assert.assertTrue;

public class CompilerDefineTest {

    @Test
    public void testDefineStringUsage() {
        // Redirect standard error to capture the compiler's output
        ByteArrayOutputStream errContent = new ByteArrayOutputStream();
        System.setErr(new PrintStream(errContent));

        String[] args = {
            "--compilation_level", "ADVANCED_OPTIMIZATIONS",
            "--define", "test.VERSION=1.0.0",
            "--js_output_file", "test-min.js",
            "--js", "test.js"
        };

        try {
            com.google.javascript.jscomp.CommandLineRunner.main(args);
        } catch (Exception e) {
            // Exception expected, capture message
        }

        // Assert that the error indicates a problem with the --define syntax
        String errorOutput = errContent.toString();
        assertTrue(errorOutput.contains("--define flag syntax invalid: test.VERSION=1.0.0"));

        // Clean up: Resetting the standard error stream
        System.setErr(System.err);
    }
}
