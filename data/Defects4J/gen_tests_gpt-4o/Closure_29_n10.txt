public void testClosureCompilerIsFunction() {
    ScriptEngine engine = new ScriptEngineManager().getEngineByName("nashorn");
    try {
        // Original code that fails when compiled by Closure Compiler
        engine.eval("var isFunction = function(functionToCheck) { " +
                    "var getType;" +
                    "getType = {};" +
                    "return functionToCheck && getType.toString.apply(functionToCheck) === '[object Function]';" +
                    "};");
        
        engine.eval("var check = function() {};"); // A dummy function to test
        assertEquals(true, ((Invocable) engine).invokeFunction("isFunction", engine.eval("check")));
        
        // Code that works around the Closure Compiler issue
        engine.eval("var isFunctionFixed = function(functionToCheck) { " +
                    "var getType;" +
                    "getType = [];" +
                    "return functionToCheck && getType.toString.apply(functionToCheck) === '[object Function]';" +
                    "};");

        assertEquals(true, ((Invocable) engine).invokeFunction("isFunctionFixed", engine.eval("check")));
    } catch (ScriptException | NoSuchMethodException e) {
        fail("Script execution failed: " + e.getMessage());
    }
}