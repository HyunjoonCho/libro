
import org.jsoup.Jsoup;
import org.jsoup.nodes.Document;
import org.jsoup.nodes.Element;
import org.junit.Test;

import static org.junit.Assert.assertTrue;

public class ElementSiblingIndexTest {

    @Test
    public void testElementSiblingIndex() {
        String html = "<table>" +
                      "<tr><td>Cell1</td><td>Cell2</td></tr>" +
                      "<tr><td>Cell1</td><td>Cell2</td></tr>" +
                      "<tr><td>Cell1</td><td>Cell2</td></tr>" +
                      "</table>";
        
        Document doc = Jsoup.parse(html);
        Element secondRow = doc.select("tr").get(1);
        Element fifthRow = doc.select("tr").get(2);

        // Check that both rows have the same content
        assertTrue(secondRow.equals(fifthRow));

        // Get the sibling index for each row
        int secondRowIndex = secondRow.elementSiblingIndex();
        int fifthRowIndex = fifthRow.elementSiblingIndex();

        // Assert that the indices are different despite rows being identical
        // The issue indicated that identical rows might have the same index.
        assertTrue("Expected indices to differ, but both are the same", secondRowIndex != fifthRowIndex);

        // Instead, they should be checked by equality
        assertTrue(secondRow.parent().children().get(secondRowIndex).equals(secondRow));
        assertTrue(fifthRow.parent().children().get(secondRowIndex).equals(fifthRow));
    }
}
