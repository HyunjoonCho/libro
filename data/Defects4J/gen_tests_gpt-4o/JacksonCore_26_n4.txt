public void testNonBlockingParserOffsetIssue() throws Exception {
    JsonFactory jsonFactory = new JsonFactory();
    JsonParser parser = jsonFactory.createNonBlockingByteArrayParser();
    ByteArrayFeeder feeder = (ByteArrayFeeder) parser.getNonBlockingInputFeeder();

    byte[] input = "[[[".getBytes(UTF_8);

    // Feed with offset
    feeder.feedInput(input, 7, 3);
    assertEquals(JsonToken.START_ARRAY, parser.nextToken());
    assertEquals(1, parser.getCurrentLocation().getByteOffset() - 7); // Expected should be 1 and actual is offset by 7
    assertEquals(1, parser.getTokenLocation().getByteOffset() - 7);   // Expected should be 1 and actual is offset by 7

    // Feed without offset from the beginning
    feeder.feedInput(input, 0, 1);
    assertEquals(JsonToken.START_ARRAY, parser.nextToken());
    assertEquals(2, parser.getCurrentLocation().getByteOffset());
    assertEquals(2, parser.getTokenLocation().getByteOffset());
}