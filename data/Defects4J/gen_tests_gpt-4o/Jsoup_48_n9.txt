
import org.jsoup.Connection.Response;
import org.jsoup.Jsoup;
import org.jsoup.helper.HttpConnection;
import org.junit.Test;

import java.io.IOException;
import java.util.List;
import java.util.Map;

import static org.junit.Assert.assertEquals;

public class DuplicateHeaderTest {

    // Mock Response class to simulate Jsoup's response
    class MockResponse extends HttpConnection.Response {
        private final Map<String, List<String>> headers;

        MockResponse(Map<String, List<String>> headers) {
            super(null);
            this.headers = headers;
        }

        @Override
        public Map<String, List<String>> headers() {
            return headers;
        }
    }

    @Test
    public void testDuplicateHeader() throws IOException {
        Map<String, List<String>> mockHeaders = Map.of(
            "X-Powered-By", List.of("PHP/5.2.8", "ASP.NET")
        );

        MockResponse mockResponse = new MockResponse(mockHeaders);
        
        // Simulate Jsoup's behavior when parsing headers
        String headerValue = mockResponse.header("X-Powered-By");
        
        // The expected behavior after the proposed fix is that the returned header
        // should concatenate the multiple entries.
        String expectedHeaderValue = "PHP/5.2.8 ASP.NET";

        // This assertion simulates the check after the suggested fix, expecting that
        // the headers would be concatenated.
        assertEquals(expectedHeaderValue, headerValue);
    }
}
