
import org.junit.Test;

import java.io.ByteArrayInputStream;
import java.io.IOException;
import java.util.zip.ZipInputStream;
import java.util.zip.ZipException;

import static org.junit.Assert.assertTrue;

public class ZipFileErrorMessageTest {

    @Test
    public void testTruncatedZipFileProducesReadableErrorMessage() throws IOException {
        // Create a truncated zip file
        byte[] truncatedZip = new byte[]{0x50, 0x4b, 0x03, 0x04}; // PK header but no contents

        try (ZipInputStream zis = new ZipInputStream(new ByteArrayInputStream(truncatedZip))) {
            zis.getNextEntry(); // Attempt to read the entry
        } catch (ZipException e) {
            // Check that the exception message is readable and does not contain a huge array dump
            String message = e.getMessage();
            System.out.println("Exception Message: " + message);
            assertTrue("Exception message should be readable", message.length() < 500);
        }
    }
}
