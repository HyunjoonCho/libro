
import static org.junit.Assert.assertNotNull;
import static org.mockito.MockitoAnnotations.initMocks;

import org.junit.Before;
import org.junit.Test;
import org.mockito.InjectMocks;
import org.mockito.Mock;

public class InjectMocksFinalFieldTest {

    // The class with the final field to be injected
    static class ClassWithFinalDependency {
        @InjectMocks
        private final Dependency dependency;

        ClassWithFinalDependency() {
            this.dependency = null; // This should have been injected by Mockito
        }

        Dependency getDependency() {
            return dependency;
        }
    }

    // A simple dependency class
    static class Dependency {
    }

    // Mocks
    @Mock
    private Dependency mockDependency;

    // The instance under test
    @InjectMocks
    private ClassWithFinalDependency classWithFinalDependency;

    @Before
    public void setUp() {
        // Initialize objects with Mockito annotations
        initMocks(this);
    }

    @Test
    public void testFinalFieldInjection() {
        // Verifies that the final field was not injected
        assertNotNull("Final fields should be injected, but they are not.", classWithFinalDependency.getDependency());
    }
}
