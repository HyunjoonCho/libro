public void testClassCastExceptionDuringTypeCheck() {
    try {
        JSTypeRegistry registry = new JSTypeRegistry(null);
        RecordTypeBuilder recordTypeBuilder = new RecordTypeBuilder(registry);
        recordTypeBuilder.addProperty("prop", registry.getNativeType(JSTypeNative.STRING_TYPE), null);
        RecordType recordType = recordTypeBuilder.build();

        ObjectType proxyObjectType = new ProxyObjectType(registry, recordType);
        NamedType namedType = new NamedType(registry, "TestType", "", -1, -1);

        namedType.resolve(registry.getErrorReporter(), registry.getGlobalScope());

        assertTrue(proxyObjectType.toObjectType().isSubtype(namedType));
    } catch (ClassCastException e) {
        fail("ClassCastException was thrown during TypeCheck pass");
    }
}