public void testParsePaxHeadersNegativeArraySizeException() {
    byte[] invalidPaxHeader = "100 path=somefile\n\n".getBytes(StandardCharsets.UTF_8);
    try (ByteArrayInputStream byteArrayInputStream = new ByteArrayInputStream(invalidPaxHeader);
         TarArchiveInputStream tarArchiveInputStream = new TarArchiveInputStream(byteArrayInputStream)) {
        tarArchiveInputStream.getNextTarEntry(); // Initiates parsing of PAX headers
        fail("Expected NegativeArraySizeException");
    } catch (NegativeArraySizeException ex) {
        // Expected exception
    } catch (IOException ex) {
        fail("Unexpected IOException: " + ex.getMessage());
    }
}