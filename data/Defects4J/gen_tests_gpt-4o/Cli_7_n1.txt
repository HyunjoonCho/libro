
package org.apache.commons.cli2.bug;

import junit.framework.TestCase;
import org.apache.commons.cli2.CommandLine;
import org.apache.commons.cli2.Group;
import org.apache.commons.cli2.Option;
import org.apache.commons.cli2.builder.DefaultOptionBuilder;
import org.apache.commons.cli2.builder.GroupBuilder;
import org.apache.commons.cli2.commandline.Parser;

public class Bug27575Test extends TestCase {

    public void testRequiredOptions() {
        DefaultOptionBuilder optionBuilder = new DefaultOptionBuilder();
        Option helpOption = optionBuilder.withShortName("h").create();
        Option configOption = optionBuilder.withShortName("c").withArgument().create();

        GroupBuilder groupBuilder = new GroupBuilder();
        Group group = groupBuilder.withOption(helpOption).withOption(configOption).withMinimum(1).create();

        Parser parser = new Parser();
        parser.setGroup(group);

        // This input string is likely the source of the error:
        String[] args = {"-c", "argument"};

        try {
            CommandLine cmdLine = parser.parse(args);
            boolean conditionMet = cmdLine.hasOption(helpOption);
            assertTrue("Expected help option to be present", conditionMet);
        } catch (Exception e) {
            fail("Parsing failed with exception: " + e.getMessage());
        }
    }

}
