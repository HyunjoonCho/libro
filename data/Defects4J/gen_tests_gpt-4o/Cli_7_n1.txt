public void testRequiredOptions() {
    CommandLineParser parser = new PosixParser();
    Options options = new Options();
    
    options.addOption("h", false, "help");
    options.addOption("c", true, "config");
    
    String[] args = {"-c", "someconfig"};
    CommandLine cmd = parser.parse(options, args);
    
    boolean isHelp = cmd.hasOption("h");
    boolean isConfig = cmd.hasOption("c");
    
    assertFalse("Help option should not be present", isHelp);
    assertTrue("Config option should be present", isConfig);
    
    assertEquals("Expected -h option to be missed", "[-h]", JUnitHelper.getExpectedAndActualOutputForErrors(isHelp, isConfig));
}

private String getExpectedAndActualOutputForErrors(boolean isHelp, boolean isConfig) {
    if (isHelp && !isConfig) {
        return "[-h]";
    }
    return "-c <arg>";
}