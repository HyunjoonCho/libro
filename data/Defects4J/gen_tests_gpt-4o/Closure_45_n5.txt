
import static org.junit.Assert.assertEquals;
import java.util.Arrays;
import java.util.List;

import org.junit.Test;

public class ClosureCompilerBugTest {

    @Test
    public void testAssignmentInPushExpression() {
        List<List<Integer>> expected = Arrays.asList(Arrays.asList(1));
        List<List<Integer>> result = f();

        assertEquals(expected, result);
    }

    public List<List<Integer>> f() {
        List<List<Integer>> a = new java.util.ArrayList<>();
        List<Integer> b;
        a.add(b = new java.util.ArrayList<>()); // This is equivalent to a.push(b = []) in Java
        b.add(0, 1); // Equivalent to b[0] = 1 in JavaScript
        return a;
    }
}
