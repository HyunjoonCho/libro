
import org.apache.commons.cli.HelpFormatter;
import org.apache.commons.cli.Options;

public class HelpFormatterInfiniteLoopTest {

    @Test
    public void testInfiniteLoopCase() {
        Options options = new Options();
        options.addOption("h", "help", false, "This is a looooong description");

        HelpFormatter formatter = new HelpFormatter();
        formatter.setWidth(20);

        // Capture output to prevent excessive console printing during test
        ByteArrayOutputStream outputStream = new ByteArrayOutputStream();
        PrintStream originalOut = System.out;
        System.setOut(new PrintStream(outputStream));

        try {
            formatter.printHelp("app", options); // Should not hang & crash
            String output = outputStream.toString();
            assertFalse("Output should not be empty", output.isEmpty());
        } finally {
            System.setOut(originalOut);
        }
    }
}
