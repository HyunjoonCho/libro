
import org.apache.commons.math3.analysis.differentiation.DerivativeStructure;
import org.apache.commons.math3.util.FastMath;
import org.junit.Test;
import static org.junit.Assert.assertEquals;

public class DerivativeStructureAtan2Test {

    @Test
    public void testAtan2SpecialCases() {
        // +0.0, +0.0
        checkAtan2(0.0, 0.0, Math.atan2(0.0, 0.0));

        // -0.0, +0.0
        checkAtan2(-0.0, 0.0, Math.atan2(-0.0, 0.0));

        // +0.0, -0.0
        checkAtan2(0.0, -0.0, Math.atan2(0.0, -0.0));

        // -0.0, -0.0
        checkAtan2(-0.0, -0.0, Math.atan2(-0.0, -0.0));
    }

    private void checkAtan2(double y, double x, double expected) {
        DerivativeStructure yDs = new DerivativeStructure(1, 0, 0, y);
        DerivativeStructure xDs = new DerivativeStructure(1, 0, 0, x);
        double result = yDs.atan2(xDs).getValue();
        assertEquals(expected, result, 1e-15);
    }
}
