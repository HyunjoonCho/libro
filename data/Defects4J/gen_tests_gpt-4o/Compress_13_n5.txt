
import org.apache.commons.compress.archivers.ArchiveEntry;
import org.apache.commons.compress.archivers.ArchiveException;
import org.apache.commons.compress.archivers.ArchiveInputStream;
import org.apache.commons.compress.archivers.ArchiveStreamFactory;
import org.apache.commons.compress.archivers.zip.ZipArchiveInputStream;
import org.junit.Test;

import java.io.FileInputStream;
import java.io.IOException;

import static org.junit.Assert.assertTrue;

public class UmlautZipTest {

    @Test
    public void testUmlautDirectoryHandling() throws IOException, ArchiveException {
        try (FileInputStream fis = new FileInputStream("umlaut.zip");
             ArchiveInputStream archiveInputStream = new ArchiveStreamFactory()
                     .createArchiveInputStream(ArchiveStreamFactory.ZIP, fis)) {

            boolean foundDirectoryWithUmlaut = false;

            ArchiveEntry entry;
            while ((entry = archiveInputStream.getNextEntry()) != null) {
                System.out.println("Entry Name: " + entry.getName());
                if (entry.getName().contains("test√§") && entry.isDirectory()) {
                    foundDirectoryWithUmlaut = true;
                    break;
                }
            }
            assertTrue("Directory with umlaut should be recognized as a directory", foundDirectoryWithUmlaut);
        }
    }
}
