
import org.jsoup.nodes.Element;
import org.jsoup.parser.Tag;
import org.junit.Test;

import java.util.Collections;
import java.util.HashSet;
import java.util.Set;

import static org.junit.Assert.*;

public class ElementCloneTest {

    @Test
    public void testElementCloneDoesNotShareClassNames() {
        // Create an original Element
        Element originalElement = new Element(Tag.valueOf("div"), "");
        
        // Add a className to the original Element
        originalElement.classNames().add("testClass");

        // Clone the original Element
        Element clonedElement = (Element) originalElement.clone();

        // Verify that the classNames Set is shared inappropriately
        Set<String> originalClassNames = originalElement.classNames();
        Set<String> clonedClassNames = clonedElement.classNames();

        // They should not be the same instance
        assertNotSame("The classNames Set should not be shared between original and cloned elements",
                originalClassNames, clonedClassNames);

        // Change classNames in clone
        clonedClassNames.add("anotherClass");

        // Now check the sets are not equal
        assertEquals(Collections.singleton("testClass"), originalClassNames);
        assertTrue("The cloned classNames should contain the new class", clonedClassNames.contains("anotherClass"));
    }
}
