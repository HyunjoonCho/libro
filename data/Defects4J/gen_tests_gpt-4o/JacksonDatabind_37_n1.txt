
import com.fasterxml.jackson.annotation.JsonTypeInfo;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.databind.exc.UnrecognizedPropertyException;
import org.junit.Test;

import static org.junit.Assert.assertEquals;
import static org.junit.Assert.fail;

public class JsonTypeDefaultImplTest {

    @JsonTypeInfo(
        use = JsonTypeInfo.Id.CLASS,
        include = JsonTypeInfo.As.PROPERTY,
        property = "@class",
        defaultImpl = JsonMapSchema.class
    )
    static class JsonSchema {
        public String name;
    }

    static class JsonMapSchema extends JsonSchema {
        public JsonMapSchema() {
            // empty constructor
        }
        
        // Other properties can be added here if needed
    }

    @Test
    public void testDeserializeJsonWithInheritedField() {
        String json = "{\n"
                    + "  \"@class\": \"org.apache.calcite.model.JsonMapSchema\",\n"
                    + "  \"name\": \"FoodMart\",\n"
                    + "  \"tables\": []"
                    + "}";

        ObjectMapper objectMapper = new ObjectMapper();
        
        try {
            JsonSchema result = objectMapper.readValue(json, JsonSchema.class);
            assertEquals("FoodMart", result.name);
        } catch (UnrecognizedPropertyException e) {
            fail("Field 'name' should not be unrecognized. Test failed with message: " + e.getMessage());
        } catch (Exception e) {
            fail("Unexpected exception: " + e.getMessage());
        }
    }
}
