
import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.databind.exc.InvalidTypeIdException;
import org.junit.Test;

import static org.junit.Assert.assertThrows;

public class JdkTypeDeserializationTest {

    static class Wrapper {
        public Object value;
    }

    @Test
    public void testBlockedJdkTypeDeserialization() {
        ObjectMapper mapper = new ObjectMapper();

        // Assuming "jdk.nashorn.internal.objects.NativeString" is one of the restricted classes.
        String json = "{\"value\": [\"com.sun.something.InsecureType\", {\"property\": \"value\"}]}";

        assertThrows(InvalidTypeIdException.class, () -> {
            mapper.readValue(json, Wrapper.class);
        });
    }
}
