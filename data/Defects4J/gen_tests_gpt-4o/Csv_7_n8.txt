public void testHeaderMapWithDuplicateColumns() throws IOException {
    String csvData =
            "Col1,Col2,Col2,Col3,Col4\n" +
            "1,2,3,4,5\n" +
            "4,5,6,7,8\n";

    CSVFormat myFormat = CSVFormat.RFC4180.withDelimiter(',')
            .withQuoteChar('"')
            .withQuotePolicy(Quote.MINIMAL)
            .withIgnoreSurroundingSpaces(true)
            .withHeader()
            .withSkipHeaderRecord(true);

    try (CSVParser parser = CSVParser.parse(csvData, myFormat)) {
        Map<String, Integer> headerMap = parser.getHeaderMap();
        assertEquals(5, headerMap.size()); // Expected to be 5, but usually ends up as 4 due to duplicate headers
    }
}