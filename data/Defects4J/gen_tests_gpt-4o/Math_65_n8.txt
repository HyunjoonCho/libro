public void testChiSquareCalculation() {
    AbstractLeastSquares leastSquares = new AbstractLeastSquares() {
        @Override
        public double[][] jacobian() {
            return new double[][]{{1.0, 2.0}, {3.0, 4.0}};
        }

        @Override
        public double[] residuals() {
            return new double[]{2.0, 3.0};
        }

        @Override
        public double[] theoreticalValues() {
            return new double[]{0.0, 0.0};
        }
    };

    leastSquares.setResidualsWeights(new double[]{2.0, 3.0});
    double expectedChiSquare = 13.0; // Calculated as 2*(2.0^2) + 3*(3.0^2)
    assertEquals(expectedChiSquare, leastSquares.getChiSquare(), 1e-9);
}