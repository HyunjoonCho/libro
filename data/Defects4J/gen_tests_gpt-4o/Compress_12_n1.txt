
import org.apache.commons.compress.archivers.tar.TarArchiveEntry;
import org.apache.commons.compress.archivers.tar.TarArchiveInputStream;
import org.junit.Test;

import java.io.ByteArrayInputStream;
import java.io.IOException;

public class TarArchiveInputStreamTest {

    @Test(expected = IOException.class)
    public void testIllegalArgumentExceptionIsWrappedAsIOException() throws IOException {
        byte[] corruptedTarData = new byte[] {
            0, 0, 0, 0, 0, 0, 0, -1 // Corrupted data that doesn't form a valid tar entry header
        };

        ByteArrayInputStream bais = new ByteArrayInputStream(corruptedTarData);
        TarArchiveInputStream tais = new TarArchiveInputStream(bais);

        try {
            TarArchiveEntry entry;
            while ((entry = tais.getNextTarEntry()) != null) {
                // Process entries (no actual processing needed)
            }
        } finally {
            tais.close();
        }
    }
}
