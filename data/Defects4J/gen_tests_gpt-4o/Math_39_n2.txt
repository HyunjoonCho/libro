public void testTooLargeFirstStepWithDormandPrince() {
    double[] y = new double[] { 0.0 };
    double t0 = 0.0;
    double t1 = 1e-10; // Extremely short range
    FirstOrderDifferentialEquations ode = new FirstOrderDifferentialEquations() {
        public int getDimension() { return 1; }
        public void computeDerivatives(double t, double[] y, double[] yDot) {
            yDot[0] = 1.0;
        }
    };

    DormandPrince853Integrator integrator = new DormandPrince853Integrator(1.0e-15, 1.0, 1.0e-10, 1.0e-10);
    try {
        integrator.integrate(ode, t0, y, t1, y);
        fail("Expecting an exception due to too large step size");
    } catch (NumberIsTooSmallException e) {
        // Expected exception due to too large step size
    }
}