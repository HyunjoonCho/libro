
import org.jsoup.Jsoup;
import org.jsoup.nodes.Document;
import org.jsoup.helper.DataUtil;
import org.junit.Test;

import java.io.ByteArrayInputStream;
import java.nio.charset.StandardCharsets;

import static org.junit.Assert.assertEquals;

public class DataUtilTest {

    @Test
    public void testParseByteDataWithUTF16BOM() throws Exception {
        // Example UTF-16 with BOM string: "Hello" in English
        byte[] utf16BomData = new byte[] {(byte) 0xFE, (byte) 0xFF, 0x00, 0x48, 0x00, 0x65, 0x00, 0x6C, 0x00, 0x6C, 0x00, 0x6F};

        // Create an input stream from the bytes
        ByteArrayInputStream inputStream = new ByteArrayInputStream(utf16BomData);

        // Assuming the parse method exists and works similarly to this example
        // Parse the byte data with Jsoup, expect it to decode correctly with the BOM considered
        Document doc = DataUtil.parseByteData(Jsoup.parse(new String(utf16BomData, StandardCharsets.UTF_16)), inputStream);
        
        // Check if the parsed text matches the expected output
        assertEquals("Hello", doc.text());
    }
}
