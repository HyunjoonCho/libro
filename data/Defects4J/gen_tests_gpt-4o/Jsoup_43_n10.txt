
import org.jsoup.Jsoup;
import org.jsoup.nodes.Document;
import org.jsoup.nodes.Element;
import org.junit.Test;
import static org.junit.Assert.*;

public class ElementSiblingIndexTest {

    @Test
    public void testElementSiblingIndex() {
        String html = "<table>" +
                      "<tr><td>Row 1, Cell 1</td><td>Row 1, Cell 2</td></tr>" +
                      "<tr><td>Row 2, Cell 1</td><td>Row 2, Cell 2</td></tr>" +
                      "<tr><td>Row 3, Cell 1</td><td>Row 3, Cell 2</td></tr>" +
                      "<tr><td>Row 4, Cell 1</td><td>Row 4, Cell 2</td></tr>" +
                      "<tr><td>Row 5, Cell 1</td><td>Row 5, Cell 2</td></tr>" +
                      "</table>";

        Document doc = Jsoup.parse(html);
        Element row2 = doc.select("tr").get(1); // 2nd <tr>
        Element row5 = doc.select("tr").get(4); // 5th <tr>

        int indexRow2 = row2.elementSiblingIndex();
        int indexRow5 = row5.elementSiblingIndex();

        // Test the unexpected behavior
        assertNotEquals("Element siblings with identical content should have different indices", indexRow2, indexRow5);

        // Ensure the elements at these indices are equal in content
        assertTrue("Elements at the same index should be equal in content", 
                   row2.equals(row2.parent().children().get(indexRow2)));

        assertTrue("Elements at the same index should be equal in content", 
                   row5.equals(row5.parent().children().get(indexRow5)));
    }
}
