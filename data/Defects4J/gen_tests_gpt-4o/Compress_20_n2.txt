
import org.junit.Test;
import java.io.ByteArrayInputStream;
import java.io.IOException;

public class CpioTest {

    @Test(expected = IllegalArgumentException.class)
    public void testReadCpioWithNonZeroTrailer() throws IOException {
        // Simulating a CPIO archive generated by Redline RPM with a non-zero file mode on the trailer
        byte[] cpioDataWithNonZeroTrailer = createCpioDataWithNonZeroTrailer();
        
        try (ByteArrayInputStream bais = new ByteArrayInputStream(cpioDataWithNonZeroTrailer)) {
            CpioUtil.readCpio(bais);
        }
    }

    private byte[] createCpioDataWithNonZeroTrailer() {
        // Crafting a byte array that mimics a CPIO archive with a non-zero file mode on the trailer
        // This is just an example, the real data needs to resemble the actual CPIO format
        return new byte[] {
            // ... [header and file contents simulation] ...
            
            0x00, 0x00, 0x00, 0x00,  // CPIO trailer without a zero file mode
            // ... Other bytes simulating the archive content ...
        };
    }
}
