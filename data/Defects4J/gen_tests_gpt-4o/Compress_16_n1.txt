
import org.apache.commons.compress.archivers.ArchiveException;
import org.apache.commons.compress.archivers.ArchiveInputStream;
import org.apache.commons.compress.archivers.ArchiveStreamFactory;
import org.junit.Test;

import java.io.File;
import java.io.FileInputStream;
import java.io.InputStream;

import static org.junit.Assert.fail;

public class ArchiveDetectionTest {

    @Test
    public void testDetectNonTarFileAsTar() {
        File testAiffFile = new File("path/to/testAIFF.aif");
        try (InputStream is = new FileInputStream(testAiffFile)) {
            ArchiveStreamFactory factory = new ArchiveStreamFactory();
            try {
                ArchiveInputStream ais = factory.createArchiveInputStream(is);
                // If we reach this point, it incorrectly detected the AIFF file as a TAR archive
                fail("AIFF file was incorrectly detected as a TAR archive.");
            } catch (ArchiveException e) {
                // Expected behavior: the file should not be detected as a TAR archive
                System.out.println("Correctly detected as not a TAR archive: " + e.getMessage());
            }
        } catch (Exception e) {
            e.printStackTrace();
            fail("An unexpected exception occurred: " + e.getMessage());
        }
    }
}
