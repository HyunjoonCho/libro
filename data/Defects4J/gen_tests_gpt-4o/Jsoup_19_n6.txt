
import org.jsoup.Jsoup;
import org.jsoup.nodes.Document;
import org.jsoup.safety.Safelist;
import org.junit.Assert;
import org.junit.Test;

public class JsoupSanitizerTest {
    
    @Test
    public void testCidReferencePreservation() {
        // Original HTML with CID reference
        String htmlWithCid = "<html><body><img src=\"cid:unique-image-id\"></body></html>";
        
        // Use Jsoup to sanitize the HTML
        Document.OutputSettings outputSettings = new Document.OutputSettings();
        // Ensure img tags are preserved during sanitization
        outputSettings.prettyPrint(false); 
        Safelist safelist = Safelist.basicWithImages();

        // Parse and clean the HTML
        String sanitizedHtml = Jsoup.clean(htmlWithCid, "", safelist, outputSettings);

        // Check if the CID reference is preserved
        String expectedHtml = "<img src=\"cid:unique-image-id\">";
        Assert.assertEquals(expectedHtml, sanitizedHtml);
    }
}
