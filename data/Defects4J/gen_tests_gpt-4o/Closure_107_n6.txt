
import com.google.javascript.jscomp.*;
import com.google.javascript.rhino.Node;
import org.junit.Test;

import java.util.ArrayList;
import java.util.List;

import static org.junit.Assert.assertEquals;

public class ClosureCompilerTest {

    @Test
    public void testMsgPrefixVariableNameAdvancedOptimizations() {
        // Configure the compiler options
        CompilerOptions options = new CompilerOptions();
        CompilationLevel.ADVANCED_OPTIMIZATIONS.setOptionsForCompilationLevel(options);

        // Create a new compiler instance
        Compiler compiler = new Compiler();
        
        // Prepare your source code
        String jsCode = "var MSG_foo = 'bar';";
        
        // Create a list holding the source inputs
        List<SourceFile> inputs = new ArrayList<>();
        inputs.add(SourceFile.fromCode("input.js", jsCode));
        
        // Empty externs list
        List<SourceFile> externs = CommandLineRunner.getDefaultExterns();
        
        // Compile the code
        Result result = compiler.compile(externs, inputs, options);
        
        // Check for errors related to MSG_ variable names
        assertEquals(1, result.errors.length);
        assertEquals("message not initialized using goog.getMsg", result.errors[0].getDescription());
    }
}
