public void testZipLocalAndCentralDirectoryVersionMismatch() throws IOException {
    ByteArrayOutputStream byteArrayOutputStream = new ByteArrayOutputStream();
    BufferedOutputStream bufferedOutputStream = new BufferedOutputStream(byteArrayOutputStream);
    ZipArchiveOutputStream zipOutputStream = new ZipArchiveOutputStream(bufferedOutputStream);

    ZipArchiveEntry entry = new ZipArchiveEntry("test.txt");
    entry.setMethod(ZipArchiveEntry.DEFLATED);

    zipOutputStream.putArchiveEntry(entry);
    zipOutputStream.write("Hello, World!".getBytes());
    zipOutputStream.closeArchiveEntry();
    zipOutputStream.close();

    byte[] zipBytes = byteArrayOutputStream.toByteArray();

    // Verify that the 'version needed to extract' is the same in both the local file header and the central directory
    int localFileHeaderVersion = ByteBuffer.wrap(zipBytes, 4, 2).getShort();
    int centralDirectoryVersion = ByteBuffer.wrap(zipBytes, zipBytes.length - 6, 2).getShort();

    assertEquals("Local file header 'version needed to extract' does not match central directory", 
                 centralDirectoryVersion, localFileHeaderVersion);
}