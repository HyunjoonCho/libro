public void testArrayJoinOptimization() throws IOException {
    String jsCode = "var variable = confirm('value from user');" +
                    "var array = ['constant', variable];" +
                    "alert(array.join(','));";
                    
    Compiler compiler = new Compiler();
    CompilerOptions options = new CompilerOptions();
    CompilationLevel.ADVANCED_OPTIMIZATIONS.setOptionsForCompilationLevel(options);
    compiler.compile(SourceFile.fromCode("externs.js", ""), SourceFile.fromCode("input.js", jsCode), options);
    
    String expected = "var a=[\"constant\",confirm(\"value from user\")];alert(a.join());";
    String actual = compiler.toSource();
    
    assertEquals(expected, actual);
}