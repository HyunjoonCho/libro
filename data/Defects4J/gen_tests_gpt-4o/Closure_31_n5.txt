
import com.google.javascript.jscomp.CommandLineRunner;
import com.google.javascript.jscomp.CompilerOptions;
import com.google.javascript.jscomp.Result;
import org.junit.Test;

import static org.junit.Assert.assertEquals;

public class ClosureDependencyTest {

    @Test
    public void testManageClosureDependenciesWithWhitespaceOnly() {
        String[] args = {
                "--compilation_level", "WHITESPACE_ONLY",
                "--manage_closure_dependencies",
                "--js", "goog.provide('example'); var x = 1;",
                "--js", "goog.require('example'); console.log(x);"
        };

        CommandLineRunner runner = new CommandLineRunner(args);
        Result result = runner.doRun();

        // Expect no errors and output should maintain dependency order
        assertEquals(0, result.errors.length);
    }
    
    @Test
    public void testOnlyClosureDependenciesWithWhitespaceOnly() {
        String[] args = {
                "--compilation_level", "WHITESPACE_ONLY",
                "--only_closure_dependencies",
                "--js", "goog.provide('example'); var x = 1;",
                "--js", "goog.require('example'); console.log(x);"
        };

        CommandLineRunner runner = new CommandLineRunner(args);
        Result result = runner.doRun();

        // Expect no errors and output should contain only closure dependencies
        assertEquals(0, result.errors.length);
    }
}
