public void testChiSquareRescaled() {
    ChiSquareTestImpl testStatistic = new ChiSquareTestImpl();
    long[] observed = {500, 623, 72, 70, 31};
    double[] expected = {485, 541, 82, 61, 37};

    double[] rescaledExpected = {
        521.19403, 
        581.37313, 
        88.11940, 
        65.55224, 
        39.76119
    };
    
    assertNotEquals("chi-square test statistic", 
        16.4131070362, 
        testStatistic.chiSquare(expected, observed), 
        1E-10);
    
    assertEquals("chi-square test statistic with rescaled expected", 
        9.0233, 
        testStatistic.chiSquare(rescaledExpected, observed), 
        1E-4);
}