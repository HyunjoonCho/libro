public void testTypeCheckingErrorWithFunctionReplacement() {
    ScriptEngine engine = new ScriptEngineManager().getEngineByName("nashorn");
    String script = "/** @constructor */\n" +
                    "var myclass = function() {\n" +
                    "}\n" +
                    "/** @param {boolean} success */\n" +
                    "myclass.prototype.fn = function(success) { }\n" +
                    "myclass.prototype.test = function() {\n" +
                    "    this.fn();\n" +
                    "    this.fn = function() { };\n" +
                    "}\n" +
                    "var obj = new myclass();\n" +
                    "obj.test();\n";

    try {
        engine.eval(script);
        fail("Expected a type checking error due to function replacement.");
    } catch (ScriptException e) {
        // Check if the error message corresponds to a type checking error
        assertTrue(e.getMessage().contains("TypeError"));
    }
}