public void testClosureRemovesNeededCode() {
    try {
        Object test = new Object();
        Math.class.getDeclaredMethod("blah", Object.class).invoke(null, test);
        fail("Expected the Closure compiler to optimize out the call resulting in a failure");
    } catch (NoSuchMethodException | IllegalAccessException | InvocationTargetException e) {
        assertTrue(e.getMessage().contains("Suspicious code. This code lacks side-effects."));
    }
}