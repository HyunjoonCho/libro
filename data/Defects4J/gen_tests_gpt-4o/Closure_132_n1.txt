
import static org.junit.Assert.assertArrayEquals;
import org.junit.Test;

public class IfStatementBugTest {

    public void originalCode(int[][] es, int esi) {
        if (es[--esi][es[esi + 1]] == 1) {
            es[esi] = 0;
        } else {
            es[esi] = 1;
        }
    }

    public void transformedCode(int[][] es, int esi) {
        es[esi] = 1 == es[--esi][es[esi + 1]] ? 0 : 1;
    }
    
    public void correctedCode(int[][] es, int esi) {
        es[--esi] = 1 == es[esi][es[esi + 1]] ? 0 : 1;
    }

    @Test
    public void testIfStatementBug() {
        int[][] esOriginal = {{0, 0, 1}, {0, 1, 0}, {1, 0, 0}};
        int[][] esTransformed = {{0, 0, 1}, {0, 1, 0}, {1, 0, 0}};
        int[][] esCorrected = {{0, 0, 1}, {0, 1, 0}, {1, 0, 0}};

        int esiOriginal = 2;
        int esiTransformed = 2;
        int esiCorrected = 2;
        
        originalCode(esOriginal, esiOriginal);
        transformedCode(esTransformed, esiTransformed);
        correctedCode(esCorrected, esiCorrected);

        assertArrayEquals("Transformed and original code results should differ due to the bug",
                esOriginal, esTransformed);

        assertArrayEquals("Corrected and original code results should match the expected behavior",
                esCorrected, esOriginal);
    }
}
