
import org.apache.commons.lang3.time.DateUtils;
import org.junit.Test;

import java.util.Calendar;
import java.util.Date;
import java.util.TimeZone;

import static org.junit.Assert.assertEquals;

public class DateUtilsDSTTest {

    @Test
    public void testTruncateDuringDSTSwitch() {
        // Set the time zone to one that has daylight saving time, like "America/Denver".
        TimeZone timeZone = TimeZone.getTimeZone("America/Denver"); // Mountain Time Zone
        Calendar calendar = Calendar.getInstance(timeZone);
        
        // Set the date to 2004-10-31 01:00:00 MDT (MDT: Mountain Daylight Time)
        calendar.set(Calendar.YEAR, 2004);
        calendar.set(Calendar.MONTH, Calendar.OCTOBER);
        calendar.set(Calendar.DAY_OF_MONTH, 31);
        calendar.set(Calendar.HOUR_OF_DAY, 1);
        calendar.set(Calendar.MINUTE, 0);
        calendar.set(Calendar.SECOND, 0);
        calendar.set(Calendar.MILLISECOND, 0);

        // Create the date object representing 2004-10-31 01:00:00 MDT
        Date oct31_01MDT = calendar.getTime();

        // Truncate the date by hour using DateUtils
        Date result = DateUtils.truncate(oct31_01MDT, Calendar.HOUR_OF_DAY);

        // Assert that the truncated result should equal the original date
        assertEquals(oct31_01MDT, result);
    }
}
