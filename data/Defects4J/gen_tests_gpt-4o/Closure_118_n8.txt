script
/**
 * @fileoverview Test reproducible compilation behavior with Google Closure Compiler
 */

public class PrototypeMethodRemovalTest {

    @Test
    public void testPrototypeMethodNotRemoved() {
        // ==ClosureCompiler==
        // @compilation_level ADVANCED_OPTIMIZATIONS
        // @output_file_name default.js
        // @formatting pretty_print
        // ==/ClosureCompiler==

        /** @const */
        var foo = {};
        foo.bar = {
            'bar1': function() { return 'bar1'; }
        }

        /** @constructor */
        function foobar() {}
        foobar.prototype = foo.bar;

        foo.foobar = new foobar;

        // The test checks if the method 'bar1' is still accessible after compilation
        assertEquals('bar1', foo.foobar['bar1']());
    }
}
