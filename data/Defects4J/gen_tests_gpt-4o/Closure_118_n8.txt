public void testPrototypeMethodNotRemoved() {
    Context context = Context.enter();
    ScriptableObject scope = context.initStandardObjects();

    String script =
        "var foo = {};\n" +
        "foo.bar = {\n" +
        " 'bar1': function() { return 'bar1'; }\n" +
        "};\n" +
        "function foobar() {}\n" +
        "foobar.prototype = foo.bar;\n" +
        "foo.foobar = new foobar;\n" +
        "foo.foobar['bar1']();";
    
    Object result = context.evaluateString(scope, script, "testScript", 1, null);

    assertEquals("bar1", Context.toString(result));
    Context.exit();
}