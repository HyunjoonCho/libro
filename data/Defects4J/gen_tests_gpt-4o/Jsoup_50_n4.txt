
import org.jsoup.Jsoup;
import org.jsoup.nodes.Document;
import org.jsoup.helper.DataUtil;
import org.junit.Test;

import java.io.ByteArrayInputStream;
import java.io.InputStream;
import java.nio.charset.StandardCharsets;

import static org.junit.Assert.assertEquals;

public class DataUtilTest {

    @Test
    public void testUtf16BomHandling() throws Exception {
        // UTF-16 encoded string with BOM
        byte[] utf16ContentWithBom = new byte[] {
            (byte)0xFE, (byte)0xFF,                    // UTF-16BE BOM
            0x00, 'H', 0x00, 'e', 0x00, 'l', 0x00, 'l', 0x00, 'o'
        };

        // Convert to UTF-16 encoded string with a BOM
        InputStream inputStream = new ByteArrayInputStream(utf16ContentWithBom);

        // Parse the stream as a Document using Jsoup
        Document doc = DataUtil.parseByteData(inputStream, "UTF-16", "");

        // Check if the text is parsed correctly
        assertEquals("Hello", doc.text());
    }
}
