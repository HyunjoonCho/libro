public void testTooLargeFirstStepWithDormandPrinceIntegrator() {
    FirstOrderDifferentialEquations simpleOde = new FirstOrderDifferentialEquations() {
        public int getDimension() {
            return 1;
        }

        public void computeDerivatives(double t, double[] y, double[] yDot) {
            yDot[0] = 1.0; // simple constant rate of change
        }
    };

    DormandPrince853Integrator integrator = new DormandPrince853Integrator(1.0e-10, 1.0, 1.0e-12, 1.0e-12);
    double[] y0 = new double[] { 0 };

    try {
        integrator.integrate(simpleOde, 0.0, y0, 1.0e-12, y0);
        fail("Exception expected due to first step being too large for the small integration range.");
    } catch (Exception e) {
        // expected behavior
    }
}