public void testJsonGenerationExceptionForSurrogatePair() {
    String problematicString = new String(new int[] { 0x10400 }, 0, 1); // Valid multi-byte Unicode character (Surrogate pair)
    String prefix = "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"; // Length of this prefix affects whether the exception is thrown

    String jsonString = prefix + problematicString;

    try {
        JsonFactory jsonFactory = new JsonFactory();
        StringWriter writer = new StringWriter();
        JsonGenerator jsonGenerator = jsonFactory.createGenerator(writer);

        jsonGenerator.writeStartObject();
        jsonGenerator.writeRawField("key", jsonString);
        jsonGenerator.writeEndObject();
        jsonGenerator.close();

        fail("Expected JsonGenerationException was not thrown");
    } catch (JsonGenerationException e) {
        assertTrue(e.getMessage().contains("Split surrogate on writeRaw() input"));
    } catch (IOException e) {
        fail("Unexpected IOException was thrown: " + e.getMessage());
    }
}