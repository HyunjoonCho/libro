
import org.junit.Test;
import java.io.ByteArrayOutputStream;
import java.io.PrintStream;

import static org.junit.Assert.assertTrue;

public class CompilerOutputTest {

    @Test
    public void testLastErrorOutputTruncated() {
        // Redirect standard error output to capture it
        ByteArrayOutputStream errContent = new ByteArrayOutputStream();
        System.setErr(new PrintStream(errContent));

        // Simulate the compiler output
        System.err.println("test.js:1: ERROR - variable foo is undefined");
        System.err.println("alert(foo);");
        System.err.println(" ^\n");
        System.err.println("test.js:2: ERROR - variable bar is undefined");

        // Check if the last error output is correctly captured
        String output = errContent.toString();

        // Check the error output
        assertTrue("The error line for 'bar' should be present", output.contains("alert(bar);"));
        assertTrue("The caret indicator for 'bar' should be present", output.contains(" ^"));
    }
}
