public void testManageClosureDependenciesWithWhitespaceOnly() {
    CompilerOptions options = new CompilerOptions();
    options.setCompilationLevel(CompilationLevel.WHITESPACE_ONLY);
    options.setManageClosureDependencies(true);

    List<SourceFile> inputs = new ArrayList<>();
    inputs.add(SourceFile.fromCode("a.js", "goog.provide('a'); var a = {};"));
    inputs.add(SourceFile.fromCode("b.js", "goog.require('a'); var b = a;"));

    List<SourceFile> externs = AbstractCommandLineRunner.getBuiltinExterns(CompilerOptions.Environment.BROWSER);

    Compiler compiler = new Compiler();
    compiler.init(externs, inputs, options);
    Result result = compiler.compile();

    assertTrue("Compilation should succeed", result.success);
    assertTrue("Expected 'a' to be defined", compiler.getRoot().toSource().contains("var a = {};"));
    assertTrue("Expected 'b' to be defined", compiler.getRoot().toSource().contains("var b = a;"));
}