
import org.apache.commons.math.stat.descriptive.moment.Variance;
import org.junit.Test;
import static org.junit.Assert.assertEquals;

public class VarianceTest {

    @Test
    public void testVarianceEvaluateWithLength() {
        // Sample data
        double[] values = {2.0, 3.0, 4.0, 5.0, 6.0};
        double[] weights = {1, 1, 1, 1, 1};
        double mean = 4.0;  // Mean for the subarray {3.0, 4.0, 5.0}
        int begin = 1;
        int length = 3;
        
        // Calculate expected variance manually for the subarray {3.0, 4.0, 5.0}
        double expectedVariance = 1.0;

        Variance variance = new Variance();
        
        // Evaluate variance using the method with the suspected bug
        double calculatedVariance = variance.evaluate(values, weights, mean, begin, length);

        // Check if the calculated variance matches the expected variance
        assertEquals("Variance does not match the expected value for the specified subarray.", expectedVariance, calculatedVariance, 1e-9);
    }
}
