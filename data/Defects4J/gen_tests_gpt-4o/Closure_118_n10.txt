public void testPrototypeMethodIncorrectlyRemoved() {
    // Set up the JavaScript context
    Context context = Context.enter();
    try {
        Scriptable scope = context.initStandardObjects();
        
        // JavaScript code input
        String jsCode =
            "var foo = {};" +
            "foo.bar = {" +
            " 'bar1': function() { return 'bar1'; }" +
            "};" +
            "function foobar() {}" +
            "foobar.prototype = foo.bar;" +
            "foo.foobar = new foobar;" +
            "foo.foobar['bar1']();";

        // Evaluate the script
        Object result = context.evaluateString(scope, jsCode, "script", 1, null);

        // Verify if the method is correctly accessed
        assertEquals("bar1", Context.toString(result));
    } finally {
        Context.exit();
    }
}