public void testPrototypeAssignmentInIIFE() {
    try {
        // Create a Nashorn script engine instance
        ScriptEngine engine = new ScriptEngineManager().getEngineByName("nashorn");

        // JavaScript code replicating the bug condition
        String script = ""
            + "/** @constructor */\n"
            + "function Foo() {}\n"
            + "(function() {\n"
            + "    Foo.prototype = {\n"
            + "        alert: function() {\n"
            + "            return 'hello world';\n"
            + "        }\n"
            + "    };\n"
            + "})();\n"
            + "result = typeof Foo.prototype.alert;\n";

        // Evaluate the script
        engine.eval(script);

        // Read the result
        String result = (String) engine.get("result");

        // Assert that the 'alert' method should not be undefined
        assertEquals("function", result);
    } catch (ScriptException e) {
        fail("Script execution failed: " + e.getMessage());
    }
}