public void testTextBufferGetTextBufferConsistency() {
    TextBuffer buffer = new TextBuffer(new BufferRecycler());

    buffer.resetWithEmpty();
    char[] firstCallResult = buffer.getTextBuffer(); // Returns null

    buffer.contentsAsString(); // Process to potentially mutate internal state
    char[] secondCallResult = buffer.getTextBuffer(); // Returns empty array []

    assertNull("First call to getTextBuffer should return null for empty content", firstCallResult);
    assertNotNull("Subsequent call to getTextBuffer should not return null after contentsAsString is invoked", secondCallResult);
    assertEquals("Subsequent call to getTextBuffer should return an empty array", 0, secondCallResult.length);
}