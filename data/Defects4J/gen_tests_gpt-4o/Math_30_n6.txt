
import static org.junit.Assert.assertFalse;
import static org.junit.Assert.assertTrue;

import org.apache.commons.math3.stat.inference.MannWhitneyUTest;
import org.junit.Test;

public class MannWhitneyUTestOverflowTest {

    @Test
    public void testMannWhitneyUForIntegerOverflow() {
        // Create two large data sets of size 1500
        double[] sample1 = new double[1500];
        double[] sample2 = new double[1500];

        // Fill the data sets with sequential numbers
        for (int i = 0; i < 1500; i++) {
            sample1[i] = i;
            sample2[i] = i + 1;
        }

        MannWhitneyUTest mannWhitneyUTest = new MannWhitneyUTest();
        double pValue = mannWhitneyUTest.mannWhitneyUTest(sample1, sample2);

        // Check for potential overflow indicated by NaN or incorrect pValue
        assertFalse("Overflow occurred, resulting in NaN", Double.isNaN(pValue));
        assertTrue("Incorrect p-value detected due to overflow.", pValue >= 0 && pValue <= 1);
    }
}
