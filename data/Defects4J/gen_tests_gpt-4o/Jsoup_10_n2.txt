
import org.jsoup.Jsoup;
import org.jsoup.nodes.Document;
import org.jsoup.nodes.Element;
import org.jsoup.select.Elements;
import org.junit.Test;

import java.net.URL;
import java.util.Iterator;

import static org.junit.Assert.assertEquals;

public class AbsUrlTest {

    @Test
    public void testAbsUrlParsing() throws Exception {
        // Mocking the HTTP input, since we don't actually have access to the real URL in the test.
        // In practice, you could use libraries like WireMock to simulate HTTP responses.

        // Here we fake the resource. Let's simulate it by parsing a similar HTML setup.
        String html = "<html><head><title>Test</title></head>"
                + "<body>"
                + "<a href=\"?p=1\">1</a>"
                + "</body></html>";

        // Base URL to simulate parsing from a specific URL
        String baseUrl = "http://www.oschina.net/bbs/thread/12975";

        // Parse the HTML content
        Document doc = Jsoup.parse(html, baseUrl);

        // Select elements with href attributes
        Elements es = doc.select("a[href]");

        for (Iterator<Element> it = es.iterator(); it.hasNext();) {
            Element e = it.next();
            String absUrl = e.absUrl("href");
            // Assert the expected URL format
            assertEquals("http://www.oschina.net/bbs/thread/12975?p=1", absUrl);
        }
    }
}
