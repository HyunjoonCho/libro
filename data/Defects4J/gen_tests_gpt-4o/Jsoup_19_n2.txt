
import org.jsoup.Jsoup;
import org.jsoup.nodes.Document;
import org.jsoup.safety.Whitelist;
import org.junit.jupiter.api.Test;
import static org.junit.jupiter.api.Assertions.assertTrue;

public class HtmlSanitizationTest {

    @Test
    public void testImgCidPreservation() {
        // Original HTML content containing CID reference
        String html = "<html><body><img src=\"cid:image001.jpg@01D3XXXX.AAAAAAAA\"></body></html>";

        // Create a whitelist that allows img tags with any src
        Whitelist whitelist = new Whitelist();
        whitelist.addTags("img");
        whitelist.addAttributes("img", "src");

        // Clean the HTML using the custom whitelist
        Document cleanDoc = Jsoup.clean(html, "", whitelist, new Document.OutputSettings());

        // Check if the cleaned HTML still contains the CID reference
        assertTrue(cleanDoc.html().contains("cid:image001.jpg@01D3XXXX.AAAAAAAA"),
                "The IMG tag's CID reference should be preserved.");
    }
}
