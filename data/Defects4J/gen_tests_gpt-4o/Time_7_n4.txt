
import org.joda.time.MutableDateTime;
import org.joda.time.format.DateTimeFormat;
import org.joda.time.format.DateTimeFormatter;
import org.junit.Test;

import java.util.Locale;
import java.util.TimeZone;

import static org.junit.Assert.assertEquals;

public class DateTimeFormatParseIntoTest {

    private static final Locale UK = Locale.UK;
    private static final TimeZone NEWYORK = TimeZone.getTimeZone("America/New_York");

    @Test
    public void testParseInto_monthDay_feb29_startOfYear() {
        DateTimeFormatter f = DateTimeFormat.forPattern("M d").withLocale(UK);
        MutableDateTime result = new MutableDateTime(2000, 1, 1, 0, 0, 0, 0, NEWYORK);
        
        // Act
        int parsePosition = f.parseInto(result, "2 29", 0);

        // Assert
        assertEquals(4, parsePosition);
        assertEquals(new MutableDateTime(2000, 2, 29, 0, 0, 0, 0, NEWYORK), result);
    }
}
