public void testCSVFormatWithHeader() throws IOException {
    Path path = Files.createTempFile("data", ".csv");
    try {
        CSVPrinter csvPrinter = CSVFormat.TDF
            .withHeader("x")
            .print(Files.newBufferedWriter(path));
        csvPrinter.printRecord(42);
        csvPrinter.close();

        List<String> lines = Files.readAllLines(path);
        assertEquals("x", lines.get(0).trim());
        assertEquals("42", lines.get(1).trim());
    } finally {
        Files.deleteIfExists(path);
    }
}