
import org.jsoup.Jsoup;
import org.jsoup.nodes.Document;
import org.jsoup.parser.Parser;
import org.junit.Test;
import java.nio.charset.Charset;

import static org.junit.Assert.assertEquals;

public class JsoupXmlCharsetTest {

    @Test
    public void testXmlEncodingCharsetDetection() throws Exception {
        // URL pointing to an XML with ISO-8859-1 charset in its declaration
        final String url = "http://www.elacontecer.com.uy/rss/hoy.xml";
        // Connect using Jsoup and parse the document as XML
        Document doc = Jsoup.connect(url).parser(Parser.xmlParser()).get();
        // Check the detected charset
        Charset detectedCharset = doc.charset();
        // The expected charset according to the XML declaration
        Charset expectedCharset = Charset.forName("ISO-8859-1");
        // Assert that the detected charset matches the expected charset
        assertEquals(expectedCharset, detectedCharset);
    }
}
