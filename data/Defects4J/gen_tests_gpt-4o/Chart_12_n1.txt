
import static org.junit.Assert.assertEquals;
import static org.junit.Assert.assertNotNull;

import org.jfree.chart.plot.MultiplePiePlot;
import org.jfree.data.category.DefaultCategoryDataset;
import org.jfree.data.general.DatasetChangeEvent;
import org.jfree.data.general.DatasetChangeListener;
import org.junit.Test;

public class MultiplePiePlotTest {

    @Test
    public void testMultiplePiePlotDatasetListener() {
        DefaultCategoryDataset dataset = new DefaultCategoryDataset();

        // Create the plot with the dataset, without calling setDataset explicitly.
        MultiplePiePlot plot = new MultiplePiePlot(dataset);

        // Test listener notification
        DatasetChangeTracker tracker = new DatasetChangeTracker();
        dataset.addChangeListener(tracker);

        // Change the dataset
        dataset.addValue(1.0, "Row1", "Column1");

        // The dataset should notify listeners, which includes the tracker.
        assertEquals(1, tracker.getChangeCount());

        // The plot should reflect the change in the dataset
        assertNotNull(plot.getDataset());
    }

    private static class DatasetChangeTracker implements DatasetChangeListener {
        private int changeCount = 0;

        @Override
        public void datasetChanged(DatasetChangeEvent event) {
            changeCount++;
        }

        public int getChangeCount() {
            return changeCount;
        }
    }
}
