public void testExternalTypeIdBeforePojo() throws Exception {
    ObjectMapper mapper = new ObjectMapper();

    String json = "{\"type\":\"custom\",\"value\":{\"name\":\"example\"}}";
   
    SimpleModule module = new SimpleModule();

    module.addDeserializer(MyPojo.class, new StdDeserializer<MyPojo>(MyPojo.class) {
        @Override
        public MyPojo deserialize(JsonParser jp, DeserializationContext ctxt) throws IOException {
            JsonNode node = jp.getCodec().readTree(jp);
            String name = node.get("name").asText();
            return new MyPojo(name);
        }
    });
   
    mapper.registerModule(module);

    MyWrapper result = mapper.readValue(json, MyWrapper.class);
    
    assertNotNull(result);
    assertEquals("custom", result.type);
    assertNotNull(result.value);
    assertEquals("example", result.value.getName());
}