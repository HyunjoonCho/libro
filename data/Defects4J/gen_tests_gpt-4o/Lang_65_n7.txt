
import org.apache.commons.lang3.time.DateUtils;
import org.junit.Test;

import java.util.Calendar;
import java.util.Date;
import java.util.TimeZone;

import static org.junit.Assert.assertEquals;

public class DateUtilsDSTTest {

    @Test
    public void testTruncateDuringDSTSwitch() {
        TimeZone timeZone = TimeZone.getTimeZone("America/Denver"); // MDT/MST timezone
        
        // Set up a Calendar instance to represent 2004-10-31 01:00:00 MDT
        Calendar cal = Calendar.getInstance(timeZone);
        cal.set(2004, Calendar.OCTOBER, 31, 1, 0, 0);
        cal.set(Calendar.MILLISECOND, 0);
        
        Date oct31_01MDT = cal.getTime();
        // The given timestamp (1099206000000L) reflects 2004-10-31 01:00:00 MDT
        Date result = DateUtils.truncate(oct31_01MDT, Calendar.HOUR_OF_DAY);

        assertEquals("The truncated time should match the expected 2004-10-31 01:00:00 MDT", oct31_01MDT, result);
    }
}
