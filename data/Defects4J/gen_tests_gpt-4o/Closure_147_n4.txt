public void testJSC_USED_GLOBAL_THIS_warning() {
    String code = ""
        + "var NS = {\n"
        + "    read: function() {\n"
        + "        return this.foo;\n"
        + "    },\n"
        + "    write: function() {\n"
        + "        this.foo = 123;\n"
        + "    }\n"
        + "};\n"
        + "NS.write2 = function() {\n"
        + "    this.foo = 123;\n"
        + "};";

    Compiler compiler = new Compiler();
    CompilerOptions options = new CompilerOptions();
    options.setWarningLevel(DiagnosticGroups.GLOBAL_THIS, CheckLevel.WARNING);

    compiler.compile(SourceFile.fromCode("externs.js", ""), SourceFile.fromCode("test.js", code), options);
    List<JSError> warnings = compiler.getWarnings();

    assertEquals(2, warnings.size());
    assertEquals("JSC_USED_GLOBAL_THIS", warnings.get(0).getType().key);
    assertEquals("JSC_USED_GLOBAL_THIS", warnings.get(1).getType().key);
}