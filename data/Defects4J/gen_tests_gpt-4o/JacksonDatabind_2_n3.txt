public void testUnwantedPOJOsEmbeddedInTree() throws IOException {
    ObjectMapper mapper = new ObjectMapper();
    mapper.registerModule(new SimpleModule().addSerializer(ListAttribute.class, new ListAttributeSerializer()));

    X<ListAttribute> reference = new X<>();
    reference.s = "example";
    reference.items = new ArrayList<>();
    reference.items.add(new ListAttribute("someKey", Arrays.asList("item1", "item2")));

    // Use valueToTree which causes the issue
    JsonNode node = mapper.valueToTree(reference);

    JsonNode itemsNode = node.get("items");
    assertTrue("Expected items node to not be VALUE_EMBEDDED_OBJECT", itemsNode.isArray());
}