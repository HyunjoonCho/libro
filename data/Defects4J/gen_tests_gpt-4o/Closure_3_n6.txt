public void testCatchVariableScopeOptimization() {
    String inputJavaScript = "function getStack() { var getErrorObject = function() { try { throw Error(\"\"); } catch(err) { return err; } }; return getErrorObject().stack; } window['getStackTrace']=getStack;";
    Compiler compiler = new Compiler();
    CompilerOptions options = new CompilerOptions();
    CompilationLevel.SIMPLE_OPTIMIZATIONS.setOptionsForCompilationLevel(options);

    compiler.compile(SourceFile.fromCode("externs.js", ""), SourceFile.fromCode("test.js", inputJavaScript), options);
    String outputJavaScript = compiler.toSource();

    assertFalse("Optimized code should not contain illegal reference to catch variable.", outputJavaScript.contains("return a.stack"));
}