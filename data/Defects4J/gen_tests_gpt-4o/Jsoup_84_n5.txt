
import org.jsoup.Jsoup;
import org.jsoup.nodes.Document;
import org.jsoup.helper.W3CDom;
import org.junit.Test;
import org.w3c.dom.Element;
import org.w3c.dom.DOMException;

public class W3CDomNamespaceTest {

    @Test(expected = DOMException.class)
    public void testMissingNamespace() {
        // HTML snippet with an undeclared namespace prefix
        String html = "<html><head><title>Test</title></head>"
                + "<body>"
                + "<fb:like></fb:like>"
                + "</body></html>";

        try {
            // Parse the HTML with Jsoup
            Document jsoupDoc = Jsoup.parse(html);

            // Attempt to convert Jsoup Document to W3C DOM Document using W3CDom
            W3CDom w3cDom = new W3CDom();
            org.w3c.dom.Document w3cDocument = w3cDom.fromJsoup(jsoupDoc);

            // Try to access the 'fb:like' element, expecting a namespace error
            Element fbLikeElement = (Element) w3cDocument.getElementsByTagName("fb:like").item(0);

        } catch (DOMException e) {
            // Expecting a NAMESPACE_ERR because the namespace is undeclared
            throw e;
        }
    }
}
