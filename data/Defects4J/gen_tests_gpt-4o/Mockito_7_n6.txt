
import org.junit.Test;
import static org.mockito.Mockito.*;

public class MockitoGenericsDeepStubTest {

    @Test(expected = Exception.class) // expect the exception based on the description
    public void discoverDeepMockingOfGenerics() {
        // Mock MyClass1 with deep stubs enabled
        MyClass1<?> myMock1 = mock(MyClass1.class, RETURNS_DEEP_STUBS);

        // This chain of method calls should throw an exception as per the bug report
        when(myMock1.getNested().getNested().returnSomething()).thenReturn("Hello World.");
    }

    // Interface declarations as per the bug report
    public static interface MyClass1<MC2 extends MyClass2<MC3>, MC3 extends MyClass3> {
        public MC2 getNested();
    }

    public static interface MyClass2<MC3 extends MyClass3> {
        public MC3 getNested();
    }

    public static interface MyClass3 {
        public String returnSomething();
    }
}
