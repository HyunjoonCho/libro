public void testExtendedBufferReaderEOLHandling() throws IOException {
    String input = "line1\rline2\nline3\r\nline4";
    ExtendedBufferReader ebr = new ExtendedBufferReader(new StringReader(input));

    int lineCount = 0;
    while (ebr.readLine() != null) {
        lineCount++;
    }

    assertEquals(4, lineCount);
}