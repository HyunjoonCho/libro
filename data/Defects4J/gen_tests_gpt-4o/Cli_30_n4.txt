
import org.apache.commons.cli.*;
import org.junit.Test;
import static org.junit.Assert.*;

import java.util.Properties;

public class OptionGroupTest {

    @Test
    public void testMutuallyExclusiveOptionsWithDefaults() {
        Options options = new Options();

        // Create mutually exclusive options
        OptionGroup group = new OptionGroup();
        group.addOption(new Option("a", "option-a", false, "Option A"));
        group.addOption(new Option("b", "option-b", false, "Option B"));
        options.addOptionGroup(group);

        // Prepare command line arguments
        String[] args = {"-a"};

        // Prepare default properties with a mutually exclusive option
        Properties defaults = new Properties();
        defaults.put("b", "true");

        // Parse the command line with defaults
        CommandLineParser parser = new DefaultParser();
        CommandLine cmd;
        try {
            cmd = parser.parse(options, args, defaults);

            // Test if both 'a' and 'b' options are present, which should not be the case
            assertTrue("Command line should contain option 'a'", cmd.hasOption("a"));
            assertFalse("Command line should not contain option 'b' due to mutual exclusion", cmd.hasOption("b"));
            
        } catch (ParseException e) {
            fail("Parsing failed: " + e.getMessage());
        }
    }
}
