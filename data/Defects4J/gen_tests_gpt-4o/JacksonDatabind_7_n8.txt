public void testTokenBufferDelegateDeserialization() throws IOException {
    String json = "{ \"a\":1, \"b\":null }";
    ObjectMapper mapper = new ObjectMapper();
    JsonParser parser = mapper.getFactory().createParser(json);
    TokenBuffer buffer = new TokenBuffer(mapper, false);

    while (parser.nextToken() != null) {
        buffer.copyCurrentStructure(parser);
    }

    List<JsonToken> expectedTokens = Arrays.asList(JsonToken.START_OBJECT, JsonToken.FIELD_NAME, 
                                    JsonToken.VALUE_NUMBER_INT, JsonToken.FIELD_NAME, 
                                    JsonToken.VALUE_NULL, JsonToken.END_OBJECT);

    // Reset the buffer
    JsonParser bufferParser = buffer.asParser();
    bufferParser.nextToken(); // to move to the START_OBJECT

    List<JsonToken> actualTokens = new ArrayList<>();
    while (bufferParser.nextToken() != null) {
        actualTokens.add(bufferParser.getCurrentToken());
    }

    assertEquals(expectedTokens, actualTokens);
}