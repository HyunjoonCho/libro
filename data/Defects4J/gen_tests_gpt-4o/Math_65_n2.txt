public void testChiSquareWeights() {
    AbstractLeastSquares leastSquares = new AbstractLeastSquares() {
        @Override
        protected double[] calculateResiduals() {
            return new double[]{2.0, 3.0};
        }

        @Override
        protected double[] calculateJacobian() {
            return new double[]{1.0, 1.0};
        }
    };
    
    // Setting up observation weights
    leastSquares.setResidualsWeights(new double[]{2.0, 3.0});
    leastSquares.solve();

    double chiSquare = leastSquares.getChiSquare();
    double expectedChiSquare = (2.0 * 2.0 * 2.0) + (3.0 * 3.0 * 3.0); 
    assertEquals(expectedChiSquare, chiSquare, 1e-6);
}