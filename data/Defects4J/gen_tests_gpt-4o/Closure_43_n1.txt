public void testJSDocLendsFailsWithUndefinedClass() {
    String jsCode = ""
        + "/** @constructor */\n"
        + "var Person = makeClass({\n"
        + "  /** @lends Person.prototype */\n"
        + "  methods: {\n"
        + "    getName: function() { return this.name; }\n"
        + "  }\n"
        + "});";

    Compiler compiler = new Compiler();
    CompilerOptions options = new CompilerOptions();
    options.setLanguageIn(CompilerOptions.LanguageMode.ECMASCRIPT5);
    options.setLanguageOut(CompilerOptions.LanguageMode.ECMASCRIPT5);
    options.setWarningLevel(DiagnosticGroups.CHECK_TYPES, CheckLevel.ERROR);
    
    compiler.compile(SourceFile.fromCode("externs.js", ""), SourceFile.fromCode("test.js", jsCode), options);
    
    // Check that a compilation error is present regarding @lends
    assertTrue(compiler.getErrors().length > 0);
    assertTrue(compiler.getErrors()[0].description.contains("Variable Person.prototype not declared before @lends annotation"));
}