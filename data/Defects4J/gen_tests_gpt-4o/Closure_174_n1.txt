public void testGoogScopeCrash() {
    Compiler compiler = new Compiler();
    CompilerOptions options = new CompilerOptions();
    String code = "goog.provide(\"main\");\n" +
                  "goog.scope(function() {\n" +
                  "  var a = foo, b, c = 1;\n" +
                  "});";
    
    try {
        compiler.compile(SourceFile.fromCode("externs.js", ""), SourceFile.fromCode("test.js", code), options);
        List<JSError> errors = compiler.getErrors();
        assertFalse("Compiler should produce an error", errors.isEmpty());
    } catch (Exception e) {
        fail("Compiler should not crash: " + e.getMessage());
    }
}