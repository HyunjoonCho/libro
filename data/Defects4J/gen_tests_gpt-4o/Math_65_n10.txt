public void testChiSquareCalculation() {
    // Assuming AbstractLeastSquares is a class that we are testing
    AbstractLeastSquares leastSquares = new AbstractLeastSquares() {

        @Override
        protected void calibrate() {
            // Implementation not needed for the test
        }

        @Override
        protected double[] theoreticalModel(double[] params) {
            return new double[0];  // Not needed for testing getChiSquare()
        }
    };

    // Assuming setResidualsWeights is a method to set weights and setResiduals to set the residuals
    double[] weights = {2.0, 2.0, 2.0}; 
    double[] residuals = {1.0, 2.0, 3.0};

    leastSquares.setResidualsWeights(weights);
    leastSquares.setResiduals(residuals);

    double expectedChiSquare = (2.0 * 1.0 * 1.0) + (2.0 * 2.0 * 2.0) + (2.0 * 3.0 * 3.0);
    assertEquals(expectedChiSquare, leastSquares.getChiSquare(), 1e-9);
}