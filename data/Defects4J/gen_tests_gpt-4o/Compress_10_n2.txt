
import org.apache.commons.compress.archivers.zip.ZipFile;
import org.apache.commons.compress.utils.IOUtils;
import org.junit.Test;

import java.io.File;
import java.io.IOException;
import java.nio.charset.StandardCharsets;

import static org.junit.Assert.assertNotNull;

public class UnicodeZipFileTest {

    @Test
    public void testUnicodeExtraFieldsInZip() throws IOException {
        // Assume `test.zip` contains files with Unicode names or extra fields.
        File zipFile = new File("path/to/your/test.zip"); // Replace with the path to a test zip file

        try (ZipFile zip = new ZipFile(zipFile, StandardCharsets.UTF_8.name())) {
            zip.getEntries().forEachRemaining(entry -> {
                try {
                    // Attempt to retrieve each entry's input stream
                    assertNotNull("The input stream for the entry should not be null", 
                                  IOUtils.toByteArray(zip.getInputStream(entry)));
                } catch (IOException e) {
                    e.printStackTrace();
                    throw new AssertionError("Failed to read entry: " + entry.getName(), e);
                }
            });
        }
    }
}
