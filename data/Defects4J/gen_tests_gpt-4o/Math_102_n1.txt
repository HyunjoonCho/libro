
import org.apache.commons.math3.stat.inference.ChiSquareTest;
import org.junit.Test;
import static org.junit.Assert.assertEquals;

public class ChiSquareTestTest {

    @Test
    public void testChiSquareWithIncorrectExpectation() {
        ChiSquareTest testStatistic = new ChiSquareTest();

        long[] observed = {500, 623, 72, 70, 31};
        double[] expected = {485, 541, 82, 61, 37};

        // The expected value without adjusting the expected probabilities
        double chiSquareStatistic = testStatistic.chiSquare(expected, observed);
        assertEquals("chi-square test statistic", 16.4131070362, chiSquareStatistic, 1E-10);

        // The correct chi-square statistic should consider rescaling 'expected' values
        // R's output: 9.0233 shows the result after rescaling expected probabilities
        double correctChiSquareStatistic = 9.0233;
        assertEquals("chi-square test statistic with rescaling", correctChiSquareStatistic, chiSquareStatistic,
                1E-4); // Since we expect the current implementation to fail, this check should reflect anticipated behavior
    }
}
