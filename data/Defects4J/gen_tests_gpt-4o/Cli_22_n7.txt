
import org.apache.commons.cli.CommandLine;
import org.apache.commons.cli.CommandLineParser;
import org.apache.commons.cli.Option;
import org.apache.commons.cli.Options;
import org.apache.commons.cli.ParseException;
import org.apache.commons.cli.PosixParser;
import org.junit.Test;
import static org.junit.Assert.assertEquals;

public class PosixParserTest {

    @Test
    public void testTargetOptionParsing() {
        Options options = new Options();
        options.addOption("t", "target", true, "Generate files for the specified target machine");

        CommandLineParser parser = new PosixParser();
        String[] args = {"-target", "foobar.com"};

        try {
            CommandLine cmd = parser.parse(options, args);
            if (cmd.hasOption("t")) {
                // This is where the bug manifests: it parses "arget" instead of "foobar.com"
                String optionValue = cmd.getOptionValue("t");
                // As per the bug description, assert the erroneous behavior.
                assertEquals("Expected to parse the full value 'foobar.com'", "foobar.com", optionValue);
            }
        } catch (ParseException e) {
            // Fail the test if a parse exception occurs
            throw new AssertionError("Parsing failed", e);
        }
    }
}
