public void testStackOverflowErrorOnClosureCompiler() {
    String jsCode = "var AdMedia = function() { return " + 
                    " function() { return " +
                    " function() { return " + 
                    " function() { return 'nested'; }" +
                    " } } }();";
    Compiler compiler = new Compiler();
    CompilerOptions options = new CompilerOptions();
    JSSourceFile extern = JSSourceFile.fromCode("externs.js", "");
    JSSourceFile input = JSSourceFile.fromCode("AdMedia.eam.js", jsCode);

    try {
        compiler.compile(extern, input, options);
        fail("Expected StackOverflowError not thrown");
    } catch (RuntimeException e) {
        assertTrue(e.getCause() instanceof StackOverflowError);
    }
}