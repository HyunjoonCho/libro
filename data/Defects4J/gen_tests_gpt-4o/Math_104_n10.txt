
import org.apache.commons.math3.special.Gamma;
import org.junit.Test;

import static org.junit.Assert.assertEquals;

public class GammaFunctionAccuracyTest {

    @Test
    public void testGammaFunctionDefaultEpsilon() {
        double value = 5.0;  // Example input

        // Compute gamma with default epsilon
        double gammaWithDefaultEpsilon = Gamma.gamma(value);

        // Compute gamma with a tighter epsilon
        double gammaWithTighterEpsilon = Gamma.regularizedGammaP(value, Double.POSITIVE_INFINITY, 1.0e-15, 10000) * Gamma.gamma(Double.POSITIVE_INFINITY);

        // The expected value is calculated using a calculator or a library known for its accuracy
        double expectedGamma = 24.0;  // Î“(5) = 4! = 24

        // Test the default precision result
        assertEquals("Gamma function with default epsilon is not accurate", expectedGamma, gammaWithDefaultEpsilon, 1.0e-9);

        // Test the higher precision result
        assertEquals("Gamma function with tighter epsilon should be more accurate", expectedGamma, gammaWithTighterEpsilon, 1.0e-15);
    }
}
