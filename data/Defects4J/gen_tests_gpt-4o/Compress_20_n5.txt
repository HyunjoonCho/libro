public void testIllegalArgumentExceptionOnCpioTrailer() throws IOException {
    byte[] cpioData = new byte[] {
        // CPIO header data that would be valid except for the trailer with non-zero file mode
        (byte) 0xC7, (byte) 0x71, (byte) 0x00, (byte) 0x00, // magic
        // File name size, file size, device numbers, etc.
        // Footer with non-zero mode for a trailer
        (byte) 0x00, (byte) 0x00, (byte) 0x81, (byte) 0xA4, // Invalid mode
    };
    InputStream input = new ByteArrayInputStream(cpioData);
    CpioArchiveInputStream cpioInput = new CpioArchiveInputStream(input);

    try {
        while (cpioInput.getNextEntry() != null) {
            // Process the entry
        }
        fail("Expected IllegalArgumentException");
    } catch (IllegalArgumentException e) {
        assertEquals("invalid file mode 0x81a4 for trailer", e.getMessage());
    } finally {
        cpioInput.close();
    }
}