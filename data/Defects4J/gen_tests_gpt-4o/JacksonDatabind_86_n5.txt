
import static org.junit.Assert.assertEquals;

import com.fasterxml.jackson.annotation.JsonProperty;
import com.fasterxml.jackson.core.JsonProcessingException;
import com.fasterxml.jackson.databind.ObjectMapper;
import org.junit.Test;

// Define base class with a property
class Base implements IFace<Sub> {
    @JsonProperty
    int base = 1;
}

// Define subclass with another property
class Sub extends Base {
    @JsonProperty
    int sub = 2;
}

// Define interface
interface IFace<T> {}

public class JacksonRecursiveTypeBugTest {

    @Test
    public void testSerializationOfSubClass() throws JsonProcessingException {
        // Create ObjectMapper for conversion
        ObjectMapper objectMapper = new ObjectMapper();

        // Serialize the instance of Sub
        Sub subInstance = new Sub();
        String json = objectMapper.writeValueAsString(subInstance);

        // Expected JSON string
        String expectedJson = "{\"base\":1,\"sub\":2}";

        // Assert that the serialized JSON matches the expectation
        assertEquals(expectedJson, json);
    }
}
