public void testSuperNotReplaced() {
    String source = "var Base = Class.create({ method: function() { return 'base'; } });"
                  + "var Derived = Class.create(Base, { method: function($super) { return $super() + ' derived'; } });"
                  + "var obj = new Derived();"
                  + "obj.method();";

    Compiler compiler = new Compiler();
    CompilerOptions options = new CompilerOptions();
    CompilationLevel.ADVANCED_OPTIMIZATIONS.setOptionsForCompilationLevel(options);

    compiler.compile(SourceFile.fromCode("externs.js", ""), SourceFile.fromCode("test.js", source), options);
    String compiledCode = compiler.toSource();

    assertTrue("Compiled code should contain '$super'", compiledCode.contains("$super"));
}