
import org.jsoup.Jsoup;
import org.jsoup.nodes.Document;
import org.jsoup.safety.Safelist;
import org.junit.Test;

public class JsoupStackOverflowTest {

    @Test(expected = StackOverflowError.class)
    public void givenLargeNumberOfNestedWbrTags_whenClean_thenThrowsStackOverflowError() {
        // Construct a sample HTML document with a large number of nested <wbr> tags.
        StringBuilder htmlBuilder = new StringBuilder("<html><body>");
        for (int i = 0; i < 24000; i++) {
            htmlBuilder.append("<wbr>");
        }
        htmlBuilder.append("</body></html>");

        String html = htmlBuilder.toString();
        
        // Attempt to clean the document with Safelist.basic().
        Document cleanDoc = Jsoup.clean(html, Safelist.basic());

        // The test is expected to throw a StackOverflowError, hence the annotation
    }
}
