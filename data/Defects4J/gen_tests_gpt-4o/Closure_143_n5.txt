
import com.google.javascript.jscomp.CommandLineRunner;
import com.google.javascript.jscomp.CompilerOptions;
import org.junit.Test;

import java.io.FileWriter;
import java.io.IOException;

import static org.junit.Assert.assertThrows;

public class DefineStringTest {

    @Test
    public void testDefineString() throws IOException {
        // Create a temporary JavaScript file simulating 'test.js'
        String jsFileName = "test.js";
        try (FileWriter writer = new FileWriter(jsFileName)) {
            writer.write("/** @define {string} */\n");
            writer.write("test.VERSION = \"\";\n");
        }

        // Command line arguments for the Closure Compiler
        String[] args = {
            "--compilation_level", "ADVANCED_OPTIMIZATIONS",
            "--define", "test.VERSION=1.0.0",  // This is expected to throw an exception
            "--js_output_file", "test-min.js",
            "--js", jsFileName
        };

        // Expect a RuntimeException due to '--define' syntax being incompatible with strings
        assertThrows(RuntimeException.class, () -> {
            new CommandLineRunner(args).run();
        });
    }
}
