
import org.apache.commons.math3.distribution.GammaDistribution;
import org.junit.jupiter.api.Test;

import java.io.*;

import static org.junit.jupiter.api.Assertions.assertEquals;

public class GammaDistributionSerializationTest {

    @Test
    public void testGammaDistributionSerialization() throws IOException, ClassNotFoundException {
        // Create a GammaDistribution with a specific seed
        RandomGenerator generator = new Well19937c(12345);
        GammaDistribution originalDistribution = new GammaDistribution(generator, 2.0, 2.0);

        // Sample a value from the original distribution
        double originalSample = originalDistribution.sample();

        // Serialize the original distribution
        ByteArrayOutputStream byteOutput = new ByteArrayOutputStream();
        ObjectOutputStream objectOutput = new ObjectOutputStream(byteOutput);
        objectOutput.writeObject(originalDistribution);

        // Deserialize into a new GammaDistribution object
        ByteArrayInputStream byteInput = new ByteArrayInputStream(byteOutput.toByteArray());
        ObjectInputStream objectInput = new ObjectInputStream(byteInput);
        GammaDistribution deserializedDistribution = (GammaDistribution) objectInput.readObject();

        // Sample a value from the deserialized distribution
        double deserializedSample = deserializedDistribution.sample();

        // The samples should be the same if serialization maintains state correctly
        assertEquals(originalSample, deserializedSample, "Serialized and deserialized samples should be equal");
    }
}
