public void testDerivativeStructureAtan2SpecialCases() {
    DerivativeStructure zero = new DerivativeStructure(1, 1, 0);
    DerivativeStructure negativeZero = new DerivativeStructure(1, 1, -0.0);
    DerivativeStructure result;

    result = DerivativeStructure.atan2(zero, zero);
    assertEquals(Math.atan2(0.0, 0.0), result.getValue(), 1.0e-15);

    result = DerivativeStructure.atan2(zero, negativeZero);
    assertEquals(Math.atan2(0.0, -0.0), result.getValue(), 1.0e-15);

    result = DerivativeStructure.atan2(negativeZero, zero);
    assertEquals(Math.atan2(-0.0, 0.0), result.getValue(), 1.0e-15);

    result = DerivativeStructure.atan2(negativeZero, negativeZero);
    assertEquals(Math.atan2(-0.0, -0.0), result.getValue(), 1.0e-15);
}