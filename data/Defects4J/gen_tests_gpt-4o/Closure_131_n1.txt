
import static org.junit.Assert.assertEquals;

import java.io.ByteArrayInputStream;
import java.io.ByteArrayOutputStream;
import java.io.InputStream;

import org.mozilla.javascript.Context;
import org.mozilla.javascript.Scriptable;
import org.mozilla.javascript.tools.shell.Global;
import org.mozilla.javascript.tools.shell.Main;

import org.junit.Test;

public class UnicodeCharacterPropertyTest {

    @Test
    public void testUnicodeCharacterInPropertyName() {
        // Original JavaScript input with unicode character in property name
        String originalScript = "var test = {\"a\\u0004b\": \"c\"};";
        
        // Expected output should maintain the unicode escape sequence
        String expectedOutput = "var test={\"a\\u0004b\":\"c\"};";
        
        // Compile the script using Rhino (or any other JavaScript engine you use)
        Context ctx = Context.enter();
        try {
            Scriptable scope = ctx.initStandardObjects();
            InputStream inputStream = new ByteArrayInputStream(originalScript.getBytes());
            ByteArrayOutputStream outputStream = new ByteArrayOutputStream();
            
            Global global = new Global(ctx);
            Main.processSource(ctx, inputStream, "<stdin>", global, outputStream);
            
            String actualOutput = new String(outputStream.toByteArray()).trim();
            
            // Assert that the compiled output matches the expected output
            assertEquals(expectedOutput, actualOutput);
        } finally {
            Context.exit();
        }
    }
}
