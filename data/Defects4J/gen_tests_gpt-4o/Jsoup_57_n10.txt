
import org.jsoup.Jsoup;
import org.jsoup.nodes.Document;
import org.jsoup.nodes.Element;
import org.junit.Test;
import java.util.Iterator;
import java.util.LinkedHashMap;
import java.util.Map;

import static org.junit.Assert.assertFalse;

public class RemoveIgnoreCaseTest {

    @Test(expected = ConcurrentModificationException.class)
    public void testRemoveIgnoreCaseConcurrentModificationException() {
        // Set up a sample HTML document with attributes
        String html = "<html><body><p id='para1' ATTR1='value1' attr2='value2'></p></body></html>";
        Document document = Jsoup.parse(html);
        Element element = document.select("p").first();

        // This loop simulates the buggy method that causes ConcurrentModificationException
        for (Map.Entry<String, String> entry : element.attributes().dataset().entrySet()) {
            if (entry.getKey().equalsIgnoreCase("attr1")) {
                element.removeAttr(entry.getKey());
            }
        }
        
        // This line should never be reached due to exception
        assertFalse(element.hasAttr("attr1"));
    }
}
