
import static org.junit.Assert.assertTrue;
import org.junit.Test;
import com.google.javascript.jscomp.Compiler;
import com.google.javascript.jscomp.CompilerOptions;
import com.google.javascript.jscomp.JSSourceFile;
import com.google.javascript.jscomp.Result;

public class CompilerCrashTest {

    @Test
    public void testCompilerCrashOnGoogScopeLocals() {
        Compiler compiler = new Compiler();

        CompilerOptions options = new CompilerOptions();
        // You can specify different options here if needed
        JSSourceFile extern = JSSourceFile.fromCode("externs.js", "");

        String code = "goog.provide(\"main\");\n" +
                      "goog.scope(function (){\n" +
                      "  var a = foo, b, c = 1;\n" +
                      "});";
        JSSourceFile input = JSSourceFile.fromCode("input.js", code);

        Result result = compiler.compile(extern, input, options);

        // Assert that the compilation did not crash.
        assertTrue("Compiler should not crash", result.success);
    }
}
