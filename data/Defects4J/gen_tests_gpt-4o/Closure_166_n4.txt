public void testAnonymousObjectTypeInferenceInconsistency() {
    String script = "/** @param {{prop: string, prop2: (string|undefined)}} record */\n" +
                    "var func = function(record) {\n" +
                    "   window.console.log(record.prop);\n" +
                    "};\n\n" +
                    "/** @param {{prop: string, prop2: (string|undefined)}|string} record */\n" +
                    "var func2 = function(record) {\n" +
                    "   if (typeof record == 'string') {\n" +
                    "       window.console.log(record);\n" +
                    "   } else {\n" +
                    "       window.console.log(record.prop);\n" +
                    "   }\n" +
                    "};\n\n" +
                    "func({prop: 'a'});\n" +
                    "func2({prop: 'a'});";

    // Assuming we're using a JavaScript library environment that can evaluate the script
    // The expected behavior is that no type error occurs.
    // You need to set up the appropriate environment to evaluate the script and check for errors.
    assertDoesNotThrow(() -> evaluateJavaScript(script)); // Replace evaluateJavaScript with the method to run your JS environment
}