public void testCollapsePropertiesException() {
    String jsInput = "var a = {}; a.b = function() {}; goog.exportSymbol('a.b', a.b);";
    Compiler compiler = new Compiler();
    CompilerOptions options = new CompilerOptions();
    CompilationLevel.ADVANCED_OPTIMIZATIONS.setOptionsForCompilationLevel(options);

    try {
        compiler.compile(SourceFile.fromCode("externs", ""), SourceFile.fromCode("input", jsInput), options);
        fail("Expected exception was not thrown.");
    } catch (RuntimeException e) {
        assertEquals(IllegalArgumentException.class, e.getCause().getClass());
    }
}