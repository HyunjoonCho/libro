
import org.jsoup.Jsoup;
import org.jsoup.nodes.Document;
import org.junit.Test;

import java.io.IOException;
import java.net.URL;

public class JsoupBugTest {

    @Test(expected = StringIndexOutOfBoundsException.class)
    public void testStringIndexOutOfBoundsException() throws IOException {
        // URL from the bug report
        String url = "https://gist.githubusercontent.com/valodzka/91ed27043628e9023009e503d41f1aad/raw/a15f68671e6f0517e48fdac812983b85fea27c16/test.html";

        // This should throw a StringIndexOutOfBoundsException in jsoup version 1.11.1
        Document doc = Jsoup.parse(new URL(url), 10_000);

        // Just for verification, though we expect it not to reach here
        System.out.println(doc.title());
    }
}
