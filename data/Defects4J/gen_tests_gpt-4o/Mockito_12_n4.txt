
import static org.junit.jupiter.api.Assertions.assertArrayEquals;
import static org.mockito.Mockito.*;

import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;
import org.mockito.ArgumentCaptor;
import org.mockito.MockitoAnnotations;

import java.util.List;

interface MyService {
    void doSomething(String... args);
}

public class ArgumentCaptorVarargsTest {
    
    private MyService myService;

    @BeforeEach
    public void setUp() {
        MockitoAnnotations.openMocks(this);
        myService = mock(MyService.class);
    }

    @Test
    public void testArgumentCaptorWithVarargs() {
        myService.doSomething("first", "second", "third");

        // Create an ArgumentCaptor to capture the varargs
        ArgumentCaptor<String> captor = ArgumentCaptor.forClass(String.class);
        
        // Use ArgumentCaptor to capture varargs
        verify(myService).doSomething(captor.capture());

        // Get all captured values as a list
        List<String> capturedArgs = captor.getAllValues();
        
        // Convert list to array
        String[] expectedArgs = {"first", "second", "third"};
        String[] capturedArgsArray = capturedArgs.toArray(new String[0]);
        
        // Asserting that the captured arguments match the expected arguments
        assertArrayEquals(expectedArgs, capturedArgsArray);
    }
}
