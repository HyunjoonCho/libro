public void testCompilerRemovesFunctionProperties() {
    CompiledCode compiledCode = new CompiledCode();

    Map<String, Function> map = compiledCode.createMap();
    Function f1 = compiledCode.createF1WithProperty();
    Function f2 = compiledCode.createF2();

    compiledCode.addToMap(map, "f1", f1);
    compiledCode.addToMap(map, "f2", f2);

    String key = Math.random() > 0.5 ? "f1" : "f2";
    compiledCode.callFunctionByKey(map, key);

    if ("f1".equals(key)) {
        assertTrue(f1.hasProperty("alwaysCall"));
        assertEquals("f1", compiledCode.getLastMsg());
    }
}