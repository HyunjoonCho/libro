
import org.apache.commons.cli.*;
import org.junit.Test;

import static org.junit.Assert.*;

public class PosixParserBugTest {

    @Test
    public void testUnrecognizedOptionWithDash() {
        // Create a new Options object and add option 'a'
        Options options = new Options();
        options.addOption("a", false, "Option A");

        // Create a PosixParser
        CommandLineParser parser = new PosixParser();

        // Command line input
        String[] args = new String[] {"-z", "-a", "foo"};

        try {
            // Parse the command line with PosixParser and stopAtNonOption
            CommandLine cmd = parser.parse(options, args, true);

            // Check if option 'a' is correctly recognized
            assertTrue("Option 'a' should be present", cmd.hasOption("a"));
            // Check if the arguments are correctly parsed
            String[] remainingArgs = cmd.getArgs();

            // Expecting to stop parsing at unrecognized '-z'
            assertArrayEquals("Remaining args should start with '-z'", new String[]{"-z", "foo"}, remainingArgs);
        } catch (ParseException e) {
            fail("ParseException was thrown");
        }
    }
}
