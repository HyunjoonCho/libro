
import org.jsoup.Jsoup;
import org.jsoup.nodes.Document;
import org.jsoup.safety.Cleaner;
import org.jsoup.safety.Safelist;
import org.junit.Test;

import static org.junit.Assert.*;

public class JsoupStackOverflowTest {

    @Test(expected = StackOverflowError.class)
    public void testStackOverflowErrorWithManyWbrTags() {
        // Simulate a document with a large number of <wbr> tags
        StringBuilder html = new StringBuilder("<html><head><title>Test</title></head><body>");
        for (int i = 0; i < 25000; i++) {  // Create excessive <wbr> tags
            html.append("<wbr>");
        }
        html.append("</body></html>");

        // Parse the document
        Document document = Jsoup.parse(html.toString());

        // Try to clean the document using Jsoup's Cleaner, which will throw a StackOverflowError
        Cleaner cleaner = new Cleaner(Safelist.basic());
        cleaner.clean(document); // This should throw a StackOverflowError
    }
}
