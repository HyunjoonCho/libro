
import org.apache.commons.csv.CSVFormat;
import org.apache.commons.csv.CSVParser;
import org.apache.commons.csv.CSVRecord;
import org.junit.Test;

import java.io.StringReader;

public class CSVFormatTest {

    @Test(expected = IllegalArgumentException.class)
    public void testExcelFormatWithEmptyHeaderNames() throws Exception {
        String csvData = "A,B,C,,\n" +
                         "a,b,c,d,e";
        
        try (CSVParser parser = CSVParser.parse(new StringReader(csvData), CSVFormat.EXCEL.withHeader())) {
            for (CSVRecord record : parser) {
                // Attempting to parse records
                // The test should expect an IllegalArgumentException to be thrown
            }
        }
    }
}
