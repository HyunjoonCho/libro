public void testSideEffectsAnalysis() {
    // Assume that we have a method 'analyze' which performs the side-effects analysis
    String jsCode = "/** @constructor */ function Foo() {" +
                    "  var self = this;" +
                    "  window.setTimeout(function() {" +
                    "    window.location = self.location;" +
                    "  }, 0);" +
                    "}" +
                    "Foo.prototype.setLocation = function(loc) {" +
                    "  this.location = loc;" +
                    "};" +
                    "(new Foo()).setLocation('http://www.google.com/');";
                    
    boolean isRemoved = analyze(jsCode);
    
    assertFalse("setLocation call should not be removed", isRemoved);
}