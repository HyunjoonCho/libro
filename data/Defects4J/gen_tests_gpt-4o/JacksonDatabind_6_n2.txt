
import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.databind.exc.InvalidFormatException;
import org.junit.Before;
import org.junit.Test;

import java.text.SimpleDateFormat;
import java.util.Date;

public class ISO8601DateParsingTest {

    private ObjectMapper objectMapper;

    @Before
    public void setUp() {
        objectMapper = new ObjectMapper();
        // Set the default date format to a format that Jackson uses for serialization/deserialization
        objectMapper.setDateFormat(new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss.SSSZ"));
    }

    @Test
    public void testParseISO8601Date_1() {
        String iso8601Date = "2014-10-03T18:00:00.6-05:00";
        parseDateAndAssertSuccess(iso8601Date);
    }

    @Test
    public void testParseISO8601Date_2() {
        String iso8601Date = "2014-10-03T18:00:00.61-05:00";
        parseDateAndAssertSuccess(iso8601Date);
    }

    @Test
    public void testParseISO8601Date_3() {
        String iso8601Date = "1997-07-16T19:20+01:00";
        parseDateAndAssertSuccess(iso8601Date);
    }

    @Test
    public void testParseISO8601Date_4() {
        String iso8601Date = "1997-07-16T19:20:30.45+01:00";
        parseDateAndAssertSuccess(iso8601Date);
    }

    private void parseDateAndAssertSuccess(String date) {
        try {
            // Attempt to deserialize the ISO 8601 date string
            Date parsedDate = objectMapper.readValue("\"" + date + "\"", Date.class);
            System.out.println("Parsed Date: " + parsedDate);
        } catch (InvalidFormatException e) {
            throw new AssertionError("Failed to parse the ISO-8601 date: " + date, e);
        } catch (Exception e) {
            throw new AssertionError("Unexpected error occurred while parsing date: " + date, e);
        }
    }
}
