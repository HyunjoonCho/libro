public void testCompilerAMDModuleFailure() {
    String[] args = {
        "--transform_amd_modules",
        "--process_common_js_modules",
        "--common_js_entry_module=Bar.js",
        "--compilation_level=ADVANCED_OPTIMIZATIONS",
        "--js_output_file=out.js",
        "--js=Bar.js",
        "--js=lib/Foo.js"
    };
    
    try {
        Compiler compiler = new Compiler();
        CompilerOptions options = new CompilerOptions();
        CommandLineRunner.populateOptions(options, args);
        
        Result result = compiler.compile(externs, inputs, options);
        assertFalse("Compilation should fail", result.success);
        assertEquals(1, compiler.getErrorCount());
        assertTrue(compiler.getErrors()[0].description.contains("required entry point \"module$lib$Foo\" never provided"));
    } catch (Exception e) {
        fail("An exception occurred: " + e.getMessage());
    }
}