public void testZipFileWithManyEntries() throws IOException {
    File zipFile = File.createTempFile("testZip", ".zip");
    try (ZipArchiveOutputStream zipOutputStream = new ZipArchiveOutputStream(zipFile)) {
        for (int i = 0; i < 5000; i++) {
            String fileName = "file" + (i % 100); // Creates many files with the same hash value
            ZipArchiveEntry entry = new ZipArchiveEntry(fileName);
            zipOutputStream.putArchiveEntry(entry);
            zipOutputStream.write(("contents of " + fileName).getBytes());
            zipOutputStream.closeArchiveEntry();
        }
    }

    try (ZipFile zf = new ZipFile(zipFile)) {
        Enumeration<ZipArchiveEntry> entries = zf.getEntries();
        int countEntries = 0;
        while (entries.hasMoreElements()) {
            entries.nextElement();
            countEntries++;
        }
        assertEquals(5000, countEntries);
    } catch (ZipException e) {
        fail("Zip file is corrupted or cannot be read: " + e.getMessage());
    } finally {
        zipFile.delete();
    }
}