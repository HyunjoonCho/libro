public void testBlockC3P0Gadgets() {
    ObjectMapper mapper = new ObjectMapper();
    mapper.enableDefaultTyping();
    String[] c3p0GadgetClasses = {
        "com.mchange.v2.c3p0.JndiRefDataSource",
        "com.mchange.v2.c3p0.WrapperConnectionPoolDataSource"
    };
    for (String gadgetClass : c3p0GadgetClasses) {
        String json = String.format("[\"%s\", {\"dataSourceName\":\"java:comp/env/jdbc/Database\"}]", gadgetClass);
        try {
            mapper.readValue(json, Object.class);
            fail("Deserialization of " + gadgetClass + " should be blocked!");
        } catch (JsonMappingException e) {
            // Expected behavior, continue
        } catch (Exception e) {
            fail("Unexpected exception type: " + e.getClass().getName());
        }
    }
}