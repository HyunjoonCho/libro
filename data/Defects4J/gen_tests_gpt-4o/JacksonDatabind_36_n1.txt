
import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.databind.util.StdDateFormat;
import org.junit.Test;

import java.text.ParseException;
import java.util.Date;

import static org.junit.Assert.assertEquals;

public class StdDateFormatTest {

    @Test
    public void testLenientDateParsing() throws Exception {
        ObjectMapper objectMapper = new ObjectMapper();
        StdDateFormat dateFormat = new StdDateFormat();

        // Below is what you would ideally want to use if setLenient was available
        // dateFormat.setLenient(false); 

        objectMapper.setDateFormat(dateFormat);

        String dateString = "2015-01-32";

        // Expecting this to throw ParseException if non-lenient parsing was available
        Date parsedDate = dateFormat.parse(dateString);

        // Since lenient parsing is the default, "2015-01-32" becomes "2015-02-01"
        StdDateFormat expectedFormat = new StdDateFormat(); 
        Date expectedDate = expectedFormat.parse("2015-02-01");

        assertEquals(expectedDate, parsedDate);
    }
}
