
import org.apache.commons.cli.CommandLine;
import org.apache.commons.cli.DefaultParser;
import org.apache.commons.cli.Option;
import org.apache.commons.cli.Options;
import org.apache.commons.cli.ParseException;
import org.junit.Test;
import static org.junit.Assert.assertEquals;

public class PosixParserTest {

    @Test
    public void testTargetOptionParsingIssue() {
        String[] args = { "-target", "foobar.com" };

        Options options = new Options();
        options.addOption(new Option("t", "target", true, "Generate files for the specified target machine"));

        try {
            DefaultParser parser = new DefaultParser();
            CommandLine parsedLine = parser.parse(options, args);

            if (parsedLine.hasOption("t")) {
                String targetValue = parsedLine.getOptionValue("t");
                // Verify the bug: it should interpret as "foobar.com" but it does "arget"
                assertEquals("foobar.com", targetValue);
            } else {
                throw new AssertionError("Option 't' was not recognized.");
            }
        } catch (ParseException e) {
            throw new AssertionError("Parsing failed: " + e.getMessage());
        }
    }
}
