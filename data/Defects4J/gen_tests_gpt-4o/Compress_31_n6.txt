
import org.apache.commons.compress.archivers.tar.TarArchiveEntry;
import org.apache.commons.compress.archivers.tar.TarArchiveInputStream;
import org.junit.Test;

import java.io.ByteArrayInputStream;
import java.io.IOException;
import java.util.zip.GZIPInputStream;

public class TarArchiveTest {

    @Test(expected = IOException.class)
    public void testInvalidTgzFileCausesIllegalArgumentException() throws IOException {
        // Simulate an invalid .tgz file content
        byte[] invalidTgzData = new byte[]{0x1f, (byte) 0x8b, 0x08, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00};

        try (ByteArrayInputStream byteIn = new ByteArrayInputStream(invalidTgzData);
             GZIPInputStream gzipIn = new GZIPInputStream(byteIn);
             TarArchiveInputStream tarIn = new TarArchiveInputStream(gzipIn)) {
                
            // This line should throw an IOException due to invalid data
            TarArchiveEntry entry = tarIn.getNextTarEntry();
            while (entry != null) {
                entry = tarIn.getNextTarEntry();
            }
        }
    }
}
