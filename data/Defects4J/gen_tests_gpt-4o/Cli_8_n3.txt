public void testHelpFormatterWrapsCorrectly() {
    HelpFormatter formatter = new HelpFormatter();
    Options options = new Options();
    Option option = new Option("d", "description", true, "This is a long description that should be wrapped correctly by the HelpFormatter. Notice how the lines are expected to wrap to the specified width correctly beyond the first line.");
    options.addOption(option);

    final int width = 50;
    StringWriter out = new StringWriter();
    PrintWriter pw = new PrintWriter(out);
    formatter.printHelp(pw, width, "command", null, options, 1, 3, null, true);

    pw.flush();
    String helpOutput = out.toString();
    String[] lines = helpOutput.split(System.lineSeparator());

    for (int i = 1; i < lines.length; i++) {
        assertTrue("Line " + i + " exceeded width limit", lines[i].length() <= width);
    }
}