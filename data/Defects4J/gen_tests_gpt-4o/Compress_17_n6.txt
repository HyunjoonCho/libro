
import java.io.ByteArrayInputStream;
import java.io.IOException;
import java.nio.charset.StandardCharsets;

import org.apache.commons.compress.archivers.ArchiveEntry;
import org.apache.commons.compress.archivers.tar.TarArchiveInputStream;
import org.junit.Test;

public class TarArchiveTest {

    @Test(expected = IllegalArgumentException.class)
    public void testInvalidTarEntry() throws IOException {
        // Mock a tar file content with an invalid octal in the header.
        byte[] invalidHeader = new byte[512];
        String invalidOctal = "01750\0\0\0\u0000"; // Using Unicode for NUL and invalid character
        System.arraycopy(invalidOctal.getBytes(StandardCharsets.US_ASCII), 0, invalidHeader, 100, invalidOctal.length());

        try (TarArchiveInputStream tais = new TarArchiveInputStream(new ByteArrayInputStream(invalidHeader))) {
            ArchiveEntry entry = tais.getNextEntry();
            // Attempting to read an entry should throw an exception.
        }
    }
}
