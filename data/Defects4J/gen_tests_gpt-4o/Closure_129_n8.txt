public void testCastingFunctionWithAdvancedOptimizations() {
    String codeWithCast = "console.log( /** @type {function(!string):!string} */ ((new window.ActiveXObject( 'ShockwaveFlash.ShockwaveFlash' ))['GetVariable'])( '$version' ) );";
    String expectedOutputWithCast = "'use strict';console.log((new window.ActiveXObject(\"ShockwaveFlash.ShockwaveFlash\")).GetVariable(\"$version\"));";
    
    Compiler compiler = new Compiler();
    CompilerOptions options = new CompilerOptions();
    CompilationLevel.ADVANCED_OPTIMIZATIONS.setOptionsForCompilationLevel(options);
    compiler.compile(SourceFile.fromCode("externs.js", ""), SourceFile.fromCode("test.js", codeWithCast), options);
    
    String compiledCodeWithCast = compiler.toSource();
    assertTrue(compiledCodeWithCast.equals(expectedOutputWithCast));
}