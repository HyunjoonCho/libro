script
const assert = require('assert');

function testOptimizedCode() {
    let uid;
    
    function reset() {
        uid = Math.random();
    }
    
    function doStuff() {
        reset();
        const _uid = uid;

        if (uid < 0.5) {
            doStuff();
        }

        if (_uid !== uid) {
            throw new Error('reset() was called');
        }
    }

    try {
        doStuff();
        console.log('Test passed: No exception was thrown.');
    } catch (e) {
        assert.strictEqual(e.message, 'reset() was called', 'Test failed due to optimization issue.');
        console.log('Test failed: Optimization incorrectly modified behavior.');
    }
}

testOptimizedCode();
