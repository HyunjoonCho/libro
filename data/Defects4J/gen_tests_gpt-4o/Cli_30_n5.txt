
import org.apache.commons.cli.*;

import java.util.Properties;

import static org.junit.Assert.*;

public class CommandLineParserTest {

    @org.junit.Test
    public void testMutuallyExclusiveOptionsWithDefaults() throws Exception {
        // Define mutually exclusive options a and b
        Options options = new Options();
        OptionGroup group = new OptionGroup();
        group.addOption(new Option("a", "option-a", false, "Option A"));
        group.addOption(new Option("b", "option-b", false, "Option B"));
        options.addOptionGroup(group);

        // Create a properties object with default option 'b'
        Properties defaults = new Properties();
        defaults.setProperty("b", "true");

        // Parse command line with argument specifying option 'a'
        CommandLineParser parser = new DefaultParser();
        CommandLine cmd = parser.parse(options, new String[]{"-a"}, defaults);

        // Check if both 'a' and 'b' options are set, which shouldn't be allowed
        assertTrue("Option 'a' should be present", cmd.hasOption("a"));
        assertFalse("Option 'b' should not be present due to mutual exclusion", cmd.hasOption("b"));
    }
}
