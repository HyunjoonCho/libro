public void testSmartNameRemovalCompilerCrash() {
    String code = ""
        + "var goog = {};\n"
        + "goog.inherits = function(x, y) {};\n"
        + "var ns = {};\n"
        + "/** @constructor */ ns.PageSelectionModel = function(){};\n"
        + "/** @constructor */ ns.PageSelectionModel.FooEvent = function() {};\n"
        + "/** @constructor */ ns.PageSelectionModel.SelectEvent = function() {};\n"
        + "goog.inherits(ns.PageSelectionModel.ChangeEvent, ns.PageSelectionModel.FooEvent);";

    try {
        // Assuming compileCode is a method that triggers the compilation in advanced mode
        compileCode(code);
        fail("Expected compiler to crash, but it did not.");
    } catch (Exception e) {
        assertTrue(e instanceof IllegalStateException);
    }
}