
import static org.junit.Assert.*;

import java.util.List;

import org.junit.Test;

public class DefaultArgsTest {

    @Test
    public void testSingleOptionSingleArgument() throws Exception {
        String defaulValue1 = "100";
        String defaultValue2 = "1000";

        DefaultOptionBuilder obuilder = new DefaultOptionBuilder();
        ArgumentBuilder abuilder = new ArgumentBuilder();
        GroupBuilder gbuilder = new GroupBuilder();

        DefaultOption bOption = obuilder.withShortName("b")
                .withLongName("b")
                .withArgument(abuilder.withName("b")
                        .withMinimum(0)
                        .withMaximum(2)
                        .withDefault(defaulValue1)
                        .withDefault(defaultValue2)
                        .create())
                .create();

        Group options = gbuilder.withName("options")
                .withOption(bOption)
                .create();

        Parser parser = new Parser();
        parser.setHelpTrigger("--help");
        parser.setGroup(options);

        // Case with one argument passed
        String enteredValue1 = "1";
        String[] args = new String[]{"-b", enteredValue1};

        CommandLine cl = parser.parse(args);

        assertNotNull(cl);

        List<String> b = cl.getValues("-b");

        // The expectation is for the second value to fall back to the default, which is "1000"
        assertEquals("[" + enteredValue1 + ", " + defaultValue2 + "]", b.toString());
    }
}
