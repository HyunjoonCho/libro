
import java.io.IOException;
import java.io.Reader;
import java.io.StringReader;

import static org.junit.Assert.assertEquals;

public class ExtendedBufferReaderTest {

    public void testLineCountingWithDifferentEOL() throws IOException {
        String input = "First line\nSecond line\rThird line\r\nFourth line\rFifth line\n";
        Reader stringReader = new StringReader(input);
        ExtendedBufferReader reader = new ExtendedBufferReader(stringReader);

        int lineCount = 0;
        while (reader.readLine() != null) {
            lineCount++;
        }

        // We expect 5 lines to be counted: each EOL variation should be considered a new line
        assertEquals("Line count should be 5", 5, lineCount);
    }
}

// Example of ExtendedBufferReader class
class ExtendedBufferReader extends BufferedReader {

    private int lineCount;

    public ExtendedBufferReader(Reader in) {
        super(in);
    }

    @Override
    public String readLine() throws IOException {
        String line = super.readLine();
        if (line != null) {
            lineCount++;
        }
        return line;
    }

    public int getLineCount() {
        return lineCount;
    }
}
