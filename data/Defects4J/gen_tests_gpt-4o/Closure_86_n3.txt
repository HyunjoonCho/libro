
import static org.junit.Assert.assertEquals;

import org.junit.Test;

public class SideEffectsAnalysisTest {

    @Test
    public void testFunctionCallWithSideEffectsNotRemoved() {
        // Temporarily storing the simulated window location change
        final String[] simulatedWindowLocation = { null };

        // Simulating setTimeout and window.location behavior
        class Foo {
            String location;

            Foo() {
                // Simulating the setTimeout function
                new Thread(() -> {
                    try {
                        Thread.sleep(0);
                        simulatedWindowLocation[0] = this.location;
                    } catch (InterruptedException e) {
                        e.printStackTrace();
                    }
                }).start();
            }

            public void setLocation(String loc) {
                this.location = loc;
            }
        }

        Foo foo = new Foo();
        foo.setLocation("http://www.google.com/");

        // Since setTimeout with 0 delay acts like a new thread, a small sleep to allow it to execute
        try {
            Thread.sleep(100);
        } catch (InterruptedException e) {
            e.printStackTrace();
        }

        // Verify that the location was set and used correctly
        assertEquals("http://www.google.com/", simulatedWindowLocation[0]);
    }
}
