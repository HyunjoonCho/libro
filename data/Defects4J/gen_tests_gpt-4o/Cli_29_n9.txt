
import org.apache.commons.cli.CommandLine;
import org.apache.commons.cli.CommandLineParser;
import org.apache.commons.cli.DefaultParser;
import org.apache.commons.cli.Option;
import org.apache.commons.cli.Options;
import org.junit.Test;

import static org.junit.Assert.assertEquals;

public class CommonsCliTest {

    @Test
    public void testArgumentWithQuotes() throws Exception {
        // Create an Options object and add the option we want to test
        Options options = new Options();
        options.addOption(Option.builder("b")
                .longOpt("balloo")
                .hasArg()
                .desc("Test option with quotes")
                .build());

        // Arguments to parse
        String[] args = {"--balloo", "this is a \"test\""};

        // Create the parser and parse the arguments
        CommandLineParser parser = new DefaultParser();
        CommandLine cmd = parser.parse(options, args);

        // Retrieve the value for the option "balloo"
        String ballooValue = cmd.getOptionValue("balloo");

        // Assert that the value hasn't been incorrectly modified by stripping quotes
        assertEquals("this is a \"test\"", ballooValue);
    }
}
