public void testPrototypeMethodsInConstructor() {
    Compiler compiler = new Compiler();
    String jsCode = 
        "function WebInspector() {}\n" +
        "/** @constructor */\n" +
        "WebInspector.DOMAgent = function() {\n" +
        "  this._setAttributesPayload({ attributes: 'test' });\n" +
        "};\n" +
        "WebInspector.DOMAgent.prototype._setAttributesPayload = function(attrs) {};\n";

    JSSourceFile input = JSSourceFile.fromCode("testcode", jsCode);
    CompilerOptions options = new CompilerOptions();
    options.setWarningLevel(DiagnosticGroups.UNDEFINED_PROTOTYPE_METHODS, CheckLevel.WARNING);
    Result result = compiler.compile(CommandLineRunner.getDefaultExterns(), ImmutableList.of(input), options);
    
    assertTrue("Prototype method used in constructor should have caused warning", 
               result.warnings.length > 0);
    assertEquals("Property _setAttributesPayload never defined on WebInspector.DOMNode", 
                 result.warnings[0].description);
}