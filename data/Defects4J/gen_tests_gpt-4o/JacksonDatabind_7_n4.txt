public void testTokenBufferWithJsonCreator() throws IOException {
    String json = "{ \"a\":1, \"b\":null }";
    ObjectMapper mapper = new ObjectMapper();

    JsonParser parser = mapper.getFactory().createParser(json);
    parser.nextToken(); // move to START_OBJECT

    TokenBuffer buffer = new TokenBuffer(parser, mapper);
    buffer.copyCurrentStructure(parser);

    assertEquals(JsonToken.START_OBJECT, buffer.firstToken());
    List<JsonToken> expectedTokens = Arrays.asList(
            JsonToken.START_OBJECT,
            JsonToken.FIELD_NAME,
            JsonToken.VALUE_NUMBER_INT,
            JsonToken.FIELD_NAME,
            JsonToken.VALUE_NULL,
            JsonToken.END_OBJECT
    );

    // Collect tokens from the TokenBuffer
    List<JsonToken> actualTokens = new ArrayList<>();
    JsonToken token;
    while ((token = buffer.nextToken()) != null) {
        actualTokens.add(token);
    }

    assertEquals(expectedTokens, actualTokens);
}