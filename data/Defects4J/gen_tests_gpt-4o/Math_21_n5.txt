public void testCorrelatedRandomVectorGeneratorWithZeroRows() {
    double[][] matrix = {
        {0.0, 0.0, 0.0, 0.0, 0.0},
        {0.0, 0.013445532, 0.01039469, 0.009881156, 0.010499559},
        {0.0, 0.01039469, 0.023006616, 0.008196856, 0.010732709},
        {0.0, 0.009881156, 0.008196856, 0.019023866, 0.009210099},
        {0.0, 0.010499559, 0.010732709, 0.009210099, 0.019107243}
    };

    RealMatrix covarianceMatrix = new Array2DRowRealMatrix(matrix);
    RealVector meanVector = new ArrayRealVector(new double[] {0, 0, 0, 0, 0});

    try {
        CorrelatedRandomVectorGenerator generator =
            new CorrelatedRandomVectorGenerator(meanVector, covarianceMatrix, 0, new GaussianRandomGenerator(new Well19937c()));
        RealVector sample = generator.nextVector();
        
        double[][] expectedCovariance = {
            {0., 0., 0., 0., 0.},
            {0., 0.013383931, 0.01034401, 0.009913271, 0.010506733},
            {0., 0.010344006, 0.02309479, 0.00837473, 0.010759306},
            {0., 0.009913271, 0.00837473, 0.019005488, 0.009187287},
            {0., 0.010506733, 0.01075931, 0.009187287, 0.019021483}
        };
        
        assertArrayEquals(expectedCovariance, computeCovarianceMatrix(generator), 1e-5);
    } catch (Exception e) {
        fail("Generator failed with exception: " + e.getMessage());
    }
}