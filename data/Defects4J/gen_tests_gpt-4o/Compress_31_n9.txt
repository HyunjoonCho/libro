
import org.apache.commons.compress.archivers.tar.TarArchiveEntry;
import org.apache.commons.compress.archivers.tar.TarArchiveInputStream;
import org.junit.Test;

import java.io.BufferedInputStream;
import java.io.FileInputStream;
import java.io.IOException;
import java.util.zip.GZIPInputStream;

public class TgzExtractionTest {

    @Test(expected = IllegalArgumentException.class)
    public void testTarGzExtraction() throws IOException {
        String fileName = "path/to/your/problematic-file.tgz";

        try (TarArchiveInputStream tarIn = new TarArchiveInputStream(
                new GZIPInputStream(
                        new BufferedInputStream(
                                new FileInputStream(fileName))))) {

            TarArchiveEntry entry = tarIn.getNextTarEntry();

            while (entry != null) {
                // Simulate reading through the entries
                if (!entry.isDirectory()) {
                    byte[] buffer = new byte[2048];
                    while (tarIn.read(buffer) != -1) {
                        // reading file contents
                    }
                }
                entry = tarIn.getNextTarEntry();
            }
        }
    }
}
