
import org.apache.commons.csv.CSVFormat;
import org.apache.commons.csv.CSVPrinter;
import org.junit.Test;

import java.io.BufferedReader;
import java.io.File;
import java.io.FileReader;
import java.nio.file.Files;
import java.nio.file.Paths;

import static org.junit.Assert.assertEquals;

public class CSVPrinterTest {

    @Test
    public void testCSVPrinterWithHeader() throws Exception {
        // Temporary file for the CSV output
        File csvFile = new File("test_output.csv");

        // Use CSVPrinter with CSVFormat and header
        try (CSVPrinter csvPrinter = CSVFormat.TDF
                .withHeader("x")
                .print(Files.newBufferedWriter(Paths.get(csvFile.getAbsolutePath())))) {
            csvPrinter.printRecord(42);  // Should write a header and a record
        }

        // Read the file to check the content
        try (BufferedReader br = new BufferedReader(new FileReader(csvFile))) {
            String firstLine = br.readLine();
            String secondLine = br.readLine();

            // Assert the expected behavior
            assertEquals("x", firstLine);    // Expected header line
            assertEquals("42", secondLine);  // Expected record line
        } finally {
            // Clean up the temporary file after the test
            csvFile.delete();
        }
    }
}
