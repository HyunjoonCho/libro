public void testPrototypeMethodRemoval() {
    String input = ""
            + "/** @const */\n"
            + "var foo = {};\n"
            + "foo.bar = { 'bar1': function() { console.log('bar1'); } }\n"
            + "/** @constructor */\n"
            + "function foobar() {}\n"
            + "foobar.prototype = foo.bar;\n"
            + "foo.foobar = new foobar;\n"
            + "console.log(foo.foobar['bar1']);";

    Compiler compiler = new Compiler();
    CompilerOptions options = new CompilerOptions();
    CompilationLevel.ADVANCED_OPTIMIZATIONS.setOptionsForCompilationLevel(options);
    compiler.compile(SourceFile.fromCode("externs.js", ""), SourceFile.fromCode("input.js", input), options);

    String output = compiler.toSource();
    boolean containsExpectedMethod = output.contains("['bar1']");
    
    assertTrue("The compiled output should contain the method 'bar1'", containsExpectedMethod);
}