
import org.apache.commons.compress.archivers.tar.TarArchiveInputStream;
import org.junit.Test;

import java.io.ByteArrayInputStream;
import java.io.IOException;

public class TarArchiveInputStreamTest {

    @Test(expected = IOException.class)
    public void testInvalidTarFileThrowsIOException() throws IOException {
        // Create a byte array representing a corrupted tar file
        byte[] corruptTarFile = new byte[]{0, 0, 0, 0, 0, 0, 0, -1};

        // Wrap the byte array in a ByteArrayInputStream to simulate a real InputStream
        ByteArrayInputStream byteArrayInputStream = new ByteArrayInputStream(corruptTarFile);

        try (TarArchiveInputStream tarInputStream = new TarArchiveInputStream(byteArrayInputStream)) {
            // Attempt to read the first entry, which should fail with an IOException
            tarInputStream.getNextTarEntry();
        }
    }
}
