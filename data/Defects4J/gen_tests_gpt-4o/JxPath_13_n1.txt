
import org.apache.commons.jxpath.JXPathContext;
import org.apache.commons.jxpath.xml.JDOMParser;
import org.jdom2.Document;
import org.jdom2.Element;
import org.junit.Test;

import static org.junit.Assert.fail;

public class NamespaceHandlingTest {

    @Test
    public void testRegisterNamespaceForAttributes() {
        try {
            // Create a simple XML document with namespaces
            Element root = new Element("ElementA");

            // Register namespaces and set attribute with namespaces
            root.setNamespace(org.jdom2.Namespace.getNamespace("A", "http://namespaceA"));
            root.setAttribute("myAttr", "Mytype", org.jdom2.Namespace.getNamespace("A", "http://namespaceA"));

            Element child = new Element("ElementB", org.jdom2.Namespace.getNamespace("B", "http://namespaceB"));
            child.setText("MY VALUE");
            root.addContent(child);

            Document document = new Document(root);
            
            // Parse the document using JXPath
            JXPathContext context = JXPathContext.newContext(document);
            context.registerNamespace("A", "http://namespaceA");
            context.registerNamespace("B", "http://namespaceB");

            // Attempt to query an attribute with a namespace
            context.getValue("/A:ElementA/@A:myAttr");

        } catch (Exception e) {
            fail("No exception should be thrown, but caught: " + e);
        }
    }
}
