public void testJsonGenerationExceptionWithSurrogatePair() {
    String problematicJson = "\"some text before the issue \uD83D\uDE00\""; // Emoji character (2 UTF-16 codes)
    StringBuilder largeInput = new StringBuilder();
    for (int i = 0; i < 5000; i++) {
        largeInput.append("x");
    }
    largeInput.append(problematicJson);

    try {
        JsonFactory jsonFactory = new JsonFactory();
        JsonGenerator jsonGenerator = jsonFactory.createGenerator(new NullWriter());
        jsonGenerator.writeRawValue(largeInput.toString());
        jsonGenerator.close();
        fail("Expected JsonGenerationException to be thrown");
    } catch (JsonGenerationException e) {
        assertTrue(e.getMessage().contains("Split surrogate on writeRaw() input"));
    } catch (IOException e) {
        fail("Unexpected IOException: " + e.getMessage());
    }
}