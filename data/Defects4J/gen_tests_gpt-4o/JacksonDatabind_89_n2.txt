
import com.fasterxml.jackson.databind.ObjectMapper;
import org.junit.Test;

import static org.junit.Assert.*;

public class JDKTypeDeserializationTest {

    static class ExploitBean {
        public String foo;
    }

    private final ObjectMapper objectMapper = new ObjectMapper();

    @Test
    public void testBlockPolymorphicDeserialization() {
        String json = "{\"@type\":\"java.util.logging.Logger\",\"foo\":\"bar\"}";
        
        try {
            objectMapper.readValue(json, ExploitBean.class);
            fail("Deserialization should be blocked, but it succeeded.");
        } catch (Exception e) {
            assertTrue("Deserialization was correctly blocked.", e.getMessage().contains("resolved type"));
        }
    }
}
