
import java.io.ByteArrayInputStream;
import java.io.IOException;
import java.util.zip.ZipInputStream;
import org.junit.Test;

public class TruncatedZipTest {

    @Test(expected = java.io.EOFException.class)
    public void testTruncatedZipFile() throws IOException {
        // Create a byte array for a truncated zip file (incomplete data)
        byte[] truncatedZipData = {0x50, 0x4B, 0x03, 0x04, // ZIP file header
                                   0x14, 0x00, 0x00, 0x00, // Some more header data
                                   // Truncated data...
                                   0x08, 0x00, 0x00, 0x00};

        // Wrap the byte array in an input stream
        ByteArrayInputStream bais = new ByteArrayInputStream(truncatedZipData);
        ZipInputStream zis = new ZipInputStream(bais);

        try {
            // Attempt to read from the zip input stream, expecting an exception
            while (zis.getNextEntry() != null) {
                // Loop over entries (the code should never reach this point)
            }
        } finally {
            zis.close();
        }
    }
}
