public void testNonBlockingParserOffsetIssue() throws Exception {
    JsonFactory jsonFactory = new JsonFactory();
    JsonParser parser = jsonFactory.createNonBlockingByteArrayParser();
    ByteArrayFeeder feeder = (ByteArrayFeeder) parser.getNonBlockingInputFeeder();

    byte[] input = "[{\"key\": \"value\"}]".getBytes(UTF_8);

    feeder.feedInput(input, 5, 10); // starting from inside the JSON
    assertEquals(JsonToken.START_OBJECT, parser.nextToken());
    assertEquals(1, parser.getCurrentLocation().getByteOffset()); // ACTUAL should be 6
    assertEquals(1, parser.getTokenLocation().getByteOffset());   // ACTUAL should be 6

    feeder.feedInput(input, 0, 5); // feed the starting part of JSON
    assertEquals(JsonToken.START_ARRAY, parser.nextToken());
    assertEquals(0, parser.getCurrentLocation().getByteOffset());
    assertEquals(0, parser.getTokenLocation().getByteOffset());
}