public void testShapeNumberExplicitlyDefined() {
    ObjectMapper mapper = new ObjectMapper();
    mapper.enable(SerializationFeature.WRITE_DATES_AS_TIMESTAMPS);

    SimpleModule module = new SimpleModule();
    module.addSerializer(Date.class, new JsonSerializer<Date>() {
        @Override
        public void serialize(Date value, JsonGenerator gen, SerializerProvider serializers) throws IOException {
            gen.writeString(new SimpleDateFormat("yyyy-MM-dd").format(value));
        }
    });

    mapper.registerModule(module);

    String json = mapper.writeValueAsString(new Date());

    assertFalse("Date should not be serialized as text when shape is explicitly NUMBER",
            json.matches("\"\\d{4}-\\d{2}-\\d{2}\""));
}