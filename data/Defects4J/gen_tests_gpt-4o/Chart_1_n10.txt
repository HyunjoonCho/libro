@Test
public void testGetLegendItemsWithNullDataset() {
    AbstractCategoryItemRenderer renderer = new AbstractCategoryItemRenderer() {
        // Provide minimal implementation needed for the test
    };
    
    // Create a mock plot and make getDataset(index) return null
    CategoryPlot plot = mock(CategoryPlot.class);
    when(plot.getDataset(anyInt())).thenReturn(null);
    when(plot.getIndexOf(any())).thenReturn(0); // Returning a sample index

    // Set the plot to renderer
    renderer.setPlot(plot);

    try {
        // Attempt to get legend items, should not throw NPE
        renderer.getLegendItems();
        // If no exception is thrown, the test passes
    } catch (NullPointerException e) {
        fail("Expected no NullPointerException, but got one.");
    }
}