
import org.apache.commons.math3.distribution.GammaDistribution;
import org.junit.Test;

import java.io.*;
import static org.junit.Assert.*;

public class GammaDistributionTest {

    @Test
    public void testGammaDistributionSerialization() throws IOException, ClassNotFoundException {
        // Create an instance of GammaDistribution
        GammaDistribution originalDistribution = new GammaDistribution(2.0, 1.0);

        // Serialize the GammaDistribution
        ByteArrayOutputStream byteOut = new ByteArrayOutputStream();
        ObjectOutputStream out = new ObjectOutputStream(byteOut);
        out.writeObject(originalDistribution);
        out.close();

        // Deserialize the GammaDistribution
        ByteArrayInputStream byteIn = new ByteArrayInputStream(byteOut.toByteArray());
        ObjectInputStream in = new ObjectInputStream(byteIn);
        GammaDistribution clonedDistribution = (GammaDistribution) in.readObject();
        in.close();

        // Check that deserialized distribution produces the same samples
        // For reproducibility, set the same seed before generating samples
        originalDistribution.reseedRandomGenerator(1234L);
        clonedDistribution.reseedRandomGenerator(1234L);

        for (int i = 0; i < 10; i++) {
            double originalSample = originalDistribution.sample();
            double clonedSample = clonedDistribution.sample();
            assertEquals("Samples from original and cloned distributions should match", originalSample, clonedSample, 1e-9);
        }
    }
}
