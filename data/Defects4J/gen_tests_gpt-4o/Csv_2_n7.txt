
import org.apache.commons.csv.CSVFormat;
import org.apache.commons.csv.CSVParser;
import org.apache.commons.csv.CSVRecord;
import org.junit.Test;

import java.io.IOException;

import static org.junit.Assert.assertThrows;

public class CSVRecordTest {

    @Test
    public void testInvalidHeaderTooLong() throws IOException {
        // Arrange: Create a CSVParser with a longer header list than data values
        final String csvData = "a,b";
        final CSVParser parser = CSVParser.parse(csvData, CSVFormat.DEFAULT.withHeader("A", "B", "C"));

        // Act & Assert: Attempt to retrieve a value using the extra header should result in an exception
        Exception exception = assertThrows(ArrayIndexOutOfBoundsException.class, () -> {
            CSVRecord record = parser.iterator().next();
            record.get("C"); // There is no "C" in the actual data values
        });

        System.out.println("Exception message: " + exception.getMessage());
    }
}
