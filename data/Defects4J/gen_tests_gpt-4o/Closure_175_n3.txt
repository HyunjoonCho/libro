
import com.google.javascript.jscomp.CommandLineRunner;

public class ClosureCompilerTest {

    public static void main(String[] args) {
        String[] compilerArgs = {
            "--compilation_level", "ADVANCED_OPTIMIZATIONS",
            "--warning_level", "VERBOSE",
            "--js", "input.js",
            "--js_output_file", "output.js"
        };

        // Create the input JavaScript file
        String jsInput = 
            "window['anchor'] = function (obj, modifiesProp) {" +
            "    return (function (saved) {" +
            "        return modifiesProp(obj) + saved;" +
            "    })(obj['prop']);" +
            "};";

        // Write the input JS to a file
        try (FileWriter writer = new FileWriter("input.js")) {
            writer.write(jsInput);
        } catch (IOException e) {
            e.printStackTrace();
            return;
        }

        // Run the Closure Compiler
        CommandLineRunner runner = new CommandLineRunner(compilerArgs);
        int result = runner.run();

        // Output the result of compilation
        System.out.println("Compilation Result Code: " + result);
        try {
            String output = new String(Files.readAllBytes(Paths.get("output.js")));
            System.out.println("Compiled JavaScript Output:");
            System.out.println(output);
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}
