public void testAssignmentInConditionalTypeError() {
    Object result = func(false, false);
    assertTrue(result instanceof Map);
    assertNull(((Map) result).get("prop1"));
    assertNull(((Map) result).get("prop2"));
    assertEquals("prop3", ((Map) result).get("prop3"));

    result = func(true, false);
    assertTrue(result instanceof Map);
    assertNotNull(((Map) result).get("prop1"));
    assertEquals(3, ((Map) result).get("prop1").a);
    assertNull(((Map) result).get("prop2"));
    assertEquals("prop3", ((Map) result).get("prop3"));

    result = func(true, true);
    assertTrue(result instanceof Map);
    assertNotNull(((Map) result).get("prop1"));
    assertEquals(3, ((Map) result).get("prop1").a);
    assertEquals("prop2", ((Map) result).get("prop2"));
    assertNull(((Map) result).get("prop3"));
}