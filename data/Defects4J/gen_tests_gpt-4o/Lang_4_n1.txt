
import org.apache.commons.lang3.StringEscapeUtils;
import org.junit.Test;
import java.nio.CharBuffer;
import static org.junit.Assert.assertEquals;

public class LookupTranslatorTest {

    @Test
    public void testTranslateWithCharSequence() {
        // Test with String
        CharSequence cs1 = "1 < 2";
        String translatedCs1 = StringEscapeUtils.ESCAPE_HTML4.translate(cs1);
        assertEquals("1 &lt; 2", translatedCs1);

        // Test with CharBuffer
        CharSequence cs2 = CharBuffer.wrap("1 < 2".toCharArray());
        String translatedCs2 = StringEscapeUtils.ESCAPE_HTML4.translate(cs2);

        // This assertion will fail due to the bug
        assertEquals("1 &lt; 2", translatedCs2);

        // Workaround using toString() on CharBuffer
        String translatedWithWorkaround = StringEscapeUtils.ESCAPE_HTML4.translate(cs2.toString());
        assertEquals("1 &lt; 2", translatedWithWorkaround);
    }
}
