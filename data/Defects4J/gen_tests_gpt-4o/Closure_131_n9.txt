
import com.google.javascript.jscomp.Compiler;
import com.google.javascript.jscomp.CompilerOptions;
import com.google.javascript.jscomp.JSError;
import com.google.javascript.jscomp.Result;
import com.google.javascript.jscomp.SourceFile;

import java.util.List;

import org.junit.Test;
import static org.junit.Assert.*;

public class UnicodePropertyNameTest {

    @Test
    public void testUnicodeCharactersInPropertyNames() {
        String jsCode = "var test={\"a\\u0004b\":\"c\"};";
        Compiler compiler = new Compiler();
        CompilerOptions options = new CompilerOptions();
        
        // Compile the JavaScript code
        SourceFile input = SourceFile.fromCode("test", jsCode);
        List<SourceFile> externs = com.google.common.collect.ImmutableList.of();
        Result result = compiler.compile(externs, com.google.common.collect.ImmutableList.of(input), options);
        
        // Check for compilation errors
        if (result.errors.length > 0) {
            for (JSError error : result.errors) {
                System.err.println("Compilation error: " + error.toString());
            }
            fail("There were compilation errors.");
        }

        // Check the compiled output
        String expectedOutput = "var test={\"a\\u0004b\":\"c\"};";
        String compiledCode = compiler.toSource();
        assertEquals("The compiled output should have preserved the escaped unicode in the property name.", expectedOutput, compiledCode);
    }
}
