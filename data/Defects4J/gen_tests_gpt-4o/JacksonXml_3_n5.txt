
import com.fasterxml.jackson.dataformat.xml.XmlMapper;
import com.fasterxml.jackson.dataformat.xml.deser.FromXmlParser;
import com.fasterxml.jackson.dataformat.xml.deser.XmlTokenStream;
import com.fasterxml.jackson.databind.JsonNode;
import org.junit.Test;
import static org.junit.Assert.*;

import java.io.IOException;

public class FromXmlParserTest {

    @Test
    public void testNextTextValueForAttributes() throws IOException {
        String xml = "<root attr=\"value\">someText</root>";
        XmlMapper xmlMapper = new XmlMapper();
        
        // Parse the XML into JsonNode structure first
        JsonNode rootNode = xmlMapper.readTree(xml);
        
        // Use the underlying FromXmlParser directly
        FromXmlParser parser = (FromXmlParser) xmlMapper.getFactory().createParser(xml);
        
        // Move to the root
        parser.nextToken(); // START_OBJECT
        parser.nextToken(); // VALUE_STRING for "attr"
        
        // Check nextTextValue() for attribute
        String attrValue = parser.nextTextValue();
        assertEquals("value", attrValue);
        
        // Move to the ELEMENT_VALUE
        parser.nextToken(); // VALUE_STRING for "someText"

        // Check nextTextValue() for element value
        String elementValue = parser.nextTextValue();
        assertEquals("someText", elementValue);

        parser.close();
    }
}
