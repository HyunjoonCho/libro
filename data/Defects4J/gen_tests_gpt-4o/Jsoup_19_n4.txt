
import org.jsoup.Jsoup;
import org.jsoup.safety.Safelist;
import org.junit.Test;

import static org.junit.Assert.assertTrue;

public class HtmlCidSanitizationTest {

    @Test
    public void testCidSanitizationPreservesCidReference() {
        // HTML with a content ID (cid) reference in an image src attribute
        String htmlInput = "<img src=\"cid:unique-image-id\">";

        // Sanitize the HTML using a basic whitelist that allows images
        String sanitizedHtml = Jsoup.clean(htmlInput, Safelist.basicWithImages());

        // Check if the sanitized HTML still contains the cid reference
        assertTrue("Cid reference should be preserved", sanitizedHtml.contains("cid:unique-image-id"));
    }
}
