
import com.google.javascript.jscomp.*;

public class LendsAnnotationTest {

    public static void main(String[] args) {
        testLendsAnnotationError();
    }

    public static void testLendsAnnotationError() {
        String jsCode = 
                "/**\n" +
                " * @lends Person.prototype\n" +
                " */\n" +
                "var personMethods = {\n" +
                "  greet: function() {\n" +
                "    console.log('Hello!');\n" +
                "  }\n" +
                "};\n" +
                "\n" +
                "/**\n" +
                " * Person constructor\n" +
                " * @constructor\n" +
                " */\n" +
                "function Person() {}\n" +
                "\n" +
                "Person.prototype = personMethods;\n";

        CompilerOptions options = new CompilerOptions();
        CompilationLevel.ADVANCED_OPTIMIZATIONS.setOptionsForCompilationLevel(options);
        options.setChecksOnly(true);
        options.setWarningLevel(DiagnosticGroups.CHECK_TYPES, CheckLevel.ERROR);

        Compiler compiler = new Compiler();
        Result result = compiler.compile(SourceFile.fromCode("externs.js", ""), 
                                         SourceFile.fromCode("test.js", jsCode), 
                                         options);

        if (result.success) {
            System.out.println("Test passed: Compilation succeeded.");
        } else {
            System.out.println("Test failed: Compilation error.");
            for (JSError error : result.errors) {
                System.out.println(error.toString());
            }
        }
    }
}
