
import com.fasterxml.jackson.databind.ObjectMapper;
import org.junit.Test;

public class JacksonVulnerabilityTest {

    @Test(expected = IllegalArgumentException.class)
    public void testDeserializationBlock() throws Exception {
        ObjectMapper objectMapper = new ObjectMapper();
        
        // Example payload; actual payload may vary
        String maliciousPayload = "[\"com.mchange.v2.c3p0.WrapperConnectionPoolDataSource\",{\"userOverridesAsString\":\"a=b\"}]";

        // Deserialization attempt should fail with an IllegalArgumentException
        objectMapper.enableDefaultTyping();
        objectMapper.readValue(maliciousPayload, Object.class);
    }
}
