public void testCheckVarsUndefinedVarsWarning() throws Exception {
    String jsCode = "foo = {};\nfoo.bar = function() { alert(this.baz); };";
    String[] commandWithoutVerbose = new String[] {
        "java", 
        "-jar", 
        "compiler.jar", 
        "--js", 
        "test.js", 
        "--jscomp_warning", 
        "checkVars"
    };
    String[] commandWithVerbose = new String[] {
        "java", 
        "-jar", 
        "compiler.jar", 
        "--js", 
        "test.js", 
        "--warning_level", 
        "VERBOSE"
    };
    
    Process processWithoutVerbose = new ProcessBuilder(commandWithoutVerbose).start();
    processWithoutVerbose.getOutputStream().write(jsCode.getBytes());
    processWithoutVerbose.getOutputStream().flush();
    processWithoutVerbose.getOutputStream().close();
    int resultWithoutVerbose = processWithoutVerbose.waitFor();
    
    Process processWithVerbose = new ProcessBuilder(commandWithVerbose).start();
    processWithVerbose.getOutputStream().write(jsCode.getBytes());
    processWithVerbose.getOutputStream().flush();
    processWithVerbose.getOutputStream().close();
    int resultWithVerbose = processWithVerbose.waitFor();

    assertEquals(0, resultWithoutVerbose);
    assertNotEquals(resultWithoutVerbose, resultWithVerbose);
}