
import org.jsoup.nodes.Document;
import org.jsoup.parser.Parser;
import org.jsoup.helper.DataUtil;
import org.junit.Test;

import java.io.ByteArrayInputStream;

import static org.junit.Assert.assertEquals;

public class DataUtilTest {

    @Test
    public void testUTF16WithBOMParsing() throws Exception {
        // UTF-16 encoded string with BOM
        byte[] utf16Bytes = new byte[] {
            (byte) 0xFE, (byte) 0xFF, // UTF-16BE BOM
            0x00, 0x3C, 0x00, 0x68, 0x00, 0x74, 0x00, 0x6D, 0x00, 0x6C, 0x00, 0x3E, // <html>
            0x00, 0x3C, 0x00, 0x2F, 0x00, 0x68, 0x00, 0x74, 0x00, 0x6D, 0x00, 0x6C, 0x00, 0x3E  // </html>
        };

        ByteArrayInputStream inputStream = new ByteArrayInputStream(utf16Bytes);

        // Parse data assuming it to be a UTF-16BE encoded HTML input
        Document doc = DataUtil.load(inputStream, "UTF-16BE", "http://example.com", Parser.htmlParser());
        
        // Verify the parsed document is correct
        assertEquals("<html></html>", doc.outerHtml());
    }
}
