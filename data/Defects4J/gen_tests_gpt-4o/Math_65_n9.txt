public void testChiSquareAndRMSConsistency() {
    AbstractLeastSquaresModel model = new AbstractLeastSquaresModel() {
        @Override
        public double[] getResiduals() {
            return new double[] {0.5, 1.5};
        }

        @Override
        public double[] getResidualsWeights() {
            return new double[] {2.0, 3.0};
        }
    };

    double expectedChiSquare = 2.0 * 0.5 * 0.5 + 3.0 * 1.5 * 1.5;
    assertEquals(expectedChiSquare, model.getChiSquare(), 1e-9);

    double expectedRMS = Math.sqrt(expectedChiSquare / 2.0);
    assertEquals(expectedRMS, model.getRMS(), 1e-9);
}