
import org.junit.Test;
import org.apache.commons.compress.archivers.cpio.CpioArchiveInputStream;

import java.io.FileInputStream;
import java.io.IOException;
import java.io.InputStream;

public class CpioArchiveTest {

    @Test(expected = IllegalArgumentException.class)
    public void testCpioTrailerFileMode() throws IOException {
        // Assume we have a CPIO file that exhibits the issue
        // Replace "path/to/test-archive.cpio" with the actual path to the problematic CPIO file
        try (InputStream is = new FileInputStream("path/to/test-archive.cpio");
             CpioArchiveInputStream cpioIn = new CpioArchiveInputStream(is)) {

            while (cpioIn.getNextEntry() != null) {
                // read through the entries
            }
        }
    }
}
