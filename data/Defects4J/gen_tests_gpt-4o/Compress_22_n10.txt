public void testBZip2CompressorInputStreamTruncatedFile() throws IOException {
    byte[] truncatedData = new byte[]{ // some truncated BZip2 data as bytes
        (byte) 0x42, (byte) 0x5a, (byte) 0x68, (byte) 0x39, (byte) 0x31, (byte) 0x41, 
        (byte) 0x59, (byte) 0x26, (byte) 0x53, (byte) 0x59, // truncated block
        // Insert further byte data till the truncated point
    };

    ByteArrayInputStream bais = new ByteArrayInputStream(truncatedData);
    BZip2CompressorInputStream bzip2 = new BZip2CompressorInputStream(bais);

    byte[] buffer = new byte[770];
    int bytesRead = 0;
    int totalRead = 0;
    while ((bytesRead = bzip2.read(buffer, totalRead, buffer.length - totalRead)) != -1) {
        totalRead += bytesRead;
    }

    assertEquals("Expected to read 770 bytes from the truncated file", 770, totalRead);
}