public void testErroneousOptimization() throws IOException {
    String inputJs = "window['anchor'] = function (obj, modifiesProp) {"
                     + " return (function (saved) {"
                     + "     return modifiesProp(obj) + saved;"
                     + " })(obj['prop']);"
                     + "};";
    
    // ... Initialize the compiler and compile the code with ADVANCED_OPTIMIZATIONS

    Compiler compiler = new Compiler();
    CompilerOptions options = new CompilerOptions();
    CompilationLevel.ADVANCED_OPTIMIZATIONS.setOptionsForCompilationLevel(options);
    compiler.compile(ExternsSupplier.DEFAULT_EXTERN, SourceFile.fromCode("input.js", inputJs), options);
    
    String generatedJs = compiler.toSource();
    assertTrue(generatedJs.contains("var HOLD=a.prop;"));
    assertTrue(generatedJs.contains("return b(a)+HOLD;"));
}