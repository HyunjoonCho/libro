
import org.jsoup.Connection;
import org.jsoup.Jsoup;
import org.jsoup.nodes.Document;
import org.jsoup.parser.Parser;
import org.junit.Test;
import org.mockito.Mockito;

import java.io.IOException;
import java.io.InputStream;

import static org.mockito.Mockito.*;

public class JsoupZeroBytesTest {

    @Test(expected = IOException.class)
    public void testZeroBytesInputStream() throws IOException {
        // Mock the connection and response behavior
        Connection connection = mock(Connection.class);
        Connection.Response response = mock(Connection.Response.class);

        // Simulate the input stream returning zero bytes by returning a stream that does not provide data
        InputStream zeroByteInputStream = new InputStream() {
            @Override
            public int read() {
                return -1; // Indicates end of stream immediately
            }
        };

        when(connection.execute()).thenReturn(response);
        when(response.bodyStream()).thenReturn(zeroByteInputStream);

        // Attempt to parse the zero-byte response stream
        Jsoup.parse(zeroByteInputStream, "UTF-8", "", Parser.htmlParser());
    }
}
