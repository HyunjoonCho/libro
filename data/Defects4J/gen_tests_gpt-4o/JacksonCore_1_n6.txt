
import com.fasterxml.jackson.core.JsonFactory;
import com.fasterxml.jackson.core.JsonParser;
import com.fasterxml.jackson.databind.ObjectMapper;
import org.junit.Test;

import java.io.IOException;
import java.math.BigDecimal;

import static org.junit.Assert.assertThrows;

public class JsonParserTest {

    @Test
    public void testNaNAsBigDecimalThrowsNumberFormatException() throws IOException {
        String json = "[NaN]";
        
        JsonFactory factory = new JsonFactory();
        factory.configure(JsonParser.Feature.ALLOW_NON_NUMERIC_NUMBERS, true);
        ObjectMapper mapper = new ObjectMapper(factory);

        JsonParser parser = mapper.createParser(json);
        parser.nextToken(); // start array
        parser.nextToken(); // read NaN

        assertThrows(NumberFormatException.class, () -> {
            parser.getDecimalValue();
        });
    }
}
