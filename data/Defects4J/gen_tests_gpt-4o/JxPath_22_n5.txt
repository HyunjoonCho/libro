public void testNamespaceLoopIssue() {
    String xml = "<foo xmlns:b='bla' xmlns='test111'>" +
                 "<b:bar>a</b:bar>" +
                 "<test xmlns=''></test>" +
                 "</foo>";
    
    try {
        DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
        factory.setNamespaceAware(true);
        DocumentBuilder builder = factory.newDocumentBuilder();
        Document document = builder.parse(new InputSource(new StringReader(xml)));
        
        JXPathContext context = JXPathContext.newContext(document);
        NodePointer nodePointer = (NodePointer) context.getPointer("//test");
        
        String asPath = null;
        try {
            asPath = nodePointer.asPath();
        } catch (StackOverflowError e) {
            fail("StackOverflowError due to endless loop in asPath()");
        }
        
        assertNotNull("Verification of node asPath failed, expected a valid XPath but obtained null due to namespace issue", asPath);
        assertFalse("The node asPath should not be improperly formed or contain 'null:test'", asPath.contains("null:test"));
        
    } catch (Exception e) {
        fail("Exception thrown during test execution: " + e.getMessage());
    }
}