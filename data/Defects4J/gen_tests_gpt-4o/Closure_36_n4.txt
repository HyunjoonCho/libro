
import com.google.javascript.jscomp.CommandLineRunner;
import org.junit.Test;
import static org.junit.Assert.*;

public class ClosureCompilerTest {

    @Test
    public void testSingletonGetterRemovalWithAdvancedOptimizations() {
        String originalCode = 
            "goog.provide('foo');\n" +
            "var foo = function() { this.values = []; };\n" +
            "goog.addSingletonGetter(foo);\n" +
            "foo.prototype.add = function(value) {this.values.push(value)};";

        String[] compilerArgs = {
            "--compilation_level", "ADVANCED_OPTIMIZATIONS",
            "--use_closure_library", "true",
        };

        CommandLineRunner runner = new CommandLineRunner(compilerArgs);
        int exitCode = runner.run();
        
        assertEquals("Output should indicate the code is removed for unused class", 0, exitCode);

        String expectedCode = ""; // Expect the code to be completely removed
        String compiledCode = runner.getOutput();
        
        assertEquals("Expected optimized code to be removed entirely", expectedCode, compiledCode.trim());
    }
}
