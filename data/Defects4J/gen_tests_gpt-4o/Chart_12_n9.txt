
import static org.junit.Assert.assertNotNull;
import static org.junit.Assert.assertTrue;

import org.jfree.chart.plot.MultiplePiePlot;
import org.jfree.data.category.CategoryDataset;
import org.jfree.data.category.DefaultCategoryDataset;
import org.jfree.data.general.DatasetChangeListener;
import org.junit.Test;

public class MultiplePiePlotTest {
    
    @Test
    public void testMultiplePiePlotDatasetListenerWiring() {
        // Create a sample dataset
        DefaultCategoryDataset dataset = new DefaultCategoryDataset();
        dataset.addValue(1.0, "Row1", "Column1");
        dataset.addValue(2.0, "Row2", "Column1");

        // Create MultiplePiePlot with dataset using constructor
        MultiplePiePlot plot = new MultiplePiePlot(dataset);

        // Check that the dataset is wired to a change listener
        DatasetChangeListener[] listeners = dataset.getDatasetChangeListeners();
        assertNotNull("Listeners should not be null", listeners);
        assertTrue("There should be at least one listener", listeners.length > 0);
        
        // Alternative check: set a flag using listener and update dataset
        final boolean[] changeDetected = { false };
        DatasetChangeListener testListener = event -> changeDetected[0] = true;
        dataset.addChangeListener(testListener);

        // Trigger a change
        dataset.addValue(3.0, "Row1", "Column2");

        // Check if the change event was captured
        assertTrue("Dataset change should be detected", changeDetected[0]);
    }
}
