public void testTokenBufferDeserialization() throws IOException {
    String jsonString = "{ \"a\":1, \"b\":null }";
    ObjectMapper mapper = new ObjectMapper();
    JsonNode rootNode = mapper.readTree(jsonString);
    
    TokenBuffer buffer = new TokenBuffer(mapper, false);
    buffer.writeTree(rootNode);

    Value value = mapper.readValue(buffer.asParser(), Value.class);
    
    TokenBuffer expectedBuffer = new TokenBuffer(mapper, false);
    expectedBuffer.writeStartObject();
    expectedBuffer.writeFieldName("a");
    expectedBuffer.writeNumber(1);
    expectedBuffer.writeFieldName("b");
    expectedBuffer.writeNull();
    expectedBuffer.writeEndObject();
    
    JsonParser expectedParser = expectedBuffer.asParser();
    JsonParser actualParser = mapper.getFactory().createParser(buffer.asParser());

    while (expectedParser.nextToken() != null) {
        assertEquals(expectedParser.currentToken(), actualParser.nextToken());
    }
}