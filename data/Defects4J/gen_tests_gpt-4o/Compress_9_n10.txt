public void testTarArchiveOutputStreamGetBytesWritten() throws Exception {
    File tempDir = Files.createTempDirectory("testTar").toFile();
    File tarFile = new File(tempDir, "tartest.tar");
    File sourceFile = new File(tempDir, "testfile.txt");
    
    // Create a dummy file with some content
    try (FileOutputStream fos = new FileOutputStream(sourceFile)) {
        byte[] data = new byte[1024];  // 1 KB data
        fos.write(data);
    }
    
    try (FileOutputStream fileOutputStream = new FileOutputStream(tarFile);
         ArchiveOutputStream tarOut = new ArchiveStreamFactory().createArchiveOutputStream(ArchiveStreamFactory.TAR, fileOutputStream);
         FileInputStream fileInputStream = new FileInputStream(sourceFile)) {
        
        TarArchiveEntry tarEntry = new TarArchiveEntry(sourceFile);
        tarOut.putArchiveEntry(tarEntry);
        
        byte[] buffer = new byte[8192];
        int bytesRead;
        while ((bytesRead = fileInputStream.read(buffer)) > 0) {
            tarOut.write(buffer, 0, bytesRead);
        }
        
        // Check bytes written before closing the entry
        assertNotEquals("Bytes written should not be zero after writing data", 0, ((TarArchiveOutputStream) tarOut).getBytesWritten());
        
        tarOut.closeArchiveEntry();
    }
    
    // Clean up
    sourceFile.delete();
    tarFile.delete();
    tempDir.delete();
}