
import com.google.javascript.jscomp.Compiler;
import com.google.javascript.jscomp.CompilerOptions;
import com.google.javascript.jscomp.JSError;
import com.google.javascript.jscomp.Result;
import com.google.javascript.jscomp.WarningLevel;
import com.google.javascript.jscomp.testing.BlackHoleErrorManager;

public class GoogScopeTest {

    public static void main(String[] args) {
        String code = "" +
        "var goog = {};\n" +
        "goog.scope;\n" +
        "\n" +
        "var ns = {};\n" +
        "ns.sub = {};\n" +
        "/** @constructor */\n" +
        "ns.sub.C = function() {};\n" +
        "\n" +
        "goog.scope(function() {\n" +
        " var sub = ns.sub;\n" +
        " /** @type {sub.C} */\n" +
        " var x = null;\n" +
        "});\n";

        Compiler compiler = new Compiler(new BlackHoleErrorManager());
        CompilerOptions options = new CompilerOptions();
        WarningLevel.VERBOSE.setOptionsForWarningLevel(options);

        // Run the compiler
        Result result = compiler.compile(
            Compiler.toSource(compiler.getDefaultExterns()), 
            Compiler.toSource(code), 
            options
        );

        // Check for errors
        if (!result.success) {
            for (JSError error : compiler.getErrors()) {
                System.out.println(error.toString());
            }
        } else {
            System.out.println("Test passed without errors.");
        }
    }
}
