public void testAnonymousObjectTypeInferenceInconsistency() {
    // Mock the window.console as it is typically not available outside browsers
    class MockConsole {
        String lastLog;

        void log(String message) {
            lastLog = message;
        }

        String getLastLog() {
            return lastLog;
        }
    }

    MockConsole console = new MockConsole();

    Object func(Object record) {
        if (record instanceof Map) {
            Map<?, ?> recordMap = (Map<?, ?>) record;
            console.log((String) recordMap.get("prop"));
        }
        return null;
    }

    Object func2(Object record) {
        if (record instanceof String) {
            console.log((String) record);
        } else {
            Map<?, ?> recordMap = (Map<?, ?>) record;
            console.log((String) recordMap.get("prop"));
        }
        return null;
    }

    Map<String, String> record = new HashMap<>();
    record.put("prop", "a");
    
    func(record);
    assertEquals("a", console.getLastLog());

    func2(record);
    // Expected to print "a" without an error
    assertEquals("a", console.getLastLog());
}