public void testChiSquareRescale() {
    long[] observed1 = { 500, 623, 72, 70, 31 };
    double[] expected1 = { 485, 541, 82, 61, 37 };
    
    ChiSquareTestImpl testStatistic = new ChiSquareTestImpl();
    
    // Calculate the expected values rescaled to match the sum of observed
    double sumObserved = Arrays.stream(observed1).sum();
    double sumExpected = Arrays.stream(expected1).sum();
    double[] rescaledExpected = Arrays.stream(expected1)
                                      .map(e -> e * sumObserved / sumExpected)
                                      .toArray();
    
    double expectedChiSquare = 9.0233; // Example value from R test
    assertEquals("chi-square test statistic", expectedChiSquare, testStatistic.chiSquare(rescaledExpected, observed1), 1E-4);
}