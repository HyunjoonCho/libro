
import static org.junit.Assert.assertEquals;
import org.apache.commons.math3.stat.inference.ChiSquareTest;
import org.junit.Test;

public class ChiSquareTestCase {
    
    @Test
    public void testChiSquareWithUnequalSums() {
        ChiSquareTest testStatistic = new ChiSquareTest();
        
        long[] observed = { 500, 623, 72, 70, 31 };
        double[] expected = { 485, 541, 82, 61, 37 };

        double chiSquare = testStatistic.chiSquare(expected, observed);
        
        // The correct chi-square should be 9.0233 according to the R test with rescaling,
        // but we expect the current implementation to return an incorrect result (16.4131070362 in the example).
        double expectedChiSquareResult = 9.0233;
        
        assertEquals("Chi-square test statistic with rescaling", expectedChiSquareResult, chiSquare, 1E-4);
    }
}
