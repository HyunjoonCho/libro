
import org.apache.commons.lang.StringEscapeUtils;
import org.junit.Test;
import org.springframework.web.util.JavaScriptUtils;

import static org.junit.Assert.assertEquals;

public class JavaScriptEscapeTest {

    @Test
    public void testJavaScriptEscape() {
        String script = "<script>alert('aaa');</script>";

        // Using Spring's JavaScript escape utility
        String springEscaped = JavaScriptUtils.javaScriptEscape(script);
        System.out.println("Spring JS Escape: " + springEscaped);

        // Expected output for well-escaped script using Spring
        String expected = "<script>alert(\\'aaa\\');<\\/script>";
        assertEquals(expected, springEscaped);

        // Using Apache Commons Lang StringEscapeUtils
        String apacheEscaped = StringEscapeUtils.escapeJavaScript(script);
        System.out.println("Apache Commons Lang JS Escape: " + apacheEscaped);

        // Demonstrating the issue: Apache does not escape '/' as '\/'
        // Adjust expected value according to actual output behavior of the method before fixing
        // For this bug, we'll show it as incorrect for clarity
        String incorrectExpected = "<script>alert(\\'aaa\\');</script>";
        assertEquals(incorrectExpected, apacheEscaped);
    }
}
