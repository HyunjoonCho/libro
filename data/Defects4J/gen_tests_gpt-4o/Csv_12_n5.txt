
import org.apache.commons.csv.CSVFormat;
import org.apache.commons.csv.CSVParser;
import org.apache.commons.csv.CSVRecord;
import org.junit.Test;

import java.io.Reader;
import java.io.StringReader;

import static org.junit.Assert.assertEquals;

public class CSVFormatExcelTest {

    @Test
    public void testIgnoreEmptyHeaderNames() throws Exception {
        String csvData = "A,B,C,,\n" +
                         "a,b,c,d,e\n";
        
        Reader reader = new StringReader(csvData);
        CSVParser parser = CSVFormat.EXCEL.withFirstRecordAsHeader().parse(reader);
        
        for (CSVRecord record : parser) {
            assertEquals("a", record.get("A"));
            assertEquals("b", record.get("B"));
            assertEquals("c", record.get("C"));
            // The columns with empty headers are not accessible by name
            assertEquals("d", record.get(3));
            assertEquals("e", record.get(4));
        }
    }
}
