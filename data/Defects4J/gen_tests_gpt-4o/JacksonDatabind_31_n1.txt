public void testJsonStreamContextDifference() throws IOException {
    ObjectMapper mapper = new ObjectMapper();
    ObjectNode rootNode = mapper.createObjectNode();
    rootNode.put("key", "value");

    StringWriter writer = new StringWriter();
    JsonGenerator gen = mapper.getFactory().createGenerator(writer);
    gen.writeTree(rootNode);
    String generatedJson = writer.toString();

    JsonNode convertedNode = mapper.convertValue(rootNode, JsonNode.class);
    String convertedJson = convertedNode.toString();

    assertEquals(generatedJson, convertedJson);

    writer.close();
    gen.close();
}