public void testJsonIdentityReferenceAtClassLevel() throws Exception {
    ObjectMapper mapper = new ObjectMapper();

    @JsonIdentityInfo(generator = ObjectIdGenerators.IntSequenceGenerator.class, property = "id")
    @JsonIdentityReference(alwaysAsId = true)
    class RefClass {
        public int id;

        public RefClass(int id) {
            this.id = id;
        }
    }

    class ContainerClass {
        public RefClass ref = new RefClass(1);
    }

    ContainerClass container = new ContainerClass();
    String json = mapper.writeValueAsString(container);
    assertTrue(json.contains("\"ref\":1"));
}