
import org.junit.Test;
import static org.junit.Assert.*;

public class CsvParserTest {
    
    @Test(expected = NullPointerException.class)
    public void testCsvParserEmptyHeaderAndNullString() {
        CsvFormat format = CsvFormat.newFormat(',')
            .withNullString("");
        
        Reader reader = new StringReader(",,\nvalue1,,value3\nvalue4,\u0000,value6");
        CsvParser parser = new CsvParser(format);
        
        parser.setHeader();
        
        List<String[]> records = parser.parseAll(reader);
        
        assertFalse(records.isEmpty());
    }
}
