public void testTextBufferGetTextBufferInconsistency() {
    TextBuffer buffer = new TextBuffer(new BufferRecycler());
    buffer.resetWithEmpty();

    char[] firstCall = buffer.getTextBuffer();
    String contents = buffer.contentsAsString();
    char[] secondCall = buffer.getTextBuffer();

    assertNull("First call to getTextBuffer should return null", firstCall);
    assertEquals("Contents as string should be an empty string", "", contents);
    assertArrayEquals("Second call to getTextBuffer should return empty array", new char[0], secondCall);
}