
import org.jsoup.Jsoup;
import org.jsoup.nodes.Document;
import org.jsoup.nodes.Element;
import org.jsoup.Connection;
import org.jsoup.Connection.KeyVal;
import org.junit.Test;

import java.util.List;

import static org.junit.Assert.*;

public class JsoupFormTest {

    @Test
    public void testRemoveNodeFromForm() {
        String html = "<form action='/submit'><input type='text' name='alpha' value='value1'></form>";
        Document doc = Jsoup.parse(html);

        // Ensure the input element is initially present
        assertNotNull(doc.select("input[name=alpha]").first());

        // Removing the node from the document
        doc.select("input[name=alpha]").first().remove();

        // Verify the input element is removed from the document
        assertNull(doc.select("input[name=alpha]").first());

        // Find the form element
        Element formElement = doc.select("form").first();
        assertNotNull(formElement);

        // Cast the form element to FormElement
        FormElement form = (FormElement) formElement;

        // Get form data
        List<Connection.KeyVal> data = form.formData();

        // Check that "alpha" is not present in the form data
        for (KeyVal keyVal : data) {
            assertNotEquals("alpha", keyVal.key());
        }
    }
}
