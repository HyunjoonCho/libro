public void testExternExportWithTypedef() throws Exception {
    String jsCode = "/** \n" +
                    " * @typedef {{a: (string|undefined), b: (number|undefined)}} \n" +
                    " */\n" +
                    "var MyType;\n" +
                    "/** \n" + 
                    " * @param {MyType=} opt_param \n" +
                    " */\n" +
                    "function testFunction(opt_param) {}\n";
    CompilerOptions options = new CompilerOptions();
    CompilationLevel.ADVANCED_OPTIMIZATIONS.setOptionsForCompilationLevel(options);
    WarningLevel.QUIET.setOptionsForWarningLevel(options);
    options.externExports = true;

    Compiler compiler = new Compiler();
    compiler.compile(ImmutableList.of(SourceFile.fromCode("externs.js", "")),
                     ImmutableList.of(SourceFile.fromCode("input.js", jsCode)),
                     options);

    String externExport = compiler.toSource();
    assertFalse("Externs should not contain '...'", externExport.contains("..."));
    assertFalse("Externs should not truncate types", externExport.contains("{{"));
}