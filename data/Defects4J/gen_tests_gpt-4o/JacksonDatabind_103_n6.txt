
import com.fasterxml.jackson.databind.JsonMappingException;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.databind.exc.InvalidFormatException;
import org.junit.Test;

import static org.junit.Assert.assertFalse;

public class JsonMappingExceptionTest {

    @Test
    public void testLocationInformationIncludedTwice() {
        ObjectMapper mapper = new ObjectMapper();
        String jsonString = "{\"value\": \"notANumber\"}";

        try {
            mapper.readValue(jsonString, TestDto.class);
        } catch (InvalidFormatException e) {
            String message = e.getMessage();
            // Check whether the location information is included more than once
            String searchString = " at [Source:";
            int firstOccurrence = message.indexOf(searchString);
            int secondOccurrence = message.indexOf(searchString, firstOccurrence + 1);
            assertFalse("Location info is included twice in the message", secondOccurrence != -1);
        } catch (JsonMappingException e) {
            // Handle other mapping exceptions if necessary
        }
    }

    private static class TestDto {
        public Double value;
    }
}
