public void testReproduceableCrashWithSwitchStatement() {
    String sourceCode = 
        "function a(b) {\n" +
        " switch (b.v) {\n" +
        " case 'SWITCH':\n" +
        " if (b.i >= 0) {\n" +
        " return b.o;\n" +
        " } else {\n" +
        " return undefined;\n" +
        " }\n" +
        " break;\n" +
        " }\n" +
        "}";

    Compiler compiler = new Compiler();
    CompilerOptions options = new CompilerOptions();

    try {
        SourceFile input = SourceFile.fromCode("test.js", sourceCode);
        Result result = compiler.compile(CommandLineRunner.getDefaultExterns(), Arrays.asList(input), options);
        assertFalse("Compilation should not have errors", result.success);
    } catch (RuntimeException e) {
        if (e.getMessage() == null) {
            throw new AssertionError("INTERNAL COMPILER ERROR. Null message exception.");
        }
        throw e; // Rethrow other runtime exceptions.
    }
}