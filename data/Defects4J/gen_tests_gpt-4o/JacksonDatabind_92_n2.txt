
import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.databind.exc.InvalidTypeIdException;
import org.junit.jupiter.api.Test;
import static org.junit.jupiter.api.Assertions.*;

public class JacksonCVE201715095Test {

    static class ExploitPayload {
        public String owner;
        public String action;
    }

    @Test
    public void testPolymorphicDeserializationBlocked() {
        ObjectMapper mapper = new ObjectMapper();

        String dangerousJson = "[\"java.util.Calendar\", {}]";

        // Attempting to deserialize should raise an exception since Calendar should be blocked
        assertThrows(InvalidTypeIdException.class, () -> {
            mapper.readValue(dangerousJson, ExploitPayload.class);
        });
    }
}
