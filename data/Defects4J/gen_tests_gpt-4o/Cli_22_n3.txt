
import org.apache.commons.cli.*;

import org.junit.Test;

import static org.junit.Assert.assertEquals;

public class PosixParserBugTest {
    
    private static final String OPTION_TARGET = "t";
    private static final String OPTION_TARGET_LONG = "target";

    @Test
    public void testPosixParserIncorrectParsing() {
        // Define the options
        Options options = new Options();
        options.addOption(new Option(OPTION_TARGET, OPTION_TARGET_LONG, true, "Generate files for the specified target machine"));

        // Create the POSIX parser
        CommandLineParser parser = new PosixParser();
        CommandLine parsedLine = null;
        
        // Test argument with "-target"
        String[] args = new String[]{"-target", "foobar.com"};
        try {
            parsedLine = parser.parse(options, args);
            // We expect "target" to work as well as "t", but it doesn't
            if (parsedLine.hasOption(OPTION_TARGET)) {
                System.out.println("processing selected target: " + parsedLine.getOptionValue(OPTION_TARGET));
                assertEquals("foobar.com", parsedLine.getOptionValue(OPTION_TARGET)); // This will fail
            }
        } catch (ParseException e) {
            System.out.println("Invalid command: " + e.getMessage());
        }
    }
}
