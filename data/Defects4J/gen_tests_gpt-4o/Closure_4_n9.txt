
import com.google.javascript.jscomp.*;
import com.google.javascript.rhino.testing.BaseJSTypeTestCase;

public class StackOverflowTest extends BaseJSTypeTestCase {

    public void testStackOverflowDueToCycle() {
        String EXTERNS = "";
        
        String SOURCE = ""
            + "/**\n"
            + " * @interface\n"
            + " */\n"
            + "var OtherType = function() {}\n"
            + "\n"
            + "/**\n"
            + " * @implements {MyType}\n"
            + " * @constructor\n"
            + " */\n"
            + "var MyType = function() {}\n"
            + "\n"
            + "/**\n"
            + " * @type {MyType}\n"
            + " */\n"
            + "var x = /** @type {!OtherType} */ (new Object());\n";

        CompilerOptions options = createCompilerOptions();
        options.setChecksOnly(true);
        options.setCheckTypes(true);

        test(new String[] {SOURCE}, options, null);  // Run the compilation with options
    }
}
