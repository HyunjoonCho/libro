public void testTypeAliasBeforeDefinition() {
    try {
        // Simulate compilation of JavaScript with type alias before its definition and expect failure
        new Compiler().compile(
            SourceFile.fromCode("foo.js",
                "goog.provide('foo.Foo');\n" +
                "goog.provide('foo.Foo.Bar');\n" +
                "goog.scope(function() {\n" +
                "  /**\n" +
                "   * @param {Foo.Bar} bar\n" +
                "   * @constructor\n" +
                "   */\n" +
                "  foo.Foo = function(bar) {\n" +
                "    this.bar = bar;\n" +
                "  };\n" +
                "  var Foo = foo.Foo;\n" +
                "  /** @type {Foo.Bar} */\n" +
                "  Foo.prototype.bar = null;\n" +
                "  /** @constructor */\n" +
                "  Foo.Bar = function() {};\n" +
                "});"
            ),
            SourceFile.fromCode("externs.js", ""),
            CompilerOptions()
        );
        fail("Expected compilation to fail due to type alias used before definition");
    } catch (RuntimeException e) {
        assertTrue(e.getMessage().contains("Unknown type Foo.Bar"));
    }
}