
import com.google.javascript.jscomp.CompilationLevel;
import com.google.javascript.jscomp.Compiler;
import com.google.javascript.jscomp.CompilerOptions;
import com.google.javascript.jscomp.JSError;
import com.google.javascript.jscomp.Result;
import com.google.javascript.jscomp.SourceFile;

import org.junit.Test;

import static org.junit.Assert.assertTrue;

public class ClosureCompilerBugTest {

    @Test
    public void testUnexpectedExpressionNodeDelProp() {
        Compiler compiler = new Compiler();
        CompilerOptions options = new CompilerOptions();
        // Enable advanced compilation
        CompilationLevel.ADVANCED_OPTIMIZATIONS.setOptionsForCompilationLevel(options);

        // JavaScript source with the problematic code
        String sourceCode = "function x() { return delete a; }";
        SourceFile input = SourceFile.fromCode("input.js", sourceCode);

        // Compile the source code
        Result result = compiler.compile(SourceFile.fromCode("externs.js", ""), input, options);

        // Assert that an error is present
        assertTrue("Expected compilation error due to delete expression issue", result.errors.length > 0);

        // Print the error message
        for (JSError error : result.errors) {
            System.out.println(error.toString());
        }
    }
}
