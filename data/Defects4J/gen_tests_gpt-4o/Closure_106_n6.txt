public void testCollapsePropertiesException() {
    try {
        Compiler compiler = new Compiler();
        CompilerOptions options = new CompilerOptions();
        CompilationLevel.ADVANCED_OPTIMIZATIONS.setOptionsForCompilationLevel(options);

        SourceFile extern = SourceFile.fromCode("externs.js", "");
        SourceFile input = SourceFile.fromCode("input.js", 
            "goog.provide('example'); " +
            "example.Class = function() {}; " +
            "goog.exportSymbol('example.fn', example.Class.prototype.method);");

        compiler.compile(extern, input, options);
        fail("Expected RuntimeException due to IllegalArgumentException");
    } catch (RuntimeException e) {
        assertTrue(e.getCause() instanceof IllegalArgumentException);
    }
}