
import org.apache.commons.lang3.time.DateUtils;
import org.junit.Test;

import java.util.Calendar;
import java.util.Date;
import java.util.TimeZone;

import static org.junit.Assert.assertEquals;

public class DateUtilsDSTTest {

    @Test
    public void testTruncateHourWithDST() {
        // Set the timezone to one that switches DST on 31st October 2004
        TimeZone originalTimeZone = TimeZone.getDefault();
        TimeZone.setDefault(TimeZone.getTimeZone("America/Denver"));  // MDT/MST switch

        try {
            // Date: 2004-10-31 01:00:00 MDT
            Date oct31_01MDT = new Date(1099206000000L);

            // Truncate by hour
            Date result = DateUtils.truncate(oct31_01MDT, Calendar.HOUR_OF_DAY);

            // Check if the result matches the expected date
            assertEquals("Truncated date should match the original date", oct31_01MDT, result);
        } finally {
            // Restore the original timezone after the test
            TimeZone.setDefault(originalTimeZone);
        }
    }
}
