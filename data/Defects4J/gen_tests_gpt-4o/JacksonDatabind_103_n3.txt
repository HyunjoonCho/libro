public void testJsonMappingExceptionLocationDuplication() {
    ObjectMapper objectMapper = new ObjectMapper();
    String jsonString = "{\"age\": \"notANumber\"}";
    try {
        objectMapper.readValue(jsonString, Person.class);
        fail("Expected JsonMappingException");
    } catch (InvalidFormatException e) {
        String message = e.getMessage();
        int firstOccurrence = message.indexOf(" at [source]");
        int secondOccurrence = message.indexOf(" at [source]", firstOccurrence + 1);
        assertTrue("Location appears more than once", secondOccurrence == -1);
    } catch (JsonMappingException e) {
        fail("Expected InvalidFormatException, got JsonMappingException");
    }
}

static class Person {
    public int age;
}