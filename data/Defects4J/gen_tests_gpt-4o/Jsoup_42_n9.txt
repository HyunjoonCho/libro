
import org.jsoup.Jsoup;
import org.jsoup.nodes.Document;
import org.jsoup.nodes.Element;
import org.jsoup.select.Elements;
import org.jsoup.Connection;
import org.jsoup.Connection.KeyVal;
import org.jsoup.helper.HttpConnection;
import org.jsoup.parser.Parser;
import org.jsoup.parser.Tag;
import org.junit.Test;

import java.util.List;

import static org.junit.Assert.assertEquals;

public class FormDataTest {

    @Test
    public void testFormDataWithCheckedCheckbox() {
        final String html = "<html>\n"
                + "    <head>\n"
                + "        <title>Test</title>\n"
                + "    </head>\n"
                + "    \n"
                + "    <body>\n"
                + "\n"
                + "    <form name=\"myForm\" method=\"POST\">\n"
                + "        <input type=\"checkbox\" name=\"testCheckBox\" checked=\"checked\" /> Something<br/>\n"
                + "\n"
                + "        <input type=\"submit\" value=\"Submit\" />\n"
                + "    </form>\n"
                + "\n"
                + "    </body>\n"
                + "</html>";

        Document document = Jsoup.parse(html);
        Element formElement = document.select("form[name=myForm]").first();
        Elements inputs = formElement.select("input");

        for (Element input : inputs) {
            String name = input.attr("name");
            String type = input.attr("type");
            if ("checkbox".equals(type) && input.hasAttr("checked")) {
                String value = input.hasAttr("value") ? input.attr("value") : "on";
                KeyVal keyVal = HttpConnection.KeyVal.create(name, value);
                assertEquals("testCheckBox", keyVal.key());
                assertEquals("on", keyVal.value());
                System.out.println(keyVal.key() + "=" + keyVal.value());
            }
        }
    }
}
