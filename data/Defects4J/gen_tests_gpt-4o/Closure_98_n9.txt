script
// This test requires a testing environment such as Jest

test('bad variable inlining in closure', (done) => {
    const output = [];
    const originalLog = console.log;

    // Mock console.log to capture the output
    console.log = (msg) => output.push(msg);

    function foo() {
        var arr = [1, 2, 3, 4, 5];
        for (var i = 0, l = arr.length; i < l; i++) {
            var j = arr[i];
            (function() {
                var k = j;
                setTimeout(function() { console.log(k); }, 0);
            })();
        }
    }
    foo();

    setTimeout(() => {
        // Restore original console.log
        console.log = originalLog;

        // Assert that the output matches the expected values [1, 2, 3, 4, 5]
        // If the variable 'k' is incorrectly inlined, the output could be incorrect
        expect(output).toEqual([1, 2, 3, 4, 5]);
        
        // Mark the test as done
        done();
    }, 10);
});
