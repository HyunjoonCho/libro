public void testEndlessLoopInAsPath() {
    DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();
    try {
        DocumentBuilder db = dbf.newDocumentBuilder();
        String xml =
                "<b:foo xmlns:b=\"bla\" xmlns=\"test111\">" +
                "<b:bar>a</b:bar>" +
                "<test xmlns=\"\"></test>" +
                "</b:foo>";
        Document doc = db.parse(new InputSource(new StringReader(xml)));
        JXPathContext context = JXPathContext.newContext(doc);

        try {
            String path = (String) context.compile("/b:foo/test").computeValue(context);
        } catch (StackOverflowError e) {
            fail("StackOverflowError occurred, indicating an endless loop in asPath computation.");
        }

    } catch (Exception e) {
        fail("Exception occurred: " + e.getMessage());
    }
}