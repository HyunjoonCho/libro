
import org.jsoup.Jsoup;
import org.jsoup.nodes.Document;
import org.jsoup.nodes.Element;
import org.jsoup.select.Elements;
import org.junit.Test;

import static org.junit.Assert.assertEquals;

public class JsoupUnclosedTagTest {

    @Test
    public void testUnclosedTagParsing() {
        String html = "<a href='www.google.com'>Link<p>Error link</a>";
        Document document = Jsoup.parse(html);

        // Extract elements to verify structure
        Elements aTags = document.select("a");
        Elements pTags = document.select("p");

        // Check the first <a> link text and attribute
        Element firstLink = aTags.first();
        assertEquals("www.google.com", firstLink.attr("href"));
        assertEquals("Link", firstLink.text());

        // Check the <p> element, it should contain an <a> with href
        Element pElement = pTags.first();
        assertEquals(1, pElement.children().size());
        Element nestedLink = pElement.select("a").first();
        assertEquals("www.google.com", nestedLink.attr("href"));
        assertEquals("Error link", nestedLink.text());
    }
}
