
import static org.junit.jupiter.api.Assertions.*;

import org.junit.jupiter.api.Test;
import com.google.javascript.jscomp.*;

public class PeepholeOptimizationTest {

    @Test
    public void testArrayIndexOptimization() {
        String jsCode = "var Mdt=[]; Mdt[11] = ['22','19','19','16','21','18','16','20','17','17','21','17'];";
        
        Compiler compiler = new Compiler();
        CompilerOptions options = new CompilerOptions();
        CompilationLevel.ADVANCED_OPTIMIZATIONS.setOptionsForCompilationLevel(options);
        
        SourceFile input = SourceFile.fromCode("input.js", jsCode);
        Result result = compiler.compile(SourceFile.fromCode("externs.js", ""), input, options);
        
        assertFalse(result.success, "Expected compilation to fail due to array index out of bounds error.");
    }
}
