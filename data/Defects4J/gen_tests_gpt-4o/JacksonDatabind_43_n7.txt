
import com.fasterxml.jackson.annotation.JsonIdentityInfo;
import com.fasterxml.jackson.annotation.ObjectIdGenerators;
import com.fasterxml.jackson.core.JsonProcessingException;
import com.fasterxml.jackson.databind.ObjectMapper;
import org.junit.jupiter.api.Test;

import static org.junit.jupiter.api.Assertions.assertEquals;
import static org.junit.jupiter.api.Assertions.assertNull;

@JsonIdentityInfo(generator = ObjectIdGenerators.PropertyGenerator.class, property = "id")
class MyObject {
    public Integer id;
    public String name;

    public MyObject() {}

    public MyObject(Integer id, String name) {
        this.id = id;
        this.name = name;
    }
}

public class ObjectIdHandlingTest {

    @Test
    public void testNullObjectIdHandling() throws JsonProcessingException {
        ObjectMapper mapper = new ObjectMapper();

        // JSON with a null ID
        String jsonWithNullId = "{\"id\":null,\"name\":\"TestObject\"}";

        // Attempt to deserialize
        MyObject deserializedObject = mapper.readValue(jsonWithNullId, MyObject.class);

        // Assert that id is null as in JSON, and name is correctly deserialized
        assertNull(deserializedObject.id);
        assertEquals("TestObject", deserializedObject.name);
    }
}
