
import org.jsoup.Jsoup;
import org.jsoup.nodes.Document;
import org.jsoup.safety.Safelist;
import org.junit.Test;

import static org.junit.Assert.assertTrue;

public class JsoupCidSanitizationTest {

    @Test
    public void testCidReferencePreservation() {
        // Simulate HTML content from an email containing a CID image reference.
        String htmlContent = "<img src=\"cid:image001.jpg@01D3C5E4.3F8D4B80\">";

        // Use Jsoup's clean method with a basic safelist.
        String cleanHtml = Jsoup.clean(htmlContent, Safelist.basicWithImages());

        // Check if the cleaned HTML still contains the CID reference
        assertTrue("CID reference should be preserved in sanitized output.",
                   cleanHtml.contains("cid:image001.jpg@01D3C5E4.3F8D4B80"));
    }
}
