
import static org.junit.Assert.assertEquals;

import com.google.javascript.jscomp.CompilationLevel;
import com.google.javascript.jscomp.Compiler;
import com.google.javascript.jscomp.CompilerOptions;
import com.google.javascript.jscomp.Result;
import com.google.javascript.jscomp.SourceFile;
import org.junit.Test;

public class PrototypeTypeInferenceTest {

    @Test
    public void testPrototypePropertyTypeInference() {
        String code = 
            "/** @param {Object} a */\n" +
            "function f(a) {\n" +
            "   a.prototype = '__proto';\n" +
            "}\n" +
            "/** @param {Object} a */\n" +
            "function g(a) {\n" +
            "   a.prototype = function(){};\n" +
            "}";

        Compiler compiler = new Compiler();
        CompilerOptions options = new CompilerOptions();
        CompilationLevel.SIMPLE_OPTIMIZATIONS.setOptionsForCompilationLevel(options);
        
        Result result = compiler.compile(SourceFile.fromCode("externs.js", ""), SourceFile.fromCode("testCode.js", code), options);

        // Assert no warnings or errors
        assertEquals(0, result.warnings.length);
        assertEquals(0, result.errors.length);
    }
}
