
import org.jsoup.Jsoup;
import org.jsoup.nodes.Document;
import org.jsoup.parser.Parser;
import org.junit.Test;

import java.nio.charset.StandardCharsets;

import static org.junit.Assert.assertEquals;

public class Utf16BomTest {

    @Test
    public void testUtf16BomHandling() throws Exception {
        // Create a UTF-16 encoded HTML document with BOM
        byte[] utf16WithBom = {(byte) 0xFE, (byte) 0xFF, // BOM for UTF-16BE
                               0x00, 0x3C, 0x00, 0x68, 0x00, 0x74, 0x00, 0x6D, 0x00, 0x6C, 0x00, 0x3E, // <html> 
                               0x00, 0x3C, 0x00, 0x2F, 0x00, 0x68, 0x00, 0x74, 0x00, 0x6D, 0x00, 0x6C, 0x00, 0x3E}; // </html>

        Document doc = Jsoup.parse(new String(utf16WithBom, StandardCharsets.UTF_16BE), "", Parser.htmlParser());

        // Check the correct parsing by verifying the HTML structure
        assertEquals("<html>\n <head></head>\n <body></body>\n</html>", doc.toString());
    }
}
