
import com.google.javascript.jscomp.*;
import com.google.javascript.rhino.Node;
import org.junit.Test;

import static org.junit.Assert.fail;

public class IncompleteFunctionDefinitionTest {

    @Test
    public void testIncompleteFunctionDefinitionInIdeMode() {
        String jsCode = "f f f ;\nfunction t";

        Compiler compiler = new Compiler();
        CompilerOptions options = new CompilerOptions();
        
        // Enabling IDE mode
        options.setIdeMode(true);

        try {
            // Parse the code
            Node root = compiler.parseInputs(
                InputId.from(new SourceFile("test.js", jsCode)), false);
            
            // Prepare AST
            PrepareAst preparer = new PrepareAst();
            preparer.process(compiler, root);

            fail("Expected a RuntimeException due to incomplete function definition");
        } catch (RuntimeException e) {
            // Check for the internal compiler error
            assertTrue(e.getMessage().contains("INTERNAL COMPILER ERROR"));
        }
    }
}
