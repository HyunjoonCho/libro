public void testJsonStreamContextDifference() throws IOException {
    ObjectMapper mapper = new ObjectMapper();
    Map<String, Object> data = new HashMap<>();
    data.put("key", "value");

    String jsonString = mapper.writeValueAsString(data);
    JsonFactory jsonFactory = mapper.getFactory();

    // Write context
    JsonGenerator generator = jsonFactory.createGenerator(new StringWriter());
    generator.writeStartObject();
    generator.writeStringField("key", "value");
    generator.writeEndObject();
    int writeContextDepth = ((JsonStreamContext) generator.getOutputContext()).getEntryCount();

    // Convert context
    JsonParser parser = jsonFactory.createParser(jsonString);
    parser.nextToken(); // StartObject
    int convertContextDepth = parser.getParsingContext().getCurrentIndex();

    assertEquals("JSON stream contexts differ between write and convert methods", writeContextDepth, convertContextDepth);
}