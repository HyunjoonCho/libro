
import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.databind.exc.InvalidTypeIdException;
import org.junit.Test;

import static org.junit.Assert.fail;

public class JacksonCVEReproductionTest {

    @Test
    public void testBlockedJDKTypeDeserialization() {
        String json = "[\"java.util.logging.FileHandler\", {}]"; // example of a type to be blocked

        ObjectMapper mapper = new ObjectMapper();
        try {
            Object result = mapper.readValue(json, Object.class);
            fail("Deserialization should not succeed for blocked types, deserialized: " + result);
        } catch (InvalidTypeIdException e) {
            // Success: exception should be thrown for a blocked JDK type
            System.out.println("Blocked JDK type deserialization was attempted and correctly failed: " + e.getMessage());
        } catch (Exception e) {
            fail("Unexpected exception type: " + e);
        }
    }
}
