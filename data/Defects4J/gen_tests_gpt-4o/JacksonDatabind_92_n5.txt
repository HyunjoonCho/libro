
import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.databind.exc.InvalidTypeIdException;
import org.junit.Test;

import static org.junit.Assert.assertTrue;
import static org.junit.Assert.fail;

public class BlacklistDeserializationTest {

    @Test
    public void testDeserializationBlockForBlacklistedType() {
        ObjectMapper objectMapper = new ObjectMapper();

        // JSON representing a potentially dangerous type
        // You should replace "com.example.BlacklistedType" with an actual type you blacklisted.
        String json = "{\"@class\":\"com.example.BlacklistedType\"}";

        try {
            // Attempt deserialization
            objectMapper.readValue(json, Object.class);
            fail("Expected an InvalidTypeIdException due to blacklisted type");
        } catch (InvalidTypeIdException e) {
            String message = e.getMessage();
            assertTrue("Exception message should indicate blocked type", message.contains("not allowed"));
        } catch (Exception e) {
            fail("Expected InvalidTypeIdException, but got: " + e);
        }
    }
}
