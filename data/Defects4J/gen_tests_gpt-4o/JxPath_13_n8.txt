
import org.apache.commons.jxpath.JXPathContext;
import org.apache.commons.jxpath.JXPathException;
import org.apache.commons.jxpath.xml.DocumentContainer;
import org.junit.Test;
import org.xml.sax.InputSource;

import java.io.StringReader;

public class NamespaceTest {

    @Test(expected = JXPathException.class)
    public void testUndefinedNamespacePrefixForAttribute() {
        String xmlContent = "<root xmlns:A=\"http://example.com/A\" xmlns:B=\"http://example.com/B\">" +
                            "<ElementA A:myAttr=\"Mytype\">" +
                            "<B:ElementB>MY VALUE</B:ElementB>" +
                            "</ElementA>" +
                            "</root>";

        StringReader xmlReader = new StringReader(xmlContent);
        InputSource inputSource = new InputSource(xmlReader);
        DocumentContainer documentContainer = new DocumentContainer(inputSource);

        JXPathContext context = JXPathContext.newContext(documentContainer);

        // Register namespaces for elements
        context.registerNamespace("A", "http://example.com/A");
        context.registerNamespace("B", "http://example.com/B");

        // Attempting to access an attribute with a namespace should cause an exception
        context.getValue("/root/ElementA/@A:myAttr");
    }

}
