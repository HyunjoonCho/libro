
import org.jsoup.Jsoup;
import org.jsoup.nodes.Document;
import org.jsoup.nodes.Element;
import org.jsoup.parser.Parser;
import org.junit.Test;

import static org.junit.Assert.assertEquals;

public class PreTagWhitespaceTest {

    @Test
    public void testPreTagWithNestedElements() {
        String htmlInput = "<pre><code>\n"
                + "  message <span style=\"color:red\"> other   \n    message  with \n"
                + "   whitespaces      </span>\n"
                + "</code></pre>";

        Document doc = Jsoup.parse(htmlInput, "", Parser.htmlParser());
        Element preElement = doc.select("pre").first();
        String expectedOutput = "<pre><code>\n"
                + "  message <span style=\"color:red\"> other   \n    message  with \n"
                + "   whitespaces      </span>\n"
                + "</code></pre>";

        assertEquals(expectedOutput, preElement.outerHtml());
    }
}
