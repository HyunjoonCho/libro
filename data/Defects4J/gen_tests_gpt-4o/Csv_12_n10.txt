
import org.apache.commons.csv.CSVFormat;
import org.apache.commons.csv.CSVParser;
import org.apache.commons.csv.CSVRecord;
import org.junit.Test;

import java.io.StringReader;
import java.util.Iterator;

import static org.junit.Assert.assertEquals;

public class CSVParserTest {

    @Test
    public void testExcelFormatIgnoresEmptyHeaderNames() throws Exception {
        String csvContent = "A,B,C,,\n" +
                            "a,b,c,d,e\n";

        CSVParser parser = CSVParser.parse(csvContent, CSVFormat.EXCEL.withHeader());

        Iterator<CSVRecord> iterator = parser.iterator();
        if (iterator.hasNext()) {
            CSVRecord record = iterator.next();

            assertEquals("a", record.get("A"));
            assertEquals("b", record.get("B"));
            assertEquals("c", record.get("C"));

            // Attempting to access columns with empty headers should not throw an exception
            // This assumes that accessing an empty header will either return null or an empty string
            // and should be ignorable
            assertEquals("d", record.get(""));
        }
    }
}
