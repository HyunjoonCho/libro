
import org.jsoup.helper.DataUtil;
import org.jsoup.nodes.Document;
import org.junit.Test;

import java.io.ByteArrayInputStream;
import java.io.IOException;
import java.nio.charset.StandardCharsets;

import static org.junit.Assert.assertEquals;

public class DataUtilTest {

    @Test
    public void testParseByteDataHandlesUTF16WithBOMCorrectly() throws IOException {
        // UTF-16 with BOM: BOM bytes for UTF-16BE are 0xFE 0xFF (Big Endian)
        // Sample XML content
        String xmlContent = "<?xml version=\"1.0\" encoding=\"UTF-16\"?><root>Hello World</root>";
        
        // Convert to bytes with UTF-16 encoding (BOM included)
        byte[] xmlBytesWithBom = xmlContent.getBytes(StandardCharsets.UTF_16);

        // Parse the byte array using Jsoup's DataUtil
        Document document = DataUtil.load(new ByteArrayInputStream(xmlBytesWithBom), "UTF-16", "");

        // Verify the content of the parsed document
        assertEquals("Hello World", document.select("root").text());
    }
}
