public void testPrototypeMethodUsageInConstructor() {
    Compiler compiler = new Compiler();
    CompilerOptions options = new CompilerOptions();
    options.setWarningLevel(DiagnosticGroups.CHECK_TYPES, CheckLevel.WARNING);
    compiler.initOptions(options);

    String jsSource = "function WebInspector() {}\n" +
                      "WebInspector.DOMAgent = function() {\n" +
                      "    this._setAttributesPayload({attributes: []});\n" +
                      "};\n" +
                      "WebInspector.DOMAgent.prototype = {\n" +
                      "    _setAttributesPayload: function(attributes) {\n" +
                      "        // do something with attributes\n" +
                      "    }\n" +
                      "};";

    Node externs = compiler.parseExterns("");
    Node root = compiler.parseSyntheticCode(jsSource);

    compiler.compile(externs, root, options);

    JSError[] warnings = compiler.getWarnings();
    boolean foundIssue = false;
    for (JSError warning : warnings) {
        if (warning.description.contains("Property _setAttributesPayload never defined on WebInspector.DOMNode")) {
            foundIssue = true;
            break;
        }
    }

    assertTrue("Expected a warning about using prototype method in constructor", foundIssue);
}