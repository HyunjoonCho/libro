
import java.text.Format;
import java.util.HashMap;
import java.util.Map;
import org.apache.commons.text.ExtendedMessageFormat;

public class ExtendedMessageFormatReproduceTest {

    private static class DummyFormatFactory implements Format {
        private static final String DUMMY_FORMAT = "dummy";

        @Override
        public StringBuffer format(Object obj, StringBuffer toAppendTo, java.text.FieldPosition pos) {
            return toAppendTo.append(obj.toString());
        }

        @Override
        public Object parseObject(String source, java.text.ParsePosition pos) {
            return null;
        }
    }

    private static Map<String, Format> formatRegistry = new HashMap<>();

    static {
        formatRegistry.put(DummyFormatFactory.DUMMY_FORMAT, new DummyFormatFactory());
    }

    public static void main(String[] args) {
        ExtendedMessageFormat mf = new ExtendedMessageFormat("it''s a {dummy} 'test'!", formatRegistry);
        String formattedPattern = mf.format(new Object[]{"great"});
        System.out.println(formattedPattern);
    }
}
