public void testNaNAsBigDecimalThrowsNPE() {
    ObjectMapper mapper = new ObjectMapper();
    mapper.configure(JsonParser.Feature.ALLOW_NON_NUMERIC_NUMBERS, true);
    String json = "NaN";

    try {
        JsonNode node = mapper.readTree(json);
        node.decimalValue();
        fail("Expected NumberFormatException to be thrown");
    } catch (JsonProcessingException e) {
        fail("Did not expect a JsonProcessingException to be thrown");
    } catch (NumberFormatException e) {
        // This is the expected behavior
    } catch (NullPointerException e) {
        fail("Expected NumberFormatException, but got NullPointerException");
    }
}