public void testGetHeaderMapThrowsNPE() {
    CSVFormat format = CSVFormat.DEFAULT.withHeader(); // Indicate there should be a header
    CSVParser parser = new CSVParser(new StringReader("a,b,c\n1,2,3\n"), format);
    parser.getRecords(); // Reads the records to initialize the header map
    parser = new CSVParser(new StringReader("1,2,3\n"), format); // Re-create parser without a real header
    try {
        Map<String, Integer> header = parser.getHeaderMap();
        fail("Expected NullPointerException");
    } catch (NullPointerException e) {
        // Expected exception
    }
}