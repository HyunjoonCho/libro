
import org.apache.commons.csv.CSVFormat;
import org.apache.commons.csv.CSVParser;
import org.apache.commons.csv.CSVRecord;
import org.junit.Test;

import java.io.IOException;
import java.io.StringReader;
import java.util.Map;

import static org.junit.Assert.assertNull;

public class CSVParserTest {

    @Test
    public void testGetHeaderMapThrowsNPE() throws IOException {
        // CSV input without a header
        String csvData = "John,Doe,30\nJane,Smith,25";
        CSVFormat formatWithoutHeader = CSVFormat.DEFAULT;

        // Parse the CSV data without specifying a header
        try (CSVParser parser = new CSVParser(new StringReader(csvData), formatWithoutHeader)) {
            for (CSVRecord record : parser) {
                // Just consume the records to simulate usage
            }
            // Getting the header map should not throw NullPointerException
            Map<String, Integer> headerMap = parser.getHeaderMap();
            assertNull("Expected header map to be null when no header is present", headerMap);
        }
    }
}
