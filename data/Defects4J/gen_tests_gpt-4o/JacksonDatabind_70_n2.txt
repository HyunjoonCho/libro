
import com.fasterxml.jackson.annotation.JsonUnwrapped;
import com.fasterxml.jackson.databind.MapperFeature;
import com.fasterxml.jackson.databind.ObjectMapper;

import java.io.IOException;

import static org.junit.jupiter.api.Assertions.assertEquals;
import org.junit.jupiter.api.Test;

public class CaseInsensitiveJsonUnwrapTest {

    static class Person {
        @JsonUnwrapped(prefix = "businessAddress.")
        public Address businessAddress;
    }

    static class Address {
        public String street;
        public String addon;
        public String zip = "";
        public String town;
        public String country;
    }

    @Test
    public void testCaseInsensitiveJsonUnwrapped() throws IOException {
        String json = "{ \"businessaddress.street\": \"1234 Elm St\", \"businessaddress.addon\": \"apt 56\", \"businessaddress.zip\": \"12345\", \"businessaddress.town\": \"Metropolis\", \"businessaddress.country\": \"Freedonia\" }";

        ObjectMapper mapper = new ObjectMapper();
        mapper.enable(MapperFeature.ACCEPT_CASE_INSENSITIVE_PROPERTIES);

        Person person = mapper.readValue(json, Person.class);

        assertEquals("1234 Elm St", person.businessAddress.street);
        assertEquals("apt 56", person.businessAddress.addon);
        assertEquals("12345", person.businessAddress.zip);
        assertEquals("Metropolis", person.businessAddress.town);
        assertEquals("Freedonia", person.businessAddress.country);
    }
}
