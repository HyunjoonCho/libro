
import javax.script.ScriptEngine;
import javax.script.ScriptEngineManager;
import javax.script.ScriptException;

import org.junit.Test;
import static org.junit.Assert.assertEquals;

public class FinallyBreakTest {

    @Test
    public void testBreakInFinallyBlock() {
        // Create a Nashorn or Rhino JavaScript engine
        ScriptEngine engine = new ScriptEngineManager().getEngineByName("nashorn");

        try {
            // Define the script to run
            String script = 
                  "var result = 'not ok';\n" +
                  "b: try { throw 'throw me'; } finally { /* fake catcher */ break b; }\n" +
                  "result = 'ok then...';\n" +
                  "result;";

            // Execute the script
            Object result = engine.eval(script);

            // Assert the expected output
            assertEquals("ok then...", result);

        } catch (ScriptException e) {
            e.printStackTrace();
        }
    }
}
