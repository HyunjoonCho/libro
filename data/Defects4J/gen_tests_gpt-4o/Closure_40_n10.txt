public void testSmartNameRemovalCompilerCrash() {
    String code = ""
        + "var goog = {};"
        + "goog.inherits = function(x, y) {};"
        + "var ns = {};"
        + "/** @constructor */ ns.PageSelectionModel = function(){};"
        + "/** @constructor */ "
        + "ns.PageSelectionModel.FooEvent = function() {};"
        + "/** @constructor */ "
        + "ns.PageSelectionModel.SelectEvent = function() {};"
        + "goog.inherits(ns.PageSelectionModel.ChangeEvent, ns.PageSelectionModel.FooEvent);";
    
    try {
        // Assume 'compileCode' is a method that compiles the provided code in advanced mode.
        compileCode(code);
        fail("Expected compiler to crash due to improper reference handling.");
    } catch (IllegalStateException e) {
        assertTrue(e.getMessage().contains("something is wrong"));
    }
}