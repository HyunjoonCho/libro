
import org.jsoup.Jsoup;
import org.jsoup.nodes.Document;
import org.jsoup.safety.Whitelist;
import org.junit.Test;

import static org.junit.Assert.assertEquals;

public class HtmlSanitizerTest {

    @Test
    public void testPreserveCIDReferencesInImageSrc() {
        String htmlWithCID = "<img src=\"cid:image001.jpg@01D3C3A6.8A93B610\">";
        
        // Create a whitelist with relaxed settings, but img tag is allowed by default
        Whitelist whitelist = Whitelist.relaxed();

        // Sanitize the HTML
        String sanitizedHtml = Jsoup.clean(htmlWithCID, whitelist);

        // Assert that the sanitized HTML still contains the cid reference
        assertEquals("<img src=\"cid:image001.jpg@01D3C3A6.8A93B610\">", sanitizedHtml);
    }
}
