public void testArrayJoinOptimization() throws IOException {
    String jsCode = "var array = [ 'constant', confirm('value from user') ]; alert(array.join(','));";
    SourceFile input = SourceFile.fromCode("input.js", jsCode);
    CompilerOptions options = new CompilerOptions();
    CompilationLevel.ADVANCED_OPTIMIZATIONS.setOptionsForCompilationLevel(options);
    Compiler compiler = new Compiler();
    Result result = compiler.compile(Collections.emptyList(), Collections.singletonList(input), options);
    String expectedOutput = "var a=[\"constant\",confirm(\"value from user\")];alert(a.join());";
    assertEquals(expectedOutput, compiler.toSource());
}