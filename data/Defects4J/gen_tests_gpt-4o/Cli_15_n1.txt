
import org.junit.Test;
import static org.junit.Assert.*;

import org.apache.commons.cli2.*;
import org.apache.commons.cli2.builder.ArgumentBuilder;
import org.apache.commons.cli2.builder.DefaultOptionBuilder;
import org.apache.commons.cli2.builder.GroupBuilder;

import java.util.List;

public class DefaultArgumentTest {

    @Test
    public void testSingleOptionSingleArgument() throws Exception {  
        String defaultValue1 = "100";  
        String defaultValue2 = "1000";  

        final DefaultOptionBuilder obuilder = new DefaultOptionBuilder();  
        final ArgumentBuilder abuilder = new ArgumentBuilder();  
        final GroupBuilder gbuilder = new GroupBuilder();

        DefaultOption bOption = obuilder.withShortName("b")  
            .withLongName("b")  
            .withArgument(abuilder.withName("b")  
                .withMinimum(0)  
                .withMaximum(2)  
                .withDefault(defaultValue1)  
                .withDefault(defaultValue2)  
                .create())  
            .create();

        Group options = gbuilder  
            .withName("options")  
            .withOption(bOption)  
            .create();

        Parser parser = new Parser();  
        parser.setHelpTrigger("--help");  
        parser.setGroup(options);  

        String enteredValue1 = "1";  
        String[] args = new String[]{"-b", enteredValue1};  

        CommandLine cl = parser.parse(args);  
        CommandLine cmd = cl;  

        assertNotNull("Command line should not be null", cmd);  

        List<String> b = cmd.getValues("-b");  
        // Expecting enteredValue1 and the second default
        assertEquals("Values should be ['1', '1000']", "[" + enteredValue1 + ", " + defaultValue2 + "]", b.toString());  
    }
}
