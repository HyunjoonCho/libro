
import org.jsoup.Jsoup;
import org.jsoup.nodes.Document;
import org.jsoup.nodes.Element;
import org.junit.Test;

import static org.junit.Assert.*;

public class ElementSiblingIndexTest {

    @Test
    public void testElementSiblingIndex() {
        String html = "<table>" +
                      "<tr><td>Cell1</td><td>Cell2</td></tr>" +
                      "<tr><td>Cell3</td><td>Cell4</td></tr>" +
                      "<tr><td>Cell1</td><td>Cell2</td></tr>" + // Duplicate row
                      "</table>";
        
        Document doc = Jsoup.parse(html);
        Element firstRow = doc.select("tr").first();
        Element duplicateRow = doc.select("tr").get(2);

        int firstRowIndex = firstRow.elementSiblingIndex();
        int duplicateRowIndex = duplicateRow.elementSiblingIndex();

        // Check the documented behavior against the observed behavior
        assertNotEquals("The indices of the original and duplicate rows should not be the same", firstRowIndex, duplicateRowIndex);
        
        // Verify .equals() behavior
        assertTrue("The two rows should be equal", firstRow.equals(duplicateRow));

        // Check if parent().children().get(n) returns the same element
        Element retrievedByIndex = duplicateRow.parent().children().get(duplicateRowIndex);
        assertTrue("The element retrieved by index should equal the original element", retrievedByIndex.equals(duplicateRow));
    }
}
