public void testUnmodifiableSetMixinJackson27Plus() throws Exception {
    String expectedJson = "[\"java.util.Collections$UnmodifiableSet\",[]]";
    
    ObjectMapper mapper = new ObjectMapper();
    mapper.enableDefaultTyping(ObjectMapper.DefaultTyping.NON_FINAL, JsonTypeInfo.As.PROPERTY);
    mapper.addMixIn(Collections.unmodifiableSet(Collections.<String>emptySet()).getClass(), UnmodifiableSetMixin.class);
    
    try {
        Set<String> foo = mapper.readValue(expectedJson, Set.class);
        assertTrue(foo.isEmpty());
    } catch (IllegalStateException e) {
        fail("Deserialization failed with exception: " + e.getMessage());
    }
}