public void testLendsIssueWithAdvancedOptimizations() {
    CompilerOptions options = new CompilerOptions();
    CompilationLevel.ADVANCED_OPTIMIZATIONS.setOptionsForCompilationLevel(options);
    options.setWarningLevel(DiagnosticGroups.CHECK_TYPES, CheckLevel.ERROR);
    
    String jsCode = "/** @constructor */\n" +
                    "function Person() {}\n" +
                    "/** @lends {Person.prototype} */\n" +
                    "var personMethods = {\n" +
                    "    /** @return {string} */\n" +
                    "    getName: function() { return 'Name'; }\n" +
                    "};\n" +
                    "goog.object.extend(Person.prototype, personMethods);\n";

    Compiler compiler = new Compiler();
    compiler.compile(SourceFile.fromCode("externs.js", ""), 
                     SourceFile.fromCode("test.js", jsCode), 
                     options);

    assertEquals("Expected no compilation errors", 0, compiler.getErrorCount());
}