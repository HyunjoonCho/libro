public void testBZip2TruncatedFile() throws IOException {
    byte[] truncatedInput = new byte[770];
    InputStream truncatedStream = new BZip2CompressorInputStream(new ByteArrayInputStream(truncatedInput), true);
    int bytesRead = 0;
    byte[] buffer = new byte[1024];
    while (truncatedStream.read(buffer) != -1) {
        bytesRead++;
    }
    truncatedStream.close();
    assertEquals(770, bytesRead);
}