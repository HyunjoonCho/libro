
import static org.junit.Assert.assertEquals;

import org.jsoup.Jsoup;
import org.jsoup.nodes.Document;
import org.junit.Test;

public class JavaScriptParsingTest {

    @Test
    public void testSingleQuoteInJavaScript() {
        String inputHtml =
                "<HTML>\n" +
                "<body>\n" +
                " <div>\n" +
                "  <script language=\"JavaScript1.1\"> \n" +
                "    document.write('</scr' + 'ipt>');\n" +
                "  </script>\n" +
                " </div>\n" +
                "</body>\n" +
                "</HTML>";

        Document document = Jsoup.parse(inputHtml);

        // Simulate the processing which causes the bug
        String outputHtml = document.html();

        String expectedHtml =
                "<html>\n" +
                " <head></head>\n" +
                " <body>\n" +
                "  <div>\n" +
                "   <script language=\"JavaScript1.1\"> \n" +
                "    document.write('</scr' + 'ipt>');\n" +
                "   </script>\n" +
                "  </div>\n" +
                " </body>\n" +
                "</html>";

        assertEquals(expectedHtml, outputHtml);
    }
}
