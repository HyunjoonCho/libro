public void testJsonIdentityReferenceOnClass() throws Exception {
    ObjectMapper mapper = new ObjectMapper();
    
    @JsonIdentityInfo(generator=ObjectIdGenerators.IntSequenceGenerator.class, property="id")
    @JsonIdentityReference(alwaysAsId=true)
    class AlwaysAsId {
        public int id = 1;
    }

    @JsonIdentityInfo(generator=ObjectIdGenerators.IntSequenceGenerator.class, property="id")
    @JsonIdentityReference(alwaysAsId=true)
    class ReallyAlwaysAsId {
        public int id = 2;
        public int value;

        public ReallyAlwaysAsId() { this(0); }
        public ReallyAlwaysAsId(int v) { value = v; }
    }

    class Container {
        public AlwaysAsId a = new AlwaysAsId();
        public ReallyAlwaysAsId b = new ReallyAlwaysAsId(13);
    }
    
    String json = mapper.writeValueAsString(new Container());
    assertEquals("{\"a\":1,\"b\":2}", json);
}