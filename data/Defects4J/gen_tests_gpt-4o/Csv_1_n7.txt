public void testExtendedBufferReaderHandlesEOLConsistently() throws IOException {
    String input = "line1\rline2\nline3\r\nline4\ranother line without eol";
    ExtendedBufferReader reader = new ExtendedBufferReader(new StringReader(input));

    int lineCount = 0;
    String line;
    while ((line = reader.readLine()) != null) {
        lineCount++;
    }
    
    assertEquals(5, lineCount);
}