
import org.junit.Test;

import javax.script.ScriptEngine;
import javax.script.ScriptEngineManager;
import javax.script.ScriptException;

import static org.junit.Assert.assertEquals;

public class JavascriptEngineTest {

    @Test
    public void testBreakInFinallyBlock() throws ScriptException {
        // Create a new instance of the JavaScript engine
        ScriptEngineManager manager = new ScriptEngineManager();
        ScriptEngine engine = manager.getEngineByName("nashorn"); // Using Nashorn for JavaScript evaluation

        // JavaScript code to evaluate
        String script = "var result = ''; " +
                        "b: try { throw 'throw me'; } finally { /* fake catcher */ break b; };" +
                        "result = 'ok then...'; " +
                        "result;";

        // Evaluate the script
        Object evaluatedResult = engine.eval(script);

        // Assert the expected result
        assertEquals("ok then...", evaluatedResult);
    }
}
