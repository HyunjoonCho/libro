public void testChiSquareIncorrectStatistic() {
    long[] observed = { 500, 623, 72, 70, 31 };
    double[] expected = { 485, 541, 82, 61, 37 };
    ChiSquareTest testStatistic = new ChiSquareTest();

    // Calculating expected chi-square value with rescaling
    double[] rescaledExpected = { 521.19403, 581.37313, 88.11940, 65.55224, 39.76119 };
    double expectedChiSquare = 9.0233;

    // Using the provided method which does not rescale
    double result = testStatistic.chiSquare(expected, observed);
    double pValue = testStatistic.chiSquareTest(expected, observed);

    assertNotEquals("chi-square test statistic without rescaling", expectedChiSquare, result, 1E-3);
    assertNotEquals("chi-square p-value without rescaling", 0.06052, pValue, 1E-5);

    // Assuming the bug fix will implement the rescaling, the result should match the R output
    // Note: If the method is fixed to handle rescaling, this will pass
    // assertEquals("chi-square test statistic", expectedChiSquare, result, 1E-3);
    assertEquals("chi-square p-value after rescaling", 0.06052, testStatistic.chiSquareTest(rescaledExpected, observed), 1E-5);
}