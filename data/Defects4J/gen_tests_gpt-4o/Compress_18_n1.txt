
import org.apache.commons.compress.archivers.tar.TarArchiveEntry;
import org.apache.commons.compress.archivers.tar.TarArchiveOutputStream;
import org.junit.Test;
import java.io.ByteArrayOutputStream;
import java.io.IOException;

public class TarArchiveLongDirectoryTest {

    @Test(expected = IOException.class)
    public void testLongDirectoryNameInTarArchive() throws IOException {
        // Creating a directory name longer than 100 bytes
        String longDirectoryName = "a".repeat(101) + "/";

        // Setting up an in-memory byte array output stream
        ByteArrayOutputStream baos = new ByteArrayOutputStream();
        TarArchiveOutputStream tarOs = new TarArchiveOutputStream(baos);

        try {
            // Create a new TarArchiveEntry for the directory
            TarArchiveEntry tarEntry = new TarArchiveEntry(longDirectoryName);
            tarEntry.setSize(0);
            
            // Attempt to add entry to the TAR archive
            tarOs.putArchiveEntry(tarEntry);
            tarOs.closeArchiveEntry();
        } finally {
            tarOs.close();
        }
    }
}
