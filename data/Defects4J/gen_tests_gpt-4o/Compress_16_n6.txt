
import org.apache.commons.compress.archivers.ArchiveException;
import org.apache.commons.compress.archivers.ArchiveInputStream;
import org.apache.commons.compress.archivers.ArchiveStreamFactory;
import org.junit.Test;

import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;

import static org.junit.Assert.assertNotEquals;

public class ArchiveStreamFactoryTest {
    
    @Test
    public void testNonTarFileDetection() throws IOException, ArchiveException {
        // Path to the non-tar AIFF test file
        File aiffFile = new File("path/to/testAIFF.aif");
        
        try (FileInputStream fis = new FileInputStream(aiffFile)) {
            ArchiveStreamFactory factory = new ArchiveStreamFactory();
            
            try {
                ArchiveInputStream archiveInputStream = factory.createArchiveInputStream(fis);
                
                // If successful, this indicates that it falsely detected the AIFF file as a supported archive type
                String formatName = archiveInputStream.getArchiveName();
                assertNotEquals("tar", formatName);
            } catch (ArchiveException e) {
                // Expected behavior, as an AIFF file should not be recognized as an archive
            }
        }
    }
}
