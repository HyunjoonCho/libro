
import org.jsoup.nodes.Attribute;
import org.jsoup.nodes.Attributes;
import org.jsoup.nodes.Element;
import org.jsoup.parser.Tag;
import org.junit.Test;

import java.util.Iterator;
import java.util.Map;

import static org.junit.Assert.assertFalse;

public class RemoveIgnoreCaseTest {

    @Test
    public void testRemoveIgnoreCase() {
        // Create an element with attributes
        Element element = new Element(Tag.valueOf("div"), "");
        element.attr("attr1", "value1");
        element.attr("attr2", "value2");

        // Create an iterator for the attributes
        Attributes attributes = element.attributes();
        for (Iterator<Map.Entry<String, Attribute>> iter = attributes.asList().iterator(); iter.hasNext(); ) {
            Map.Entry<String, Attribute> entry = iter.next();
            if (entry.getKey().equalsIgnoreCase("attr1")) {
                iter.remove();
            }
        }

        // Check if the attribute "attr1" has been removed without causing ConcurrentModificationException
        assertFalse(element.hasAttr("attr1"));
        assertFalse(element.hasAttr("attr2")); // Also testing if other attributes are removed through some method called after
    }
}
