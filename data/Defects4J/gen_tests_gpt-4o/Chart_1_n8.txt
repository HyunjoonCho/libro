public void testGetLegendItemsWithNullDataset() {
    AbstractCategoryItemRenderer renderer = new CustomCategoryItemRenderer();
    CategoryPlot plot = new CategoryPlot();
    plot.setDataset(null);
    
    renderer.setPlot(plot);
    
    LegendItemCollection legendItems = renderer.getLegendItems();
    
    assertNotNull("The method should not return null even if the dataset is null", legendItems);
    assertEquals("Should return an empty LegendItemCollection when dataset is null", 0, legendItems.getItemCount());
}

private class CustomCategoryItemRenderer extends AbstractCategoryItemRenderer {
    @Override
    public LegendItem getLegendItem(int datasetIndex, int series) {
        return null;
    }
}