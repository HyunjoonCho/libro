public void testBrentOptimizerBestPoint() {
    UnivariateFunction parabola = new UnivariateFunction() {
        public double value(double x) {
            return -(x - 1) * (x - 1) + 1;
        }
    };
    BrentOptimizer optimizer = new BrentOptimizer(1e-10, 1e-14);
    UnivariatePointValuePair result = optimizer.optimize(
        new MaxEval(100),
        new UnivariateObjectiveFunction(parabola),
        GoalType.MAXIMIZE,
        new SearchInterval(0, 2)
    );
    double bestX = result.getPoint();
    double bestValue = result.getValue();

    UnivariatePointValuePair secondLastPoint = optimizer.getLastEvaluatedPoint();
    
    // Check if the reported best point is indeed the best by comparing it to the second last evaluated point
    assertTrue("Optimizer did not return the best point", bestValue >= secondLastPoint.getValue());
}