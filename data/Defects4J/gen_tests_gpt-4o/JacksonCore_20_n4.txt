
import com.fasterxml.jackson.core.JsonFactory;
import com.fasterxml.jackson.core.JsonGenerator;
import com.fasterxml.jackson.core.JsonParseException;
import com.fasterxml.jackson.databind.ObjectMapper;
import org.junit.Test;

import java.io.ByteArrayOutputStream;
import java.io.IOException;

import static org.junit.Assert.assertArrayEquals;
import static org.junit.Assert.assertEquals;

public class JsonGeneratorTest {

    @Test
    public void testWriteEmbeddedObjectWithByteArray() throws IOException {
        JsonFactory factory = new JsonFactory();
        ByteArrayOutputStream outputStream = new ByteArrayOutputStream();
        JsonGenerator generator = factory.createGenerator(outputStream);
        
        byte[] testData = "Hello, World!".getBytes();
        
        generator.writeStartArray();
        generator.writeEmbeddedObject(testData);
        generator.writeEndArray();
        generator.close();
        
        ObjectMapper mapper = new ObjectMapper();
        byte[][] result = mapper.readValue(outputStream.toByteArray(), byte[][].class);

        assertEquals(1, result.length);
        assertArrayEquals(testData, result[0]);
    }
}
