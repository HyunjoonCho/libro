
import org.apache.commons.compress.archivers.ArchiveException;
import org.apache.commons.compress.archivers.ArchiveInputStream;
import org.apache.commons.compress.archivers.ArchiveStreamFactory;
import org.junit.Test;

import java.io.ByteArrayInputStream;
import java.io.IOException;

import static org.junit.Assert.*;

public class ArchiveStreamTest {

    @Test
    public void testShortTextFileDetection() {
        String shortText = "This is a short text file, not a tar archive.";

        try (ByteArrayInputStream bais = new ByteArrayInputStream(shortText.getBytes())) {
            ArchiveInputStream ais = new ArchiveStreamFactory().createArchiveInputStream(bais);
            assertNull("Expected null because the input is not a tar archive", ais);
        } catch (ArchiveException | IOException e) {
            // An exception should be thrown indicating that it's not a valid archive
            assertTrue(e.getMessage().contains("No Archiver"));
        }
    }
}
