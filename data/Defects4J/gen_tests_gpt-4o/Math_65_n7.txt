public void testChiSquareWeightApplicaton() {
    double[] residualsWeights = {0.5, 1.0, 1.5};
    double[] residuals = {1.0, 2.0, 3.0};
    AbstractLeastSquares model = new AbstractLeastSquares() {
        @Override
        public double[] getResiduals() {
            return residuals;
        }

        @Override
        public double[] getWeights() {
            return residualsWeights;
        }
    };

    double expectedChiSquare = residualsWeights[0] * Math.pow(residuals[0], 2) +
                               residualsWeights[1] * Math.pow(residuals[1], 2) +
                               residualsWeights[2] * Math.pow(residuals[2], 2);

    assertEquals(expectedChiSquare, model.getChiSquare(), 1e-10);
}