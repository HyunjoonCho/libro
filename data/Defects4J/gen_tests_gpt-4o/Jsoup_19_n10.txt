
import org.jsoup.Jsoup;
import org.jsoup.nodes.Document;
import org.jsoup.safety.Whitelist;
import org.junit.Test;
import static org.junit.Assert.assertTrue;

public class JsoupCidSanitizerTest {

    @Test
    public void testCidReferencePreservation() {
        String html = "<img src=\"cid:image001@example.com\">";

        // Use a simple whitelist that allows image tags
        Whitelist whitelist = Whitelist.basicWithImages();

        // Clean the HTML, which will sanitize it according to the whitelist
        String sanitizedHtml = Jsoup.clean(html, whitelist);

        // Check that the cid reference is not preserved and is removed
        assertTrue("Cid reference should be preserved, but is removed.",
                !sanitizedHtml.contains("cid:image001@example.com"));
        
        System.out.println("Sanitized HTML: " + sanitizedHtml);
    }
}
