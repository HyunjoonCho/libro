public void testGoogAddSingletonGetterPreventsUnusedClassRemoval() {
    // Setup compilation options with ADVANCED_OPTIMIZATIONS
    CompilationOptions options = CompilationOptions.builder()
        .setCompilationLevel(CompilationLevel.ADVANCED_OPTIMIZATIONS)
        .setUseClosureLibrary(true)
        .setFormatting(ImmutableList.of(Formatting.PRETTY_PRINT, Formatting.PRINT_INPUT_DELIMITER))
        .setWarningLevel(WarningLevel.VERBOSE)
        .setDebug(true)
        .build();

    String inputJs = "/** @provideGoog */\n" +
                     "goog.provide('foo');\n" +
                     "var foo = function() { this.values = []; };\n" +
                     "goog.addSingletonGetter(foo);\n" +
                     "foo.prototype.add = function(value) {this.values.push(value)};";

    // Compile the input JavaScript
    Result result = Compiler.compile(options, inputJs);

    // Check that the output is empty (i.e., the code is completely removed)
    assertTrue("The compiled output was not empty", result.getOutput().isEmpty());
}