public void testCommaOperatorHandling() {
    // 1. Check that a warning is issued for non-side effect expression
    assertParsedAndWarnedExpression("foo((1, 2, 42))", "foo((1, 3))", true);

    // 2. Check that no warning is issued for side effect expression in non-rightmost position
    assertParsedAndWarnedExpression("foo((bar(), 2, 42))", "foo((bar(), 3))", false);

    // 3. Check that warnings are issued for non-side effect expressions in nested sequences
    assertParsedAndWarnedExpression("foo(((1, 2, 3), (4, 5, 42)))", "foo((1, 4, 42))", true);
}

private void assertParsedAndWarnedExpression(String input, String expectedOutput, boolean expectedWarning) {
    ParsedExpression parsedExpression = parseExpression(input);
    String transformedOutput = parsedExpression.getTransformedExpression();
    boolean warningIssued = parsedExpression.isWarningIssued();

    assertEquals(expectedOutput, transformedOutput);
    assertEquals(expectedWarning, warningIssued);
}