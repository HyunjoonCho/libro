script
/**
 * This test is designed to reproduce a bug where a prototype method is incorrectly removed
 * due to advanced optimizations in Closure Compiler. Ensure that the method `bar1` exists and is callable.
 */
function testPrototypeMethodRemoval() {
    /** @const */
    var foo = {};
    foo.bar = {
        'bar1': function() { return 'bar1'; } // Return string to assert later
    }

    /** @constructor */
    function foobar() {}
    foobar.prototype = foo.bar;

    foo.foobar = new foobar();

    // Access the prototype method and assert its behavior
    try {
        const result = foo.foobar['bar1']();
        if (result !== 'bar1') {
            throw new Error("Prototype method `bar1` was modified or removed unexpectedly.");
        }
    } catch (e) {
        throw new Error("Prototype method `bar1` was removed. Error: " + e.message);
    }
}

// Run the test
testPrototypeMethodRemoval();
console.log('Test passed: Prototype method `bar1` exists and is callable.');
