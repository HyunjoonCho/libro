
import org.apache.commons.lang3.time.DateUtils;
import org.junit.Test;

import java.util.Calendar;
import java.util.Date;
import java.util.TimeZone;

import static org.junit.Assert.assertEquals;

public class DateUtilsDSTTest {

    @Test
    public void testTruncateDST() {
        // Set the time zone to a location that observes DST
        TimeZone defaultTimeZone = TimeZone.getDefault();
        TimeZone.setDefault(TimeZone.getTimeZone("America/Denver"));

        try {
            // Date representing 2004-10-31 01:00:00 MDT
            Date oct31_01MDT = new Date(1099206000000L);

            // Perform truncation by hour
            Date result = DateUtils.truncate(oct31_01MDT, Calendar.HOUR_OF_DAY);

            // Assert that the result matches the original date (ignoring any DST changes)
            assertEquals(oct31_01MDT, result);
        } finally {
            // Restore the original default time zone
            TimeZone.setDefault(defaultTimeZone);
        }
    }
}
