
import org.apache.commons.math3.analysis.UnivariateFunction;
import org.apache.commons.math3.analysis.solvers.BrentSolver;
import org.apache.commons.math3.exception.NoBracketingException;
import org.junit.Test;

public class BrentSolverTest {

    @Test(expected = IllegalArgumentException.class)
    public void testBrentSolverInitialGuessWrongSign() {
        // Define a simple function with a known root, e.g., f(x) = x^2 - 1; root at x = 1 or x = -1
        UnivariateFunction function = new UnivariateFunction() {
            @Override
            public double value(double x) {
                return x * x - 1;
            }
        };

        // Create an instance of BrentSolver
        BrentSolver solver = new BrentSolver();

        // min and max bracket the root x = 1
        double min = 0.5;
        double max = 2.0;

        // Initial guess is outside the interval and wrong, e.g., far from root with same sign as function values at min and max
        double initialGuess = 2.5;

        // This should throw an IllegalArgumentException according to the bug report
        solver.solve(100, function, min, max, initialGuess);
    }
}
