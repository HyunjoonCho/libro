
import org.apache.commons.math3.special.Gamma;
import org.apache.commons.math3.util.Precision;
import org.junit.Test;
import static org.junit.Assert.assertTrue;

public class SpecialFunctionsAccuracyTest {

    @Test
    public void testGammaFunctionAccuracy() {
        double x = 5.0;
        double expectedGammaValue = 24.0; // Gamma(5) = 4!
        double calculatedGammaValue = Gamma.gamma(x);
        assertTrue("Gamma function accuracy issue",
                Precision.equals(expectedGammaValue, calculatedGammaValue, 1.0e-15));
    }

    @Test
    public void testRegularizedGammaPAccuracy() {
        double x = 2.0;
        double a = 3.0;
        double expectedValue = 0.800851726528544; // Expectation from known calculations
        double calculatedValue = Gamma.regularizedGammaP(a, x, 1.0e-15, 10000);
        assertTrue("Regularized Gamma P function accuracy issue",
                Precision.equals(expectedValue, calculatedValue, 1.0e-15));
    }
}
