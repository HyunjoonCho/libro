public void testJsonIdentityReferenceOnClass() throws Exception {
    ObjectMapper mapper = new ObjectMapper();
    
    @JsonIdentityInfo(generator=ObjectIdGenerators.IntSequenceGenerator.class, property="id")
    @JsonIdentityReference(alwaysAsId=true)
    class ReallyAlwaysAsId {
        public int id;
        public int value;

        public ReallyAlwaysAsId() { this(0); }
        public ReallyAlwaysAsId(int v) {
            this.id = v;
            value = v;
        }
    }
    
    class ReallyAlwaysContainer {
        public ReallyAlwaysAsId a = new ReallyAlwaysAsId(1);
        public ReallyAlwaysAsId b = new ReallyAlwaysAsId(2);
    }
    
    ReallyAlwaysContainer container = new ReallyAlwaysContainer();
    String json = mapper.writeValueAsString(container);
    assertEquals("{\"a\":1,\"b\":2}", json);
}