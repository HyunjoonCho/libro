public void testTooLargeFirstStep() {
    double[] y0 = {1.0};
    double t0 = 0.0;
    double tf = 1e-6;
    DormandPrince853Integrator integrator = new DormandPrince853Integrator();
    integrator.setInitialStepSize(tf / 1000.0);
    StepProblem problem = new StepProblem(t0, tf, y0) {
        @Override
        public double[] computeDerivatives(double t, double[] y) {
            return new double[] {-y[0]};
        }
    };
    integrator.integrate(problem);
}