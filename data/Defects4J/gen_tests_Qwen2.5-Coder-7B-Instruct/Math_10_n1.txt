public void testDerivativeStructureAtan2() {
    double[][] data = { { Double.POSITIVE_INFINITY, Double.POSITIVE_INFINITY },
                        { Double.NEGATIVE_INFINITY, Double.POSITIVE_INFINITY },
                        { Double.POSITIVE_INFINITY, Double.NEGATIVE_INFINITY },
                        { Double.NEGATIVE_INFINITY, Double.NEGATIVE_INFINITY } };

    for (double[] pair : data) {
        DerivativeStructure atan2 = new DerivativeStructure(1, 0, pair[1], pair[0]).atan2(pair[1]);
        assertEquals(Math.atan2(pair[1], pair[0]), atan2.getValue(), 0);
    }
}