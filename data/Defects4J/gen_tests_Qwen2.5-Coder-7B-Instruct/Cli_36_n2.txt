public void testHelpFormatterOptionComparator() throws Exception {
    OptionGroup group = new OptionGroup();
    Option h = Option.builder("h").build();
    Option s = Option.builder("s").build();
    Option b = Option.builder("b").build();
    Option t = Option.builder("t").build();
    group.addOption(h).addOption(s).addOption(b).addOption(t);
    Options options = new Options();
    options.addOptionGroup(group);
    options.addOption(Option.builder("o").build());

    HelpFormatter formatter = new HelpFormatter();
    formatter.setOptionComparator(null);

    ByteArrayOutputStream out = new ByteArrayOutputStream();
    PrintStream originalOut = System.out;
    try {
        System.setOut(new PrintStream(out));
        formatter.printHelp("cmd", "", options, null);
        String helpText = out.toString();

        assertTrue(helpText.contains("-h, --help"));
        assertTrue(helpText.contains("-s"));
        assertTrue(helpText.contains("-b"));
        assertTrue(helpText.contains("-t"));
        assertTrue(helpText.contains("-o"));
    } finally {
        System.setOut(originalOut);
    }
}