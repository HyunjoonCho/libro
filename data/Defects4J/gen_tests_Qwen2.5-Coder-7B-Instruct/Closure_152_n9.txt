public void testResolveTypes() throws Exception {
  String jsCode = "function foo(x) { return x; }";
  Compiler compiler = new Compiler();
  compiler.initOptions(new Options());
  compiler.addInput(jsCode, "test.js", null);
  compiler.setWarningLevel(DiagnosticGroups.CHECK_TYPES, CheckLevel.ERROR);
  try {
    compiler.compile();
    fail("Expected ClassCastException");
  } catch (ClassCastException e) {
    assertTrue(e.getMessage().contains("UnionType cannot be cast to ObjectType"));
  }
}