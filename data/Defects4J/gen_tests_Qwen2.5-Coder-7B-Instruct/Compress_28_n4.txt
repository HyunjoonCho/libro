public void testTarArchiveInputStreamSilentlyFinishedWhenUnexpectedEOFOccurred() throws IOException {
    InputStream inputStream = mock(InputStream.class);
    when(inputStream.read(any(byte[].class))).thenReturn(-1);

    BZip2CompressorInputStream bzip2Stream = mock(BZip2CompressorInputStream.class);
    when(bzip2Stream.getInputStream()).thenReturn(inputStream);

    TarArchiveInputStream tarStream = new TarArchiveInputStream(bzip2Stream);

    try {
        tarStream.getNextEntry();
        fail("Expected IOException to be thrown due to unexpected EOF");
    } catch (IOException e) {
        // Expected exception
    }
}