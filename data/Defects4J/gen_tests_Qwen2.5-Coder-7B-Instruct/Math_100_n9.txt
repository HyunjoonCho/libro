public void testAbstractEstimator() throws Exception {
    LeastSquaresProblem problem = mock(LeastSquaresProblem.class);
    double[] params = {1.0, 2.0, 3.0};
    double[] errors = {0.1, 0.2, 0.3};
    when(problem.getAllParameters()).thenReturn(params);
    when(problem.getJacobian()).thenReturn(new RealMatrixImpl(new double[][]{
            {1.0, 0.0, 0.0},
            {0.0, 1.0, 0.0},
            {0.0, 0.0, 1.0}
    }));
    AbstractEstimator estimator = new AbstractEstimator() {
        @Override
        protected void estimate(double[] point) {
            // Do nothing
        }
    };
    estimator.setEstimationProblem(problem);
    try {
        estimator.getCovariances();
        fail("Expected ArrayIndexOutOfBoundsException");
    } catch (ArrayIndexOutOfBoundsException e) {
        // Expected
    }
    try {
        estimator.guessParametersErrors();
        fail("Expected ArrayIndexOutOfBoundsException");
    } catch (ArrayIndexOutOfBoundsException e) {
        // Expected
    }
}