public void testJsCompilerWarnings() {
    String[] args1 = {"--js", "test.js"};
    String[] args2 = {"--js", "test.js", "--warning_level", "VERBOSE"};
    String[] args3 = {"--js", "test.js", "--jscomp_warning", "globalThis"};
    String[] args4 = {"--js", "test.js", "--jscomp_warning", "checkVars"};
    String[] args5 = {"--js", "test.js", "--jscomp_warning", "undefinedVars"};

    runCompiler(args1, false, true, true);
    runCompiler(args2, true, true, true);
    runCompiler(args3, true, false, true);
    runCompiler(args4, false, false, true);
    runCompiler(args5, false, false, true);
}

private void runCompiler(String[] args, boolean expectError, boolean expectWarning, boolean expectCheckVar) {
    int exitCode = GwtCompiler.main(args);
    assertEquals(expectError? 1 : 0, exitCode);

    List<String> outputLines = getOutputLines();
    boolean foundError = outputLines.stream().anyMatch(line -> line.startsWith("ERROR"));
    assertTrue(foundError ==