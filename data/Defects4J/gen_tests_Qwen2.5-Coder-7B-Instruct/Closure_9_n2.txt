public void testCompilerFailsToFindAMDModuleInSubdirectory() throws Exception {
    File libDir = new File("lib");
    File fooFile = new File(libDir, "Foo.js");
    File barFile = new File("Bar.js");

    // Assume these files already exist and contain valid AMD module definitions

    List<String> args = Arrays.asList(
            "-jar", "compiler.jar",
            "--transform_amd_modules",
            "--process_common_js_modules",
            "--common_js_entry_module=Bar.js",
            "--compilation_level=ADVANCED_OPTIMIZATIONS",
            "--js_output_file=out.js",
            "--js=" + barFile.getAbsolutePath(),
            "--js=" + fooFile.getAbsolutePath()
    );

    ProcessBuilder pb = new ProcessBuilder(args);
    Process process = pb.start();
    int exitCode = process.waitFor();

    assertEquals(1, exitCode);
}