public void testJoinThrowsNPEWhenToStringIsNull() {
    try {
        StringUtils.join(new Object[]{
                new Object() {
                    @Override
                    public String toString() {
                        return null;
                    }
                }
        }, ',');
        fail("Expected NullPointerException");
    } catch (NullPointerException e) {
        // Expected exception
    }
}