public void testAnonymousObjectInference() {
  String jsCode = 
      "/**\n" +
      " * @param {{prop1: string, prop2: (number|undefined)}} parry\n" +
      " * @constructor\n" +
      " */\n" +
      "function callz(parry) {\n" +
      "  if (parry.prop2 && parry.prop2 < 5) alert('alright!');\n" +
      "  alert(parry.prop1);\n" +
      "}\n" +
      "\n" +
      "new callz({prop1: 'hi'});";

  JsErrorReporter reporter = new JsErrorReporter();
  Compiler compiler = new Compiler(reporter);
  compiler.compile(new JSSourceFile("test.js", jsCode));

  assertTrue(reporter.hasErrors());
  assertEquals(1, reporter.getErrorCount());
}