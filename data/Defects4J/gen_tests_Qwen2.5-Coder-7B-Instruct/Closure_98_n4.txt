import org.junit.Test;
import static org.junit.Assert.*;

public class ClosureTest {

    @Test
    public void testBadVariableInliningInClosure() {
        StringBuilder output = new StringBuilder();
        System.setOut(new PrintStream(new OutputStreamWriter(output)));

        foo();

        String expectedOutput = "1\n2\n3\n4\n5\n";
        assertEquals(expectedOutput, output.toString());
    }

    private void foo() {
        int[] arr = {1, 2, 3, 4, 5};
        for (int i = 0, l = arr.length; i < l; i++) {
            final int j = arr[i];
            Runnable task = new Runnable() {
                @Override
                public void run() {
                    System.out.println(j);
                }
            };
            task.run();
        }
    }
}