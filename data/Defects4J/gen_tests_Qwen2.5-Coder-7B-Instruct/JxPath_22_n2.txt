public void testResetDefaultNamespaceCausesEndlessLoop() throws Exception {
    String xml = "<root><b:foo xmlns:b=\"bla\" xmlns=\"test111\"><b:bar>a</b:bar><test xmlns=\"\"></test></b:foo></root>";
    Document document = new SAXBuilder().build(new StringReader(xml));
    NodePointer rootPointer = new DOMNodePointer(null, document.getDocumentElement(), null);
    NodePointer testPointer = rootPointer.getChild("test", false);
    assertNotNull(testPointer);
    try {
        testPointer.asPath();
        fail("Expected an endless loop or incorrect XPath");
    } catch (StackOverflowError e) {
        // Expected endless loop
    } catch (XPathExpressionException e) {
        // Expected incorrect XPath
        assertTrue(e.getMessage().contains("//b:foo/null:test"));
    }
}