public void testNullTypeIdForPolymorphicValues() {
    PolymorphicTypeValidator ptv = new PolymorphicTypeValidator.Builder()
           .addTrustedSubtype(Base.class)
           .build();
    ObjectMapper mapper = new ObjectMapper();
    mapper.activateDefaultTyping(ptv, ObjectMapper.DefaultTyping.NON_FINAL);

    Base base = new Derived();
    String json = mapper.writeValueAsString(base);

    try {
        mapper.readValue(json, Base.class);
        fail("Expected exception was not thrown.");
    } catch (InvalidTypeException e) {
        // Expected exception
    }
}

class Base {}

class Derived extends Base {}