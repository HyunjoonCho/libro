public void testChiSquare() {
    double[] expected = {485, 541, 82, 61, 37};
    long[] observed = {500, 623, 72, 70, 31};
    
    double expectedSum = Arrays.stream(expected).mapToDouble(val -> val).sum();
    double observedSum = Arrays.stream(observed).mapToDouble(val -> val).sum();
    double scalingFactor = observedSum / expectedSum;
    
    for (int i = 0; i < expected.length; i++) {
        expected[i] *= scalingFactor;
    }

    double result = new ChiSquareTestImpl().chiSquare(expected, observed);
    assertEquals(9.0233, result, 1e-5);
}