public void testLocalVersionNeededToExtractDoesNotMatchCentralDirectory()
    throws IOException
{
    ByteArrayOutputStream baos = new ByteArrayOutputStream();
    try (ZipArchiveOutputStream zaos = new ZipArchiveOutputStream(baos))
    {
        zaos.setUseDataDescriptor(true);

        ZipArchiveEntry entry = new ZipArchiveEntry("test.txt");
        entry.setSize(10);
        entry.setTime(System.currentTimeMillis());

        zaos.putArchiveEntry(entry);
        zaos.write(new byte[10]);
        zaos.closeArchiveEntry();

        zaos.finish();

        byte[] bytes = baos.toByteArray();

        // Read the local file header
        ZipInputStream zis = new ZipInputStream(new ByteArrayInputStream(bytes));
        ZipEntry ze = zis.getNextEntry();
        int localVersionNeededToExtract = ((ze.getVersion() & 0xFF) << 8) | (ze.getVersion() >> 8);

        // Read the central directory
        ZipFile zf = new ZipFile(new File("test.zip"), "r");
        ZipEntry ce = zf.getEntry("test.txt");
        int centralVersionNeededToExtract = ((ce.getVersion() & 0xFF) << 8) | (ce.getVersion() >> 8);

        assertEquals(localVersionNeededToExtract