public void testInconsistentTextBufferBehavior() {
    TextBuffer buffer = new TextBuffer(new BufferRecycler());
    buffer.resetWithEmpty();
    
    Object textBuffer = buffer.getTextBuffer();
    assertNotNull(textBuffer);
    assertTrue(textBuffer instanceof char[]);
    assertEquals(0, ((char[])textBuffer).length);

    String content = buffer.contentsAsString();
    assertEquals("", content);

    Object textBufferAfterStringAccess = buffer.getTextBuffer();
    assertNotNull(textBufferAfterStringAccess);
    assertTrue(textBufferAfterStringAccess instanceof char[]);
    assertEquals(0, ((char[])textBufferAfterStringAccess).length);
}