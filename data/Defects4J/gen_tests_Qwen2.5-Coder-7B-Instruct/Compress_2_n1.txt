public void testArDeleteFails() throws IOException {
    // Arrange
    File tempFile = File.createTempFile("bla", ".ar");
    try (ArOutputStream aos = new ArOutputStream(new FileOutputStream(tempFile))) {
        aos.putArchiveEntry(new ArArchiveEntry("test1.xml", 10));
        aos.write("content1".getBytes());
        aos.closeArchiveEntry();
        aos.putArchiveEntry(new ArArchiveEntry("test2.xml", 10));
        aos.write("content2".getBytes());
        aos.closeArchiveEntry();
    }

    // Act
    try (ArInputStream ais = new ArInputStream(new FileInputStream(tempFile))) {
        ArArchiveEntry entry;
        while ((entry = ais.getNextEntry())!= null) {
            if ("test2.xml".equals(entry.getName())) {
                ais.deleteCurrentEntry();
            }
        }
    }

    // Assert
    try (ArInputStream ais = new ArInputStream(new FileInputStream(tempFile))) {
        ArArchiveEntry entry;
        int count = 0;
        while ((entry = ais.getNextEntry())!= null) {
            count++;
        }
        assertEquals(2, count); // Should be 2 entries after deleting one
    }
}