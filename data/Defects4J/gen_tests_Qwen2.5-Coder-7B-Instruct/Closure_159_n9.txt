public void testClosureCompilerBug() throws Exception {
    String input = 
        "function preload_check_all() { }" +
        "function test() { preload_check_all(); }";
    String expectedOutput =
        "function a() { }" +
        "function b() { a(); }";
    String actualOutput = compileWithClosureCompiler(input);
    assertEquals(expectedOutput, actualOutput);
}

private String compileWithClosureCompiler(String input) throws Exception {
    // Set up compiler options and inputs
    CompilerOptions options = new CompilerOptions();
    SourceFile inputSource = SourceFile.fromCode("input.js", input);

    // Run the compiler
    Compiler compiler = new Compiler();
    Result result = compiler.compile(SourceFile.fromCode("externs.js", ""), inputSource, options);

    // Check for errors
    assertTrue(result.success);

    // Return the compiled output
    return compiler.toSource();
}