public void testOverlyAggressiveCommaRemoval() {
    String jsCode = 
        "function Test(n) {\n" +
        "  var i = 0;\n" +
        "  return typeof n!== \"undefined\"? (i = n.length) : (n = \"foo\"), i\n" +
        "}\n" +
        "var dummy = \"6chars\";\n" +
        "console && console.log(Test(dummy));";
    
    // Simulate compilation with simple optimizations
    String optimizedJsCode = 
        "function Test(a) {\n" +
        "  return 0\n" +
        "}\n" +
        "var dummy = \"6chars\";\n" +
        "console && console.log(Test(dummy));";

    // Execute the original and optimized JavaScript code
    Object resultOriginal = executeJavaScript(jsCode);
    Object resultOptimized = executeJavaScript(optimizedJsCode);

    // Compare the results
    assertNotEquals(resultOriginal, resultOptimized);
}

private Object executeJavaScript(String code) {
    // Implementation of JavaScript execution goes here
    // This could involve using Nashorn, V8, or another JavaScript engine
    // For simplicity, we'll