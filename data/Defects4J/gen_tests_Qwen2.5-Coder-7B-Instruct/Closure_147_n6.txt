public void testGlobalThisWarning() {
    String script = 
        "var NS = {\n" +
        "  read: function()\n" +
        "  {\n" +
        "    return this.foo;\n" +
        "  },\n" +
        "\n" +
        "  write: function()\n" +
        "  {\n" +
        "    this.foo = 123;\n" +
        "  }\n" +
        "};";
    
    JavaScriptEngine engine = new JavaScriptEngine();
    engine.eval(script);
    
    Invocable invocable = (Invocable) engine;
    try {
        invocable.invokeFunction("NS.read");
        fail("Expected exception not thrown");
    } catch (ScriptException e) {
        assertTrue(e.getMessage().contains("JSC_USED_GLOBAL_THIS"));
    }
    
    try {
        invocable.invokeFunction("NS.write");
        fail("Expected exception not thrown");
    } catch (ScriptException e) {
        assertTrue(e.getMessage().contains("JSC_USED_GLOBAL_THIS"));
    }
}