public void testAbstractLeastSquares() {
    double[] residuals = {1.0, 2.0, 3.0};
    double[] weights = {0.5, 1.0, 2.0};
    AbstractLeastSquares leastSquares = new AbstractLeastSquares(residuals, weights) {};
    double expectedChiSquare = 0.5 * 1.0 * 1.0 + 1.0 * 2.0 * 2.0 + 2.0 * 3.0 * 3.0;
    double actualChiSquare = leastSquares.getChiSquare();
    assertEquals(expectedChiSquare, actualChiSquare, 0.0001);
}