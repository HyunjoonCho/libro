public void testGoogScopeFunctionDeclarationError() {
    String source = "goog.scope(function() { var x = function() {}; });";
    try {
        JsCompiler.compile(source);
        fail("Expected compilation error");
    } catch (JavaScriptException e) {
        assertTrue(e.getMessage().contains("Prevent the goog.scope from being unboxed"));
    }

    source = "goog.scope(function() { function x() {} });";
    try {
        JsCompiler.compile(source);
        fail("Expected compilation error");
    } catch (JavaScriptException e) {
        assertTrue(e.getMessage().contains("Prevent the goog.scope from being unboxed"));
    }
}