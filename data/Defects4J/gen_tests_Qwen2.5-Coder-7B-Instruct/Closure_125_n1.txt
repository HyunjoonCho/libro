public void testCrash() throws Exception {
    String jsCode = "var test = {}; /** * @interface */ test.T = function() {}; /** * @constructor * @implements {test.T} */ test.A = function() {}; /** * @constructor * @implements {test.T} */ test.B = function() {}; /** * @constructor */ test.X = function() { this.type = test.A; this.t = this.f(); }; /** * @return {test.T} */ test.X.prototype.f = function() { if (this.type === test.A) { return new test.A(); } else if (this.type === test.B) { return new test.B(); } };";
    File tempFile = File.createTempFile("crash", ".js");
    try (PrintWriter writer = new PrintWriter(tempFile)) {
        writer.print(jsCode);
    }
    ProcessBuilder pb = new ProcessBuilder("java", "-jar", "./compiler.jar", "--js", tempFile.getAbsolutePath(), "--warning_level=VERBOSE", "--compilation_level=SIMPLE_OPTIMIZATIONS");
    Process process = pb.start();
    int exitCode = process.waitFor();
    assertEquals(1, exitCode);
}