public void testDerivativeStructureAtan2SpecialCases() {
    DerivativeStructure dsXPosYPos = new DerivativeStructure(1, 0, 0, 1, 1);
    DerivativeStructure dsXNegYPos = new DerivativeStructure(1, 0, 0, -1, 1);
    DerivativeStructure dsXPosYNeg = new DerivativeStructure(1, 0, 0, 1, -1);
    DerivativeStructure dsXNegYNeg = new DerivativeStructure(1, 0, 0, -1, -1);

    double resultXPosYPos = dsXPosYPos.atan2(dsXPosYPos.getValue()).getValue();
    double resultXNegYPos = dsXNegYPos.atan2(dsXNegYPos.getValue()).getValue();
    double resultXPosYNeg = dsXPosYNeg.atan2(dsXPosYNeg.getValue()).getValue();
    double resultXNegYNeg = dsXNegYNeg.atan2(dsXNegYNeg.getValue()).getValue();

    assertEquals(Math.atan2(1, 1), resultXPosYPos, 0);
    assertEquals(Math.atan2(-1,