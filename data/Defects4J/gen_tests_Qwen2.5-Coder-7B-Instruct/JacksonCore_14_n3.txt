public void testRelaxOwnershipChecksForBuffersNotToRequireIncreaseInSize() {
    IOContext context = mock(IOContext.class);
    byte[] oldBuffer = new byte[1024];
    ByteBuffer oldByteBuffer = ByteBuffer.wrap(oldBuffer);

    ByteBuffer newByteBuffer = ByteBuffer.allocate(1024);

    when(context.allocManagedBuffer(anyInt())).thenReturn(newByteBuffer);

    // Call the method under test that is expected to relax ownership checks
    // For example:
    // IOUtils.readFully(inputStream, oldByteBuffer, context);

    verify(context).allocManagedBuffer(eq(1024));
    assertSame(newByteBuffer, oldByteBuffer);
}