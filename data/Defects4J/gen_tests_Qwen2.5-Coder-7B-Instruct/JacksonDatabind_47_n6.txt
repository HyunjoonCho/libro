import static org.junit.Assert.*;

import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.databind.module.SimpleModule;

public class JacksonTest {

    private ObjectMapper mapper;

    @Before
    public void setUp() {
        mapper = new ObjectMapper();
        SimpleModule module = new SimpleModule();
        // Add custom serializer/deserializer if needed
        module.addSerializer(AccessionIdentifier.class, new AccessionIdentifierSerializer());
        module.addDeserializer(AccessionIdentifier.class, new AccessionIdentifierDeserializer());
        mapper.registerModule(module);
    }

    @Test(expected = JsonMappingException.class)
    public void testModelObjects() throws Exception {
        String json = "{\"reference\":{\"id\":\"ABC\"}}";
        mapper.readValue(json, Foo.class);
    }

    public static class Foo {
        @JsonSerialize(as = BaseAccessionIdentifier.class)
        @JsonDeserialize(as = BaseAccessionIdentifier.class)
        public AccessionIdentifier getReference() {
            return null;
        }
    }

    public interface AccessionIdentifier {
    }

    public static class BaseAccessionIdentifier implements AccessionIdentifier {
        private String id;

        public String getId() {
            return id;
        }

        public void setId(String id) {
            this.id = id;
        }