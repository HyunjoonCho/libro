public void testExcelEmptyHeader() throws Exception {
    String csv = "A,B,C,,\na,b,c,d,e";
    Reader reader = new StringReader(csv);
    try {
        CSVParser parser = new CSVParser(reader, CSVFormat.EXCEL.withFirstRecordAsHeader());
        fail("Expected IllegalArgumentException to be thrown");
    } catch (IllegalArgumentException e) {
        assertTrue(e.getMessage().contains("The header contains a duplicate name: \"\""));
    }
}