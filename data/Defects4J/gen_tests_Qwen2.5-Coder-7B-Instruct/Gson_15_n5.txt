public void testJsonWriterValue() throws Exception {
    ByteArrayOutputStream out = new ByteArrayOutputStream();
    JsonWriter writer = new JsonWriter(new OutputStreamWriter(out));
    writer.setLenient(true);
    writer.beginObject();
    writer.name("nan").value(Double.NaN);
    writer.name("infinity").value(Double.POSITIVE_INFINITY);
    writer.endObject();
    writer.close();

    String result = out.toString("UTF-8");
    assertTrue(result.contains("\"nan\":null"));
    assertTrue(result.contains("\"infinity\":null"));

    out.reset();
    writer = new JsonWriter(new OutputStreamWriter(out));
    writer.beginObject();
    writer.name("nan").value((Number) Double.NaN);
    writer.name("infinity").value((Number) Double.POSITIVE_INFINITY);
    writer.endObject();
    writer.close();

    result = out.toString("UTF-8");
    assertTrue(result.contains("\"nan\":null"));
    assertTrue(result.contains("\"infinity\":null"));
}