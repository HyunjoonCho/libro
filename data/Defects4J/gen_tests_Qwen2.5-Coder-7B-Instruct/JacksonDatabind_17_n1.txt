public void testReadTreeWithDefaultTyping() throws Exception {
    ObjectMapper mapper = new ObjectMapper()
           .enableDefaultTyping()
           .configure(SerializationFeature.INDENT_OUTPUT, true);

    Foo foo = new Foo("bar");
    String serialized = mapper.writeValueAsString(foo);

    try {
        JsonNode jsonNode = mapper.readTree(serialized);
        fail("Expected JsonMappingException");
    } catch (JsonMappingException e) {
        assertTrue(e.getMessage().contains("need JSON Array to contain As.WRAPPER_ARRAY type information"));
    }
}