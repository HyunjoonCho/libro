public void testInvalidHttpCharset() throws IOException {
    String html = "<html><head><meta charset=\"UTF8\"></head><body>Hello World</body></html>";
    byte[] data = html.getBytes("UTF-8");

    Document doc = Jsoup.parse(data, "UTF-8", "http://example.com");

    // Modify the charset to be invalid
    ByteBuffer buffer = ByteBuffer.wrap(data);
    buffer.position(25); // Position after <meta charset="UTF8">
    buffer.put((byte) 'U');
    buffer.put((byte) 'F');
    buffer.put((byte) 'T');
    buffer.put((byte) '9');

    try {
        Jsoup.parse(buffer.array(), "UTF-8", "http://example.com");
        fail("Expected UnsupportedCharsetException");
    } catch (UnsupportedCharsetException e) {
        // Expected
    }
}