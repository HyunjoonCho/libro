public void testDerivativeStructureAtan2SpecialCases() {
    double[][] data = {
        {Double.POSITIVE_INFINITY, Double.POSITIVE_INFINITY},
        {Double.NEGATIVE_INFINITY, Double.POSITIVE_INFINITY},
        {Double.POSITIVE_INFINITY, Double.NEGATIVE_INFINITY},
        {Double.NEGATIVE_INFINITY, Double.NEGATIVE_INFINITY},
        {0.0, Double.POSITIVE_INFINITY},
        {0.0, Double.NEGATIVE_INFINITY},
        {Double.POSITIVE_INFINITY, 0.0},
        {Double.NEGATIVE_INFINITY, 0.0}
    };

    for (double[] pair : data) {
        double result = new DerivativeStructure(1, 0, pair[1], pair[0]).atan2(pair[0]);
        assertEquals(Math.atan2(pair[1], pair[0]), result, 0.0);
    }
}