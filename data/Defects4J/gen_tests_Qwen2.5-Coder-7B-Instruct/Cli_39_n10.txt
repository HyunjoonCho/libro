public void testOptionParserType() throws Exception {
    Options options = new Options();
    options.addOption(Option.builder("f")
                            .hasArg()
                            .type(FileInputStream.class)
                            .build());

    String[] args = {"-f", "/nonexistent/file"};
    CommandLine cmdLine = new DefaultParser().parse(options, args);

    Object value = cmdLine.getParsedOptionValue("f");
    assertTrue(value instanceof FileInputStream);
    assertFalse(((FileInputStream)value).getFD().valid());
}