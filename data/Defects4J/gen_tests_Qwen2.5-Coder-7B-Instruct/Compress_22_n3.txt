public void testBZip2CompressorInputStreamReadsTruncatedFile() throws IOException {
    // Create a truncated bzip2 file
    byte[] originalData = "Hello, World!".getBytes();
    ByteArrayOutputStream baos = new ByteArrayOutputStream();
    try (BZip2CompressorOutputStream bos = new BZip2CompressorOutputStream(baos)) {
        bos.write(originalData);
    }
    byte[] truncatedData = baos.toByteArray();
    truncatedData[truncatedData.length - 1] = 0; // Truncate the last byte

    // Read the truncated data using BZip2CompressorInputStream
    try (ByteArrayInputStream bais = new ByteArrayInputStream(truncatedData);
         BZip2CompressorInputStream bis = new BZip2CompressorInputStream(bais)) {
        byte[] buffer = new byte[1024];
        int bytesRead = bis.read(buffer);

        // Verify that the correct number of bytes were read
        assertEquals(770, bytesRead); // This should fail under Jython
    }
}