public void testExtendedBufferedReader() throws IOException {
    String input = "line1\r\nline2\nline3";
    ExtendedBufferedReader reader = new ExtendedBufferedReader(new StringReader(input));
    
    String line;
    int lineNumber = 1;
    while ((line = reader.readLine())!= null) {
        assertEquals("line" + lineNumber, line);
        lineNumber++;
    }
    assertEquals(4, lineNumber); // Should count 3 lines plus initial line number
    
    assertTrue(reader.read() == -1); // EOF
}