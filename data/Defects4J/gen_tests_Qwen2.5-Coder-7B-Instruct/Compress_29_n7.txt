public void testEncodingPassThrough() throws Exception {
    String encoding = "UTF-8";
    ArchiveEntry entry = new ArchiveEntryImpl();
    entry.setName("test.txt");

    try (ArjArchiveOutputStream arjOut = new ArjArchiveOutputStream(new ByteArrayOutputStream())) {
        arjOut.putArchiveEntry(entry);
        arjOut.write("test".getBytes(encoding));
        arjOut.closeArchiveEntry();
    }

    try (ArjArchiveInputStream arjIn = new ArjArchiveInputStream(new ByteArrayInputStream(arjOut.toByteArray()))) {
        ArchiveEntry readEntry = arjIn.getNextEntry();
        byte[] content = new byte[(int) readEntry.getSize()];
        arjIn.read(content);
        assertArrayEquals("test".getBytes(encoding), content);
    }
}