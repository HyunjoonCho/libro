public void testLocalVersionNeededToExtractDoesNotMatchCentralDirectory() throws IOException {
    ByteArrayOutputStream baos = new ByteArrayOutputStream();
    ZipArchiveOutputStream zaos = new ZipArchiveOutputStream(new BufferedOutputStream(baos));
    zaos.setUseDataDescriptor(true);

    ZipArchiveEntry entry = new ZipArchiveEntry("test.txt");
    entry.setSize(10);
    entry.setTime(System.currentTimeMillis());
    zaos.putArchiveEntry(entry);

    byte[] data = "Hello World".getBytes();
    zaos.write(data);
    zaos.closeArchiveEntry();

    zaos.finish();
    zaos.close();

    ByteArrayInputStream bais = new ByteArrayInputStream(baos.toByteArray());
    ZipInputStream zis = new ZipInputStream(bais);

    ZipEntry ze = zis.getNextEntry();
    assertTrue(ze!= null);

    assertEquals(ZipArchiveOutputStream.ZIP64_MIN_VERSION, ze.getGeneralPurposeBit().usesDataDescriptor());

    zis.close();
}