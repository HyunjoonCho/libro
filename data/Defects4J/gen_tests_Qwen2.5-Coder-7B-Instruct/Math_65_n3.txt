public void testWeightSigmaInAbstractLeastSquares() {
    // Create mock data for testing
    double[] residuals = {1.0, 2.0, 3.0};
    double[] weights = {0.5, 0.5, 1.0};

    // Mock implementation of AbstractLeastSquares
    AbstractLeastSquares abstractLeastSquares = new AbstractLeastSquares() {
        @Override
        protected double[] getResiduals() {
            return residuals;
        }

        @Override
        protected double[] getObservationWeights() {
            return weights;
        }
    };

    // Calculate RMS and ChiSquare
    double rms = abstractLeastSquares.getRMS();
    double chiSquare = abstractLeastSquares.getChiSquare();

    // Check if RMS calculation is correct
    assertEquals(Math.sqrt((Math.pow(residuals[0], 2) * weights[0] +
                            Math.pow(residuals[1], 2) * weights[1] +
                            Math.pow(residuals[2], 2) * weights[2]) / 3), rms);

    // Check if ChiSquare calculation is correct
    assertEquals((Math.pow(residuals[0