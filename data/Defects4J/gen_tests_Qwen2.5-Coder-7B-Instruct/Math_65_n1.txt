public void testWeightVersusSigma() {
    // Arrange
    LeastSquaresProblem problem = mock(LeastSquaresProblem.class);
    double[] residuals = {1.0, 2.0, 3.0};
    double[] weights = {0.5, 1.0, 2.0};
    when(problem.getResiduals()).thenReturn(residuals);
    when(problem.getObservations()).thenReturn(Arrays.asList(new WeightedObservedPoint(weights[0], 0, 0),
                                                            new WeightedObservedPoint(weights[1], 0, 0),
                                                            new WeightedObservedPoint(weights[2], 0, 0)));
    
    AbstractLeastSquares solver = new AbstractLeastSquares(problem) {};
    
    // Act
    double rms = solver.getRMS();
    double chiSquare = solver.getChiSquare();
    
    // Assert
    assertEquals(Math.sqrt((residuals[0]*residuals[0]*weights[0] + 
                            residuals[1]*residuals[1]*weights[1] + 
                            residuals[2]*residuals[2]*weights[2])) / 3.0, rms, 0.00