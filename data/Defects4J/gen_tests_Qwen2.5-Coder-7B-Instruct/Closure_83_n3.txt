public void testCannotSeeVersionWithVersionFlag() throws Exception {
    ProcessBuilder pb = new ProcessBuilder(
        "java", "-jar", "compiler.jar", "--version");
    ByteArrayOutputStream baos = new ByteArrayOutputStream();
    pb.redirectErrorStream(true);
    pb.start().getOutputStream().close();
    int exitCode = pb.waitFor();
    String output = baos.toString();

    assertTrue(output.contains("Опция \"--version\" требует операнд"));
    assertTrue(output.contains("Closure Compiler (http://code.google.com/closure/compiler)"));
    assertTrue(output.contains("Version: 698"));
    assertTrue(output.contains("Built on: 2011/01/17 12:16"));
    assertEquals(1, exitCode);
}