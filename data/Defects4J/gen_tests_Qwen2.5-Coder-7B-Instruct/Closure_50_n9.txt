public void testArrayJoinOptimization() throws Exception {
    String input = "var variable = confirm('value from user');\n" +
                   "var array = [ \"constant\", variable ];\n" +
                   "alert(array.join(\",\"));";
    String expectedOutput = "var a=[\"constant\",confirm(\"value from user\")];alert(a.join());";
    String actualOutput = compileWithAdvancedOptimizations(input);
    assertEquals(expectedOutput, actualOutput);
}

private String compileWithAdvancedOptimizations(String input) throws Exception {
    File inputFile = new File("input.js");
    Files.write(inputFile.toPath(), input.getBytes());

    ProcessBuilder pb = new ProcessBuilder(
            "java",
            "-jar",
            "/usr/local/slando/lib/Google/compiler.jar",
            "--compilation_level", "ADVANCED_OPTIMIZATIONS",
            "--js", inputFile.getAbsolutePath()
    );
    Process process = pb.start();
    process.waitFor();

    return new String(Files.readAllBytes(inputFile.toPath()));
}