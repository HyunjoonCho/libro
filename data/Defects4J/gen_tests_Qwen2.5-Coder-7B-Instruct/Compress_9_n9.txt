import org.apache.commons.compress.archivers.tar.TarArchiveEntry;
import org.apache.commons.compress.archivers.tar.TarArchiveOutputStream;
import org.junit.Test;

import java.io.ByteArrayOutputStream;
import java.io.IOException;

import static org.junit.Assert.assertEquals;

public class TarArchiveOutputStreamTest {

    @Test
    public void testBytesWritten() throws IOException {
        ByteArrayOutputStream baos = new ByteArrayOutputStream();
        TarArchiveOutputStream tao = new TarArchiveOutputStream(baos);

        TarArchiveEntry entry = new TarArchiveEntry("testfile.txt");
        tao.putArchiveEntry(entry);

        byte[] data = "Hello, World!".getBytes();
        tao.write(data);

        tao.closeArchiveEntry();
        tao.finish();
        tao.close();

        assertEquals(data.length, tao.getBytesWritten());
    }
}