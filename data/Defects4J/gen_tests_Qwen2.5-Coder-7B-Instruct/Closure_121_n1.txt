public void testOverzealousOptimization() {
    double uid;
    Random random = new Random();
    uid = random.nextDouble();

    Runnable doStuff = () -> {
        reset();
        double _uid = uid;

        if (uid < 0.5) {
            doStuff.run();
        }

        if (_uid!= uid) {
            throw new RuntimeException("reset() was called");
        }
    };

    doStuff.run();

    private void reset() {
        uid = random.nextDouble();
    }
}