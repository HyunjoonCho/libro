public void testJsonWriterValue() throws Exception {
    StringWriter out = new StringWriter();
    JsonWriter writer = new JsonWriter(out);
    try {
      writer.setLenient(true);
      writer.value((Number) Double.valueOf(Double.NaN));
      fail("Expected IllegalArgumentException");
    } catch (IllegalArgumentException e) {
      // Expected
    }

    writer.setLenient(false);
    try {
      writer.value(Double.NaN);
      fail("Expected IllegalArgumentException");
    } catch (IllegalArgumentException e) {
      // Expected
    }
}