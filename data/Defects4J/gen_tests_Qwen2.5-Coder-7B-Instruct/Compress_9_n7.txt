import org.apache.commons.compress.archivers.tar.TarArchiveEntry;
import org.apache.commons.compress.archivers.tar.TarArchiveOutputStream;

import java.io.ByteArrayOutputStream;
import java.io.IOException;

public class TarArchiveOutputStreamTest {

    @Test
    public void testBytesWritten() throws IOException {
        ByteArrayOutputStream byteArrayOutputStream = new ByteArrayOutputStream();
        TarArchiveOutputStream tarArchiveOutputStream = new TarArchiveOutputStream(byteArrayOutputStream);

        TarArchiveEntry entry = new TarArchiveEntry("testfile.txt");
        tarArchiveOutputStream.putArchiveEntry(entry);

        String content = "Hello, World!";
        tarArchiveOutputStream.write(content.getBytes());
        tarArchiveOutputStream.closeArchiveEntry();

        long bytesWritten = tarArchiveOutputStream.getBytesWritten();
        System.out.println("Bytes Written: " + bytesWritten);

        // Assuming the tar header size is around 512 bytes
        // and the content size is 13 bytes (length of "Hello, World!"),
        // the total bytes written should be close to 525.
        assertTrue(bytesWritten >= 520 && bytesWritten <= 530);

        tarArchiveOutputStream.finish();
        tarArchiveOutputStream.close();
    }
}