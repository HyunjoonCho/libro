public void testWrongParameterFirstStepSizeGuess() {
    // Arrange
    double[] y0 = {1.0};
    double[] vecAbsoluteTolerance = null;
    double scalAbsoluteTolerance = 1e-6;
    double scalRelativeTolerance = 1e-6;

    // Act
    double[] scale = new double[y0.length];
    if (vecAbsoluteTolerance == null) {
        for (int i = 0; i < scale.length; ++i) {
            final double yi = Math.max(Math.abs(y0[i]), Math.abs(y0[i]));
            scale[i] = scalAbsoluteTolerance + scalRelativeTolerance * yi;
        }
    } else {
        for (int i = 0; i < scale.length; ++i) {
            final double yi = Math.max(Math.abs(y0[i]), Math.abs(y0[i]));
            scale[i] = vecAbsoluteTolerance[i] + vecRelativeTolerance[i] * yi;
        }
    }

    // Assert
    assertEquals(scalAbsoluteTolerance + scalRelativeTolerance * Math.abs(y0[0]), scale[0]);
}