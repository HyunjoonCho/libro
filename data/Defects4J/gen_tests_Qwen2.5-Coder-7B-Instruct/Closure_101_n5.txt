public void testProcessClosurePrimitives() throws Exception {
    Path inputFile = Paths.get("testfile.js");
    Files.write(inputFile, Collections.singletonList("goog.provide('test.Test');"));

    ProcessBuilder pb = new ProcessBuilder("java", "-cp", System.getProperty("java.class.path"), "com.google.javascript.jscomp.CommandLineRunner",
            "--js", inputFile.toString(), "--process_closure_primitives", "false");
    pb.redirectErrorStream(true);
    Process process = pb.start();
    int exitCode = process.waitFor();

    String output = new String(process.getInputStream().readAllBytes());
    assertTrue(output.contains("goog.provide('test.Test');"));

    pb = new ProcessBuilder("java", "-cp", System.getProperty("java.class.path"), "com.google.javascript.jscomp.CommandLineRunner",
            "--js", inputFile.toString(), "--process_closure_primitives", "true");
    pb.redirectErrorStream(true);
    process = pb.start();
    exitCode = process.waitFor();

    output = new String(process.getInputStream().readAllBytes());
    assertTrue(output.contains("goog.provide('test.Test');"));
}