public void testInvalidDeterministicTest() {
    String source = 
        "var t = null;" +
        "" +
        "window.test = function()" +
        "{" +
        " if (t!= null)" +
        " {" +
        " t = null;" +
        " }" +
        "" +
        " t = 1;" +
        "}";

    try {
        Compiler compiler = new Compiler();
        compiler.compile(SourceFile.fromCode("test", source),
                        SourceFile.fromCode("out", ""),
                        new Options());
        fail("Expected compilation error due to JSC_DETERMINISTIC_TEST warning");
    } catch (Exception e) {
        assertTrue(e.getMessage().contains("JSC_DETERMINISTIC_TEST"));
    }
}