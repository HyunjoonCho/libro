public void testUnionTypeCastError() {
  String jsCode = "var x = {a: 1};\n" +
                  "function foo(y) {\n" +
                  "  var z = y.a;\n" +
                  "}\n" +
                  "foo(x);";
  try {
    new Compiler().compile("", "", jsCode,
      EnumSet.of(CheckLevel.WARNING),
      ErrorManager.DEFAULT);
    fail();
  } catch (CompilerException e) {
    assertTrue(e.getMessage().contains("Cannot cast UnionType"));
  }
}