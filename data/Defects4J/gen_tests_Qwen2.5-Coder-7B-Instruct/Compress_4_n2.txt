public void testFinishMethodNecessity() throws IOException {
    try (ArchiveOutputStream aos = new ZipArchiveOutputStream(new ByteArrayOutputStream())) {
        // Write some data to the archive
        aos.putArchiveEntry(new ZipArchiveEntry("test.txt"));
        aos.write("Hello, World!".getBytes());
        aos.closeArchiveEntry();

        // Call the finish method externally
        Method finishMethod = ArchiveOutputStream.class.getDeclaredMethod("finish");
        finishMethod.setAccessible(true);
        finishMethod.invoke(aos);

        fail("Expected an exception to be thrown when calling finish() externally");
    } catch (Exception e) {
        assertTrue(e instanceof IllegalStateException);
    }
}