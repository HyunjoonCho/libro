public void testArgumentCaptorVarargs() {
    List<String> list = mock(List.class);

    String arg1 = "foo";
    String arg2 = "bar";

    verify(list).add(arg1, arg2);

    ArgumentCaptor<String> captor = ArgumentCaptor.forClass(String.class);
    verify(list).add(captor.capture(), captor.capture());

    List<String> capturedValues = captor.getAllValues();
    assertEquals(2, capturedValues.size());
    assertEquals(arg1, capturedValues.get(0));
    assertEquals(arg2, capturedValues.get(1));
}