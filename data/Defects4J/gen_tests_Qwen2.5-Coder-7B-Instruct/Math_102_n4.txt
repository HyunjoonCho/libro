public void testChiSquare() {
    long[] observed = { 500, 623, 72, 70, 31 };
    double[] expected = { 485, 541, 82, 61, 37 };

    double expectedSum = Arrays.stream(expected).mapToDouble(e -> e).sum();
    double observedSum = Arrays.stream(observed).mapToDouble(o -> o).sum();

    double scale = observedSum / expectedSum;
    double[] scaledExpected = Arrays.stream(expected)
                                    .map(e -> e * scale)
                                    .toArray();

    ChiSquareTestImpl testStatistic = new ChiSquareTestImpl();
    double result = testStatistic.chiSquare(scaledExpected, observed);

    assertEquals(9.0233, result, 1E-4);
}