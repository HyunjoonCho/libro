import org.apache.commons.lang3.builder.ToStringStyle;
import java.util.concurrent.atomic.AtomicBoolean;

public void testThreadLocalMemoryLeak() throws Exception {
    AtomicBoolean accessed = new AtomicBoolean(false);
    ThreadLocal<String> threadLocal = new ThreadLocal<String>() {
        @Override protected String initialValue() { accessed.set(true); return "test"; }
    };
    ToStringStyle style = new ToStringStyle();
    assertEquals("test", threadLocal.get());
    assertTrue(accessed.get());
    threadLocal.remove();
}