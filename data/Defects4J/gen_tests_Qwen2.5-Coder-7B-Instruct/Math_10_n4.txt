public void testDerivativeStructureAtan2() {
    double[] values = {0.0, Double.POSITIVE_INFINITY, Double.NEGATIVE_INFINITY};
    for (double x : values) {
        for (double y : values) {
            double expected = Math.atan2(y, x);
            DerivativeStructure dsY = new DerivativeStructure(1, 0, y);
            DerivativeStructure dsX = new DerivativeStructure(1, 0, x);
            DerivativeStructure result = dsY.atan2(dsX);
            assertEquals(expected, result.getValue(), 0.0);
        }
    }
}