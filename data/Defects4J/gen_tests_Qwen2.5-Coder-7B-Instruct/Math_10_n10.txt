public void testDerivativeStructureAtan2() {
    DerivativeStructure dsYPosXPos = new DerivativeStructure(1, 0, 0, 1.0, 1.0);
    DerivativeStructure dsYNegXPos = new DerivativeStructure(1, 0, 0, -1.0, 1.0);
    DerivativeStructure dsYPosXNeg = new DerivativeStructure(1, 0, 0, 1.0, -1.0);
    DerivativeStructure dsYNegXNeg = new DerivativeStructure(1, 0, 0, -1.0, -1.0);

    double resultPosPos = dsYPosXPos.atan2(dsYNegXPos).getValue();
    double resultPosNeg = dsYPosXPos.atan2(dsYPosXNeg).getValue();
    double resultNegPos = dsYNegXPos.atan2(dsYNegXNeg).getValue();
    double resultNegNeg = dsYNegXNeg.atan2(dsYPosXPos).getValue();

    assertTrue(Double.isNaN(resultPosPos));
    assertTrue(Double.isNaN(resultPosNeg));
    assertTrue(Double.isNaN(resultNegPos));