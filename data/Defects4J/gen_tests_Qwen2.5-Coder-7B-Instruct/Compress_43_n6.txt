public void testLocalVersionNeededToExtractDoesNotMatchCentralDirectory() throws IOException {
    ByteArrayOutputStream baos = new ByteArrayOutputStream();
    try (ZipArchiveOutputStream zaos = new ZipArchiveOutputStream(baos)) {
        zaos.setUseDataDescriptor(true);
        ZipArchiveEntry entry = new ZipArchiveEntry("test.txt");
        zaos.putArchiveEntry(entry);
        zaos.write(new byte[10]);
        zaos.closeArchiveEntry();
    }

    byte[] bytes = baos.toByteArray();
    ZipInputStream zis = new ZipInputStream(new ByteArrayInputStream(bytes));
    ZipEntry ze = zis.getNextEntry();

    int localVersionNeededToExtract = ((bytes[ze.getName().length() + 4] & 0xFF) << 8)
                                      | (bytes[ze.getName().length() + 5] & 0xFF);

    int centralVersionNeededToExtract = ((bytes[ze.getName().length() + 28] & 0xFF) << 8)
                                        | (bytes[ze.getName().length() + 29] & 0xFF);

    assertNotEquals(localVersionNeededToExtract, centralVersionNeededToExtract);
}