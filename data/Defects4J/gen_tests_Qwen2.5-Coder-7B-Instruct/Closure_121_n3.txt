public void testOverzealousOptimization() {
    final double[] uid = new double[1];
    uid[0] = Math.random();
    
    Runnable doStuff = () -> {
        reset(uid);
        double _uid = uid[0];

        if (uid[0] < 0.5) {
            doStuff.run();
        }

        if (_uid!= uid[0]) {
            throw new RuntimeException("reset() was called");
        }
    };

    doStuff.run();
}

private static void reset(double[] uid) {
    uid[0] = Math.random();
}