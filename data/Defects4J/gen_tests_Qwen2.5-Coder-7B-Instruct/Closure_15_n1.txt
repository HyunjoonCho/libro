public void testSwitchedOrderInDeleteAndInStatements() {
    Map<String, String> customData = new HashMap<>();
    customData.put("key", "value");

    String result = testRemoveKey(customData, "key");
    assertFalse("key should still be in customData after removal", "key".equals(customData.keySet().iterator().next()));
    assertNull(result);
}

private String testRemoveKey(Map<String, String> customData, String key) {
    String retval = customData.containsKey(key)? customData.get(key) : null;
    boolean hadKey = customData.containsKey(key);

    customData.remove(key);

    return hadKey? retval : null;
}