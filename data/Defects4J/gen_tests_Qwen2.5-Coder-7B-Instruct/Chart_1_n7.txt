import org.jfree.chart.renderer.category.AbstractCategoryItemRenderer;
import org.jfree.chart.plot.CategoryPlot;
import org.jfree.data.category.DefaultCategoryDataset;

import java.awt.Graphics2D;
import java.awt.image.BufferedImage;

public class TestIssue983 {

    public static void main(String[] args) {
        AbstractCategoryItemRenderer renderer = new AbstractCategoryItemRenderer() {
            @Override
            public LegendItemCollection getLegendItems() {
                LegendItemCollection result = new LegendItemCollection();
                CategoryPlot plot = new CategoryPlot();
                setPlot(plot);
                int index = plot.getIndexOf(this);
                CategoryDataset dataset = plot.getDataset(index);
                if (dataset == null) {
                    return result;
                }
                int seriesCount = dataset.getRowCount();
                return result;
            }
        };

        DefaultCategoryDataset dataset = new DefaultCategoryDataset();
        renderer.setDataset(dataset);

        BufferedImage image = new BufferedImage(100, 100, BufferedImage.TYPE_INT_ARGB);
        Graphics2D g2 = image.createGraphics();
        renderer.draw(g2, null, null, null, null);
        g2.dispose();
    }

}