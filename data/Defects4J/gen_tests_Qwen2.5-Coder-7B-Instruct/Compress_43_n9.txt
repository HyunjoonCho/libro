public void testZipLocalCentralVersionMismatch() throws IOException {
    ByteArrayOutputStream baos = new ByteArrayOutputStream();
    try (ZipArchiveOutputStream zaos = new ZipArchiveOutputStream(baos)) {
        ZipArchiveEntry entry = new ZipArchiveEntry("test.txt");
        entry.setSize(0);
        zaos.putArchiveEntry(entry);
        zaos.closeArchiveEntry();
    }

    byte[] bytes = baos.toByteArray();
    ByteBuffer buffer = ByteBuffer.wrap(bytes);

    // Skip over the signature and the file comment
    buffer.position(28);

    // Read the central directory record
    buffer.getInt(); // signature
    int centralDirectoryOffset = buffer.getInt();

    // Go back to the start of the central directory record
    buffer.position(centralDirectoryOffset);

    // Check the version needed to extract in the central directory
    int centralDirectoryVersion = buffer.getShort() & 0xFFFF;

    // Go back to the start of the local file header
    buffer.position(0);

    // Read the local file header record
    buffer.getInt(); // signature
    int compressedSize = buffer.getInt();
    int uncompressedSize = buffer.getInt();
    int fileNameLength = buffer.getShort() & 0xFFFF;
    int extraFieldLength = buffer