public void testTooLargeFirstStep() {
    double[] y0 = { 0.0 };
    double t0 = 0.0;
    double tf = 1e-6;
    DormandPrince853Integrator integrator = new DormandPrince853Integrator(1e-12, 1e6, 1e-12, 1e-12);

    try {
        integrator.integrate(new FirstOrderDifferentialEquations() {
            public int getDimension() {
                return 1;
            }
            public double[] computeDerivatives(double t, double[] y) {
                return new double[] { 1.0 / 0.0 }; // This will cause division by zero
            }
        }, t0, y0, tf, new double[1]);
        fail("An exception should have been thrown");
    } catch (MathIllegalArgumentException e) {
        // Expected exception
    }
}