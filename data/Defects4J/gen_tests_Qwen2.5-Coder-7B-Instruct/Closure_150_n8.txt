public void testTypeCheckerMissesAnnotationsOnFunctionsDefinedWithinFunctions() {
    // Arrange
    String code = 
        "var ns = {};"
      + "(function() {"
      + "/** @param {string=} b */"
      + "ns.a = function(b) {}"
      + "})();"
      + "function d() {"
      + "ns.a();"
      + "ns.a(123);"
      + "}";
    
    // Act & Assert
    try {
        JsCompiler compiler = new JsCompiler();
        compiler.compile(code);
        fail("Expected a warning about type mismatch");
    } catch (JsCompilerException e) {
        assertTrue(e.getMessage().contains("type mismatch"));
    }
}