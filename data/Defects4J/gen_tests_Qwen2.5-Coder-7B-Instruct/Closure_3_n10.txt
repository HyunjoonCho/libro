public void testOptimizationFailsWithVariableInCatchClause() {
    String script = "function getStack() {\n" +
                    "  var getErrorObject = function() {\n" +
                    "    try {\n" +
                    "      throw Error('');\n" +
                    "    } catch(err) {\n" +
                    "      return err;\n" +
                    "    }\n" +
                    "  };\n" +
                    "  return getErrorObject().stack;\n" +
                    "}\n" +
                    "window['getStackTrace'] = getStack;";

    ScriptEngine engine = new ScriptEngineManager().getEngineByName("javascript");
    try {
        engine.eval(script);
        Invocable invocable = (Invocable) engine;
        Object stackTrace = invocable.invokeFunction("getStackTrace");
        assertNotNull(stackTrace);
    } catch (ScriptException | NoSuchMethodException e) {
        fail("Script execution failed: " + e.getMessage());
    }
}