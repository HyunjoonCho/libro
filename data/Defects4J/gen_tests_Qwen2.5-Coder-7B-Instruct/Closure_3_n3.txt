public void testOptimizationFailsWithVariableInCatchClause() {
    String script = "function getStack() {\n" +
                    "    var getErrorObject = function() {\n" +
                    "        try {\n" +
                    "            throw Error('');\n" +
                    "        } catch(err) {\n" +
                    "            return err;\n" +
                    "        }\n" +
                    "    };\n" +
                    "    return getErrorObject().stack;\n" +
                    "}\n" +
                    "window['getStackTrace'] = getStack;";
    
    ScriptEngine engine = new ScriptEngineManager().getEngineByName("JavaScript");
    try {
        engine.eval(script);
        Object getStackTrace = engine.eval("window.getStackTrace()");
        assertNotNull(getStackTrace);
    } catch (ScriptException e) {
        fail("Script execution failed: " + e.getMessage());
    }
}