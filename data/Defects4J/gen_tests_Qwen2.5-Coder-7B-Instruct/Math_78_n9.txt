public void testODEEventDetection() throws Exception {
    // Setup the ODE problem with a switching function that changes sign around t=90 and t=135
    OrdinaryDifferentialEquation ode = new MyODE();
    double[] initialConditions = { /* initial conditions */ };
    double startTime = 67.5;
    double endTime = 153.0;

    // Create and configure the integrator
    Integrator integrator = new DormandPrince853Integrator(1e-12, 1e3, 1e-12, 1e-12);
    integrator.addStepHandler(new StepHandler() {
        public boolean hasNext() {
            return true;
        }

        public StepMonitor nextStep(StepInterpolator interpolator) {
            double time = interpolator.getCurrentTime();
            if (time >= 90 && time <= 135) {
                double value = interpolator.getInterpolatedState()[0];
                System.out.println("Event detected at " + time + " with value " + value);
                return null; // Stop the integration
            }
            return this;
        }
    });

    // Perform the integration
    integrator