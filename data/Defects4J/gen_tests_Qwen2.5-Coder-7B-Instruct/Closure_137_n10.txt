public void testDeterministicTestWarning() {
    // Arrange
    String jsCode = "var t = null; window.test = function(){ if (t!= null) { t = null; } t = 1; };";

    // Act & Assert
    try {
        JsCompiler.compile(jsCode, new InMemoryInputProvider(), new DiagnosticCollector<Error>(true));
        fail("Expected JSC_DETERMINISTIC_TEST warning to be thrown.");
    } catch (CompilationFailedException e) {
        List<Diagnostic<?>> diagnostics = e.getDiagnostics();
        boolean foundWarning = diagnostics.stream()
               .anyMatch(d -> d.getType().equals(DiagnosticType.WARNING) && d.getMessage(Locale.ROOT).contains("JSC_DETERMINISTIC_TEST"));
        assertTrue("Expected JSC_DETERMINISTIC_TEST warning to be present.", foundWarning);
    }
}