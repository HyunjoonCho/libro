public void testBitInputStreamOverflow() throws Exception {
    ByteArrayInputStream in = new ByteArrayInputStream(new byte[] {
        (byte) 0x57, (byte) 0x2d, (byte) 0x42, (byte) 0x0f,
        (byte) 0x5a, (byte) 0x1d, (byte) 0x58, (byte) 0x3d, (byte) 0x21, (byte) 0x4a
    });
    BitInputStream bin = new BitInputStream(in, ByteOrder.LITTLE_ENDIAN);
    long ret1 = bin.readBits(5);
    long ret2 = bin.readBits(63);
    long ret3 = bin.readBits(12);
    assertEquals(23, ret1);
    assertEquals(9223372036854775807L, ret2);
    assertEquals(0, ret3);
}