public void testAssignmentRemoved() {
    String input = "function f() { var a = [], b; a.push(b = []); b[0] = 1; return a; }";
    String expected = "function f(){var a=[];a.push([]);b=[1];return a}";
    assertEquals(expected, compile(input));
}

private String compile(String input) {
    Compiler compiler = new Compiler();
    CompilerOptions options = new CompilerOptions();
    JSSourceFile externs = JSSourceFile.fromCode("externs", "");
    JSSourceFile jsSource = JSSourceFile.fromCode("source", input);
    compiler.compile(externs, jsSource, options);
    if (compiler.hasErrors()) {
        throw new RuntimeException(compiler.toSource());
    }
    return compiler.toSource();
}