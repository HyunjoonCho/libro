public void testLastWarningOrErrorTruncated() throws Exception {
    File inputFile = new File("test.js");
    PrintWriter writer = new PrintWriter(inputFile);
    writer.println("alert(foo);");
    writer.println("alert(bar);");
    writer.close();

    Process process = Runtime.getRuntime().exec(
            "java -jar compiler.jar --warning_level VERBOSE --js " + inputFile.getAbsolutePath());

    String output = IOUtils.toString(process.getInputStream(), StandardCharsets.UTF_8);

    assertTrue(output.contains("variable foo is undefined"));
    assertTrue(output.contains("variable bar is undefined"));
    assertFalse(output.endsWith("^"));
}