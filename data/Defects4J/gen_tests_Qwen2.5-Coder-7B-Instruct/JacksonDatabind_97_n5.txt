import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.databind.SerializationFeature;
import org.junit.Test;

import java.io.IOException;

import static org.junit.Assert.assertEquals;

public class TestCaseTest {

  private static final ObjectMapper mapper = new ObjectMapper();

  @Test
  public void testCustomSerializerWithAttributes() throws IOException {
    mapper.configure(SerializationFeature.FAIL_ON_EMPTY_BEANS, false);

    // Test with HashMap
    String mapOut = mapper.writer()
           .withAttribute("myAttr", "Hello!")
           .writeValueAsString(new HashMap<String, Object>() {{
                put("data", new Data("Hello"));
            }});
    assertEquals("{\"data\":{\"aStr\":\"The value is: Hello!\"}}", mapOut);

    // Test with ObjectNode
    String treeOut = mapper.writer()
           .withAttribute("myAttr", "Hello!")
           .writeValueAsString(mapper.createObjectNode()
                   .putPOJO("data", new Data("Hello")));
    assertEquals("{\"data\":{\"aStr\":\"The value is: Hello!\"}}", treeOut);
  }

  public static class Data {
    public String aStr;

    public Data(String aStr) {
      this.aStr = aStr;
    }
  }
}