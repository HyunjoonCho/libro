public void testW3CDomHelperWithMissingNamespaces() throws Exception {
    String html = "<html><body><div fb:like=\"\"></div></body></html>";
    Document doc = Jsoup.parse(html);
    DOMImplementation domImpl = new DOMImplementationRegistry().getDOMImplementation("XML 1.0");
    DocumentType doctype = domImpl.createDocumentType("html", "-//W3C//DTD XHTML 1.0 Transitional//EN", "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd");
    Document w3cDoc = domImpl.createDocument(doctype.getPublicId(), doctype.getRootElementName(), doctype);
    Element body = w3cDoc.getDocumentElement();
    Node importedNode = w3cDoc.importNode(doc.body(), true);
    body.appendChild(importedNode);
    try {
        W3CDom.toDom(doc);
        fail("Expected NAMESPACE_ERR exception");
    } catch (DOMException e) {
        assertEquals(DOMException.NAMESPACE_ERR, e.code);
    }
}