public void testSubclassDeserialization() throws Exception {
    class MyMultiKey extends MultiKey {
        private static final long serialVersionUID = 1L;
        public MyMultiKey(Object... keys) { super(keys); }
    }

    MyMultiKey original = new MyMultiKey("key1", "key2");
    ByteArrayOutputStream baos = new ByteArrayOutputStream();
    ObjectOutputStream oos = new ObjectOutputStream(baos);
    oos.writeObject(original);
    oos.close();

    ByteArrayInputStream bais = new ByteArrayInputStream(baos.toByteArray());
    ObjectInputStream ois = new ObjectInputStream(bais);
    MyMultiKey deserialized = (MyMultiKey) ois.readObject();
    ois.close();

    assertNotSame(original, deserialized);
    assertEquals(original.getKey(0), deserialized.getKey(0));
    assertEquals(original.getKey(1), deserialized.getKey(1));
}