public void testNullContext() throws Exception {
    ObjectMapper mapper = new ObjectMapper();
    SimpleModule module = new SimpleModule();
    module.addDeserializer(String.class, new JsonDeserializer<String>() {
        @Override
        public String deserialize(JsonParser p, DeserializationContext ctxt) throws IOException, JsonProcessingException {
            return "foo";
        }
    });
    mapper.registerModule(module);

    try {
        mapper.readValue("\"bar\"", String.class);
        fail("Expected NullPointerException");
    } catch (NullPointerException e) {
        // expected
    }
}