public void testUnionTypeCannotBeCastToObjectTypeError() throws Exception {
    String jsCode =
        "function foo(x) { return x; }" +
        "var y = foo({a: 1} | {b: 2});";
    Compiler compiler = new Compiler();
    compiler.initOptions(new CommandLineRunner().getOptionsForCompilation());
    compiler.addExterns(JSDocInfoParser.EXTERNS_JSDOC_INFO);
    compiler.addInputs("test", jsCode, SourceKind.EXTERNAL);
    try {
      compiler.compile();
      fail("Expected ClassCastException");
    } catch (ClassCastException e) {
      assertTrue(e.getMessage().contains("UnionType cannot be cast to ObjectType"));
    }
}