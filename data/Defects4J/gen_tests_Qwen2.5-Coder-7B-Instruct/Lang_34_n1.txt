public void testThreadLocalMemoryLeak() throws Exception {
    // Trigger loading of ToStringStyle
    ToStringStyle style = ToStringStyle.SHORT_PREFIX_STYLE;

    // Simulate webapp reload by clearing ThreadLocal cache
    Field field = ToStringStyle.class.getDeclaredField("threadLocal");
    field.setAccessible(true);
    ((ThreadLocal) field.get(null)).remove();

    // Verify that the ThreadLocal has been cleared
    assertNull(((ThreadLocal) field.get(null)).get());
}