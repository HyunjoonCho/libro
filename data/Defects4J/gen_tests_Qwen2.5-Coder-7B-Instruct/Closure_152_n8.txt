public void testResolveTypes() {
  // Arrange
  String jsCode = "function foo(x) { return x; }";
  Compiler compiler = new Compiler();
  compiler.initLogger(new PrintStream(System.err));
  List<SourceFile> sources = ImmutableList.of(SourceFile.fromCode("test", jsCode));

  // Act & Assert
  try {
    compiler.compile(sources, ImmutableList.<SourceFile>of(), new CompilerOptions());
    fail("Expected ClassCastException");
  } catch (ClassCastException e) {
    assertTrue(e.getMessage().contains("UnionType cannot be cast to ObjectType"));
  }
}