public void testCastingFunctionBeforeCallingIt() {
    Object obj = new ActiveXObject("ShockwaveFlash.ShockwaveFlash");
    Method getVariableMethod = obj.getClass().getMethod("GetVariable", String.class);
    Function<String, String> func = (Function<String, String>) getVariableMethod::invoke;
    try {
        func.apply("$version");
        fail("Expected exception not thrown");
    } catch (Exception e) {
        // Expected exception
    }
}