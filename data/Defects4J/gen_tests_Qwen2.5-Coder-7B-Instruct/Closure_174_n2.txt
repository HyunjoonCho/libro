public void testCompilerCrashOnGoogScopeLocals() {
    String sourceCode = 
        "goog.provide('main');\n" +
        "goog.scope(function (){\n" +
        " var a = foo, b, c = 1;\n" +
        "});";
    
    try {
        Compiler.compile(sourceCode);
        fail("Expected compiler to throw an exception");
    } catch (Exception e) {
        assertTrue(e.getMessage().contains("error"));
    }
}