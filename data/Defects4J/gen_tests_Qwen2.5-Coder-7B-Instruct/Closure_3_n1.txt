public void testOptimizationFailsWithVariableInCatchClause() {
    // Arrange
    ScriptEngine engine = new ScriptEngineManager().getEngineByName("nashorn");
    String script = "function getStack() {\n" +
                    "    var getErrorObject = function() {\n" +
                    "        try {\n" +
                    "            throw Error('');\n" +
                    "        } catch(err) {\n" +
                    "            return err;\n" +
                    "        }\n" +
                    "    };\n" +
                    "    return getErrorObject().stack;\n" +
                    "}\n" +
                    "window['getStackTrace'] = getStack;";
    
    // Act
    engine.eval(script);
    Invocable invocable = (Invocable) engine;
    Object stackTrace = invocable.invokeFunction("getStackTrace");

    // Assert
    assertNotNull(stackTrace);
}