public void testExcelIgnoreEmptyHeaders() throws Exception {
    String csv = "A,B,C,,\na,b,c,d,e";
    Reader reader = new StringReader(csv);
    try {
        CSVParser parser = new CSVParser(reader, CSVFormat.EXCEL.withFirstRecordAsHeader());
        fail("Expected IllegalArgumentException");
    } catch (IllegalArgumentException e) {
        assertTrue(e.getMessage().contains("duplicate name"));
    }
}