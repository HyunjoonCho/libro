public void testArgumentCaptorForVarargs() {
    List<String> list = mock(List.class);
    ArgumentCaptor<String[]> captor = ArgumentCaptor.forClass(String[].class);

    list.addAll(Arrays.asList("a", "b", "c"));

    verify(list).addAll(captor.capture());

    String[] capturedArray = captor.getValue();
    assertNotNull(capturedArray);
    assertEquals(3, capturedArray.length);
    assertEquals("a", capturedArray[0]);
    assertEquals("b", capturedArray[1]);
    assertEquals("c", capturedArray[2]);
}