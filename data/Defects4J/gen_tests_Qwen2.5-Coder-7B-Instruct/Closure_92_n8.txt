public void testImplicitNamespacesAcrossModules() throws Exception {
    String moduleAContent =
        "goog.provide('apps');\n" +
        "goog.require('apps.foo.bar.B');";
    String moduleBContent =
        "goog.provide('apps.foo.bar.B');";
    String moduleCContent =
        "goog.provide('apps.foo.bar.C');";

    File tempDir = Files.createTempDirectory("test").toFile();
    try {
        File moduleA = new File(tempDir, "module_a.js");
        Files.write(moduleA.toPath(), moduleAContent.getBytes());

        File moduleB = new File(tempDir, "module_b.js");
        Files.write(moduleB.toPath(), moduleBContent.getBytes());

        File moduleC = new File(tempDir, "module_c.js");
        Files.write(moduleC.toPath(), moduleCContent.getBytes());

        ProcessBuilder pb = new ProcessBuilder(
            "java", "-jar", "closure-compiler.jar",
            "--js", moduleA.getPath(),
            "--js", moduleB.getPath(),
            "--js", moduleC.getPath(),
            "--compilation_level", "SIMPLE_OPTIMIZATIONS");
        Process process = pb.start();

        int exitCode = process.waitFor();