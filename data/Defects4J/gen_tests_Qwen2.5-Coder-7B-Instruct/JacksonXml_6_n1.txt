public void testWriteBinaryWithInputStream() throws Exception {
    ByteArrayOutputStream out = new ByteArrayOutputStream();
    ToXmlGenerator generator = new ToXmlGenerator(out);

    InputStream inputStream = new ByteArrayInputStream(new byte[]{0x01, 0x02, 0x03});
    generator.writeBinary(null, inputStream, 3);

    String xml = out.toString();
    assertTrue(xml.contains("<binary>AGIA</binary>")); // Base64 encoded representation of {0x01, 0x02, 0x03}
}