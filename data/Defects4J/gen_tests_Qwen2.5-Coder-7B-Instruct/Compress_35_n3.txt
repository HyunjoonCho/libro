public void testTarChecksum() throws Exception {
    // Arrange
    String tarEntryContent = "file content";
    int correctChecksum = calculateCorrectChecksum(tarEntryContent);

    // Simulate a tar entry with right-aligned checksum
    String rightAlignedChecksum = String.format("%06d", correctChecksum) + "   ";
    byte[] tarEntryBytes = (tarEntryContent + rightAlignedChecksum).getBytes();

    // Act
    TarArchiveInputStream tarIn = new TarArchiveInputStream(new ByteArrayInputStream(tarEntryBytes));
    TarArchiveEntry entry = tarIn.getNextTarEntry();
    int actualChecksum = tarIn.read();

    // Assert
    assertEquals(correctChecksum, actualChecksum);
}

private int calculateCorrectChecksum(String content) {
    int sum = 0;
    for (char c : content.toCharArray()) {
        sum += c & 0xFF;
    }
    return sum;
}