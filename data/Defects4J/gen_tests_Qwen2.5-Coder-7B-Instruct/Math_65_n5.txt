public void testWeightVersusSigma() {
    double[] weights = {1.0, 2.0};
    double[] residuals = {1.0, 1.0};
    AbstractLeastSquares leastSquares = new AbstractLeastSquares() {
        @Override
        protected double[] getResiduals(double[] point) {
            return residuals;
        }

        @Override
        protected double[] getJacobian(double[] point) {
            return new double[0];
        }

        @Override
        protected int getObservationsCount() {
            return weights.length;
        }
    };
    leastSquares.residualsWeights(weights);
    double rms = leastSquares.getRMS();
    double expectedRms = Math.sqrt((Math.pow(residuals[0], 2) + Math.pow(residuals[1], 2)) / (weights[0] + weights[1]));
    assertEquals(expectedRms, rms, 0.0001);
}