import org.apache.commons.compress.archivers.tar.TarArchiveEntry;
import org.apache.commons.compress.archivers.tar.TarArchiveOutputStream;

import java.io.ByteArrayOutputStream;
import java.io.IOException;

public class TarArchiveOutputStreamTest {

    @Test
    public void testBytesWritten() throws IOException {
        ByteArrayOutputStream baos = new ByteArrayOutputStream();
        TarArchiveOutputStream tao = new TarArchiveOutputStream(baos);

        TarArchiveEntry entry = new TarArchiveEntry("testfile.txt");
        entry.setSize(1024);
        tao.putArchiveEntry(entry);

        byte[] data = new byte[1024];
        tao.write(data);

        tao.closeArchiveEntry();
        tao.finish();
        tao.close();

        long bytesWritten = tao.getBytesWritten();
        assertEquals(1024L, bytesWritten); // Header size is not included in this calculation
    }

}