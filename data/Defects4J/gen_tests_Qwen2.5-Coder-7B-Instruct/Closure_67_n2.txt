public void testAdvancedCompilationFailure() {
    Function<?> func1 = new Function<Object, Object>() {
        @Override
        public Object apply(Object input) {
            ((MyClass) input)._x = 2;
            return ((MyClass) input).func2();
        }
    };

    MyClass obj = new MyClass();
    obj._x = 1;
    obj.func1 = func1;

    assertEquals(3, obj.func1.apply(obj));
}

class MyClass {
    int _x;

    Function<?,?> func1;

    Object func2() {
        _x = 3;
        return null;
    }
}