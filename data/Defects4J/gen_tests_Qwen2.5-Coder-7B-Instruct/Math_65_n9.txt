public void testWeightVersusSigma() {
    // Arrange
    double[] residuals = {1.0, 2.0, 3.0};
    double[] weights = {0.5, 1.0, 2.0};
    LeastSquaresProblem problem = mock(LeastSquaresProblem.class);
    when(problem.getResiduals()).thenReturn(residuals);
    when(problem.getObservations()).thenReturn(new WeightedObservedPoints(weights));
    
    AbstractLeastSquares leastSquares = new AbstractLeastSquares(problem) {};
    
    // Act
    double rms = leastSquares.getRMS();
    
    // Assert
    assertEquals(Math.sqrt((Math.pow(1.0, 2) * 0.5 + Math.pow(2.0, 2) * 1.0 + Math.pow(3.0, 2) * 2.0) / 3.0), rms, 0.0001);
}