public void testOptimization() {
    String input = "var a=[\"constant\",confirm(\"value from user\")];alert(a.join(\",\"));";
    String expectedOutput = "var a=[\"constant\",confirm(\"value from user\")];alert(a.join());";
    String actualOutput = compile(input, CompilationLevel.ADVANCED_OPTIMIZATIONS);
    assertEquals(expectedOutput, actualOutput);
}

private String compile(String input, CompilationLevel level) {
    Compiler compiler = new Compiler();
    CompilerOptions options = new CompilerOptions();
    level.setOptionsForCompilationLevel(options);
    Result result = compiler.compile(SourceFile.fromCode("test.js", input), null, options);
    return result.success? compiler.toSource() : input;
}