public void testWrongResultInEigenDecomposition() throws Exception {
    double[] mainDiagonal = {1, 2};
    double[] offDiagonal = {3, 4};

    EigenDecomposition decomposition = new EigenDecompositionImpl(mainDiagonal, offDiagonal, MathUtils.SAFE_MIN);

    double[][] expectedEigenvectors = {{1, 1}, {1, -1}};
    double[] expectedEigenvalues = {5, -1};

    double[][] actualEigenvectors = decomposition.getV().getData();
    double[] actualEigenvalues = decomposition.getRealEigenvalues();

    for (int i = 0; i < expectedEigenvalues.length; i++) {
        assertEquals(expectedEigenvalues[i], actualEigenvalues[i], 1e-6);
        for (int j = 0; j < expectedEigenvectors[0].length; j++) {
            assertEquals(expectedEigenvectors[i][j], actualEigenvectors[i][j], 1e-6);
        }
    }
}