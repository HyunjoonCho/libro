public void testAdvancedOptimizationsBug() throws Exception {
    String inputJS = 
        "window['anchor'] = function(obj, modifiesProp) {\n" +
        "  return (function(saved) {\n" +
        "    return modifiesProp(obj) + saved;\n" +
        "  })(obj['prop']);\n" +
        "}\n";

    String expectedOutputJS =
        "window.foo=function(a,b){var HOLD=a.prop;return b(a)+HOLD};\n";

    // Run the compiler with ADVANCED_OPTIMIZATIONS
    CompilerOptions options = new CompilerOptions();
    options.setCompilationLevel(CompilationLevel.ADVANCED_OPTIMIZATIONS);
    options.setWarningLevel(Diagnostic.Kind.ERROR);

    List<String> inputs = Arrays.asList(inputJS);
    List<CompilerInput> inputList = new ArrayList<>();
    for (String input : inputs) {
      inputList.add(new JsAstRoot(new SourceFile("input.js", input)));
    }

    InMemorySource outputSource = new InMemorySource("output.js");
    List<CompilerInput> outputList = Collections.singletonList(
        new JsAstRoot(outputSource));

    Compiler compiler = new Compiler();
    compiler.init(options, null