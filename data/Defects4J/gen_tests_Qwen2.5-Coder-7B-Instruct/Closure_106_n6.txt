public void testCollapsePropertiesException() throws IOException {
    String jsCode = "var obj = {}; goog.exportSymbol('obj', obj);";
    Compiler compiler = new Compiler();
    compiler.initLogging(System.err);
    compiler.setLanguageLevel(LanguageMode.ECMASCRIPT5);
    compiler.addInput(null, jsCode, InputId.UNKNOWN_PATH);
    try {
      compiler.compile(new CompilerOptions(), new DiagnosticCollector<ErrorReport>() {});
      fail("Expected IllegalArgumentException");
    } catch (IllegalArgumentException e) {
      // Expected exception
    }
}