public void testCastingFunctionBeforeCalling() {
    Object obj = new ActiveXObject("ShockwaveFlash.ShockwaveFlash");
    Function<String, String> func = (Function<String, String>) (Object) obj.getClass().getMethod("GetVariable").invoke(obj, "$version");
    assertThrows(ClassCastException.class, () -> func.apply(null));
}