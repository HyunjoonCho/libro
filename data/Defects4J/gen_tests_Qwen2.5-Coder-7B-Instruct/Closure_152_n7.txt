public void testResolveTypesFailsOnUnionType() throws Exception {
    String js = "function foo(x) { return x; }";
    try {
        Compiler compiler = new Compiler();
        compiler.initOptions(new CommandLineRunner());
        compiler.setWarningLevel(DiagnosticGroups.CHECK_TYPES, CheckLevel.ERROR);
        compiler.setLanguageIn(LanguageMode.ECMASCRIPT_5);
        compiler.setLanguageOut(LanguageMode.ECMASCRIPT_5);
        compiler.addInput("test", js);
        compiler.compile();
        fail("Expected ClassCastException");
    } catch (ClassCastException e) {
        // expected
    }
}