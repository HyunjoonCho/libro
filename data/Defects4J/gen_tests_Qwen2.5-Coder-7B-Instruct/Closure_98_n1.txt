public void testBadVariableInliningInClosure() {
    StringBuilder result = new StringBuilder();
    JavaScriptExecutor executor = (JavaScriptExecutor) driver;
    executor.executeScript("function foo() { " +
            "var arr = [1, 2, 3, 4, 5]; " +
            "for (var i = 0, l = arr.length; i < l; i++) { " +
            "var j = arr[i]; " +
            "(function() { " +
            "var k = j; " +
            "setTimeout(function() { " +
            "result += k + ','; " +
            "}, 0); " +
            "})(); " +
            "} " +
            "} " +
            "foo();", result);

    String expected = "1,2,3,4,5,";
    assertEquals(expected, result.toString());
}