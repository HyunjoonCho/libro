public void testCannotReturnDeepStubsFromGenericMethodThatReturnsGenericType() {
    InterfaceWithGenericMethod iface = mock(InterfaceWithGenericMethod.class, RETURNS_DEEP_STUBS);

    try {
        when(iface.genericMethod(String.class).get());
        fail();
    } catch (ClassCastException e) {
        // expected
    }
}