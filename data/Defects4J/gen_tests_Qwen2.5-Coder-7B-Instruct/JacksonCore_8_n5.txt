public void testInconsistentTextBufferBehavior() {
    TextBuffer buffer = new TextBuffer(new BufferRecycler());
    buffer.resetWithEmpty();

    assertNull(buffer.getTextBuffer());
    assertEquals("", buffer.contentsAsString());

    Object result = buffer.getTextBuffer();
    assertTrue(result instanceof char[]);
    assertEquals(0, ((char[])result).length);
}