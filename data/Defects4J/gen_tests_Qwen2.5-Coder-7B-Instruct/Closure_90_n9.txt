public void testThisTypedefWarning() {
    // Arrange
    String jsCode = "goog.provide('bug');\n" +
                    "/**\n" +
                    "* @this {bug.Thing}\n" +
                    "*/\n" +
                    "bug.sharedMethod = function() {};\n" +
                    "\n" +
                    "/**\n" +
                    "* @constructor\n" +
                    "*/\n" +
                    "bug.A = function() {};\n" +
                    "\n" +
                    "/**\n" +
                    "* @constructor\n" +
                    "*/\n" +
                    "bug.B = function() {};\n" +
                    "\n" +
                    "/**\n" +
                    "* @type {bug.A|bug.B}\n" +
                    "*/\n" +
                    "bug.Thing = goog.typedef;";

    // Act
    Compiler compiler = new Compiler();
    compiler.initCompilerOptions();
    compiler.setLanguageIn(LanguageMode.ECMASCRIPT_5);
    compiler.setLanguageOut(LanguageMode.ECMASCRIPT_5);
    compiler.compile(new SourceFile("test.js", CharSource.fromString(jsCode)), null);

    // Assert