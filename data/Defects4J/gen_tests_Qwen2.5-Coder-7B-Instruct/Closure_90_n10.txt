public void testCompilerWarning() throws Exception {
    String source = "goog.provide('bug');\n" +
                    "/**\n" +
                    " * @this {bug.Thing}\n" +
                    " */\n" +
                    "bug.sharedMethod = function() {};\n" +
                    "\n" +
                    "/**\n" +
                    " * @constructor\n" +
                    " */\n" +
                    "bug.A = function() {};\n" +
                    "\n" +
                    "/**\n" +
                    " * @constructor\n" +
                    " */\n" +
                    "bug.B = function() {};\n" +
                    "\n" +
                    "/**\n" +
                    " * @type {bug.A|bug.B}\n" +
                    " */\n" +
                    "bug.Thing = goog.typedef;\n";
    
    Compiler compiler = new Compiler();
    compiler.initLogging(null);
    compiler.setLanguageIn(LanguageMode.ECMASCRIPT_2015);
    compiler.setLanguageOut(LanguageMode.ECMASCRIPT_2015);
    compiler.compile(new JSSourceFile("test", source));

    List<Diagnostic>