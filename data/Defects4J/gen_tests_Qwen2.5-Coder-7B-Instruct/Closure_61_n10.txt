public void testClosureRemovesNeededCode() {
    String jsCode = 
        "Math.blah = function(test) { test.a = 5; };" +
        "var test = {};" +
        "Math.blah(test);";
    Compiler compiler = new Compiler();
    CompilerOptions options = new CompilerOptions();
    Result result = compiler.compile(new JSSourceFile("test.js", jsCode.toCharArray()), null, options);
    assertFalse(result.errors.length > 0);
    assertTrue(jsCode.equals(compiler.toSource()));
}