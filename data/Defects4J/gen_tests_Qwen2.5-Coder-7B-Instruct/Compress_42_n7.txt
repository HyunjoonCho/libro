import org.apache.commons.compress.archivers.zip.ZipArchiveEntry;
import org.apache.commons.compress.archivers.zip.ZipFile;

import java.io.File;
import java.io.IOException;
import java.util.Iterator;

public class TestIsUnixSymlink {

    @Test
    public void testIsUnixSymlinkForInvalidEntry() throws IOException {
        try (ZipFile zipFile = new ZipFile(new File("invalid-entry.jar"))) {
            Iterator<ZipArchiveEntry> entries = zipFile.getEntriesInPhysicalOrder();
            while (entries.hasNext()) {
                ZipArchiveEntry entry = entries.next();
                if ("META-INF/maven/".equals(entry.getName())) {
                    assertFalse(entry.isUnixSymlink());
                    assertEquals(65535, entry.getUnixMode());
                } else if ("META-INF/".equals(entry.getName())) {
                    assertFalse(entry.isUnixSymlink());
                    assertEquals(16877, entry.getUnixMode());
                }
            }
        }
    }

}