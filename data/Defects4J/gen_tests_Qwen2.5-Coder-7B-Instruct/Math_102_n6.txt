public void testChiSquareWithRescaling() {
    double[] expected = {485, 541, 82, 61, 37};
    long[] observed = {500, 623, 72, 70, 31};

    // Calculate the expected values based on the observed values
    double sumObserved = Arrays.stream(observed).mapToDouble(i -> i).sum();
    double sumExpected = Arrays.stream(expected).mapToDouble(i -> i).sum();
    double scalingFactor = sumObserved / sumExpected;
    double[] expectedRescaled = Arrays.stream(expected).map(i -> i * scalingFactor).toArray();

    // Perform the chi-square test with the rescaled expected values
    double chiSquareValue = new ChiSquareTestImpl().chiSquare(expectedRescaled, observed);

    // Compare the calculated chi-square value with the expected value
    assertEquals("chi-square test statistic", 9.0233, chiSquareValue, 1E-4);
}