import org.apache.commons.compress.archivers.zip.ZipArchiveEntry;
import org.apache.commons.compress.archivers.zip.ZipFile;

import java.io.File;
import java.io.IOException;
import java.util.Enumeration;

public class TestIsUnixSymlink {

    @Test
    public void testIsUnixSymlinkForInvalidEntry() throws IOException {
        try (ZipFile zipFile = new ZipFile(new File("invalid-entry.jar"))) {
            Enumeration<ZipArchiveEntry> entries = zipFile.getEntries();
            while (entries.hasMoreElements()) {
                ZipArchiveEntry entry = entries.nextElement();
                if ("META-INF/maven/".equals(entry.getName())) {
                    assertFalse(entry.isUnixSymlink());
                    assertEquals(65535, entry.getUnixMode());
                    break;
                }
            }
        }
    }
}