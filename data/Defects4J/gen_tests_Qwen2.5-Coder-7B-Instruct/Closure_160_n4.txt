public void testCheckVarsAndUndefinedVarsDiagnostics() {
    String jsCode = "foo = {};\n" +
                    "foo.bar = function() { alert(this.baz); };";

    List<String> args = Arrays.asList("--js", "test.js");

    // Test without checkVars and undefinedVars warnings
    CompilerOptions optionsWithoutChecks = new CompilerOptions();
    optionsWithoutChecks.setWarningLevel(DiagnosticGroups.CHECK_VARS, CheckLevel.OFF);
    optionsWithoutChecks.setWarningLevel(DiagnosticGroups.UNDEFINED_VARS, CheckLevel.OFF);
    Result resultWithoutChecks = compileWithArgs(args, optionsWithoutChecks);
    assertTrue(resultWithoutChecks.successful());

    // Test with globalThis warning
    CompilerOptions optionsWithGlobalThis = new CompilerOptions();
    optionsWithGlobalThis.setWarningLevel(DiagnosticGroups.GLOBAL_THIS, CheckLevel.WARNING);
    Result resultWithGlobalThis = compileWithArgs(args, optionsWithGlobalThis);
    assertFalse(resultWithGlobalThis.successful());
    assertTrue(resultWithGlobalThis.hasErrorsOrWarnings());
    assertTrue(resultWithGlobalThis.hasWarnings());

    // Test with checkVars warning
    CompilerOptions optionsWithCheckVars = new CompilerOptions();
    optionsWithCheckVars.setWarningLevel