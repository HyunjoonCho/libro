public void testBadTypeInference() {
  Function<String, Void> f = new Function<String, Void>() {
    public Void apply(String x) {
      if (x!= null) {
        return null;
      }
      return null;
    }
  };
  try {
    f.apply(null);
    fail();
  } catch (NullPointerException e) {
    // Expected
  }
}