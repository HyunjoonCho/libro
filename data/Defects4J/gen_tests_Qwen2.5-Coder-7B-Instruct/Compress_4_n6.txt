public void testFinishMethod() throws IOException {
    try (ArchiveOutputStream aos = new ZipArchiveOutputStream(new ByteArrayOutputStream())) {
        // Add some entries to the archive
        aos.putArchiveEntry(new ZipArchiveEntry("test.txt"));
        aos.write("Hello, World!".getBytes());
        aos.closeArchiveEntry();
        
        // Call the finish() method manually
        ReflectionTestUtils.invokeMethod(aos, "finish");
        
        fail("Expected IllegalStateException to be thrown");
    } catch (IllegalStateException e) {
        // Expected exception
    }
}