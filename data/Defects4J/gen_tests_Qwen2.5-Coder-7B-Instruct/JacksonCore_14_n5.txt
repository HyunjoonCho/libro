public void testRelaxOwnershipChecksForBuffersNotToRequireIncreaseInSize() throws Exception {
    ByteArrayOutputStream out = new ByteArrayOutputStream();
    IOContext context = IOContext.builder().build();
    byte[] initialBuffer = new byte[1024];
    int bytesWritten = out.write(initialBuffer);
    ByteBuffer buffer = ByteBuffer.wrap(out.toByteArray());
    ByteBuffer resultBuffer = context.copyBytes(buffer, 0, bytesWritten, false);
    assertTrue(resultBuffer.hasArray());
    assertArrayEquals(initialBuffer, resultBuffer.array());
}