public void testArrayJoinOptimization() throws Exception {
    String input = 
        "var a = ['constant', confirm('value from user')];\n" +
        "alert(a.join(','));";
    String expectedOutput =
        "var a=['constant',confirm('value from user')];\n" +
        "alert(a.join());";

    Compiler compiler = new Compiler();
    CompilerOptions options = new CompilerOptions();
    options.setOptimizationLevel(CompilationLevel.ADVANCED_OPTIMIZATIONS);

    Result result = compiler.compile(SourceFile.fromCode("test.js", input), null, options);
    assertTrue(result.success);
    assertEquals(expectedOutput, compiler.toSource());
}