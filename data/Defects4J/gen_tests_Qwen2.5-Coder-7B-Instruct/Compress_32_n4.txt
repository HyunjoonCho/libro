public void testTarArchiveInputStreamRejectsUidOrGidAbove0x80000000() throws IOException {
    byte[] data = new byte[512];
    ByteBuffer buffer = ByteBuffer.wrap(data);

    // Create a fake tar entry with a UID/GID above 0x80000000
    buffer.putInt(0); // File type and permissions
    buffer.putShort((short) 0); // Hard link count
    buffer.putInt(0); // User ID
    buffer.putInt(0x80000001); // Group ID
    buffer.putInt(0); // Size
    buffer.putInt(0); // Modification time
    buffer.putInt(0); // Checksum
    buffer.put((byte) 0); // Type flag
    buffer.put(new byte[100]); // Filename
    buffer.put((byte) 0); // Null terminator

    ByteArrayInputStream bais = new ByteArrayInputStream(data);
    TarArchiveInputStream tais = new TarArchiveInputStream(bais);

    try {
        tais.getNextTarEntry();
        fail("Expected NumberFormatException");
    } catch (NumberFormatException e) {
        // Expected exception
    }

    tais.close