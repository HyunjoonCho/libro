public void testCVE_2018_7489() throws Exception {
    ObjectMapper mapper = new ObjectMapper();
    String payload = "{\"value\":{}}";
    try {
        mapper.readValue(payload, MyClass.class);
        fail("Expected exception not thrown");
    } catch (JsonMappingException e) {
        assertTrue(e.getMessage().contains("Illegal type"));
    }
}

class MyClass {
    @JsonTypeInfo(use = JsonTypeInfo.Id.CLASS, include = JsonTypeInfo.As.PROPERTY, property = "@class")
    public Object value;
}