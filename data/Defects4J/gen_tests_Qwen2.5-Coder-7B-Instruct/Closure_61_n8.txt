public void testClosureRemovesNeededCode() {
    String input = 
      "Math.blah = function(test) { test.a = 5; };" +
      "var test = new Object();" +
      "Math.blah(test);";
    String expectedOutput = 
      "Math.blah=function(a){a.a=5};" +
      "var test={a:5};"; // Expected output after optimization

    Compiler compiler = new Compiler();
    CompilerOptions options = new CompilerOptions();
    options.setCodingConvention(new CodingConventions.Default());
    compiler.compile(SourceFile.fromCode("test.js", input),
                    SourceFile.fromCode("out.js", ""),
                    options);

    assertEquals(expectedOutput, compiler.toSource());
}