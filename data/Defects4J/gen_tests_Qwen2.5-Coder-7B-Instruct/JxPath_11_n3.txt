public void testIncompleteHandlingOfUndefinedNamespaces() throws Exception {
    String xml = "<root xmlns:A=\"http://example.com/A\" xmlns:B=\"http://example.com/B\">"
               + "  <ElementA A:myAttr=\"Mytype\">"
               + "    <B:ElementB>MY VALUE</B:ElementB>"
               + "  </ElementA>"
               + "</root>";

    DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
    DocumentBuilder builder = factory.newDocumentBuilder();
    Document document = builder.parse(new InputSource(new StringReader(xml)));

    DOMModel model = new DOMModel(document.getDocumentElement());

    try {
        model.getAttribute("A", "myAttr");
        fail("Expected NamespaceException");
    } catch (NamespaceException e) {
        // Expected exception
    }

    ((DOMModel) model.getChild(0)).registerNamespace("A", "http://example.com/A");

    assertEquals("Mytype", model.getAttribute("A", "myAttr"));
}