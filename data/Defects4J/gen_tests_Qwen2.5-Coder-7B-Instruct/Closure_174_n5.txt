public void testCompilerCrashOnGoogScopeLocals() {
    String sourceCode = 
        "goog.provide('main');" + 
        "goog.scope(function (){" + 
        "  var a = foo, b, c = 1;" + 
        "});";
    
    try {
        JavaScriptCompiler.compile(sourceCode);
        fail("Expected compilation to throw exception");
    } catch (JavaScriptException e) {
        assertTrue(e.getMessage().contains("Error parsing goog.scope"));
    }
}