public void testArgumentCaptorNoLongerWorkingForVarargs() {
    // Given
    MyClass myClass = mock(MyClass.class);

    // When
    myClass.doSomethingWithVarargs(1, 2, 3);

    // Then
    ArgumentCaptor<Integer> captor = ArgumentCaptor.forClass(Integer.TYPE);
    verify(myClass).doSomethingWithVarargs(captor.capture(), captor.capture(), captor.capture());
    List<Integer> capturedValues = captor.getAllValues();
    assertEquals(3, capturedValues.size());
    assertEquals(1, (int)capturedValues.get(0));
    assertEquals(2, (int)capturedValues.get(1));
    assertEquals(3, (int)capturedValues.get(2));
}