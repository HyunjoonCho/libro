public void testIssueIncorrectOutput() throws Exception {
    String input = 
        "var foo = function bar(){\n" +
        "  var bar;\n" +
        "  alert(bar)\n" +
        "};";
    String expected = 
        "var foo = function() {\n" +
        "  alert(void 0)\n" +
        "};";
    String actual = compile(input);
    assertEquals(expected, actual);
}

private String compile(String input) throws Exception {
    URL url = new URL("http://closure-compiler.appspot.com/home");
    HttpURLConnection conn = (HttpURLConnection)url.openConnection();
    conn.setDoOutput(true);
    conn.setRequestMethod("POST");
    conn.setRequestProperty("Content-Type", "application/x-www-form-urlencoded");

    OutputStream os = conn.getOutputStream();
    os.write(("js_code=" + URLEncoder.encode(input, "UTF-8")).getBytes());
    os.write(("compilation_level=SIMPLE_OPTIMIZATIONS").getBytes());
    os.close();

    InputStream is = conn.getInputStream();
    BufferedReader reader = new BufferedReader(new InputStreamReader(is));
    StringBuilder sb = new StringBuilder();
    String line;
    while ((line = reader.readLine())!= null) {
        sb.append(line);
    }