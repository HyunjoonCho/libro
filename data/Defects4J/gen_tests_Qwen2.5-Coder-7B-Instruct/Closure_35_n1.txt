public void testAssignmentToObjectInConditionalCausesTypeErrorOnFunctionWithRecordTypeReturnType() {
    Object result = func(true, false);
    assertTrue(result instanceof Map);
    assertTrue(((Map<?,?>)result).containsKey("prop1"));
    assertFalse(((Map<?,?>)result).containsKey("prop2"));
    assertTrue(((Map<?,?>)result).containsKey("prop3"));

    result = func(false, true);
    assertTrue(result instanceof Map);
    assertFalse(((Map<?,?>)result).containsKey("prop1"));
    assertTrue(((Map<?,?>)result).containsKey("prop2"));
    assertFalse(((Map<?,?>)result).containsKey("prop3"));

    result = func(true, true);
    assertTrue(result instanceof Map);
    assertTrue(((Map<?,?>)result).containsKey("prop1"));
    assertTrue(((Map<?,?>)result).containsKey("prop2"));
    assertFalse(((Map<?,?>)result).containsKey("prop3"));
}