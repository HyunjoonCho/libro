public void testTypeAliasesInAnnotations() throws Exception {
    String source = "package test;\n" +
                   "\n" +
                   "import com.google.common.base.Objects;\n" +
                   "\n" +
                   "public class Test {\n" +
                   "  public static class Bar {}\n" +
                   "  public static class Foo {\n" +
                   "    private Bar bar;\n" +
                   "    public Foo(Bar bar) { this.bar = bar; }\n" +
                   "  }\n" +
                   "}\n";

    JavaFileObject file = new JavaSourceFromString("test.Test", source);

    JavaCompiler compiler = ToolProvider.getSystemJavaCompiler();
    StandardJavaFileManager standardFileManager = compiler.getStandardFileManager(null, null, null);
    Iterable<? extends JavaFileObject> compilationUnits = Collections.singletonList(file);

    boolean success = compiler.getTask(null, standardFileManager, null, null, null, compilationUnits).call();
    assertFalse(success);
}