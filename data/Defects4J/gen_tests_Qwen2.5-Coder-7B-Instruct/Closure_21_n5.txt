public void testClassifyNonRightmostExpressions() {
    // Test case 1
    Expression expr1 = new CommaExpression(Arrays.asList(
        new ConstantExpression(1),
        new ConstantExpression(2),
        new ConstantExpression(42)
    ));
    List<Expression> problematicExprs1 = classifyProblematicExpressions(expr1);
    assertEquals(1, problematicExprs1.size());
    assertTrue(problematicExprs1.contains(expr1.getExpressions().get(0)));

    // Test case 2
    Expression expr2 = new CommaExpression(Arrays.asList(
        new MethodCallExpression(new VariableExpression("bar"), Collections.emptyList()),
        new ConstantExpression(2),
        new ConstantExpression(42)
    ));
    List<Expression> problematicExprs2 = classifyProblematicExpressions(expr2);
    assertEquals(1, problematicExprs2.size());
    assertTrue(problematicExprs2.contains(expr2.getExpressions().get(0)));

    // Test case 3
    Expression expr3 = new CommaExpression(Arrays.asList(
        new CommaExpression(Arrays.asList(
            new ConstantExpression(1),
            new ConstantExpression(2),
            new ConstantExpression(3)
        )),
        new CommaExpression(Arrays.asList(
            new ConstantExpression