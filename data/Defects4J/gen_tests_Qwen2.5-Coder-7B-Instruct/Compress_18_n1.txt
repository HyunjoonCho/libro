public void testTarArchiveWithLongDirectoryName() throws IOException {
    File file = new File("target/test-classes/tar-with-long-directory-name.tar");
    try (TarArchiveOutputStream tarOut = new TarArchiveOutputStream(new FileOutputStream(file))) {
        String longDirName = "layers/openstreetmap_osm.disy.net/_tiles/1.0.0/openstreetmap_osm.disy.net/default/";
        TarArchiveEntry dirEntry = new TarArchiveEntry(longDirName, TarArchiveEntry.DIR_FLAG);
        dirEntry.setSize(0); // This line is problematic as it sets the size to 0
        tarOut.putArchiveEntry(dirEntry);
        tarOut.closeArchiveEntry();
    }

    try (TarArchiveInputStream tarIn = new TarArchiveInputStream(new FileInputStream(file))) {
        TarArchiveEntry entry;
        while ((entry = tarIn.getNextTarEntry())!= null) {
            if (!entry.isDirectory()) {
                fail("Unexpected non-directory entry: " + entry.getName());
            }
        }
    }
}