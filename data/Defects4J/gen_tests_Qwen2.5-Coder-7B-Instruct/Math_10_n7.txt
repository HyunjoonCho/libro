public void testDerivativeStructureAtan2SpecialCases() {
    double[] yValues = {Double.POSITIVE_INFINITY, Double.NEGATIVE_INFINITY, 0.0};
    double[] xValues = {Double.POSITIVE_INFINITY, Double.NEGATIVE_INFINITY, 0.0};

    for (double y : yValues) {
        for (double x : xValues) {
            double expected = Math.atan2(y, x);
            double result = new DerivativeStructure(1, 0, y, x).atan2().getValue();
            assertEquals(expected, result, 0.0);
        }
    }
}