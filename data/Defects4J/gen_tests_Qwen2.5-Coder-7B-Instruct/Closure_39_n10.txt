public void testExternExportWithTypedef() {
    String input = 
        "var foo;\n" +
        "/** @typedef {number} */\n" +
        "foo.Bar;\n" +
        "\n" +
        "function baz(opt_foo) {}\n";
    Compiler compiler = new Compiler();
    CompilerOptions options = new CompilerOptions();
    compiler.init(input, null, options);
    compiler.compile(new CompilerInput[] {}, null, null);
    String output = compiler.toSource();
    assertTrue(output.contains("var foo;\n" +
                               "/** @typedef {number} */\n" +
                               "foo.Bar;\n" +
                               "\n" +
                               "function baz(opt_foo) {}"));
}