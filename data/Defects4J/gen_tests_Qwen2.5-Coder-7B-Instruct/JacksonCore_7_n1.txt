public void testJsonGeneratorWriteStringFailure() throws IOException {
    ByteArrayOutputStream out = new ByteArrayOutputStream();
    JsonFactory factory = new JsonFactory();
    JsonGenerator gen = factory.createGenerator(out);

    gen.writeStartObject();
    gen.writeFieldName("field");

    try {
        gen.writeString("value");
        fail("Expected JsonGenerationException to be thrown");
    } catch (JsonGenerationException e) {
        // Expected exception
    }

    gen.writeEndObject();
    gen.close();

    String result = out.toString("UTF-8");
    assertTrue(result.contains("\"field\":null}")); // Ensure null is written for invalid state
}