public void testOverlyAggressiveCommaRemoval() {
    String input = "function Test(n) {\n" +
                   " var i = 0;\n" +
                   " return typeof n!== \"undefined\"? (i = n.length) : (n = \"foo\"), i\n" +
                   "}\n" +
                   "var dummy = \"6chars\";\n" +
                   "console && console.log(Test(dummy));";
    String expectedOutput = "function Test(a) {\n" +
                             " return 0\n" +
                             "}\n" +
                             "var dummy = \"6chars\";\n" +
                             "console && console.log(Test(dummy));";
    // Assuming there is a method `optimizeCode` that performs the optimization
    String actualOutput = optimizeCode(input);
    assertEquals(expectedOutput, actualOutput);
}