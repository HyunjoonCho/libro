public void testCompilerCrashOnGoogScopeLocals() {
    // This test is expected to cause a compilation error
    String sourceCode = 
        "goog.provide('main');\n" +
        "goog.scope(function (){\n" +
        "  var a = foo, b, c = 1;\n" +
        "});";
    
    try {
        Compiler.compile(sourceCode);
        fail("Expected compilation to fail");
    } catch (JavaScriptCompilationException e) {
        assertTrue(e.getMessage().contains("Variable 'foo' is undefined"));
    }
}