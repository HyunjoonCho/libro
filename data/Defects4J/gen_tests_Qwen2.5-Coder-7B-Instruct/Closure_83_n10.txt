public void testCannotSeeVersionWithVersionOption() throws Exception {
    ProcessBuilder pb = new ProcessBuilder("java", "-jar", "compiler.jar", "--version");
    pb.redirectErrorStream(true);
    Process process = pb.start();
    String output = StreamGobbler.readAll(process.getInputStream());
    int exitCode = process.waitFor();

    assertEquals(1, exitCode);
    assertTrue(output.contains("Опция \"--version\" требует операнд"));
    assertTrue(output.contains("Closure Compiler (http://code.google.com/closure/compiler)"));
    assertTrue(output.contains("Version: 698"));
}