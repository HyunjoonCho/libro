public void testJsonWriterValue() throws Exception {
    StringWriter out = new StringWriter();
    JsonWriter writer = new JsonWriter(out);
    writer.setLenient(true);
    writer.value(new BigDecimal("NaN"));
    writer.close();
    String json = out.toString();
    assertTrue(json.contains("\"NaN\""));

    out = new StringWriter();
    writer = new JsonWriter(out);
    try {
        writer.value(Double.NaN);
        fail("Expected IllegalArgumentException");
    } catch (IllegalArgumentException e) {
        // Expected
    }
}