public void testInvalidPropertyInPrototypeFunction() {
    // This should cause a compilation error due to invalid property access within a prototype function
    String jsCode = 
        "function Thing() {}\n" +
        "Thing.prototype.subthing = {};\n" +
        "\n" +
        "function MyClass(thing) {\n" +
        "  this.thing_ = thing;\n" +
        "}\n" +
        "\n" +
        "MyClass.prototype.doIt = function() {\n" +
        "  var subthing = this.thing_.subthing;\n" +
        "  for (var i = 0; i < subthing.noprop; i++) {\n" +
        "    console.log(i);\n" +
        "  }\n" +
        "}\n" +
        "\n" +
        "var thing = {subthing: {noprop: 3}};\n" +
        "var c = new MyClass(thing);\n" +
        "c.doIt();";

    try {
        JavaScriptCompiler compiler = new JavaScriptCompiler();
        compiler.compile(jsCode);
        fail("Expected a compilation error due to invalid property access");
    } catch (JavaScriptCompilerException e