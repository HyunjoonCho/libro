public void testResetDefaultNamespaceCausesEndlessLoop() throws Exception {
    String xml = "<root><child xmlns=\"\"/></root>";
    Document document = DocumentBuilderFactory.newInstance().newDocumentBuilder().parse(new InputSource(new StringReader(xml)));
    XPath xpath = XPathFactory.newInstance().newXPath();
    NodePointer pointer = new DOMNodePointer(null, document.getDocumentElement(), xpath);
    try {
        pointer.getValue();
        fail("Expected endless loop due to resetting default namespace");
    } catch (StackOverflowError e) {
        // Expected exception
    }
}