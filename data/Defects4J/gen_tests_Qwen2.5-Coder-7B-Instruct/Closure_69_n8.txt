public void testIssueCompilerWarning() throws Exception {
    String source = "goog.require('goog.graphics.Path');\n" +
                   "function demo() {\n" +
                   "  var path = new goog.graphics.Path();\n" +
                   "  var points = [[1,1], [2,2]];\n" +
                   "  for (var i = 0; i < points.length; i++) {\n" +
                   "    (" + 
                   "(i == 0? 'path.moveTo' : 'path.lineTo') + \n" +
                   ") (path, points[i][0], points[i][1]);\n" +
                   "  }\n" +
                   "}\n" +
                   "goog.exportSymbol('demo', demo);";

    try {
      JsCompiler compiler = new JsCompiler();
      compiler.compile(source, null, null);
      fail("Expected compilation to fail due to invalid 'this' context.");
    } catch (Exception e) {
      assertTrue(e.getMessage().contains("Invalid 'this' context"));
    }
}