public void testAllowMultipleMatches() throws Exception {
    ObjectMapper mapper = new ObjectMapper();
    SimpleModule module = new SimpleModule();
    module.addSerializer(String.class, new JsonSerializer<String>() {
        @Override
        public void serialize(String value, JsonGenerator gen, SerializerProvider serializers) throws IOException {
            gen.writeStartArray();
            gen.writeString(value);
            gen.writeString(value);
            gen.writeEndArray();
        }
    });
    mapper.registerModule(module);
    String json = mapper.writeValueAsString("test");
    assertEquals("[\"test\",\"test\"]", json);
}