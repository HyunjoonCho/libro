public void testObjectReaderReadValuesWithErrorRecovery() throws IOException {
    ObjectMapper mapper = new ObjectMapper();
    String json = "[{\"a\":1},{\"b\":2}]";
    JsonParser p = mapper.getFactory().createParser(json + "extra");
    MappingIterator<Object> it = mapper.readerFor(Object.class).readValues(p);

    assertTrue(it.hasNextValue());
    assertEquals("{\"a\":1}", mapper.writeValueAsString(it.nextValue()));
    
    try {
        it.nextValue();
        fail("Expected JsonProcessingException");
    } catch (JsonProcessingException e) {
        // expected
    }

    assertTrue(it.hasNextValue()); // heuristic recovery
    assertEquals("{\"b\":2}", mapper.writeValueAsString(it.nextValue()));

    assertFalse(it.hasNextValue());
}