public void testTokenBufferDelegateDeserialization() throws Exception {
    String json = "{\"a\":1,\"b\":null}";
    ObjectMapper mapper = new ObjectMapper();
    JsonNode node = mapper.readTree(json);

    TokenBuffer buffer = new TokenBuffer(mapper.getFactory(), false);
    buffer.copyCurrentStructure(node.traverse(mapper.getFactory()));

    assertEquals(JsonToken.START_OBJECT, buffer.currentToken());
    assertTrue(buffer.nextToken() == JsonToken.FIELD_NAME);
    assertEquals("a", buffer.getCurrentName());
    assertTrue(buffer.nextToken() == JsonToken.VALUE_NUMBER_INT);
    assertEquals(1, buffer.getIntValue());

    assertTrue(buffer.nextToken() == JsonToken.FIELD_NAME);
    assertEquals("b", buffer.getCurrentName());
    assertTrue(buffer.nextToken() == JsonToken.VALUE_NULL);

    assertNull(buffer.nextToken());
}