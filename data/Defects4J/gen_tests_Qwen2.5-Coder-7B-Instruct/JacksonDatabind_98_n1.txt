import static org.junit.Assert.assertEquals;

import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.module.kotlin.KotlinModule;

public class TestExternalPropertyPolymorphicDeserialization {

    @org.junit.Test
    public void testDeserializeEnum() throws Exception {
        String json = "{\"kind\":\"CONTACT\",\"to\":{\"name\":\"Foo\"}}";
        
        ObjectMapper mapper = new ObjectMapper();
        mapper.registerModule(new KotlinModule());

        Contact contact = mapper.readValue(json, Contact.class);

        assertEquals(Contact.Kind.CONTACT, contact.kind);
        assertEquals("Foo", contact.to.name);
    }

    public static class Contact {
        public Kind kind;
        public To to;

        public enum Kind {
            CONTACT,
            EMAIL
        }

        public static class To {
            public String name;
        }
    }
}