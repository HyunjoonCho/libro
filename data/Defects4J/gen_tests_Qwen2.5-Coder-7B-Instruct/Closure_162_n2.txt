public void testTypeAliasesInAnnotations() {
    // This test should fail because the type alias 'Bar' is used before its definition
    // which is not allowed according to the compiler
    try {
        String sourceCode = 
            "package test;\n" +
            "\n" +
            "import com.google.common.annotations.VisibleForTesting;\n" +
            "\n" +
            "public class TestClass {\n" +
            "    public static void main(String[] args) {\n" +
            "        new Bar();\n" +
            "    }\n" +
            "}\n" +
            "\n" +
            "@VisibleForTesting\n" +
            "class Bar {\n" +
            "    private int x;\n" +
            "}\n";
        JavaFileObject file = JavaFileObjects.forSourceString("test.TestClass", sourceCode);
        JavaCompiler compiler = ToolProvider.getSystemJavaCompiler();
        StandardJavaFileManager standardFileManager = compiler.getStandardFileManager(null, null, null);
        Iterable<? extends JavaFileObject> compilationUnits = Arrays.asList(file);
        boolean success = compiler.getTask(null, standardFileManager, null, null, null, compilationUnits).call();
        assertFalse(success);