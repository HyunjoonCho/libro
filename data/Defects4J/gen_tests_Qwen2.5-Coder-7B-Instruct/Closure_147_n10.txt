public void testGlobalThisWarning() {
    String script = 
        "var NS = {\n" +
        "  read: function() { return this.foo; },\n" +
        "  write: function() { this.foo = 123; },\n" +
        "  write2: function() { this.foo = 123; }\n" +
        "};";

    List<String> warnings = new ArrayList<>();
    JavaScriptEngine engine = new JavaScriptEngine();
    engine.setWarningListener(warnings::add);

    try {
        engine.eval(script);
    } catch (ScriptException e) {
        fail(e.getMessage());
    }

    assertTrue(warnings.contains("JSC_USED_GLOBAL_THIS: dangerous use of the global this object"));
    assertEquals(2, warnings.size());
}