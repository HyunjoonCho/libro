public void testDormandPrince853Integrator() throws Exception {
    double[] y0 = {0};
    double t0 = 0;
    double tf = 1;
    double[] absTol = {1e-6};
    double relTol = 1e-6;

    DormandPrince853Integrator integrator = new DormandPrince853Integrator(tf - t0, 1000, absTol, relTol);

    double[] y = new double[]{0};
    double t = t0;

    integrator.integrate(new FirstOrderDifferentialEquation() {
        public int getDimension() {
            return 1;
        }

        public double[] computeDerivatives(double t, double[] y) {
            return new double[]{y[0]};
        }
    }, t0, y0, tf, y);

    assertEquals(1, t, 1e-5);
    assertEquals(1, y[0], 1e-5);
}