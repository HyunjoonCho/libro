public void testDerivativeStructureAtan2SpecialCases() {
    DerivativeStructure dsYPosXPos = new DerivativeStructure(1, 0, 0, 1.0, 1.0);
    DerivativeStructure dsYNegXPos = new DerivativeStructure(1, 0, 0, -1.0, 1.0);
    DerivativeStructure dsYPosXNeg = new DerivativeStructure(1, 0, 0, 1.0, -1.0);
    DerivativeStructure dsYNegXNeg = new DerivativeStructure(1, 0, 0, -1.0, -1.0);

    double resultYPosXPos = dsYPosXPos.atan2(dsYPosXPos).getValue();
    double resultYNegXPos = dsYNegXPos.atan2(dsYNegXPos).getValue();
    double resultYPosXNeg = dsYPosXNeg.atan2(dsYPosXNeg).getValue();
    double resultYNegXNeg = dsYNegXNeg.atan2(dsYNegXNeg).getValue();

    assertTrue(Double.isNaN(resultYPosXPos));
    assertTrue(Double.isNaN(result