public void testAdvancedOptimizationsBug() {
    String jsCode = 
        "window['anchor'] = function (obj, modifiesProp) { "
      + "  return (function (saved) { "
      + "    return modifiesProp(obj) + saved; "
      + "  })(obj['prop']); "
      + "}";
    
    CompilerOptions options = new CompilerOptions();
    options.setOptimizationLevel(OptimizeLevel.ADVANCED);
    options.setWarningLevel(Diagnostic.Kind.ERROR);

    List<CompilerInput> inputs = Lists.newArrayList(
        CompilerInput.fromSource(SourceKind.EXTERNS, "window.js", "window = {};"),
        CompilerInput.fromSource(SourceKind.JS, "input.js", jsCode));

    Result result = compile(options, inputs);
    assertTrue(result.success);
    assertEquals(
        "window.anchor=function(a,b){var c=a.prop;return b(a)+c};",
        result.output);
}