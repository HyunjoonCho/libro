public void testDependencySortingWithClosurePassFalse() throws Exception {
    Compiler compiler = new Compiler();
    compiler.init(new SourceFile("test.js", "goog.provide('foo');\n" +
                                               "goog.require('bar');\n" +
                                               "function foo() {}\n" +
                                               "function bar() {}"),
                  null,
                  new CompilerOptions());

    CompilerOptions options = new CompilerOptions();
    options.setDependencySorting(true);
    options.setClosurePass(false);

    compiler.compile(null, null, options);

    assertTrue(compiler.getResultTree().getRootNode().hasChildren());
    Node root = compiler.getResultTree().getRootNode();
    Node child = root.getFirstChild();
    while (child!= null) {
        if (child.isScript()) {
            String sourceName = child.getSourceFileName();
            assertTrue(sourceName.contains("bar") || sourceName.contains("foo"));
        }
        child = child.getNext();
    }
}