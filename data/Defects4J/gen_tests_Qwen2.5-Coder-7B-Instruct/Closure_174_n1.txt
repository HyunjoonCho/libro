public void testCompilerCrashOnGoogScopeLocals() {
    String sourceCode = "goog.provide(\"main\");\n" +
                       "goog.scope(function (){\n" +
                       "  var a = foo, b, c = 1;\n" +
                       "});";
    try {
        // Compile the source code
        Compiler compiler = new Compiler();
        compiler.compile(SourceFile.fromCode("test.js", sourceCode));
        fail("Expected compiler to throw exception");
    } catch (Exception e) {
        assertTrue(e.getMessage().contains("Unknown type 'foo'"));
    }
}