public void testWrongParameterForFirstStepSizeGuess() throws Exception {
    double[] y0 = {1.0, 2.0};
    double[] atol = {1e-6, 1e-6};
    double rtol = 1e-6;

    DormandPrince853Integrator integrator = new DormandPrince853Integrator(atol, rtol);

    // This should trigger the bug
    integrator.integrate(new TestODEProblem(), 0.0, y0, 1.0, y0);

    fail("Expected ArithmeticException to be thrown");
}

private static class TestODEProblem implements FirstOrderDifferentialEquations {

    @Override
    public int getDimension() {
        return 2;
    }

    @Override
    public double[] computeDerivatives(double t, double[] y) {
        return new double[]{y[1], -y[0]};
    }
}