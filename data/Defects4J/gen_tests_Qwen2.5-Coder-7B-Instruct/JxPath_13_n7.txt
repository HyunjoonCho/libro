public void testIncompleteHandlingOfUndefinedNamespaces() throws Exception {
    String xml = "<ElementA xmlns:A='http://example.com/A' A:myAttr='Mytype'>" +
                 "  <B:ElementB xmlns:B='http://example.com/B'>MY VALUE</B:ElementB>" +
                 "</ElementA>";
    Document doc = DOMUtil.readDocument(new ByteArrayInputStream(xml.getBytes()));
    
    Node node = doc.getDocumentElement();
    NamespaceContext ctx = new SimpleNamespaceContext();
    ctx.setPrefix("A", "http://example.com/A");
    ctx.setPrefix("B", "http://example.com/B");
    
    XPath xpath = XPathFactory.newInstance().newXPath();
    xpath.setNamespaceContext(ctx);
    
    NodeList nodeList = (NodeList) xpath.evaluate("//A:myAttr", node, XPathConstants.NODESET);
    assertEquals(1, nodeList.getLength());
}