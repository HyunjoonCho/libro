public void testChiSquare() {
    double[] expected = {485, 541, 82, 61, 37};
    long[] observed = {500, 623, 72, 70, 31};
    
    double chiSquareValue = new ChiSquareTestImpl().chiSquare(expected, observed);
    
    // Rescaling expected values based on sum of observed and expected
    double sumObserved = Arrays.stream(observed).mapToDouble(i -> i).sum();
    double sumExpected = Arrays.stream(expected).mapToDouble(i -> i).sum();
    double[] scaledExpected = Arrays.stream(expected).map(i -> i * sumObserved / sumExpected).toArray();

    double rChiSquareValue = new ChiSquareTestImpl().chiSquare(scaledExpected, observed);

    assertEquals(rChiSquareValue, chiSquareValue, 0.0001);
}