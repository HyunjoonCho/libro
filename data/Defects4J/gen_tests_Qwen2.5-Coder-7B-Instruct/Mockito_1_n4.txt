public void testArgumentCaptorNoLongerWorkingForVarargs() {
    List<String> list = mock(List.class);
    ArgumentCaptor<String[]> captor = ArgumentCaptor.forClass(String[].class);

    list.addAll(new String[]{"foo", "bar"});

    verify(list).addAll(captor.capture());

    assertArrayEquals(new String[]{"foo", "bar"}, captor.getValue());
}