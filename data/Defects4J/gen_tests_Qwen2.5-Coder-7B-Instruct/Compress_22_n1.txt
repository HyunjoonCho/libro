public void testBzip2ReadTruncated() throws Exception {
    byte[] testData = "Hello, World!".getBytes();
    ByteArrayOutputStream baos = new ByteArrayOutputStream();
    try (BZip2CompressorOutputStream bcos = new BZip2CompressorOutputStream(baos)) {
        bcos.write(testData);
    }
    baos.close();

    // Truncate the last byte
    byte[] truncatedData = baos.toByteArray();
    byte[] expectedDecompressedData = "Hello, Wor".getBytes();

    try (ByteArrayInputStream bais = new ByteArrayInputStream(truncatedData);
         BZip2CompressorInputStream bis = new BZip2CompressorInputStream(bais)) {
        byte[] result = bis.readAllBytes();
        assertArrayEquals(expectedDecompressedData, result);
    }
}