public void testTarArchiveWithLongDirectoryName() throws IOException {
    File tempDir = new File(System.getProperty("java.io.tmpdir"), "long_directory_name_" + System.currentTimeMillis());
    tempDir.mkdirs();
    try {
        Path longPath = tempDir.toPath().resolve("a".repeat(120));
        Files.createDirectories(longPath);

        try (TarArchiveOutputStream tarOut = new TarArchiveOutputStream(new FileOutputStream(tempDir.getPath() + "/archive.tar"))) {
            TarArchiveEntry entry = new TarArchiveEntry(longPath.toString());
            tarOut.putArchiveEntry(entry);
            tarOut.closeArchiveEntry();
        }
    } finally {
        FileUtils.deleteQuietly(tempDir);
    }
}