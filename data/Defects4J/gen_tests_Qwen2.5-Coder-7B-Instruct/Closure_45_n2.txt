public void testAssignmentRemovedInExpressionResult() {
    String input = "function f() { var a = [], b; a.push(b = []); b[0] = 1; return a; }";
    String expectedOutput = "function f(){var a=[];a.push([]);b=[1];return a}";
    String actualOutput = compile(input);
    assertEquals(expectedOutput, actualOutput);
}

private String compile(String input) {
    Compiler compiler = new Compiler();
    compiler.initLogger(new NullErrorReporter());
    compiler.setWarningLevel(DiagnosticGroups.CHECK_JAVA_LANG_OBJECT, CheckLevel.WARNING);
    compiler.setLanguageVersion(LanguageMode.ECMASCRIPT5);
    compiler.compile(SourceFile.fromCode("test", input));
    StringBuilder sb = new StringBuilder();
    compiler.toSource(sb);
    return sb.toString();
}