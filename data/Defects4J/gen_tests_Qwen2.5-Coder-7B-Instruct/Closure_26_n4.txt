public void testProcessCommonJSModules() throws Exception {
  String echoJs = "define(function() { return {"
      + " echo: function(val) { window.console.log(val); }"
      + "} });";
  String echoMainJs = "var echo = require('echo');"
      + "echo.echo('hello world');";

  List<String> inputs = Arrays.asList(echoJs, echoMainJs);

  Compiler compiler = new Compiler();
  compiler.initLogger(new NullErrorReporter());

  compiler.compile(inputs, null, null);

  assertTrue(compiler.hasErrors());
}