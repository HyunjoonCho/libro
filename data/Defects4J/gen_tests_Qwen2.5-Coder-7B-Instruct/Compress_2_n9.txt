public void testArDeleteFails() throws IOException {
    File file = new File("/tmp/dir26673/bla.ar");
    try (ArchiveOutputStream aos = new ArchiveOutputStream(new FileOutputStream(file))) {
        ArchiveEntry entry = new ArchiveEntry("test1.xml", "text/xml");
        aos.putArchiveEntry(entry);
        aos.write("content1".getBytes());
        aos.closeArchiveEntry();
        
        entry = new ArchiveEntry("test2.xml", "text/xml");
        aos.putArchiveEntry(entry);
        aos.write("content2".getBytes());
        aos.closeArchiveEntry();
    }
    
    try (ArchiveInputStream ais = new ArchiveInputStream(new FileInputStream(file))) {
        ArchiveEntry entry = ais.getNextEntry();
        assertNotNull(entry);
        assertEquals("test1.xml", entry.getName());
        
        entry = ais.getNextEntry();
        assertNotNull(entry);
        assertEquals("test2.xml", entry.getName());
        
        entry = ais.getNextEntry();
        assertNull(entry);
    }
    
    // Attempt to delete "test2.xml"
    try (ArchiveOutputStream aos = new ArchiveOutputStream(new FileOutputStream(file))) {
        ArchiveEntry entry = new ArchiveEntry("test1.xml", "text/xml");
        aos.putArchiveEntry(entry);
        aos.write("content1