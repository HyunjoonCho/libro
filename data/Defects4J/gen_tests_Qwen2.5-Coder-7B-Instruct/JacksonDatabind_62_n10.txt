public void testCustomUnmodifiableSetMixin() throws Exception {
    String json = "[\"java.util.Collections$UnmodifiableSet\",[]]";
    ObjectMapper mapper = new ObjectMapper();
    mapper.enableDefaultTyping(ObjectMapper.DefaultTyping.NON_FINAL, JsonTypeInfo.As.PROPERTY);
    mapper.addMixIn(Collections.unmodifiableSet(Collections.<String>emptySet()).getClass(), UnmodifiableSetMixin.class);

    Object obj = mapper.readValue(json, Object.class);
    assertTrue(obj instanceof Set);
    assertTrue(((Set<?>)obj).isEmpty());
}