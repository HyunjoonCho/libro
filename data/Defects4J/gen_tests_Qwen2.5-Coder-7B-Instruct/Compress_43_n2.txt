public void testLocalVersionNeededToExtractDoesNotMatchCentralDirectory() throws IOException {
    ByteArrayOutputStream baos = new ByteArrayOutputStream();
    ZipArchiveOutputStream zaos = new ZipArchiveOutputStream(baos);

    ZipArchiveEntry entry = new ZipArchiveEntry("test.txt");
    entry.setSize(10);
    entry.setCompressedSize(10);
    entry.setCrc(0);
    entry.setTime(System.currentTimeMillis());

    zaos.putArchiveEntry(entry);
    zaos.write(new byte[10]);
    zaos.closeArchiveEntry();

    zaos.finish();
    zaos.close();

    byte[] bytes = baos.toByteArray();
    ByteArrayInputStream bais = new ByteArrayInputStream(bytes);
    ZipInputStream zis = new ZipInputStream(bais);

    ZipEntry ze = zis.getNextEntry();
    assertEquals(2, ze.getVersionNeededToExtract());
    zis.close();
}