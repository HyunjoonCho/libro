public void testTypeCheckerMissesAnnotationsOnFunctionsDefinedWithinFunctions() {
    // Arrange
    String code = 
        "var ns = {};\n" +
        "(function() {\n" +
        "/** @param {string=} b */\n" +
        "ns.a = function(b) {}\n" +
        "})();\n" +
        "\n" +
        "function d() {\n" +
        "ns.a();\n" +
        "ns.a(123);\n" +
        "}\n";

    // Act & Assert
    assertThrows(TypeCheckException.class, () -> {
        JavaScriptCompiler.compile(code, CompilerOptions.newBuilder().setWarningLevel(CompilerOptions.WarningLevel.VERBOSE).build());
    });
}