public void testSupportLendsAnnotation() throws Exception {
    JsScope scope = new JsScope(null, null);
    JsFunction func = new JsFunction(scope, "foo");
    func.setBody("this.nonExistentProperty = 5;");
    scope.addMember(func.getName(), func);

    CompilerOptions options = new CompilerOptions();
    options.setLanguageIn(LanguageMode.ECMASCRIPT_5);
    options.setLanguageOut(LanguageMode.ECMASCRIPT_5);
    options.setJsOutputType(JsOutputType.BROWSERIFIED);
    options.setCodingConvention(new CodingConvention.Simple());

    Node root = parse("/** @lends {Object} */\n" +
                      "var obj = {\n" +
                      "  foo: function() {}\n" +
                      "};");

    TranspilationPasses.runInSingleThreadedMode(
        new Compiler(),
        root,
        options,
        null,
        null);
}