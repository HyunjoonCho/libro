java
import java.io.ByteArrayInputStream;
import java.io.IOException;
import org.apache.commons.compress.compressors.bzip2.BZip2CompressorInputStream;
import org.junit.Test;

import static org.junit.Assert.assertEquals;

public class BZip2CompressorInputStreamTest {

    @Test
    public void testReadTruncated() throws IOException {
        byte[] data = new byte[] { // truncated data, 769 bytes
            0x42, 0x5a, 0x68, 0x01, 0x00, 0x00, 0x01, 0x00,
            //... truncated data...
        };

        ByteArrayInputStream bis = new ByteArrayInputStream(data);
        BZip2CompressorInputStream b2is = new BZip2CompressorInputStream(bis);

        int bytesRead = 0;
        byte[] buffer = new byte[1024];
        while (true) {
            int read = b2is.read(buffer);
            if (read == -1) {
                break;
            }
            bytesRead += read;
        }

        assertEquals(769, bytesRead);
    }
}
