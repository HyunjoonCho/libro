javascript
// ==ClosureCompiler==
// @compilation_level ADVANCED_OPTIMIZATIONS
// ==/ClosureCompiler==

/**
 * @constructor
 */
function Foo() {
  this._bar = null;
};

/**
 * @this {Foo}
 */
function writeMethodWithAnnotation() {
  this._bar = 123; // no warning. ok
}

/**
 * @this {Foo}
 */
function readMethodWithAnnotation() {
  return this._bar; // no warning. ok
}

/**
 * No @this annotation
 */
function writeMethodWithoutAnnotation() {
  this._bar = 123; // warning. ok.
}

/**
 * No @this annotation
 */
function readMethodWithoutAnnotation() {
  return this._bar; // No warning!
}

// Test that readMethodWithAnnotation should also issue a warning
function testIssue() {
  var foo = new Foo();
  writeMethodWithAnnotation();
  readMethodWithAnnotation();
  writeMethodWithoutAnnotation();
  readMethodWithoutAnnotation();
}

testIssue();
