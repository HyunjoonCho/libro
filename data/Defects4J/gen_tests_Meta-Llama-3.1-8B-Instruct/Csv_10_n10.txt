java
public void testCSVFormatWithHeader() throws IOException {
    Path filePath = Files.createTempFile("data", ".csv");
    try (BufferedWriter writer = Files.newBufferedWriter(filePath);
         CSVPrinter csvPrinter = CSVFormat.TDF.withHeader("x").print(writer)) {
        csvPrinter.printRecord(42);
    }
    try {
        Path actualFile = Files.createTempFile("data", ".csv");
        Files.copy(filePath, actualFile);
        CSVFormat csvFormat = CSVFormat.TDF.withHeader("x");
        List<String> actual = csvFormat.parseAll(Files.newBufferedReader(actualFile)).get(0);
        assertEquals("x", actual.get(0));
        assertEquals("42", actual.get(1));
    } finally {
        Files.delete(filePath);
        Files.delete(Files.newFile(filePath));
    }
}
