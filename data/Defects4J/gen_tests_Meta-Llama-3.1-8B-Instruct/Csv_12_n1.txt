java
public void testCSVFormatExcelIgnoreEmptyHeaderNames() {
    String csv = "A,B,C,,\na,b,c,d,e";
    CSVFormat format = CSVFormat.EXCEL.withHeader("A", "B", "C", "D", "E");
    try {
        CSVParser parser = new CSVParser(csv, format);
        fail("Expected IllegalArgumentException");
    } catch (IllegalArgumentException e) {
        // expected
    }
    
    // test that it works with non-empty header
    format = CSVFormat.EXCEL.withHeader("A", "B", "C");
    parser = new CSVParser(csv, format);
    assertEquals(4, parser.getRecords().get(0).size());
}
