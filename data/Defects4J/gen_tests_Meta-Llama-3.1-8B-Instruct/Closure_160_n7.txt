java
import org.junit.Test;
import com.google.javascript.jscomp.CompilationLevel;
import com.google.javascript.jscomp.Compiler;
import com.google.javascript.jscomp.CompilerOptions;
import com.google.javascript.jscomp.DiagnosticGroup;
import com.google.javascript.jscomp.DiagnosticType;

public class UndefinedVarsDiagnosticTest {
    @Test
    public void testUndefinedVarsDiagnostic() throws Exception {
        String input = "foo = {};\n" +
                "foo.bar = function() { alert(this.baz); };";
        
        Compiler compiler = new Compiler();
        CompilerOptions options = new CompilerOptions();
        options.setWarningLevel(CompilationLevel.VERBOSE);
        options.setDiagnosticGroups(DiagnosticGroup.GLOBAL_THIS);
        options.setWarning(DiagnosticType.UNKNOWN_VARIABLE);
        
        compiler.compile(input, options);
        // Check that we get the expected diagnostics
        
        // Since the checkVars/undefinedVars diagnostics do not work from the command line,
        // we cannot directly test that they are enabled. Instead, we can test that the
        // globalThis diagnostic works, which is enabled in the same way.
        options.setWarning(DiagnosticType.DANGEROUS_USE_OF_GLOBAL