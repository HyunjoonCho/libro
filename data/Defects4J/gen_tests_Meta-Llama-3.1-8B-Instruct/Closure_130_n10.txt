java
import org.junit.Test;
import org.mozilla.javascript.Context;
import org.mozilla.javascript.Function;
import org.mozilla.javascript.Scriptable;

public class ArgumentsCollapseTest {
    @Test
    public void testArgumentsCollapse() {
        Context ctx = Context.enter();
        try {
            Scriptable scope = ctx.initStandardObjects();
            Function func = ctx.compileString(
                "function () { return function () { var arg = arguments; setTimeout(function() { alert(args); }, 0); } }"
            ).func;
            func.call(ctx, scope, scope, new Object[] {});
            String result = ctx.evalString(
                "var f = arguments[0]; f();",
                scope
            ).toString();
            // The test will fail if the result is not null
            assertNotSame(null, result);

            // Now, let's check if arguments is collapsed
            ctx = Context.enter();
            scope = ctx.initStandardObjects