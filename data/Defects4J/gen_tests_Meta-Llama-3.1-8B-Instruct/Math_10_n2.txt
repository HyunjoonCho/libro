public void testDerivativeStructureAtan2() {
    DerivativeStructure x = new DerivativeStructure(1, 1, 1.0);
    DerivativeStructure y = new DerivativeStructure(1, 1, 0.0);
    DerivativeStructure result1 = DerivativeStructure.atan2(y, x);
    DerivativeStructure result2 = Math.atan2(y.getValue(), x.getValue());
    assertEquals(result2, result1);

    x.setValue(0.0);
    result1 = DerivativeStructure.atan2(y, x);
    result2 = Math.atan2(y.getValue(), x.getValue());
    assertEquals(result2, result1);

    x.setValue(0.0);
    y.setValue(0.0);
    result1 = DerivativeStructure.atan2(y, x);
    result2 = Math.atan2(y.getValue(), x.getValue());
    assertEquals(result2, result1);

    x.setValue(-0.0);
    result1 = DerivativeStructure.atan2(y, x);
    result2 = Math.atan2(y.getValue(), x.getValue());
    assertEquals(result2, result1);
}