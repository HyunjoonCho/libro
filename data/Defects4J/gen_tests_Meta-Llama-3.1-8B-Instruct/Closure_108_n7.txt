java
import org.junit.Test;
import com.google.common.base.Preconditions;

public class ScopedAliasesTest {

    @Test(expected = IllegalStateException.class)
    public void testScopeCrash() {
        var ns = new Object();
        ns.sub = new Object();
        ((Object) ns.sub).sub = new Object();

        com.google.javascript.jscomp.ScopedAliases scopedAliases = new com.google.javascript.jscomp.ScopedAliases();
        scopedAliases.addAlias("goog", ns);
        scopedAliases.enterScope();

        try {
            com.google.javascript.jscomp.ScopedAliases.AliasedTypeNode.applyAlias(scopedAliases, "sub.sub.C");
        } finally {
            scopedAliases.exitScope();
        }

        com.google.javascript.jscomp.ScopedAliases.AliasedTypeNode.applyAlias(scopedAliases, "sub.sub.C");
    }
}
