java
public void testBZip2CompressorInputStreamReadsFewerBytesFromTruncatedFile() throws IOException {
    // Create a truncated bz2 file with 770 bytes
    byte[] data = new byte[770];
    BZip2Compressor compressor = new BZip2Compressor();
    compressor.setInput(data);
    ByteArrayOutputStream bos = new ByteArrayOutputStream();
    compressor.deflate(bos);
    byte[] truncatedData = new byte[769];
    System.arraycopy(data, 0, truncatedData, 0, 769);

    // Create a BZip2CompressorInputStream
    ByteArrayInputStream bis = new ByteArrayInputStream(truncatedData);
    BZip2CompressorInputStream bci = new BZip2CompressorInputStream(bis);

    // Read the data
    byte[] buffer = new byte[10];
    int bytesRead = bci.read(buffer);

    // Check that the correct number of bytes were read
    assertEquals(769, bytesRead);
}
