public void testDerivativeStructureAtan2() {
    DerivativeStructure dsX = new DerivativeStructure(1, 1);
    DerivativeStructure dsY = new DerivativeStructure(1, 1);
    DerivativeStructure result = DerivativeStructure.atan2(dsY, dsX);

    assertEquals(Double.NaN, result.getValue(), 0);
    dsX.setValue(0);
    result = DerivativeStructure.atan2(dsY, dsX);
    assertEquals(Double.NaN, result.getValue(), 0);
    assertEquals(Double.NaN, result.getPartialDerivative(0), 0);
    assertEquals(Double.NaN, result.getPartialDerivative(1), 0);

    dsY.setValue(0);
    result = DerivativeStructure.atan2(dsY, dsX);
    assertEquals(Double.NaN, result.getValue(), 0);
    assertEquals(Double.NaN, result.getPartialDerivative(0), 0);
    assertEquals(Double.NaN, result.getPartialDerivative(1), 0);

    dsX.setValue(0);
    dsY.setValue(0);
    result = DerivativeStructure.atan2(dsY, dsX);
    assertEquals(Double.NaN, result.getValue(), 0);
    assertEquals(Double.NaN, result.getPartialDerivative(0),