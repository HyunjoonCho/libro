public void testVarCheckCrashWhenUsingModules() throws IOException {
    Compiler compiler = new Compiler();
    compiler.setModuleResolutionPolicy(ModuleResolutionPolicy.ALWAYS_RESOLVE);
    compiler.setModule("jquery", new StringReader("function jQuery() { }"));
    compiler.setModule("core", new StringReader("function core() { jQuery$$2 = 'test'; }"));
    compiler.setModuleOutputPathPrefix("mod");
    compiler.compile("function test() { core(); jQuery('div'); }");
    compiler.process();
}