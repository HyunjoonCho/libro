java
import com.google.javascript.jscomp.Compiler;
import com.google.javascript.jscomp.CompilerOptions;
import com.google.javascript.jscomp.SourceFile;
import org.junit.Test;

import java.io.File;
import java.io.FileWriter;
import java.io.IOException;

public class ClosureCompilerTest {

    @Test(expected = RuntimeException.class)
    public void testStackOverflowError() throws IOException {
        Compiler compiler = new Compiler();
        CompilerOptions options = new CompilerOptions();
        options.setWarningLevel(CompilerOptions.WarningLevel.ERROR);
        SourceFile sourceFile = SourceFile.fromReader("AdMedia.eam.js", "js");
        compiler.compile(sourceFile, options);
    }

    @Test
    public void testStackOverflowErrorWithJava7() throws IOException {
        System.setProperty("java.runtime.version", "1.7.0");
        Compiler compiler = new Compiler();
        CompilerOptions options = new CompilerOptions();
        options.setWarningLevel(CompilerOptions.WarningLevel.ERROR);
        SourceFile sourceFile = SourceFile.fromReader("AdMedia.eam.js", "js");
        try {
            compiler.compile(sourceFile, options);
        } catch (RuntimeException e) {
            // expected
        }
    }
}
