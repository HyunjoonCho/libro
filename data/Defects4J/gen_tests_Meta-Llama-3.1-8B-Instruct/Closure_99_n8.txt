javascript
describe('Test JSC_USED_GLOBAL_THIS warning', function() {
  it('should produce warning when using quoted prototypes', function() {
    function MyClass() {}
    MyClass.prototype["MyMethod"] = function(a) {
      this.a = a;
    }
    window["MyClass"] = MyClass;
    expect(console.warn).toHaveBeenCalledWith("dangerous use of the global this object.");
  });

  it('should produce warning when using quoted prototypes and implementing an interface', function() {
    function MyParent() {}
    MyParent.prototype.MyMethod = function(a) {}
    function MyClass() {}
    MyClass.prototype["MyMethod"] = function(a) {
      this.a2 = a;
    }
    window["MyClass"] = MyClass;
    expect(console.warn).toHaveBeenCalledWith("dangerous use of the global this object.");
    expect(console.warn).toHaveBeenCalledWith("property MyMethod on interface MyParent is not implemented by type MyClass");
  });
});
