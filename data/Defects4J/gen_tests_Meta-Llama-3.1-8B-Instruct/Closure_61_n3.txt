public void testClosureRemovesNeededCode() {
    ClosureCompiler compiler = new ClosureCompiler();
    String code = "function test() { a = 5; }; var test = {}; test.blah = function(test) { test.a = 5; }; test.blah(test);";
    String result = compiler.compile(code);
    assertTrue(result.contains("test.blah=function(a){a.a=5};var test={};"));
    assertTrue(result.contains("test.blah(test);"));
}