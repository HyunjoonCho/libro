java
private int num = 1;
private Deque<Node> stack = new ArrayDeque<>();

private int copySafeNodes(Element source, Element dest) {
    List<Node> sourceChildren = source.childNodes();
    int numDiscarded = 0;

    for (Node sourceChild : sourceChildren) {
        num++;
        if (num > 2000) {
            //break this tag.
            break;
        }
        if (sourceChild instanceof Element) {
            Element sourceEl = (Element) sourceChild;

            if (whitelist.isSafeTag(sourceEl.tagName())) { // safe, clone
                                                            // and copy safe
                                                            // attrs
                ElementMeta meta = createSafeElement(sourceEl);
                Element destChild = meta