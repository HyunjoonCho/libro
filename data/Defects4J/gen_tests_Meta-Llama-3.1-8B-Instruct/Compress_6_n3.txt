public void testZipOutputStreamCollision() {
    ByteArrayOutputStream bos = new ByteArrayOutputStream();
    ZipOutputStream zos = new ZipOutputStream(bos);
    ZipArchiveEntry entry1 = new ZipArchiveEntry("test1.txt");
    ZipArchiveEntry entry2 = new ZipArchiveEntry("test2.txt");
    zos.putArchiveEntry(entry1);
    zos.putArchiveEntry(entry2);
    entry2.setName("test1.txt");
    zos.putArchiveEntry(entry2);
    zos.close();
    ZipFile zipFile = new ZipFile(new ByteArrayInputStream(bos.toByteArray()));
    assertEquals(2, zipFile.size());
    try (ZipInputStream zis = new ZipInputStream(new ByteArrayInputStream(bos.toByteArray()))) {
        ZipArchiveEntry currentEntry = zis.getNextEntry();
        assertEquals("test1.txt", currentEntry.getName());
        currentEntry = zis.getNextEntry();
        assertEquals("test1.txt", currentEntry.getName());
    }
}