java
public void testArgumentCaptorVarargs() {
    ArgumentCaptor<String> captor = ArgumentCaptor.forClass(String.class);
    Method method = MyClass.class.getMethod("myMethod", String.class, String.class, String.class);
    doNothing(method).when(MyClass.class).myMethod(captor.capture(), captor.capture(), captor.capture());
    MyClass obj = new MyClass();
    obj.myMethod("arg1", "arg2", "arg3");
    List<String> arguments = captor.getAllValues();
    assertEquals(3, arguments.size());
    assertEquals("arg1", arguments.get(0));
    assertEquals("arg2", arguments.get(1));
    assertEquals("arg3", arguments.get(2));
}

public void testArgumentCaptorVarargsFails() {
    ArgumentCaptor<String> captor = ArgumentCaptor.forClass(String.class);
    Method method = MyClass.class.getMethod("myMethod", String.class, String.class, String.class, String.class);
    doNothing(method).when(MyClass.class).myMethod(captor.capture(), captor.capture(), captor.capture(),