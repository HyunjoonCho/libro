public void testAssignmentToRecordInConditional() {
    Object a = true;
    Object b = false;
    Object result = func(a, b);
    assertEquals("prop1", result.getClass().getSimpleName());
    assertEquals(3, ((Map)result).get("prop1"));
    assertNull(((Map)result).get("prop2"));
    assertNull(((Map)result).get("prop3"));
}

public Object func(Object a, Object b) {
    Object results;
    if (a) {
        results = new HashMap<>();
        results.put("prop1", new HashMap<String, Object>() {{
            put("a", 3);
        }});
    } else {
        results = null;
    }
    if (b) {
        if (results!= null) {
            results.put("prop2", "prop2");
        } else {
            results = new HashMap<>();
            results.put("prop2", "prop2");
        }
    } else {
        if (results!= null) {
            results.put("prop3", "prop3");
        } else {
            results = new HashMap<>();
            results.put("prop3", "prop3");
        }
    }
    return results;
}