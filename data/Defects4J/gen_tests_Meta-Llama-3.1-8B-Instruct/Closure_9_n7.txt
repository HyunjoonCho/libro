java
import org.junit.Test;
import java.io.File;
import java.io.IOException;
import java.nio.file.Files;
import java.nio.file.Path;
import java.nio.file.Paths;

import com.google.javascript.jscomp.CompilationLevel;
import com.google.javascript.jscomp.Compiler;
import com.google.javascript.jscomp.CompilerOptions;

public class AmDModuleTest {

    @Test
    public void testAmdModuleInSubdirectory() throws IOException {
        // Create directory structure
        Path libDir = Paths.get("lib");
        Files.createDirectories(libDir);
        Path fooFile = libDir.resolve("Foo.js");
        Path barFile = Paths.get("Bar.js");

        // Create Foo.js
        String fooJs = "goog.provide('module$lib$Foo');\n" +
                "goog.require('goog.string');\n" +
                "function Foo() {}\n";
        Files.write(fooFile, fooJs.getBytes());

        // Create Bar.js
        String barJs = "goog.provide('Bar');\n" +
                "goog.require('module$lib$Foo');\n" +
                "function Bar() {\n" +
                "    var foo