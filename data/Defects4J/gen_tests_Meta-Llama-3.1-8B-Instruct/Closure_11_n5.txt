javascript
describe('Record type invalid property not reported on function with @this annotation', () => {
  var makeClass = function(protoMethods) {
    var clazz = function() {
      this.initialize.apply(this, arguments);
    }
    for (var i in protoMethods) {
      clazz.prototype[i] = protoMethods[i];
    }

    return clazz;
  }

  var Person = function(options) {};
  Person = makeClass({
    initialize: {
      value: function(options) {
        /** @type {string} */
        this.name_ = options.thisPropDoesNotExist;
      }
    },
    say: {
      value: function(message) {
        window.console.log(this.name_ +'says:'+ message);
      }
    }
  });

  it('should report error on invalid property', () => {
    var joe = new Person({name: 'joe', height: 300});
    expect(function() {
      joe.say('hi');
    }).toThrowError('Property "name_" is not defined on type Person');
  });
});
