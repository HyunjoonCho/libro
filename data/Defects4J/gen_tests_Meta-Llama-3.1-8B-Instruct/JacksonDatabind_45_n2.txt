java
public void testNumberShapeExplicitlyDefined() {
    // Before fix
    NumberFormat format = NumberFormat.getInstance(Locale.US);
    format.setNumberShape(NumberFormat.SIMPLE);
    try {
        format.parse("123.456");
        fail("Expected NumberFormatException before fix");
    } catch (NumberFormatException e) {}

    // After fix
    NumberFormat format = NumberFormat.getInstance(Locale.US);
    format.setNumberShape(NumberFormat.SIMPLE);
    Number num = format.parse("123.456");
    assertNotNull(num);
    assertEquals(NumberFormat.SIMPLE, format.getNumberFormat().getNumberFormat().getNumberShape());

    // Test that explicit shape takes precedence
    NumberFormat format = NumberFormat.getInstance(Locale.US);
    format.setNumberShape(NumberFormat.SIMPLE);
    format.setNumber(NumberFormat.SIMPLE);
    try {
        format.parse("123.456");
        fail("Expected NumberFormatException");
    } catch (NumberFormatException e) {}
}
