java
import org.junit.Test;
import org.junit.runner.RunWith;
import org.junit.runners.JUnit4;

import com.google.testing.compile.Compilation;
import com.google.testing.compile.CompilationRule;

import static com.google.common.truth.Truth.assertThat;
import static com.google.testing.compile.CompilationRule.compile;

@RunWith(JUnit4.class)
public class ClosureCompilerTest {
    @Rule public final CompilationRule compilation = new CompilationRule();

    @Test
    public void testPropertyRemoval() {
        Compilation compilation =
            compilation().addSourceElements(
                "var lastMsg;",
                "var map = {};",
                "var f1 = function() { alert('f1'); };",
                "f1.alwaysCall = true;",
                "var f2 = function() { alert('f2'); };",
                "addToMap('f1', f1);",
                "addToMap('f2', f2);",
                "var callFunctionByKey = function(key) {",
                "  var f = map[key];",
                "  if (f.alwaysCall) f();",
                "};",
                "callFunctionByKey(Math.random() > 0.5? 'f1' : 'f2');")
               .setCompilationLevel