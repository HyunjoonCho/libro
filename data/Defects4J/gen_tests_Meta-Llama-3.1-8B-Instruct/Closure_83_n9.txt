public void testVersionOption() {
    try {
        Process process = Runtime.getRuntime().exec(new String[] {"java", "-jar", "compiler.jar", "--version"});
        BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream()));
        String line = reader.readLine();
        assert line.contains("Version: 698");
        assert line.contains("Built on:");
        line = reader.readLine();
        assert line.startsWith("Usage: ");
        line = reader.readLine();
        assert line.contains("Option '--version' requires operand");
    } catch (IOException e) {
        fail("Process execution failed");
    }
}