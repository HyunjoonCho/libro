public void testAdvancedCompilationRenameDeleteFunction() {
    Object a = new Object() {
        int _x = 1;
        public void func1() {
            _x = 2;
            func2();
        }
        public void func2() {
            _x = 3;
            func3();
        }
        public void func3() {}
    };

    a.getClass().getField("func1").set(a, new java.lang.reflect.Method() {
        @Override
        public void invoke(Object obj, Object... args) throws Throwable {
            ((a.getClass()).getDeclaredField("_x").set(obj, 2));
            ((a.getClass()).getDeclaredMethod("func2").invoke(obj));
        }
    });

    assertNotSame(a.getClass().getField("func1"), a.getClass().getDeclaredMethod("func2"));

    try {
        a.getClass().getField("func1").get(a);
        fail("Expected NoSuchMethodException");
    } catch (NoSuchMethodException e) {}
}