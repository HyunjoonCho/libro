public void testAbstractLeastSquaresWeights() {
    AbstractLeastSquares als = new AbstractLeastSquares();
    als.setResiduals(new double[] {1.0, 2.0, 3.0});
    als.setWeights(new double[] {1.0, 2.0, 3.0});
    als.setRows(3);
    
    double rms = als.getRMS();
    double chiSquare = als.getChiSquare();
    
    double expectedChiSquare = (als.getResiduals()[0]*als.getResiduals()[0]*als.getWeights()[0] +
                               als.getResiduals()[1]*als.getResiduals()[1]*als.getWeights()[1] +
                               als.getResiduals()[2]*als.getResiduals()[2]*als.getWeights()[2]);
    assertEquals(expectedChiSquare, chiSquare, 0.0001);
    
    double expectedRms = Math.sqrt(expectedChiSquare / als.getRows());
    assertEquals(expectedRms, rms, 0.0001);
}