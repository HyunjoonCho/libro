java
import org.junit.Test;

public class AMDModuleTest {
    @Test
    public void testAMDModule() throws Exception {
        String barJs = "define('module$lib$Foo', ['require'], function(require) {\n" +
                "  console.log('Foo module loaded');\n" +
                "});\n" +
                "\n" +
                "define('Bar', ['module$lib$Foo'], function(module$lib$Foo) {\n" +
                "  console.log('Bar module loaded');\n" +
                "});";

        String command = "java -jar compiler.jar --transform_amd_modules --process_common_js_modules --common_js_entry_module=Bar --compilation_level=ADVANCED_OPTIMIZATIONS --js_output_file=out.js --js=Bar.js --js=lib/Foo.js";
        Process process = Runtime.getRuntime().exec(command);
        int exitCode = process.waitFor();
        assert exitCode!= 0;
    }
}
