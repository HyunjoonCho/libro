public void testArgumentCaptorVarargs() {
    ArgumentCaptor<String> captor = ArgumentCaptor.forClass(String.class);
    when(mockMethod("arg1", "arg2", "arg3")).thenReturn("result");
    mockMethod("arg1", captor.capture(), "arg3");
    String[] args = captor.getAllValues().toArray(new String[0]);
    assertArrayEquals(new String[] {"arg1", "arg2"}, args);
}