public void testIncompleteNamespaceHandling() throws Exception {
    NamespaceContext namespaceContext = new NamespaceContext();
    namespaceContext.registerNamespace("A", "http://example.com/A");
    namespaceContext.registerNamespace("B", "http://example.com/B");

    Element element = new Element("ElementA", namespaceContext);
    element.setAttribute("myAttr", "Mytype", "A");

    Element child = new Element("ElementB", namespaceContext);
    child.setText("MY VALUE");

    element.appendChild(child);

    try {
        DOMNodePointer.createAttribute(element, "myAttr");
        fail("Expected unknown namespace prefix exception");
    } catch (UnknownNamespacePrefixException e) {
        assertEquals("A", e.getPrefix());
    }
}