javascript
describe('Type checking error when replacing a function with a stub after calling', function() {
    it('should throw error on first call to fn', function() {
        var MyClass = function() {};
        MyClass.prototype.fn = function() {};
        MyClass.prototype.test = function() {
            this.fn(); // This should throw an error
            this.fn = function() {};
        };
        var obj = new MyClass();
        expect(function() {
            obj.test();
        }).toThrowError();
    });

    it('should throw error on second call to fn', function() {
        var MyClass = function() {};
        MyClass.prototype.fn = function() {};
        MyClass.prototype.test = function() {
            this.fn = function() {};
            this.fn(); // This should throw an error
        };
        var obj = new MyClass();
        expect(function() {
            obj.test();
        }).toThrowError();
    });
});
