public void testJsonIncludeNonDefaultString() {
    Object obj = new Object() {
        @JsonInclude(JsonInclude.Include.NON_DEFAULT)
        public String notNullField = "not null";
        public String nullField = null;
    };

    ObjectMapper mapper = new ObjectMapper();
    try {
        mapper.writeValueAsString(obj);
        fail("Expected exception");
    } catch (JsonProcessingException e) {
        // expected
    }

    obj.notNullField = null;
    try {
        mapper.writeValueAsString(obj);
        fail("Expected exception");
    } catch (JsonProcessingException e) {
        // expected
    }
}