public void testReadValuesErrorRecovery() throws JsonProcessingException {
    ObjectMapper mapper = new ObjectMapper();
    JsonFactory jsonFactory = mapper.getFactory();
    JsonParser jp = jsonFactory.createParser("[1, 2, {\"key\":\"value\"");
    MappingIterator iter = mapper.readerForList(Integer.class).readValues(jp);
    
    try {
        iter.next();
        fail("Expected JsonProcessingException");
    } catch (JsonProcessingException e) {
        // expected
    }
    
    // check that the iterator is pointing at the closing bracket of the object
    assert iter.getCurrentToken() == JsonToken.END_OBJECT;
}