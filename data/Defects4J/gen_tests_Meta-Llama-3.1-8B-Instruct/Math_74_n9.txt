public void testEmbeddedRungeKuttaIntegratorInitialization() {
    double[] y0 = {1.0, 2.0};
    double[] scalAbsoluteTolerance = {1e-6, 1e-6};
    double[] scalRelativeTolerance = {1e-6, 1e-6};
    double[] vecAbsoluteTolerance = {1e-6, 1e-6};
    double[] vecRelativeTolerance = {1e-6, 1e-6};
    double[] yDotK = new double[2];
    double[] yTmp = new double[2];

    EmbeddedRungeKuttaIntegrator integrator = new DormandPrince853Integrator();
    integrator.initializeStep(equations, forward, 3, calculateScale(y0, scalAbsoluteTolerance, scalRelativeTolerance), stepStart, y0, yDotK[0], yTmp, yDotK[1]);
    assertEquals(1e-6 + Math.abs(y0[0]) * 1e-6, integrator.getScale()[0], 0.01);
    assertEquals(1e-6 + Math.abs(y0[1]) * 1