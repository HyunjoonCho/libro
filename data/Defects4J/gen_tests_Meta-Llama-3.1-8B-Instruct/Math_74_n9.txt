java
public void testDOP853WrongStepSize() {
    // Create a simple ODE to integrate
    final double[] y0 = new double[] {1.0, 1.0};
    final double[] yDotK = new double[y0.length];
    final double[] yTmp = new double[y0.length];
    final double[] y = new double[y0.length];
    final double[] scalAbsoluteTolerance = new double[] {1e-6, 1e-6};
    final double[] vecAbsoluteTolerance = new double[] {1e-6, 1e-6};
    final double[] scalRelativeTolerance = new double[] {1e-6, 1e-6};
    final double[] vecRelativeTolerance = new double[] {1e-6, 1e-6};
    final double[] scale = new double[y0.length];

    // Initialize the scaling array incorrectly (as in the bug report)
    for (int i = 0; i < scale.length; ++i) {
        scale[i] = scalAbsoluteTolerance[i];
    }

    // Integrate the ODE using the DOP853 method
    final double hNew =