public void testWriteBigDecimalAsPlainIgnoredWithJsonFormat() {
    ObjectMapper mapper = new ObjectMapper();
    mapper.configure(Feature.WRITE_BIGDECIMAL_AS_PLAIN, true);
    mapper.setSerializationInclusion(JsonInclude.Include.NON_NULL);
    BigDecimal value = new BigDecimal("0.0000000005");
    JsonFormat format = new JsonFormat();
    format.setShape(JsonFormat.Shape.STRING);
    JsonNode node = mapper.valueToTree(new Object() {
        @JsonFormat(shape = JsonFormat.Shape.STRING)
        public BigDecimal getValue() {
            return value;
        }
    });
    String result = mapper.writeValueAsString(node);
    assertEquals("0.0000000005", result);
}