public void testCSVFormatEXCELIgnoreEmptyHeaderNames() {
    Reader reader = new StringReader("A,B,C,,\na,b,c,d,e");
    CSVFormat format = CSVFormat.EXCEL;
    CSVParser parser = new CSVParser(reader, format);
    CSVParserSettings settings = parser.getSettings();
    settings.getFormat().setHeaderIncluded(false);
    CSVPrinter printer = new CSVPrinter(new StringWriter(), settings);
    printer.printRecord();
    String[] headers = printer.getCSVFormat().getHeader();
    assertArrayEquals(new String[] {"A", "B", "C"}, headers);
}