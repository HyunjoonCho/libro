public void testAnonymousObjectInferenceInconsistency() {
    // Test function with type parameters
    Function<Object> func = record -> System.out.println(((Map<String, String>) record).get("prop"));
    // Test function with union type parameters
    Function<Object> func2 = record -> {
        if (record instanceof String) {
            System.out.println(record);
        } else {
            System.out.println(((Map<String, String>) record).get("prop"));
        }
    };
    
    Map<String, String> obj = new HashMap<>();
    obj.put("prop", "a");
    
    // Expected to pass
    func.apply(obj);
    
    // Expected to fail, but currently passes
    func2.apply(obj);
}