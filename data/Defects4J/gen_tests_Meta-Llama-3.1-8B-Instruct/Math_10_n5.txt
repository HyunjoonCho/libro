public void testDerivativeStructureAtan2() {
    DerivativeStructure dsX = new DerivativeStructure(1, 1);
    DerivativeStructure dsY = new DerivativeStructure(1, 1);
    assertEquals(0, FastMath.atan2(0, 0), 1e-12);
    assertEquals(Double.NEGATIVE_INFINITY, FastMath.atan2(-0, 0), 1e-12);
    assertEquals(Double.POSITIVE_INFINITY, FastMath.atan2(0, -0), 1e-12);
    assertEquals(Double.POSITIVE_INFINITY, FastMath.atan2(0, 0), 1e-12);
    assertEquals(dsX, new DerivativeStructure(1, 1).atan2(dsY, dsX));
    assertEquals(dsX, new DerivativeStructure(1, 1).atan2(-dsY, dsX));
    assertEquals(dsX, new DerivativeStructure(1, 1).atan2(dsY, -dsX));
    assertEquals(dsX, new DerivativeStructure(1, 1).atan2(dsY, dsX));
}