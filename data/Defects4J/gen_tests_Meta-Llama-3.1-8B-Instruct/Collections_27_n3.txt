public void testInvokerTransformer() throws Exception {
    Collection<?> collection = new ArrayList<>();
    InvokerTransformer transformer = new InvokerTransformer();
    ByteArrayOutputStream bos = new ByteArrayOutputStream();
    ObjectOutputStream oos = new ObjectOutputStream(bos);
    oos.writeObject(transformer.transform(collection));
    ByteArrayInputStream bis = new ByteArrayInputStream(bos.toByteArray());
    ObjectInputStream ois = new ObjectInputStream(bis);
    Object deserialized = ois.readObject();
    Method getEntrySet = deserialized.getClass().getMethod("entrySet");
    Method getFirst = getEntrySet.invoke(deserialized).getClass().getMethod("iterator").invoke(getEntrySet.invoke(deserialized)).getClass().getMethod("next").invoke(getEntrySet.invoke(deserialized));
    Method invoke = deserialized.getClass().getMethod("get").invoke(getFirst.invoke(getEntrySet.invoke(deserialized)));
    Method invokeWithArg = deserialized.getClass().getMethod("invoke", Class[].class);
    assertEquals("This is a test", invokeWithArg.invoke(invoke, new Class[]{String.class})); // This should not be allowed
}