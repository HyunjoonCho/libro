java
import org.junit.Test;
import org.junit.runner.RunWith;
import org.junit.runners.JUnit4;
import com.google.javascript.jscomp.CompilationLevel;
import com.google.javascript.jscomp.JSError;
import com.google.javascript.jscomp.JSType;
import com.google.javascript.jscomp.JSTypeCheck;
import com.google.javascript.jscomp.JSTypeTest;
import com.google.javascript.jscomp.PeepholeFoldConstants;
import com.google.javascript.jscomp.PeepholeOptimizer;

@RunWith(JUnit4.class)
public class PeepholeFoldConstantsTest {

    @Test
    public void testTryFoldArrayAccessSideEffects() throws Exception {
        String input = "[console.log('hello, '), 'world!'][1]";
        CompilationLevel SIMPLE_OPTIMIZATIONS.compile(input);
        PeepholeOptimizer optimizer = new PeepholeOptimizer();
        optimizer.process(input);
        String output = optimizer.toSource();
        String expectedOutput = "(console.log(\"hello\"), \"world!\")";
        assertEquals(expectedOutput, output);
    }
}
