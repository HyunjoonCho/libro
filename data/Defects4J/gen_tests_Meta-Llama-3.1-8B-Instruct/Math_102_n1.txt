java
public void testChiSquareTest() {
    double[] expected = {485, 541, 82, 61, 37};
    long[] observed = {500, 623, 72, 70, 31};
    double chiSquareExpected = 9.0233;
    double pValueExpected = 0.06052;
    double[] expectedRescaled = {521.19403, 581.37313, 88.11940, 65.55224, 39.76119};

    ChiSquareTestImpl testStatistic = new ChiSquareTestImpl();

    double chiSquareTestStatistic = testStatistic.chiSquare(expected, observed);
    double chiSquareTestPValue = testStatistic.chiSquareTest(expected, observed);

    assertEquals("chi-square test statistic", chiSquareExpected, chiSquareTestStatistic, 1E-5);
    assertEquals("chi-square p-value", pValueExpected, chiSquareTestPValue, 1E-5);

    // Verify that expected values are correctly rescaled
    double sumObserved = Arrays.stream(observed).asLongStream().sum();
    double sumExpected = Arrays.stream(expected).asDoubleStream().sum();
    double rescalingFactor =