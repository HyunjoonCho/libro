java
public class ExtendedMessageFormatTest {
    
    private static Map<String, Object> formatRegistry = new HashMap<String, Object>();    
    static {
        formatRegistry.put("dummy", new DummyFormatFactory());
    }
    
    public void testExtendedMessageFormatWithSingleQuotes() {
        ExtendedMessageFormat mf = new ExtendedMessageFormat("it''s a {dummy} 'test'!", formatRegistry);
        String formattedPattern = mf.format(new String[] {"great"});
        
        // Since the bug is an OutOfMemoryError, we can't directly assert on the formattedPattern.
        // We'll try to create a large number of instances of ExtendedMessageFormat to cause the OutOfMemoryError.
        for (int i = 0; i < 10000; i++) {
            mf = new ExtendedMessageFormat("it''s a {dummy} 'test'!", formatRegistry);
            mf.format(new String[] {"great"});
        }
    }
    
    public static class DummyFormatFactory implements FormatFactory {
        @Override
        public Format getFormat() {
            return new Format() {
                @Override
                public String format(Object[] args) {
                    return "dummy