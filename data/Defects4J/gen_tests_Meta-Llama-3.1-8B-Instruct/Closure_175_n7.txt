public void testAdvancedOptimizations() throws Exception {
    File inputJs = new File("input.js");
    File externsJs = new File("window.js");
    File compilationResult = new File("output.js");

    // Create a compiler process
    ProcessBuilder processBuilder = new ProcessBuilder("java", "-jar", "compiler.jar",
            "--compilation_level", "ADVANCED_OPTIMIZATIONS",
            "--warning_level", "VERBOSE",
            "--externs", externsJs.getAbsolutePath(),
            "--js", inputJs.getAbsolutePath(),
            "--js_output_file", compilationResult.getAbsolutePath());
    Process process = processBuilder.start();

    // Wait for the process to finish
    process.waitFor();

    // Read the output
    String result = new String(compilationResult.readAllBytes());

    // Check the result
    String expected = "window.foo=function(a,b){var HOLD=a.prop;return b(a)+HOLD};";
    Assert.assertNotEquals(expected, result);
}