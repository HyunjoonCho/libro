java
public void testChiSquare() {
    double[] expected = {485, 541, 82, 61, 37};
    long[] observed = {500, 623, 72, 70, 31};
    double expectedSum = 0;
    for (double d : expected) {
        expectedSum += d;
    }
    long observedSum = 0;
    for (long l : observed) {
        observedSum += l;
    }
    double[] correctedExpected = new double[expected.length];
    for (int i = 0; i < expected.length; i++) {
        correctedExpected[i] = (double) observedSum / expectedSum * expected[i];
    }
    double chiSquareTestStatistic = 0;
    for (int i = 0; i < observed.length; i++) {
        double dev = ((double) observed[i] - correctedExpected[i]);
        chiSquareTestStatistic += dev * dev / correctedExpected[i];
    }
    assertEquals(9.0233, chiSquareTestStatistic, 1E-4);
}
