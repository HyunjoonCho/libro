public void testIteratePointers() throws Exception {
    DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
    factory.setNamespaceAware(true);
    DocumentBuilder builder = factory.newDocumentBuilder();
    Document doc = builder.parse(new InputSource(new StringReader("<a:doc xmlns:a=\"ns\"><a:elem/><b:elem xmlns:b=\"ns\"/></a:doc>")));

    JXPathContext context = JXPathContext.newInstance(doc);
    Object[] pointers = context.iteratePointers("//ns:elem");
    assertEquals(2, pointers.length);
    Object[] expectedPointers = context.iteratePointers("//ns:elem", new NamespaceContext());
    assertEquals(2, expectedPointers.length);
}

public class NamespaceContext implements NamespaceContext {
    @Override
    public String getNamespaceURI(String prefix) {
        return prefix.equals("a")? "ns" : prefix.equals("b")? "ns" : null;
    }

    @Override
    public String getPrefix(String namespaceURI) {
        return namespaceURI.equals("ns")? "a" : "b";
    }
}