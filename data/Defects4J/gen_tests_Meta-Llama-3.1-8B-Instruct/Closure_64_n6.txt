public void testLanguageInECMASCRIPT5_STRICT() throws Exception {
    FileCompiler compiler = new FileCompiler();
    compiler.setIn(new StringReader("var getNum = function() { return 5; };"));
    compiler.setOut(new ByteArrayOutputStream());
    compiler.setIn(new StringReader("alert(getNum());"));
    compiler.compile();
    String output = new String(((ByteArrayOutputStream) compiler.getOut()).toByteArray());
    // Expected output: 'use strict';alert(5);
    // Actual output contains 2 'use strict' directives
    assertEquals(1, countOccurrences(output, "'use strict'"));
}

private int countOccurrences(String str, String substr) {
    int count = 0;
    int index = str.indexOf(substr);
    while (index!= -1) {
        count++;
        index = str.indexOf(substr, index + substr.length());
    }
    return count;
}