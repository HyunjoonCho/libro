java
public void testExtendedMessageFormatOOM() {
    Map<String, Object> formatRegistry = new HashMap<String, Object>();
    formatRegistry.put(DummyFormatFactory.DUMMY_FORMAT, new DummyFormatFactory());
    
    String pattern = "it''s a {dummy} 'test'!";
    ExtendedMessageFormat mf = new ExtendedMessageFormat(pattern, formatRegistry);
    String[] args = {"great"};
    
    // Intentionally test the broken behavior
    try {
        mf.format(args);
        fail("Expected OutOfMemoryError");
    } catch (OutOfMemoryError e) {
        // Expected
    }
    
    // Test the fixed behavior
    mf = new ExtendedMessageFormat(pattern, formatRegistry);
    String formattedPattern = mf.format(args);
    assertNotNull(formattedPattern);
}
