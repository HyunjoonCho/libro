java
public void testAlwaysAsIdOnClass() throws Exception {
    ObjectMapper mapper = new ObjectMapper();
    mapper.enableDefaultTyping(DefaultTyping.NON_FINAL, As.PROPERTY);
    mapper.setVisibility(mapper.getSerializationConfig().getDefaultVisibilityChecker()
           .withFieldVisibility(JsonAutoDetect.Visibility.ANY)
           .withGetterVisibility(JsonAutoDetect.Visibility.NONE)
           .withIsGetterVisibility(JsonAutoDetect.Visibility.NONE)
           .withConstructorVisibility(JsonAutoDetect.Visibility.NONE));

    ReallyAlwaysAsId a = new ReallyAlwaysAsId(1);
    ReallyAlwaysContainer container = new ReallyAlwaysContainer();
    container.a = a;
    container.b = a;

    String json = mapper.writeValueAsString(container);

    assertEquals("{\"a\":1,\"b\":1}", json);
}
