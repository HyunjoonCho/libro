javascript
describe('Casting a function before calling it produces bad code and breaks plugin code', () => {
  it('should produce incorrect code when casting a function', () => {
    let result = castFunctionBeforeCall();
    expect(result).toBe('(0,(new window.ActiveXObject("ShockwaveFlash.ShockwaveFlash")).GetVariable)');
  });

  it('should produce correct code when not casting a function', () => {
    let result = callFunctionDirectly();
    expect(result).toBe('(new window.ActiveXObject("ShockwaveFlash.ShockwaveFlash")).GetVariable');
  });

  function castFunctionBeforeCall() {
    return /* @type {function(!string):!string} */ ((new window.ActiveXObject('ShockwaveFlash.ShockwaveFlash'))['GetVariable'])('$version');
  }

  function callFunctionDirectly() {
    return (new window.ActiveXObject('ShockwaveFlash.ShockwaveFlash'))['GetVariable']('$version');
  }
});
