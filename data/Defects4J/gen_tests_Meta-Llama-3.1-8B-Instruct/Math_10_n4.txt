public void testAtan2SpecialCases() {
    DerivativeStructure dsX = new DerivativeStructure(1, 1, 0);
    DerivativeStructure dsY = new DerivativeStructure(1, 1, 0);
    
    assertEquals(Math.atan2(0, 0), dsX.atan2(dsY));
    assertEquals(FastMath.atan2(0, 0), dsX.atan2(dsY));
    
    dsX = new DerivativeStructure(1, 1, Double.POSITIVE_INFINITY);
    dsY = new DerivativeStructure(1, 1, 0);
    assertEquals(Math.atan2(Double.POSITIVE_INFINITY, 0), dsX.atan2(dsY));
    assertEquals(FastMath.atan2(Double.POSITIVE_INFINITY, 0), dsX.atan2(dsY));
    
    dsX = new DerivativeStructure(1, 1, 0);
    dsY = new DerivativeStructure(1, 1, Double.POSITIVE_INFINITY);
    assertEquals(Math.atan2(0, Double.POSITIVE_INFINITY), dsX.atan2(dsY));
    assertEquals(FastMath.atan2(0, Double.POSITIVE_INFINITY), dsX.atan2(dsY));
    
    dsX = new