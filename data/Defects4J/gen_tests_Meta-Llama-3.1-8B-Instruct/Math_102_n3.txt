public void testChiSquare() {
    double[] expected = {485, 541, 82, 61, 37};
    long[] observed = {500, 623, 72, 70, 31};
    double sumObserved = 1296;
    double sumExpected = 0;
    for (double e : expected) {
        sumExpected += e;
    }
    double scalingFactor = sumObserved / sumExpected;
    double[] correctedExpected = new double[expected.length];
    for (int i = 0; i < expected.length; i++) {
        correctedExpected[i] = expected[i] * scalingFactor;
    }
    assertEquals(9.0233, testStatistic.chiSquare(correctedExpected, observed), 1E-4);
}