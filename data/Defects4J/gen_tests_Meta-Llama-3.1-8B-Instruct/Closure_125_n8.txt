public void testIssue107() {
    // Create a test class with the specified structure
    Class<?> clazz = new Class<?>() {
        public static class T {}
        public static class A extends T {}
        public static class B extends T {}
        public static class X {
            public T type;
            public T f() {
                if (type == A.class) {
                    return new A();
                } else if (type == B.class) {
                    return new B();
                }
                return null;
            }
        }
    };

    // Create an instance of X and call f() on it
    Object x = clazz.newInstance();
    clazz.getField("type").set(x, clazz.getEnumConstants()[0]);
    Object result = clazz.getMethod("f").invoke(x);

    // The test will fail if an exception is thrown
    try {
        // Try to create a FunctionType for the result
        FunctionType.getInstanceType((Function) result);
        fail("Expected an exception");
    } catch (Exception e) {
        // Expected
    }
}