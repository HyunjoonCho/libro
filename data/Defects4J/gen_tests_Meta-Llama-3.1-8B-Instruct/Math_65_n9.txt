public void testAbstractLeastSquares() {
    // Create a test AbstractLeastSquares object with a single observation
    AbstractLeastSquares als = new AbstractLeastSquares(1);
    als.addObservation(1.0, 1.0);
    
    // Set the weights for the observation
    als.setWeights(new double[] { 2.0 });
    
    // Calculate the chi-square
    als.calculateChiSquare();
    
    // Calculate the RMS using the original implementation
    double rmsOriginal = Math.sqrt(als.getChiSquare() / als.getRows());
    
    // Calculate the RMS using the corrected implementation
    als.setChiSquare(als.getResidualsWeightedSumOfSquares());
    double rmsCorrected = Math.sqrt(als.getChiSquare() / als.getRows());
    
    // Assert that the two values are equal
    assertEquals(rmsCorrected, rmsOriginal, 1e-9);
}