java
import org.mozilla.javascript.Context;
import org.mozilla.javascript.Scriptable;
import org.mozilla.javascript.Scriptable;
import org.mozilla.javascript.ScriptableObject;
import org.mozilla.javascript.Error;
import org.junit.Test;
import static org.junit.Assert.assertEquals;

public class JavaScriptCompilerTest {

    @Test
    public void testLastWarningOrErrorTruncated() throws Exception {
        Context ctx = Context.enter();
        Scriptable scope = ctx.initStandardObjects();
        try {
            ctx.evaluateString(scope, "var foo = 1; alert(foo); alert(bar);", "test.js", 1, null);
            fail("Expected an error or warning");
        } catch (Exception e) {
            String output = e.getMessage();
            System.out.println(output);
            assertEquals("test.js:1: ERROR - variable bar is undefined", output);
            assertEquals("2 error(s), 0 warning(s)", output.split("\n")[1]);
        } finally {
            Context.exit();
        }
    }
}
