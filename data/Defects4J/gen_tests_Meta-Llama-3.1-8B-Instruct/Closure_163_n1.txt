public void testVarCheckCrashWhenUsingModules() throws Exception {
    String[] args = new String[] {
        "--compilation_level", "ADVANCED_OPTIMIZATIONS",
        "--formatting", "PRETTY_PRINT",
        "--debug",
        "--module", "jquery:1",
        "--module", "core:1:jquery",
        "--module_output_path_prefix", "mod",
        "--js", "src/main/resources/jquery.js",
        "--js", "src/main/resources/core.js",
        "--externs", "src/main/resources/qunit_externs.js"
    };
    ProcessBuilder processBuilder = new ProcessBuilder("java", "-jar", "compiler.jar", args);
    Process process = processBuilder.start();
    int exitValue = process.waitFor();
    assertTrue("Compilation failed with exit code " + exitValue, exitValue == 0);
}