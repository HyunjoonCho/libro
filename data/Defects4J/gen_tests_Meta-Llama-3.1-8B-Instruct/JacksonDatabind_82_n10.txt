public void testJsonIgnorePropertiesAllowSetters() {
    ObjectMapper mapper = new ObjectMapper();
    JsonTest json = new JsonTest("user", "password");

    try {
        mapper.setVisibility(PropertyAccessor.FIELD, Visibility.NONE);
        mapper.setVisibility(PropertyAccessor.GETTER, Visibility.ANY);
        mapper.setVisibility(PropertyAccessor.SETTER, Visibility.NONE);

        String jsonStr = mapper.writeValueAsString(json);
        assertEquals("{\"username\":\"user\"}", jsonStr);

        json = mapper.readValue("{\"username\":\"newuser\"}", JsonTest.class);
        assertEquals("newuser", json.getUsername());
        assertEquals(null, json.getPassword());
    } catch (JsonProcessingException e) {
        fail(e.getMessage());
    } catch (IOException e) {
        fail(e.getMessage());
    }
}