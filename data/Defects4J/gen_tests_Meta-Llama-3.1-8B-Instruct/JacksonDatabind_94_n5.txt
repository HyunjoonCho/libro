java
import com.mchange.v2.c3p0.ConnectionManager;
import com.mchange.v2.c3p0.PoolBackedDataSource;
import com.mchange.v2.c3p0.TestUtils;
import com.mchange.v2.c3p0:type=PoolBackedDataSource;
import com.mchange.v2.c3p0:type=TestUtils;
import org.junit.Test;

import javax.sql.DataSource;
import java.sql.Connection;
import java.sql.SQLException;

public class C3p0BlockTest {

    @Test(expected = SQLException.class)
    public void testC3p0Block() throws SQLException {
        PoolBackedDataSource ds = new PoolBackedDataSource();
        ds.setJdbcUrl("jdbc:h2:mem:");
        ds.setUser("sa");
        ds.setPassword("");
        ds.setInitialPoolSize(1);
        ds.setMinPoolSize(1);
        ds.setMaxPoolSize(1);

        DataSource dataSource = new com.mchange.v2.c3p0:type=PoolBackedDataSource();
        dataSource = ds;

        Connection conn = dataSource.getConnection();
        // Some operation to trigger the bug
        conn.createStatement().execute("SELECT 1");
        conn.close();
    }
}
