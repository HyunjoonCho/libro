java
import com.google.javascript.jscomp.Compiler;
import com.google.javascript.jscomp.CompilerOptions;
import com.google.javascript.jscomp.SourceFile;
import com.google.javascript.jscomp.ProcessCommonJSModules;
import org.junit.Test;
import static org.junit.Assert.assertEquals;
import static org.junit.Assert.fail;

public class TestProcessCommonJSModules {
    @Test
    public void testProcessCommonJSModules() throws Exception {
        // Define the echo.js module
        String echoJs = "define(function() { return { echo: function(val) { window.console.log(val); } }; });";

        // Define the echo-main.js entry point
        String echoMainJs = "var echo = require('echo'); echo.echo('hello world');";

        // Compile with ProcessCommonJSModules
        CompilerOptions options = new CompilerOptions();
        options.setWarningLevel(CompilerOptions.WarningLevel.REPORT);
        options.setLanguageIn(CompilerOptions.LanguageMode.ECMASCRIPT3);
        options.setLanguageOut(CompilerOptions.LanguageMode.ECMASCRIPT3);
        options.setPrettyPrint(true);
        options.setCheckTypes(true);
        options.setCompilationLevel(CompilerOptions.CompilationLevel.SIMPLE_OPTIMIZATIONS);
        options.setProcessCommonJSModules