public void testProcessClosurePrimitives() throws Exception {
    File file1 = File.createTempFile("test1", ".js");
    file1.deleteOnExit();
    File file2 = File.createTempFile("test2", ".js");
    file2.deleteOnExit();

    FileWriter writer1 = new FileWriter(file1);
    writer1.write("goog.provide('test1');");
    writer1.close();

    FileWriter writer2 = new FileWriter(file2);
    writer2.write("goog.provide('test2');");
    writer2.close();

    Process process = Runtime.getRuntime().exec(new String[] {"java", "-jar", "compiler.jar", "--process_closure_primitives", "false", file1.getAbsolutePath()});
    assertEquals(1, process.waitFor());

    process = Runtime.getRuntime().exec(new String[] {"java", "-jar", "compiler.jar", "--process_closure_primitives", "true", file2.getAbsolutePath()});
    assertEquals(1, process.waitFor());

    // Check if the files have been modified
    assertTrue(new File(file1.getAbsolutePath() + ".js").exists());
    assertTrue(new File(file2.getAbsolutePath() + ".js").exists());
}