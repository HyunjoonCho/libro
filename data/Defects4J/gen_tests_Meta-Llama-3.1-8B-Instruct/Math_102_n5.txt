java
public void testChiSquare() {
    double[] expected = {485, 541, 82, 61, 37};
    long[] observed = {500, 623, 72, 70, 31};
    double sumObserved = 1296;
    double sumExpected = 0;
    for (int i = 0; i < expected.length; i++) {
        sumExpected += expected[i];
    }
    double[] rescaledExpected = new double[expected.length];
    for (int i = 0; i < expected.length; i++) {
        rescaledExpected[i] = (double) observed[i] / sumObserved * sumExpected;
    }
    double chiSquareExpected = testStatistic.chiSquare(rescaledExpected, observed);
    double chiSquareActual = testStatistic.chiSquare(expected, observed);
    assertEquals(chiSquareExpected, chiSquareActual, 1E-10);
}
