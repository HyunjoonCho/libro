public void testChiSquare() {
    long[] observed1 = { 500, 623, 72, 70, 31 };
    double[] expected1 = { 485, 541, 82, 61, 37 };
    double sumExpected = 0;
    for (double d : expected1) {
        sumExpected += d;
    }
    double sumObserved = 0;
    for (long l : observed1) {
        sumObserved += l;
    }
    double[] expected1Corrected = new double[expected1.length];
    for (int i = 0; i < expected1.length; i++) {
        expected1Corrected[i] = (sumObserved / sumExpected) * expected1[i];
    }
    assertEquals(9.0233, testStatistic.chiSquare(expected1Corrected, observed1), 1E-10);
}