javascript
function someFunction(anyExpression, externalRef) {
    var fn1;
    var fn2;

    if (anyExpression) {
        fn2 = externalRef;
        fn1 = function (content) {
            return fn2();
        }
    }

    return {
        method1: function () {
            if (fn1) fn1();
            return true;
        },
        method2: function () {
            return false;
        }
    }
}

describe("Test someFunction", function() {
    it("should replace true/false with!0/!1", function() {
        var result = someFunction(true, function() { return true; });
        expect(result.method1()).toBe(true);
        expect(result.method2()).toBe(false);

        var result2 = someFunction(false, function() { return false; });
        expect(result2.method1()).toBeUndefined();
        expect(result2.method2()).toBe(false);
    });
});
