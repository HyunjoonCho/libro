public void testPrototypeMethodRemoved() {
    Object foo = new Object();
    foo.getClass().getField("bar").set(foo, new Object() {
        public void bar1() {
            System.out.println("bar1");
        }
    });

    Object foobar = new Object();
    foobar.getClass().getField("bar").set(foobar, foo.getClass().getField("bar").get(foo));

    try {
        ((Method) foo.getClass().getField("bar").get(foobar).getClass().getMethod("bar1")).invoke(foo.getClass().getField("bar").get(foobar));
        fail("Expected exception");
    } catch (Exception e) {
        // expected
    }
}