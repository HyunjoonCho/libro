java
import com.fasterxml.jackson.annotation.JsonIdentityInfo;
import com.fasterxml.jackson.annotation.JsonCreator;
import com.fasterxml.jackson.annotation.JsonProperty;

@JsonIdentityInfo(generator = ObjectIdGenerators.PropertyGenerator.class, property = "id")
public class Parent {
    public int id;
    @JsonCreator
    public Parent(@JsonProperty("id") int id) {
        this.id = id;
    }
}

@JsonIdentityInfo(generator = ObjectIdGenerators.PropertyGenerator.class, property = "id")
public class Child {
    public int id;
    @JsonCreator
    public Child(@JsonProperty("id") int id) {
        this.id = id;
    }
}

public class Test {
    public static void main(String[] args) throws Exception {
        ObjectMapper mapper = new ObjectMapper();

        Parent parent = new Parent(1);
        Child child = new Child(2);

        // Test deserialization with both patches
        String json = "{\"id\":2,\"parent\":{\"id\":1,\"child\":{\"id\":2}}}";
        mapper.readerForUpdating(parent).