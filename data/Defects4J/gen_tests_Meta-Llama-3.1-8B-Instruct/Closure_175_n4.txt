public void testIssue() throws Exception {
    // Create a JavaScript engine
    JavaScriptEngineManager manager = new JavaScriptEngineManager();
    ScriptEngine engine = manager.getEngineByName("javascript");
    
    // Compile the JavaScript code
    String input = "window['anchor'] = function (obj, modifiesProp) { return (function (saved) { return modifiesProp(obj) + saved; })(obj['prop']); }";
    String externs = "window['prop'] = 'test';";
    String compilationLevel = "ADVANCED_OPTIMIZATIONS";
    String warningLevel = "VERBOSE";
    
    NashornScriptEngineFactory factory = (NashornScriptEngineFactory) engine.getFactory();
    engine.put("window", factory.createScript("window = {}").getEngine().getContext());
    
    // Run the test
    engine.eval(externs);
    engine.eval("var result = window.anchor({prop: 'test'}, function(obj) { obj.prop = 'new test'; });");
    
    // Check the result
    Object result = engine.get("result");
    String expected = "new test test";
    String actual = result.toString();
    assertEquals(expected, actual);
}