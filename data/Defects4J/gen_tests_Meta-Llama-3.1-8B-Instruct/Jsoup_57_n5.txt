public void testRemoveIgnoreCaseConcurrentModificationException() {
    Element element = new Element("abc");
    element.addAttribute("attr1", "value1");
    element.addAttribute("attr2", "value2");
    element.addAttribute("attr3", "value3");

    // This should throw a ConcurrentModificationException
    for (Attribute attribute : element.getAttributes()) {
        if (attribute.getName().equalsIgnoreCase("attr1")) {
            element.removeAttribute(attribute);
        }
    }

    // This should not throw a ConcurrentModificationException
    for (Iterator<Map.Entry<String, Attribute>> iter = element.getAttributes().entrySet().iterator(); iter.hasNext();) {
        Map.Entry<String, Attribute> entry = iter.next();
        if (entry.getKey().equalsIgnoreCase("attr2")) {
            iter.remove();
        }
    }
}