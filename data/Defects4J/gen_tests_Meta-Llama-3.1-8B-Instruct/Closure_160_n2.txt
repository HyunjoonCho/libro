public void testCheckVarsUndefinedVars() {
    String jsCode = "foo = {}; foo.bar = function() { alert(this.baz); };";
    String[] expectedWarnings = {"test.js:2: WARNING - dangerous use of the global this object",
            "test.js:1: ERROR - variable foo is undefined"};
    String[] expectedWarningsVerbose = {"test.js:2: WARNING - dangerous use of the global this object",
            "test.js:1: ERROR - variable foo is undefined"};
    String[] expectedWarningsGlobalThis = {"test.js:2: WARNING - dangerous use of the global this object"};
    
    String[] warningsCheckVars = compiler.compile(jsCode).getWarnings();
    String[] warningsUndefinedVars = compiler.compile(jsCode).getWarnings();
    String[] warningsVerbose = compiler.compile(jsCode, "--warning_level=VERBOSE").getWarnings();
    String[] warningsGlobalThis = compiler.compile(jsCode, "--jscomp_warning=globalThis").getWarnings();
    
    assertArrayEquals(expectedWarningsVerbose, warningsVerbose);
    assertArrayEquals(expectedWarningsGlobalThis, warningsGlobalThis);
    assertArrayEquals(expectedWarnings, warningsCheckVars);
    assertArrayEquals(expectedWarnings, warningsUndefinedVars);
}