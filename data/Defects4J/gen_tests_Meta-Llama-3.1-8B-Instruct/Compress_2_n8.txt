java
import java.io.*;

public void testArDelete() throws IOException {
    // Create an empty archive
    ByteArrayOutputStream bos = new ByteArrayOutputStream();
    ArchiveArchive archive = new ArchiveArchive(bos);
    archive.put("test1.xml");
    archive.put("test2.xml");

    // Delete test2.xml
    archive.delete("test2.xml");

    // Check that getNextEntry returns null
    assert archive.getNextEntry() == null;

    // Save the archive
    archive.close();

    // Load the archive
    ArchiveArchive loadedArchive = new ArchiveArchive(new ByteArrayInputStream(bos.toByteArray()));

    // Check that test2.xml is still in the archive
    InputStream stream = loadedArchive.get("test2.xml");
    assertNotNull(stream);

    // Now add a new file to the archive
    loadedArchive.put("test.txt");

    // Save the archive
    loadedArchive.close();

    // Try to load the archive again
    loadedArchive = new ArchiveArchive(new ByteArrayInputStream(bos.toByteArray()));

    // Check that the archive is now corrupted
    try {
        loadedArchive.getNextEntry();
        fail("Expected IOException");
    } catch (IOException e) {
        assertEquals("Inappropriate file type or format", e.getMessage());
    }
}
