public void testSmartNameRemoval() {
    CompilationUnit cu = new CompilationUnit();
    Scriptable scope = cu.newScope();
    ScriptableObject goog = scope.newObject();
    scope.put("goog", scope, goog);
    goog.put("inherits", scope, new NativeJavaObject(scope, new Function() {
        public Object call(Context cx, Scriptable scope, Scriptable thisObj, Object[] args) {
            // Simulate goog.inherits behavior
            Object x = (ScriptableObject) args[0];
            Object y = (ScriptableObject) args[1];
            return y;
        }
    }));

    ScriptableObject ns = scope.newObject();
    scope.put("ns", scope, ns);

    ScriptableObject pageSelectionModel = scope.newObject();
    scope.put("PageSelectionModel", scope, pageSelectionModel);

    ScriptableObject fooEvent = scope.newObject();
    scope.put("FooEvent", scope, fooEvent);

    ScriptableObject selectEvent = scope.newObject();
    scope.put("SelectEvent", scope, selectEvent);

    pageSelectionModel.put("ChangeEvent", pageSelectionModel, selectEvent);
    goog.get("inherits").call(null, pageSelectionModel, fooEvent);

    try {
        scope.put("