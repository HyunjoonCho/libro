java
import com.google.javascript.jscomp.CompilationLevel;
import com.google.javascript.jscomp.Compiler;
import com.google.javascript.jscomp.JSModule;
import com.google.javascript.jscomp.SourceFile;
import com.google.javascript.jscomp.SourceMap;

import java.io.IOException;

public class TestCompiler {
    public void testCompilerCrash() throws IOException {
        String code = "dojox.gfx.shape.Shape = function(params) {}; dojox.gfx.shape.Shape = dojo.declare('dojox.gfx.shape.Shape', null, /** @lends dojox.gfx.shape.Shape.prototype */ { });";
        SourceFile file = SourceFile.fromCode("test.js", code);
        Compiler compiler = new Compiler();
        compiler.setCompilationLevel(CompilationLevel.SIMPLE_OPTIMIZATIONS);
        JSModule module = compiler.compile(file);
        SourceMap sourceMap = module.getSourceMap();
        assert sourceMap!= null; // compiler should not crash
    }
}
