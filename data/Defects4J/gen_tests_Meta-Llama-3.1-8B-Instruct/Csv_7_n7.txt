java
public void testHeaderMapWithDuplicateColumnNames() throws IOException {
    // Given a parser format for csv files with a header line
    CSVFormat myFormat = CSVFormat.RFC4180.withDelimiter(",").withQuoteChar('"')
           .withQuotePolicy(Quote.MINIMAL).withIgnoreSurroundingSpaces(true).withHeader().withSkipHeaderRecord(true);

    // Create a CSV file with duplicate header names
    try (CSVParser parser = new CSVParser(myFormat, new StringReader("Col1,Col2,Col2,Col3,Col4\n1,2,3,4,5\n4,5,6,7,8"))) {
        CSVParserSettings settings = parser.getSettings();
        HeaderMap headerMap = settings.getHeaderMap();

        // The HeaderMap should not miss an entry due to duplicate column names
        assertEquals(5, headerMap.size());
        assertEquals("Col1", headerMap.get(0));
        assertEquals("Col2", headerMap.get(1));
        assertEquals("Col2", headerMap.get(2)); // This should not be null
        assertEquals("Col3", headerMap.get(3));
        assertEquals("Col4", headerMap.get(4));
    }
