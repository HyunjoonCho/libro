public void testDeepStubbingWithGenerics() {
    MyClass1 myMock1 = mock(MyClass1.class, RETURNS_DEEP_STUBS);

    when(myMock1.getNested()).thenReturn(mock(MyClass2.class, RETURNS_DEEP_STUBS));
    when(myMock1.getNested().getNested()).thenReturn(mock(MyClass3.class, RETURNS_DEEP_STUBS));
    when(myMock1.getNested().getNested().returnSomething()).thenReturn("Hello World.");

    MyClass1 nested = myMock1.getNested();
    MyClass2 nested2 = nested.getNested();
    MyClass3 nested3 = nested2.getNested();
    assertEquals("Hello World.", nested3.returnSomething());
}