public void testSelfReferentialInterface() {
    interface GenericsSelfReference<T extends GenericsSelfReference<T>> {
        T self();
    }

    GenericMetadataSupport genericMetadata = new GenericMetadataSupport();
    Method method = GenericsSelfReference.class.getMethod("self");
    Type type = genericMetadata.inferFrom(GenericsSelfReference.class).resolveGenericReturnType(method);
    try {
        genericMetadata.rawType(type);
        fail("Expected StackOverflowError");
    } catch (StackOverflowError e) {
        // expected
    }
}