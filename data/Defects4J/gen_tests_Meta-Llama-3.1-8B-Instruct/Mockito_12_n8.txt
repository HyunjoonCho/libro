public void testArgumentCaptorVarargs() {
    ArgumentCaptor<Integer> captor = ArgumentCaptor.forClass(Integer.class);
    when(mockMethod(Integer.class)).thenReturn("integer");
    when(mockMethod((Integer[]) new Integer[] { 1, 2, 3 })).thenReturn("array");
    verify(mockMethod).with(captor.capture());
    verify(mockMethod).with(captor.capture());
    assertEquals(Arrays.asList(1, 2, 3), captor.getAllValues());
}