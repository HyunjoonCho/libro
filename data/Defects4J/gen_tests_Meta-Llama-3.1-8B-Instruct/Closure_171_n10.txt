public void testObjectPrototypeAssignment() {
    class Foo {
    }
    Foo foo = new Foo();
    Runnable r = new Runnable() {
        @Override
        public void run() {
            foo.getClass().getDeclaredField("prototype").set(foo, new Object() {
                public void alert() {
                    System.out.println("hello world");
                }
            });
        }
    };
    r.run();
    try {
        foo.getClass().getDeclaredField("alert").get(foo);
        fail("Expected NullPointerException");
    } catch (NullPointerException e) {
        // expected
    }
}