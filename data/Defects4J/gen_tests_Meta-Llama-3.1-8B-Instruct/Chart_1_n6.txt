java
public void testIssue983() {
    // Create a plot with a null dataset
    JFreeChart chart = new JFreeChart("Test Chart", PlotOrientation.VERTICAL, false, true, false);
    CategoryPlot plot = (CategoryPlot) chart.getPlot();
    plot.setDataset(null);

    AbstractCategoryItemRenderer renderer = new AbstractCategoryItemRenderer();
    renderer.setPlot(plot);

    LegendItemCollection result = renderer.getLegendItems();
    // This should not throw a NullPointerException
    assertNotNull(result);
}
