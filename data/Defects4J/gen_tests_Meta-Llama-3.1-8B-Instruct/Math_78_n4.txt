public void testODEIntegrationEventDetection() {
    // create an ODE solver and a switching function
    // for simplicity, we'll use a simple function that switches at 90 and 135
    ODEIntegrator solver = new ODEIntegrator() {
        @Override
        public double[] solve(double[] y0, double t0, double tEnd) {
            // switching function that switches at 90 and 135
            if (t0 < 90) return new double[] {1};
            else if (t0 < 135) return new double[] {-1};
            else return new double[] {0};
        }
    };

    // set up the events to detect
    EventDetector eventDetector = new EventDetector() {
        @Override
        public double[] detectEvents(double[] y, double t, double[] yDot) {
            if (t < 135) return new double[] {90};
            return new double[0];
        }
    };

    // set up the step size to make the events close
    double[] y0 = new double[] {1};
    double t0 = 67.5;
    double tEnd = 112.5;
    double