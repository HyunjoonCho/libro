public void testInstanceOfUnreachableCode() {
    try {
        Object value = new Object();
        boolean result = instanceOf(value, Object.class);
    } catch (Exception e) {
        fail("Expected no exception, but caught: " + e.getMessage());
    }
}

private boolean instanceOf(Object value, Class<?> type) {
    try {
        if (value instanceof type) {
            return true;
        }
    } catch (Exception exception) {
        if (exception instanceof ClassCastException) {
            throw exception; // indicates that "type" is not a type
        }
        // Otherwise, assume the exception was caused by 
        // the Firefox 1.0.3 bug. Work around it.
        return (type == Object.class);
    }
}