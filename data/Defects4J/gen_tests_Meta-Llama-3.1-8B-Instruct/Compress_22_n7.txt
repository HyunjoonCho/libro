public void testReadTruncated() throws IOException {
    byte[] data = new byte[770];
    Arrays.fill(data, (byte) 0x01);
    BZip2CompressorInputStream bis = new BZip2CompressorInputStream(new ByteArrayInputStream(data));
    bis.mark(1000);
    int bytesRead = bis.read(new byte[100]);
    bis.reset();
    assertEquals(769, bytesRead);
    byte[] readData = new byte[100];
    bis.read(readData);
    assertEquals(769, bis.getBytesRead());
}