bash
# Create a directory structure:
# build/
#   compiler.jar
# lib/
#     Foo.js
#     Bar.js
# Makefile

# lib/Foo.js
define(function() {
  console.log("Foo module loaded");
});

# lib/Bar.js
define(["lib/Foo"], function(Foo) {
  console.log("Bar module loaded");
});

# Makefile
JS_COMPILER =./build/compiler.jar
JS_OUT = out.js

all: $(JS_OUT)

$(JS_OUT): Bar.js lib/Foo.js
  java -jar $(JS_COMPILER) --transform_amd_modules --process_common_js_modules --common_js_entry_module=Bar.js --compilation_level=ADVANCED_OPTIMIZATIONS --js_output_file=$@ --js=Bar.js --js=lib/Foo.js

clean:
  rm -f $(JS_OUT)

test:
  @echo "Running test"
  node $(JS_OUT)
