public void testAmdModuleInSubdirectory() throws Exception {
    File output = new File("out.js");
    File fooJs = new File("lib/Foo.js");
    File barJs = new File("Bar.js");
    ProcessBuilder pb = new ProcessBuilder("java", "-jar", "compiler.jar",
            "--transform_amd_modules", "--process_common_js_modules",
            "--common_js_entry_module=Bar.js", "--compilation_level=ADVANCED_OPTIMIZATIONS",
            "--js_output_file=out.js", "--js=" + barJs.getAbsolutePath(), "--js=" + fooJs.getAbsolutePath());
    pb.directory(new File("."));
    Process process = pb.start();
    int exitCode = process.waitFor();
    assertEquals(1, exitCode);
    assertTrue("Expected error message'required entry point \"module$lib$Foo\" never provided'", output.exists());
}