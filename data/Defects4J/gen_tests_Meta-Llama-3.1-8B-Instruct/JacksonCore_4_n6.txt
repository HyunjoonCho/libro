java
import com.fasterxml.jackson.core.JsonFactory;
import com.fasterxml.jackson.core.JsonParser;
import com.fasterxml.jackson.core.JsonToken;
import com.fasterxml.jackson.core.util.TextBuffer;

import org.junit.Test;

import static org.junit.Assert.assertThrows;

public class TextBufferTest {

    @Test
    public void testTextBufferOverflow() throws Exception {
        JsonFactory factory = new JsonFactory();
        JsonParser parser = factory.createParser(new StringInputStream("a".repeat(262145)));
        parser.nextToken(); // move to the start of the string
        TextBuffer buffer = parser.getCodec().getFactory().newTextBuffer();
        assertThrows(IllegalArgumentException.class, () -> buffer.writeUTF8String("verylongkey".repeat(262144)));
    }
}
