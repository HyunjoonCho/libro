public void testArDeletion() throws IOException {
    // Create an archive with two entries
    try (ZipArchive archive = new ZipArchive("bla.ar")) {
        archive.put("test1.xml", "test1.xml contents".getBytes());
        archive.put("test2.xml", "test2.xml contents".getBytes());
    }

    // Delete the second entry
    try (ZipArchive archive = new ZipArchive("bla.ar")) {
        archive.delete("test2.xml");
    }

    // Check that getNextEntry returns null
    try (ZipArchive archive = new ZipArchive("bla.ar")) {
        assertEquals(null, archive.getNextEntry());
    }

    // Check that the archive is still corrupt
    try {
        Process process = Runtime.getRuntime().exec(new String[] {"ar", "-t", "bla.ar"});
        assertEquals(1, process.waitFor());
    } catch (IOException | InterruptedException e) {
        fail("Expected 'ar: /tmp/dir24825/bla.ar: Inappropriate file type or format' exception");
    }
}