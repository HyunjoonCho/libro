public void testTypeCheckerMissesAnnotationsOnFunctionsDefinedWithinFunctions() {
    JSTypeCheck test = new JSTypeCheck();
    test.compile("var ns = {}; var d = function() { ns.a(); ns.a(123); }; " +
            "(function() { ns.a = function(b) {}; })();");
    assertTrue(test.getWarningCount() == 2);
    
    test.compile("var ns = {}; var d = function() { ns.a(); ns.a(123); }; " +
            "(function() { /** @param {string=} b */ ns.a = function(b) {}; })();");
    assertTrue(test.getWarningCount() == 1);
    
    test.compile("var ns = {}; (function() { /** @param {string=} b */ ns.a = function(b) {}; })(); ns.a(); ns.a(123);");
    assertTrue(test.getWarningCount() == 1);
    
    test.compile("var ns = {}; (function() { /** @param {string=} b */ ns.a = function(b) {}; })();");
    assertTrue(test.getWarningCount() == 0);
}