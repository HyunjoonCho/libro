java
import org.jsoup.helper.DataUtil;
import org.junit.Test;

import java.io.ByteArrayInputStream;
import java.nio.charset.StandardCharsets;

import static org.junit.Assert.assertEquals;

public class DataUtilTest {

    @Test
    public void testUtf16BomHandling() throws Exception {
        byte[] utf16Bom = new byte[]{(byte) 0xFE, (byte) 0xFF};
        byte[] utf8Bom = new byte[]{(byte) 0xEF, (byte) 0xBB, (byte) 0xBF};
        byte[] data = "Hello, World!".getBytes(StandardCharsets.UTF_16);

        ByteArrayInputStream utf16Stream = new ByteArrayInputStream(utf16Bom);
        utf16Stream.write(data);

        ByteArrayInputStream utf8Stream = new ByteArrayInputStream(utf8Bom);
        utf8Stream.write(data);

        byte[] utf16Bytes = DataUtil.parseByteData(utf16Stream);
        byte[] utf8Bytes = DataUtil.parseByteData(utf8Stream);

        assertEquals(StandardCharsets.UTF_16, java.nio.charset.Charset.forName(new String(utf16Bytes)));
        assertEquals(StandardCharsets.UTF_8, java.nio.charset.Charset.forName(new String(utf8Bytes)));
    }
}
