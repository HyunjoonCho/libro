public void testDerivativeStructureAtan2() {
    DerivativeStructure dsX = new DerivativeStructure(1, 1, 1, 0);
    DerivativeStructure dsY = new DerivativeStructure(1, 1, 1, 0);
    assertEquals(Math.atan2(0, 0), dsX.atan2(dsY));
    dsX.setValue(0);
    assertEquals(Math.atan2(0, 0), dsX.atan2(dsY));
    dsY.setValue(0);
    assertEquals(Math.atan2(0, 0), dsX.atan2(dsY));
    assertEquals(Double.NaN, Double.NaN);
    dsX.setValue(Double.NaN);
    assertEquals(Double.NaN, dsX.atan2(dsY));
    dsY.setValue(Double.NaN);
    assertEquals(Double.NaN, dsX.atan2(dsY));
}