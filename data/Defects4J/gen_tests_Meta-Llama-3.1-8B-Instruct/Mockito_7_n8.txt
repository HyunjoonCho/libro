public void testDeepStubbingWithGenerics() {
    MyClass1 myMock1 = mock(MyClass1.class, RETURNS_DEEP_STUBS);

    when(myMock1.getNested()).thenReturn(new MyClass2() {
        @Override
        public MyClass3 getNested() {
            return mock(MyClass3.class);
        }
    });

    when(myMock1.getNested().getNested()).thenReturn(mock(MyClass3.class));

    when(myMock1.getNested().getNested().returnSomething()).thenReturn("Hello World.");

    MyClass3 nested = myMock1.getNested().getNested();
    MyClass2 outer = myMock1.getNested();
    MyClass1 mock1 = myMock1;
}