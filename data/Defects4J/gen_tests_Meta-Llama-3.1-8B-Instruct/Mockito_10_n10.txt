public void testReturnsDeepStubsSerializability() {
    NotSerializableReturnValue notSerializableReturnValue = new NotSerializableReturnValue("");
    ToBeMocked toBeMocked = mock(ToBeMocked.class, withSettings().serializable());
    when(toBeMocked.getSomething()).thenReturn(notSerializableReturnValue);
    try {
        toBeMocked.getSomething();
        fail("Expected MockitoException");
    } catch (MockitoException e) {
        assertEquals("You are using the setting 'withSettings().serializable()' however the type you are trying to mock 'NotSerializableReturnValue' does not implement Serializable AND does not have a no-arg constructor.", e.getMessage());
    }
}