public void testPearsonsCorrelationPrecision() {
    double[] data = new double[1000];
    Random rand = new Random(123);
    for (int i = 0; i < 1000; i++) {
        data[i] = rand.nextDouble();
    }
    PearsonsCorrelation correlation = new PearsonsCorrelation(data);
    double[] pValues = correlation.getCorrelationPValues();
    double[] expectedPValues = new double[pValues.length];
    for (int i = 0; i < pValues.length; i++) {
        double[] t = new double[1];
        t[0] = correlation.getCorrelationCoefficient()[i];
        double p = 2 * (1 - Math.min(1, correlation.getTStatistic()[i].cumulativeProbability(t[0])));
        expectedPValues[i] = p;
    }
    for (int i = 0; i < pValues.length; i++) {
        assertEquals(expectedPValues[i], pValues[i], 1e-15);
    }
}