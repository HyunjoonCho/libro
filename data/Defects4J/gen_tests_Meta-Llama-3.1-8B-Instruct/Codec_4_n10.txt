public void testBase64EncodingCRLF() {
    Base64 b64 = new Base64();
    String longString = "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa";
    byte[] longBytes = longString.getBytes("UTF-8");
    byte[] encoded = b64.encode(longBytes);
    String expected = "YWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYQ==";
    int expectedLines = 2;
    int actualLines = encoded.length / 76 + 1;
    if (encoded.length % 76!= 0) {
        expectedLines++;
    }
    if (!Arrays.equals(Arrays.copyOfRange(encoded, 0, expected.length()), expected.getBytes("UTF-8"))) {
        fail("Incorrect encoding");
    }
    if (actualLines!= expectedLines) {
        fail("Incorrect line count");
    }
}