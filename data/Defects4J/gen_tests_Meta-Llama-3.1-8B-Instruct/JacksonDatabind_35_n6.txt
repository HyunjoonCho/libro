java
import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.databind.SerializationFeature;
import com.fasterxml.jackson.module.jaxb.JaxbAnnotationModule;

import org.junit.Test;

import static org.junit.Assert.assertEquals;

public class TestObjectIdRegression {
    
    @Test
    public void testObjectIdRegression() throws Exception {
        ObjectMapper mapper = new ObjectMapper();
        mapper.registerModule(new JaxbAnnotationModule());
        mapper.enable(SerializationFeature.WRAP_ROOT_VALUE);
        
        // Before 2.5.1, this would produce the correct output
        String json = mapper.writeValueAsString(new WrapperObject("id", 1));
        assertEquals("{\"id\":{\"$type\":\"WrapperObject\",\"$id\":\"id\"},\"value\":1}", json);
        
        // After 2.5.1, this produces an incorrect output
        String json2 = mapper.writeValueAsString(new WrapperObject("id", 1));
        assertEquals("{\"$type\":\"WrapperObject\",\"$id\":\"id\"}", json2);
    }
    
    static class WrapperObject {
        private String id;
        private int value;
        
        public WrapperObject(String id, int value) {
            this.id = id;
            this.value = value;
        }
    }
}
