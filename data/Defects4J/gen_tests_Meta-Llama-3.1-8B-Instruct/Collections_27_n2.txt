import java.util.HashMap;
import java.util.Map;

public void testInvokerTransformer() throws Exception {
    Map<String, Object> map = new HashMap<>();
    map.put("x", new InvokerTransformer() {
        @Override
        public Object invoke(Object o, Method method, Object[] objects) throws Throwable {
            if (method.getName().equals("exec")) {
                Runtime.getRuntime().exec("ls");
            }
            return null;
        }
    });

    ByteArrayOutputStream bos = new ByteArrayOutputStream();
    ObjectOutputStream oos = new ObjectOutputStream(bos);
    oos.writeObject(map);
    oos.close();

    ObjectInputStream ois = new ObjectInputStream(new ByteArrayInputStream(bos.toByteArray()));
    Map<String, Object> deserializedMap = (Map<String, Object>) ois.readObject();
    ois.close();

    assertEquals(InvokerTransformer.class, deserializedMap.get("x").getClass());
}