java
import org.mozilla.javascript.Context;
import org.mozilla.javascript.Scriptable;

public class TestIssue {
    public void testIssue() {
        Context context = Context.enter();
        Scriptable scope = context.initStandardObjects();
        context.evaluateString(scope, "var fn1; var fn2;", "test", 1, null);
        context.evaluateString(scope, "if (true) { fn2 = externalRef; fn1 = function (content) { return fn2(); } }", "test", 1, null);
        context.evaluateString(scope, "function someFunction() { var a, b; true && (b = externalRef, a = function () { return b() }); return { method1: function () { a && a(); return true }, method2: function () { return false } } }", "test", 1, null);
        Scriptable result = context.evaluateString(scope, "someFunction().method1()", "test", 1, null);
        assertEquals(true, context.toBoolean(result));
    }
}
