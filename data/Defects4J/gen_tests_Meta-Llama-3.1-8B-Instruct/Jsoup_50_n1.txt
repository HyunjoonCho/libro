java
public void testBomHandling() throws Exception {
    byte[] utf16Bom = new byte[] {(byte) 0xFF, (byte) 0xFE, (byte) 0xFF};
    byte[] utf8Bom = new byte[] {(byte) 0xEF, (byte) 0xBB, (byte) 0xBF};
    byte[] utf16BomData = "Hello, World!".getBytes("UTF-16BE");
    byte[] utf8Data = "Hello, World!".getBytes("UTF-8");

    byte[] utf16Stream = new byte[utf16Bom.length + utf16BomData.length];
    System.arraycopy(utf16Bom, 0, utf16Stream, 0, utf16Bom.length);
    System.arraycopy(utf16BomData, 0, utf16Stream, utf16Bom.length, utf16BomData.length);

    byte[] utf8Stream = new byte[utf8Bom.length + utf8Data.length];
    System.arraycopy(utf8Bom, 0, utf8Stream, 0, utf8Bom.length);
    System.arraycopy(utf8Data, 0, utf8Stream, utf8Bom.length