public void testTypedefWarning() {
    String code = 
        "goog.provide('bug');\n" +
        "bug.sharedMethod = function() {};\n" +
        "bug.A = function() {};\n" +
        "bug.B = function() {};\n" +
        "bug.Thing = goog.typedef;\n" +
        "goog.scope(function() {\n" +
        "  var sharedMethod = bug.sharedMethod;\n" +
        "  sharedMethod();\n" +
        "});";
    
    CompilationUnit unit = parseCode(code);
    assertCompilationUnitHasWarning(unit, "WARNING - @this type of a function must be an object");
}

private CompilationUnit parseCode(String code) {
    // implementation to parse the given code into a CompilationUnit
}