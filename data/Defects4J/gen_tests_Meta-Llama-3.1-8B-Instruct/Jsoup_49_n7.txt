public void testInsertChildrenBug() {
    Document doc = new Document("");
    Element body = doc.appendElement("body");
    Element div1 = body.appendElement("div1");
    Element div2 = body.appendElement("div2");
    Element div3 = body.appendElement("div3");
    Element div4 = body.appendElement("div4");

    body.appendElement("div5");
    body.appendElement("div6");

    ArrayList<Element> toMove = new ArrayList<Element>() {
        {
            add(div3);
            add(div4);
        }
    };

    body.insertChildren(0, toMove);

    // Move div3 to index 2
    ArrayList<Element> toMove2 = new ArrayList<Element>() {
        {
            add(div3);
        }
    };
    body.insertChildren(2, toMove2);

    // Move div4 to index 3
    ArrayList<Element> toMove3 = new ArrayList<Element>() {
        {
            add(div4);
        }
    };
    body.insertChildren(3, toMove3);

    String result = doc.toString().replaceAll("\\s+", "");
    assertEquals("<body><div5></div5><div6></div6><div3></div3><div