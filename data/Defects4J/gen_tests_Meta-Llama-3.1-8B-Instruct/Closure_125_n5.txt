public void testIssue107() {
    // Create a test class that implements the interface T
    class T {}

    // Create two classes A and B that implement the interface T
    class A implements T {}
    class B implements T {}

    // Create a class X that implements the interface T
    class X {
        T type;
        T t;

        public X() {
            this.type = A.class;
            this.t = this.f();
        }

        public T f() {
            if (this.type == A.class) {
                return new A();
            } else if (this.type == B.class) {
                return new B();
            }
            return null;
        }
    }

    // Create an instance of X
    X x = new X();

    // This should not throw an IllegalStateException
    x.t = x.f();
}