public void testExternalTypeIdBeforePojo() {
    ObjectMapper mapper = new ObjectMapper();
    ObjectWriter writer = mapper.writer();
    ObjectReader reader = mapper.reader();

    SimpleModule module = new SimpleModule();
    module.addSerializer(new TestPojoSerializer());
    module.addDeserializer(TestPojo.class, new TestPojoDeserializer());
    mapper.registerModule(module);

    TestPojo pojo = new TestPojo();
    String json = writer.writeValueAsString(pojo);
    TestPojo deserialized = reader.readValue(json, TestPojo.class);

    assertNotNull(deserialized.getExternalTypeId());
}