public void testPearsonsCorrelationPrecision() {
    // Generate a large correlation value that should result in a very small p-value
    double[] data1 = new double[1000];
    double[] data2 = new double[1000];
    for (int i = 0; i < 1000; i++) {
        data1[i] = i / 1000.0;
        data2[i] = (i + 1) / 1000.0;
    }
    PearsonsCorrelation correlation = new PearsonsCorrelation(data1, data2);
    double t = correlation.getTStatistic();
    double originalP = correlation.getCorrelationPValues();
    double expectedP = 2 * tDistribution.cumulativeProbability(-t);

    // Check that the p-value is not exactly zero
    assertTrue(originalP > 0);

    // Check that the expected and actual p-values are close
    assertEquals(expectedP, originalP, 1e-12);
}