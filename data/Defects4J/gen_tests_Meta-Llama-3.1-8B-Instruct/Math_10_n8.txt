public void testAtan2SpecialCases() {
    DerivativeStructure dsX = new DerivativeStructure(1, 1, 0);
    DerivativeStructure dsY = new DerivativeStructure(1, 1, 0);
    DerivativeStructure result1 = DerivativeStructure.atan2(dsY, dsX);
    DerivativeStructure result2 = Math.atan2(dsY.value(), dsX.value());
    assertEquals(result2.value(), result1.value(), 1e-15);

    dsX = new DerivativeStructure(1, 1, Double.NaN);
    dsY = new DerivativeStructure(1, 1, 0);
    result1 = DerivativeStructure.atan2(dsY, dsX);
    result2 = Math.atan2(dsY.value(), dsX.value());
    assertEquals(Double.NaN, result1.value(), 1e-15);

    dsX = new DerivativeStructure(1, 1, 0);
    dsY = new DerivativeStructure(1, 1, Double.NaN);
    result1 = DerivativeStructure.atan2(dsY, dsX);
    result2 = Math.atan2(dsY.value(), dsX.value());
    assertEquals(Double.NaN, result1.value