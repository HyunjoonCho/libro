public void testPearsonsCorrelationPValuesPrecision() {
    Random rand = new Random(0);
    int numObservations = 10000;
    double[] x = new double[numObservations];
    double[] y = new double[numObservations];
    for (int i = 0; i < numObservations; i++) {
        x[i] = rand.nextDouble();
        y[i] = rand.nextDouble();
    }
    PearsonsCorrelation pc = new PearsonsCorrelation(x, y);
    double[] pValues = pc.getCorrelationPValues();
    double minPValue = Double.MAX_VALUE;
    for (double p : pValues) {
        if (p < minPValue) {
            minPValue = p;
        }
    }
    // Due to floating point precision issues, we can't expect the minimum p-value to be exactly 2.2e-16,
    // but we should be close to it
    assertLessThan(minPValue, 2.3e-16);
}