java
import com.google.javascript.jscomp.Compiler;
import com.google.javascript.jscomp.JSError;
import com.google.javascript.jscomp.ProcessCommonJSModules;
import com.google.javascript.jscomp.SourceFile;

import org.junit.Test;

public class ProcessCommonJSModulesTest {
    @Test
    public void testProcessCommonJSModulesFailuresWhenCheckTypesEnabled() throws Exception {
        // Define the echo.js module
        String echoJs = "define(function() { return { echo: function(val) { window.console.log(val); } }; })";

        // Define the echo-main.js entry point
        String echoMainJs = "var echo = require('echo'); echo.echo('hello world');";

        // Compile the code with checkTypes enabled
        Compiler compiler = new Compiler();
        compiler.setWarningLevel(JSError.Level.ERROR);
        compiler.setOptimizationLevel(Compiler.OptimizationLevel.SIMPLE_OPTIMIZATIONS);
        compiler.setFormatOutput(true);
        compiler.setProcessCommonJSModules(true);
        compiler.setCheckTypes(true);

        SourceFile echoJsFile = new SourceFile("echo.js", echoJs);
        SourceFile echoMainJsFile = new SourceFile("echo-main.js", echoMainJs);

        compiler.addSource