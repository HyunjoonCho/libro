public void testCSVFormatWithHeader() throws Exception {
    CSVPrinter csvPrinter = CSVFormat.DEFAULT.withHeader("x").print(Files.newBufferedWriter(Paths.get("data.csv")));
    csvPrinter.printRecord(42);
    csvPrinter.close();
    String expected = "x\n42";
    String actual = new String(Files.readAllBytes(Paths.get("data.csv")));
    assertEquals(expected, actual);
}