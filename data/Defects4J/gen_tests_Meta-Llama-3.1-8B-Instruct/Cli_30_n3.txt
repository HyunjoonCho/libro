public void testOptionGroupStateNotUpdated() {
    OptionSet options = new OptionSet();
    options.addOption("a", "option a");
    options.addOption("b", "option b");
    options.addOption("c", "option c").withGroup("group").withRequired(true);
    options.addOption("d", "option d").withGroup("group");
    options.addOption("e", "option e").withGroup("group").withRequired(true);
    options.addOption("f", "option f").withGroup("group");
    options.addOption("g", "option g");

    Properties defaultOptions = new Properties();
    defaultOptions.setProperty("a", "true");
    defaultOptions.setProperty("d", "true");

    CommandLine cmdLine = new GnuParser().parse(options, new String[] {"-c", "-e"}, defaultOptions);

    assertTrue(cmdLine.hasOption("a"));
    assertTrue(cmdLine.hasOption("c"));
    assertTrue(cmdLine.hasOption("d"));
    assertTrue(cmdLine.hasOption("e"));
    assertFalse(cmdLine.hasOption("b"));
    assertFalse(cmdLine.hasOption("f"));
    assertFalse(cmdLine.hasOption("g"));
}