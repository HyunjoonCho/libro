java
import com.fasterxml.jackson.core.JsonGenerator;
import com.fasterxml.jackson.core.JsonParser;
import com.fasterxml.jackson.core.JsonToken;
import com.fasterxml.jackson.databind.JsonNode;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.databind.SerializationFeature;
import com.fasterxml.jackson.databind.SerializationConfig;
import com.fasterxml.jackson.databind.ser.DefaultSerializerProvider;
import com.fasterxml.jackson.databind.ser.SerializerFactory;

import org.junit.Test;

import static org.junit.Assert.assertEquals;

public class JsonStreamContextTest {

    @Test
    public void testWriteContextVsConvertContext() throws Exception {
        ObjectMapper mapper = new ObjectMapper();
        mapper.enable(SerializationFeature.INDENT_OUTPUT);
        JsonGenerator gen = mapper.getFactory().createGenerator(System.out);
        gen.setRootValueSeparator("");

        JsonNode node = mapper.readTree("{\"name\":\"John\",\"age\":30}");
        JsonGenerator writeGen = mapper.getFactory().createGenerator(System.out);
        writeGen.setRootValueSeparator("");
        writeContext(gen, node);

        JsonParser parser = mapper.getFactory().createParser(node.toString());
        JsonNode convertedNode = mapper.readTree(parser);
        JsonGenerator convertGen = mapper.getFactory().createGenerator(System.out);
        convertGen.setRootValueSeparator("");
        convertContext(convertGen, convertedNode);

