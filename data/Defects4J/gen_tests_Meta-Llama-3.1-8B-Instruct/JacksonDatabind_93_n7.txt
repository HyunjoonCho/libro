java
public void testSubTypeValidatorFailsWithNPE() throws Exception {
    ObjectMapper mapper = new ObjectMapper();
    mapper.enableDefaultTyping(ObjectMapper.DefaultTyping.NON_FINAL, JsonTypeInfo.As.PROPERTY);

    String json = "{\"@class\":\"org.springframework.security.core.Authentication\",\"authorities\":[\"java.util.ArrayList\",[]]}";

    // Create a bean with a field of type List<GrantedAuthority>
    Authentication authentication = new Authentication();
    GrantedAuthority authority = new GrantedAuthority() {
        @Override
        public String getAuthority() {
            return "test";
        }
    };
    List<GrantedAuthority> authorities = new ArrayList<>();
    authorities.add(authority);
    authentication.setAuthorities(authorities);

    // Serialize the object
    String serialized = mapper.writeValueAsString(authentication);

    // Deserialize the object
    Authentication deserialized = mapper.readValue(serialized, Authentication.class);

    // Check that the deserialized object is not null
    assertNotNull(deserialized);
    assertEquals(authentication, deserialized);
}
