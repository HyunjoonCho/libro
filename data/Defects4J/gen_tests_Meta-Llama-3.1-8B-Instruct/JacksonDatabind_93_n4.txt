public void validateSubTypeFailsWithNPE() throws Exception {
    ObjectMapper mapper = new ObjectMapper();
    mapper.enableDefaultTyping(ObjectMapper.DefaultTyping.NON_FINAL, JsonTypeInfo.As.PROPERTY);

    String json = "{\"@class\":\"org.springframework.security.core.Authentication\",\"authorities\":[\"java.util.ArrayList\",[]]}";

    // Create an instance of Authentication with a null property "authorities"
    Authentication authentication = new Authentication();
    authentication.setAuthorities(null);

    // Serialize the object to JSON
    String jsonFromObject = mapper.writeValueAsString(authentication);

    // Deserialize the JSON back to an object
    Authentication deserializedAuthentication = mapper.readValue(jsonFromObject, Authentication.class);
}