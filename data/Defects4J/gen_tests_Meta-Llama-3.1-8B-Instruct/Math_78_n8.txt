public void testODEIntegrationLastEventDetection() {
    // Create a simple event function
    final double EPS = 1e-9;
    final double g(double t) {
        return (t - 90.0) * (t - 135.0);
    }

    // Create an ODE solver
    ODE solver = new ODE() {
        @Override
        public double[] deriv(double t, double[] y) {
            return new double[] { g(t) };
        }
    };

    // Set up events
    Event event1 = new Event(90.0, true, true);
    Event event2 = new Event(135.0, true, true);

    // Create an ODE solver with events
    ODESolver solverWithEvents = new ODESolver(solver, new double[] { 67.5, 112.5 });
    solverWithEvents.addEvent(event1);
    solverWithEvents.addEvent(event2);

    // Integrate the ODE
    solverWithEvents.solve();

    // Check that the second event was detected
    assertEquals(2, solverWithEvents.getEvents().size());

    // Now, make the first event not detected by making the solver