javascript
describe('Closure Compiler', function() {
  it('should not inline variable in closure', function(done) {
    var arr = [1, 2, 3, 4, 5];
    var callback = function() {
      for (var i = 0, l = arr.length; i < l; i++) {
        var j = arr[i];
        (function() {
          var k = j;
          setTimeout(function() {
            if (k!== j) {
              done(new Error('Variable k was inlined'));
            } else {
              done();
            }
          }, 0);
        })();
      }
    };
    callback();
  });
});
