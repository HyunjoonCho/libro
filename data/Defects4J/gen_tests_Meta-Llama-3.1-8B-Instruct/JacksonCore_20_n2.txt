java
import com.fasterxml.jackson.core.JsonGenerator;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.databind.SerializationFeature;
import org.junit.Test;

import java.io.ByteArrayOutputStream;
import java.io.IOException;

public class TestWriteEmbeddedObject {
    @Test(expected = UnsupportedOperationException.class)
    public void testWriteEmbeddedObject() throws IOException {
        ObjectMapper mapper = new ObjectMapper();
        ByteArrayOutputStream bos = new ByteArrayOutputStream();
        JsonGenerator gen = mapper.getFactory().createGenerator(bos);
        gen.writeStartObject();
        gen.writeFieldName("bytes");
        gen.writeEmbeddedObject(new byte[] {1, 2, 3});
        gen.writeEndObject();
        gen.close();
    }

    @Test
    public void testWriteEmbeddedObjectSupported() throws IOException {
        ObjectMapper mapper = new ObjectMapper();
        mapper.configure(SerializationFeature.WRITE_EMBEDDED_OBJECT_AS_BINARY, true);
        ByteArrayOutputStream bos = new ByteArrayOutputStream();
        JsonGenerator gen = mapper.getFactory().createGenerator(bos);
        gen.writeStartObject();
        gen.writeFieldName("bytes");
        gen.writeBinary(new byte[] {1, 2, 3});
        gen.writeEndObject();
        gen.close();
        byte[] json = bos.toByteArray();
        String expected = "{\"bytes\":[1,2