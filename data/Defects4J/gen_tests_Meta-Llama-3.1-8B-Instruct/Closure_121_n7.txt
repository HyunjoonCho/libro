public void testOverzealousOptimization() {
    int uid;
    boolean throwException = false;
    try {
        reset();
        int _uid = uid;

        if (uid < 0.5) {
            reset();
            doStuff();
        }

        if (_uid!= uid) {
            throwException = true;
        }
    } catch (Exception e) {
        // expected
    }

    assertTrue(throwException);
}

void reset() {
    uid = 0;
}

void doStuff() {
    uid = 0;
}