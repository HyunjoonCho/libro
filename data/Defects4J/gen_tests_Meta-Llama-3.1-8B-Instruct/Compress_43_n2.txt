java
public void testVersionNeededToExtract() throws IOException {
    ZipArchiveOutputStream zipOut = new ZipArchiveOutputStream(new ByteArrayOutputStream());
    ZipEntry entry = new ZipEntry("test.txt");
    entry.setSize(1024);
    entry.setCompressedSize(512);
    zipOut.putCentralDirectoryFileHeader(entry);

    // Test case 1: Deflate compression, no zip64, no data descriptors
    zipOut.putLocalFileHeader(entry);
    assertEquals(INITIAL_VERSION, zipOut.getVersionNeededToExtract(entry.getCompressedSize(), entry.getSize(), entry.getCompressedSize(), entry.getSize()));
    zipOut.close();

    // Test case 2: Deflate compression, no zip64, with data descriptors
    entry.setSize(1024);
    entry.setCompressedSize(512);
    zipOut = new ZipArchiveOutputStream(new ByteArrayOutputStream());
    zipOut.putCentralDirectoryFileHeader(entry);
    zipOut.putLocalFileHeader(entry);
    assertEquals(DATA_DESCRIPTOR_MIN_VERSION, zipOut.getVersionNeededToExtract(entry.getCompressedSize(), entry.getSize(), entry.getCompressedSize(), entry.getSize()));
    zipOut.close();

    // Test case 3: Deflate compression, zip64, no data descriptors
    entry.setSize(Zip64End