java
import com.google.gwt.core.client.GWT;
import com.google.gwt.junit.client.GWTTestCase;

public class TestAddSingletonGetter extends GWTTestCase {

    @Override
    protected void gwtSetUp() throws Exception {
        GWT.setUncaughtExceptionHandler(new GWT.UncaughtExceptionHandler() {
            @Override
            public void onUncaughtException(Throwable caught) {
                fail(caught.getMessage());
            }
        });
    }

    public void testAddSingletonGetter() {
        final Object singleton = new Object();
        GWT.create(singleton.getClass());
        GWT.addSingletonGetter(singleton.getClass());
        String compiledCode = GWT.getModuleBaseURL() + "default.js";
        // Verify that the compiled code contains the singleton getter
        // Note: This is a bit tricky, as we can't directly read the compiled code.
        // We can verify that the code is not optimized away by checking that it still exists.
        // If the code is optimized away, the URL should return 404.
        try {
            GWT.getModuleBaseURL().resolve(compiledCode).open();
        } catch (Exception e) {
            fail("Singleton getter was optimized away");
        }
