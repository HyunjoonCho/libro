public void testReadTruncated() throws IOException {
    byte[] data = new byte[770];
    byte[] truncatedData = new byte[769];
    System.arraycopy(data, 0, truncatedData, 0, 769);
    ByteArrayInputStream bais = new ByteArrayInputStream(truncatedData);
    BZip2CompressorInputStream bis = new BZip2CompressorInputStream(bais);
    int bytesRead = bis.read(data);
    assertEquals(769, bytesRead);
}