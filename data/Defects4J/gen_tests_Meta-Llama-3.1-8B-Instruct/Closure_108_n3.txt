public void testPreconditionCrash() {
    com.google.javascript.jscomp.CompilationLevel NO_DEDUPING_DONT_STRIP = com.google.javascript.jscomp.CompilationLevel.NO_DEDUPING_DONT_STRIP;
    com.google.javascript.jscomp.JSCompiler compiler = new com.google.javascript.jscomp.JSCompiler();
    com.google.javascript.jscomp.SourceFile sourceFile = new com.google.javascript.jscomp.SourceFile("test.js", "var goog = {};\n" +
            "goog.scope;\n" +
            "var ns = {};\n" +
            "ns.sub = {};\n" +
            "/** @constructor */\n" +
            "ns.sub.C = function() {};\n" +
            "\n" +
            "goog.scope(function() {\n" +
            " var sub = ns.sub;\n" +
            " /** @type {sub.C} */\n" +
            " var x = null;\n" +
            "});");
    compiler.compile(sourceFile);
    try {
        compiler.compile(sourceFile);
        fail("Expected a compilation error");
    } catch (com.google.javascript.jscomp.Error e) {
        assertTrue(e.getMessage().contains("pre