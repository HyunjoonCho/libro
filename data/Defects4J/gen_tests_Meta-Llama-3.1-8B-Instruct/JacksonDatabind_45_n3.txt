public void testIssue1154ExplicitShapePrecedence() {
    // Before fix
    try {
        XLSXWorkbook wb = new XLSXWorkbook();
        XSSFSheet sheet = wb.addSheet("Sheet1");
        XSSFCreationHelper creationHelper = sheet.getCreationHelper();
        XSSFCell cell = sheet.createRow(0).createCell(0);
        cell.setCellValue(1);
        cell.setCellType(CellType.NUMBER);
        assertEquals(CellType.STRING, cell.getCellType());
    } catch (Exception e) {
        // This should throw an exception before the fix
    }

    // After fix
    XLSXWorkbook wb = new XLSXWorkbook();
    XSSFSheet sheet = wb.addSheet("Sheet1");
    XSSFCreationHelper creationHelper = sheet.getCreationHelper();
    XSSFCell cell = sheet.createRow(0).createCell(0);
    cell.setCellValue(1);
    cell.setCellType(CellType.NUMBER);
    assertEquals(CellType.NUMBER, cell.getCellType());

    // Test with explicit shape
    cell = sheet.createRow(1).createCell(0);
    cell.setCellValue(1);
    cell.setCellType(CellType.NUMBER);
    cell.setCellStyle