java
import org.junit.Test;
import java.io.ByteArrayInputStream;
import java.io.IOException;
import java.util.zip.TarArchiveEntry;
import java.util.zip.TarArchiveInputStream;

import static org.junit.Assert.assertThrows;

public class TarArchiveInputStreamTest {

    @Test(expected = NegativeArraySizeException.class)
    public void testParsePaxHeadersNegativeArraySizeException() throws IOException {
        String paxHeaders = "header1\n" +
                "header2\n" +
                "\n"; // empty line at the end
        TarArchiveInputStream tarIn = new TarArchiveInputStream(new ByteArrayInputStream(paxHeaders.getBytes()));
        TarArchiveEntry entry = new TarArchiveEntry("test");
        while (tarIn.getNextEntry()!= null) {
            entry = tarIn.getNextEntry();
        }
        tarIn.parsePaxHeaders(entry);
    }
}
