public void testToStringStyleMemoryLeak() throws Exception {
    ToStringStyle style = ToStringStyle.SIMPLE_STYLE;
    Thread thread = new Thread(() -> {
        try {
            Thread.sleep(1000);
        } catch (InterruptedException e) {
            Thread.currentThread().interrupt();
        }
    });
    thread.start();
    thread.join();
    // verify that the thread local was garbage collected
    System.gc();
    Thread.sleep(2000); // wait for gc to run
    assertNotSame(style, Thread.currentThread().getThreadLocals().get(ToStringStyle.class));
}