java
public void testEmbeddedRungeKuttaInitialStepSize() {
    // Set up the test parameters
    double[] y0 = {1.0, 2.0};
    double[] atol = {1e-6, 1e-6};
    double[] rtol = {1e-6, 1e-6};
    double[] yDotK = {0.0, 0.0};
    double[] yTmp = {0.0, 0.0};
    double[] scale = new double[y0.length];
    double[] vecAbsoluteTolerance = {atol[0], atol[1]};
    double[] vecRelativeTolerance = {rtol[0], rtol[1]};

    // Test the original implementation
    double hNew1 = EmbeddedRungeKuttaIntegrator.initializeStep(equations, forward, getOrder(), atol, y0, yDotK, yTmp, scale);
    System.out.println("Original implementation: hNew = " + hNew1);

    // Test the corrected implementation
    if (vecAbsoluteTolerance == null) {
        for (int i =