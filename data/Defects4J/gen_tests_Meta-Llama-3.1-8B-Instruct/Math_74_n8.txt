public void testEmbeddedRungeKuttaInitializeStep() {
    double[] y0 = new double[] {1.0, 2.0};
    double[] vecAbsoluteTolerance = new double[] {1e-10, 1e-10};
    double[] vecRelativeTolerance = new double[] {1e-10, 1e-10};
    double[] yDotK = new double[y0.length];
    double[] yTmp = new double[y0.length];
    double[] scale = new double[y0.length];

    if (vecAbsoluteTolerance == null) {
        for (int i = 0; i < scale.length; ++i) {
            double yi = Math.max(Math.abs(y0[i]), Math.abs(y0[i]));
            scale[i] = scalAbsoluteTolerance + scalRelativeTolerance * yi;
        }
    } else {
        for (int i = 0; i < scale.length; ++i) {
            double yi = Math.max(Math.abs(y0[i]), Math.abs(y0[i]));
            scale[i] = vecAbsoluteTolerance[i] + vecRelativeTolerance[i] * yi;
        }
    }

    // Assuming scalAbsoluteTolerance and scal