public void testIssue() {
    Object map = new Object();
    Object f1 = new Object() {
        public void alert(String msg) {
            System.out.println(msg);
        }
    };
    f1.getClass().getField("alwaysCall").set(f1, true);
    Object f2 = new Object() {
        public void alert(String msg) {
            System.out.println(msg);
        }
    };

    ((Map)map).put("f1", f1);
    ((Map)map).put("f2", f2);

    Method callFunctionByKey = map.getClass().getMethod("callFunctionByKey", String.class);
    callFunctionByKey.invoke(map, Math.random() > 0.5? "f1" : "f2");
}