public void testArchiveStreamFactoryEncoding() throws IOException {
    File tempFile = File.createTempFile("test", ".jar");
    tempFile.deleteOnExit();

    JarArchiveOutputStream jos = (JarArchiveOutputStream) ArchiveStreamFactory.newArchiveOutputStream(tempFile.toURI().toURL(), "UTF-8");

    jos.putArchiveEntry(new ArchiveEntry("test.txt"));
    jos.write("Hello, World!".getBytes("UTF-8"));
    jos.closeArchiveEntry();

    jos = (JarArchiveOutputStream) ArchiveStreamFactory.newArchiveOutputStream(tempFile.toURI().toURL(), "UTF-8");
    jos.putArchiveEntry(new ArchiveEntry("test.txt"));
    jos.write("Hello, World!".getBytes("UTF-8"));
    jos.closeArchiveEntry();

    CpioArchiveInputStream cis = (CpioArchiveInputStream) ArchiveStreamFactory.newArchiveInputStream(tempFile.toURI().toURL());
    DumpArchiveInputStream das = (DumpArchiveInputStream) ArchiveStreamFactory.newArchiveInputStream(tempFile.toURI().toURL());
    ArjArchiveInputStream ais = (ArjArchiveInputStream) ArchiveStreamFactory.newArchiveInputStream(tempFile.toURI().toURL());

    // Verify the streams are readable
    BufferedReader reader = new BufferedReader(new InputStreamReader(cis));