public void testZipArchiveEOFException() throws IOException {
    ByteArrayOutputStream bos = new ByteArrayOutputStream();
    ZipOutputStream zos = new ZipOutputStream(bos);
    zos.putNextEntry(new ZipEntry("test"));
    zos.closeEntry();
    zos.close();
    bos.close();
    bos = new ByteArrayOutputStream(bos.toByteArray(), 10); // truncate the buffer
    try {
        ZipInputStream zis = new ZipInputStream(bos);
        zis.getNextEntry();
        fail("Expected EOFException");
    } catch (EOFException e) {
        // expected
    }
}