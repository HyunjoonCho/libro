public void testODEIntegration() {
    // Create a simple switching function
    final double g = new IFunction() {
        public double value(double t) {
            return t > 90? 1 : -1;
        }
    };

    // Create an event handler to detect the switching function change
    final EventDetectionIF eventDetection = new EventDetectionIF() {
        public boolean detectEvent(double t, double y, double dydt, double[] params) {
            return g.value(t) * g.value(t - 1e-6) < 0;
        }
    };

    // Create an ODE solver with the event detection
    ODEIntegrator solver = new DormandPrince853Integrator(eventDetection);
    solver.setInitialStepSize(1e-6);
    solver.setMaxStepSize(1e6);
    solver.setMinStepSize(1e-6);

    // Integrate the switching function from 67.5 to 112.5
    double[] y = new double[] {0};
    double t = 67.5;
    double[] eventParams = new double[0];
    solver.integrate(t, y, eventParams);

    // The first event should be detected