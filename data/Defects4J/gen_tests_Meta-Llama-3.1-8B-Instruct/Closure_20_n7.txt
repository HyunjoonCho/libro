public void testStringConversionOptimization() {
    Object f = new Object() {
        public String valueOf() { return null; }
    };
    try {
        String s = f.toString();
        fail("Expected NullPointerException");
    } catch (NullPointerException e) {
        // expected
    }
}