public void testTruncatedZipArchive() throws IOException {
    ByteArrayOutputStream baos = new ByteArrayOutputStream();
    ZipArchiveInputStream zais = new ZipArchiveInputStream(new ByteArrayInputStream(new byte[] {0x50, 0x4b, 0x03, 0x04, 0x14, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00}));
    byte[] buffer = new byte[1024];
    int bytesRead = zais.read(buffer);
    assertEquals(0, bytesRead);
    zais.close();
    zais = new ZipArchiveInputStream(new ByteArrayInputStream(buffer));
    try {
        while ((bytesRead = zais.read(buffer))!= -1) {
            zais.read(buffer);
            fail("Expected IOException for truncated ZIP file");
        }
    } catch (IOException e) {
        // expected
    }
}