java
public void testEmbeddedRungeKuttaIntegratorInitializeStep() {
    double[] y0 = {1.0, 2.0};
    double[] yDotK = new double[2];
    double[] yTmp = new double[2];
    double[] yDotK1 = new double[2];
    double[] scale = new double[y0.length];
    double hNew;
    double scalAbsoluteTolerance = 1e-6;
    double scalRelativeTolerance = 1e-6;
    double[] vecAbsoluteTolerance = null;

    // Test with scalar absolute and relative tolerances
    for (int i = 0; i < scale.length; ++i) {
        double yi = Math.max(Math.abs(y0[i]), Math.abs(y0[i]));
        scale[i] = scalAbsoluteTolerance + scalRelativeTolerance * yi;
    }
    hNew = EmbeddedRungeKuttaIntegrator.initializeStep(null, true, 0, scale, 0.0, y0, yDotK[0], yTmp, yDotK1);

    // Test with vector absolute and relative tolerances
    vecAbsoluteTolerance = new double[y0.length];
    for