java
import org.jsoup.Jsoup;
import org.jsoup.nodes.Document;
import org.jsoup.nodes.Element;
import org.junit.Test;

import static org.junit.Assert.assertEquals;

public class JSDOMTest {

    @Test
    public void testJSMinificationBug() {
        String originalJs = "function urlEncodeIfNecessary(s) { var regex = /[\\\"<>\.;]/; var hasBadChars = regex.exec(s)!= null; return hasBadChars && typeof encodeURIComponent!= UNDEF? encodeURIComponent(s) : s;}";
        String minifiedJs = JsMinifier.minify(originalJs);

        Document doc = Jsoup.parse("<html><body>" + minifiedJs + "</body></html>");
        Element script = doc.body().child(0);
        String minifiedJsString = script.data();

        assertEquals("function Z(a){return/[\"<>.;]/.exec(a)!=null&&typeof encodeURIComponent!=j?encodeURIComponent(a):a}", minifiedJsString);
    }
}
