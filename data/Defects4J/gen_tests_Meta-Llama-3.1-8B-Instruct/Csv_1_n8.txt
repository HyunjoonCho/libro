java
public void testExtendedBufferReaderEOLHandling() {
    ExtendedBufferReader reader = new ExtendedBufferReader();
    reader.append("abc\r\n");
    reader.append("def\r\n");
    reader.append("ghi");

    assertEquals(1, reader.readLine());
    assertEquals("abc", reader.readLine());
    assertEquals(2, reader.readLine());
    assertEquals("def", reader.readLine());
    assertEquals(3, reader.readLine());
    assertEquals("ghi", reader.readLine());

    // Test that it doesn't throw an exception when there's a CR at the end of the buffer
    reader = new ExtendedBufferReader();
    reader.append("abc\r");
    assertEquals(1, reader.readLine());
    assertEquals("abc", reader.readLine());
}
