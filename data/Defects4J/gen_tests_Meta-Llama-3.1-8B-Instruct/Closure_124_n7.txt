public void testClosureCompiler() throws Exception {
    String input = "var foreignObject = gfx.parentNode.parentNode;\n" +
            "var parentContainer = foreignObject.parentNode.parentNode;";
    String expectedOutput = "if(b){if(a=b.parentNode.parentNode,b=a.parentNode.parentNode,null!==b)";
    String actualOutput = runClosureCompiler(input);

    assertEquals(expectedOutput, actualOutput);
}

private String runClosureCompiler(String input) throws Exception {
    // simulate the command line compilation
    Process process = Runtime.getRuntime().exec("java -jar compiler.jar --js /dev/stdin", null, new File("/dev/stdin"));
    process.getOutputStream().write(input.getBytes());
    process.getOutputStream().close();
    return new String(readAllBytes(process.getInputStream()));
}

private byte[] readAllBytes(InputStream inputStream) throws IOException {
    ByteArrayOutputStream bos = new ByteArrayOutputStream();
    byte[] buffer = new byte[1024];
    int bytesRead;
    while ((bytesRead = inputStream.read(buffer))!= -1) {
        bos.write(buffer, 0, bytesRead);
    }
    return bos.toByteArray();
}