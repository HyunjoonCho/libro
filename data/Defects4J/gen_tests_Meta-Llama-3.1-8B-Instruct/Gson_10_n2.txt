java
public void testJsonAdapterIgnoredForPrimitiveFields() {
    Gson gson = new Gson();
    String json = gson.toJson(new PrimitiveWrapper(42L));
    assertEquals("{\"value\":\"42\"}", json);
    PrimitiveWrapper wrapper = gson.fromJson(json, PrimitiveWrapper.class);
    assertEquals("42", wrapper.value);
}

public static class PrimitiveWrapper {
    @JsonAdapter(LongToStringTypeAdapterFactory.class)
    final long value;

    private PrimitiveWrapper(long value) {
        this.value = value;
    }
}

private static class LongToStringTypeAdapterFactory implements TypeAdapterFactory {
    static final TypeAdapter<Long> ADAPTER = new TypeAdapter<Long>() {
        @Override
        public void write(JsonWriter out, Long value) throws IOException {
            out.value(value.toString());
        }

        @SuppressWarnings("unchecked")
        @Override
        public Long read(JsonReader in) throws IOException {
            return in.nextLong();
        }
    };

    @Override
    public <T> TypeAdapter<T> create(Gson gson, final TypeToken<T> type) {
        Class<?> cls = type.getRawType();
        if (Long.class.isAssignableFrom(cls)) {
            return (TypeAdapter<T>) ADAPTER;
        } else if (long.class.isAssignableFrom(cls)) {
