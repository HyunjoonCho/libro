javascript
function testTypeCheckerMissesAnnotationsOnFunctionsDefinedWithinFunctions() {
    var ns = {};

    function outer() {
        ns.a = function(b) {
            /** @param {string=} b */
        };
    }

    outer();
    ns.a(); // Should not throw error
    ns.a(123); // Should throw error

    var ns2 = {};

    ns2.a = function(b) {
        /** @param {string=} b */
    };

    ns2.a(); // Should not throw error
    ns2.a(123); // Should throw error

    var ns3 = {};
    (function() {
        ns3.a = function(b) {
            /** @param {string=} b */
        };
    })();
    ns3.a(); // Should not throw error
    ns3.a(123); // Should throw error

    try {
        ns.a(123);
        assert.fail("Expected error for type mismatch");
    } catch (e) {
        // Expected
    }

    try {
        ns2.a(123);
        assert.fail("Expected error for type mismatch");
    } catch (e) {
        // Expected
    }

    try {
        ns3.a(123);
        assert.fail("