java
public void testDeserializeExternalTypeIdBeforePojo() throws JsonProcessingException {
    ObjectMapper mapper = new ObjectMapper();
    TypeFactory typeFactory = mapper.getTypeFactory();
    JavaType externalTypeIdType = typeFactory.constructType(String.class);
    JavaType pojoType = typeFactory.constructType(Pojo.class);

    ObjectWriter writer = mapper.writerFor(pojoType);
    String json = "{\"@type\":\"ExternalTypeId\",\"field\":\"value\"}";
    byte[] bytes = writer.writeValueAsBytes(new Pojo());
    byte[] externalTypeIdBytes = json.getBytes(StandardCharsets.UTF_8);

    // Deserialize the external type id before the POJO
    byte[] mixedBytes = new byte[bytes.length + externalTypeIdBytes.length];
    System.arraycopy(bytes, 0, mixedBytes, 0, bytes.length);
    System.arraycopy(externalTypeIdBytes, 0, mixedBytes, bytes.length, externalTypeIdBytes.length);

    JsonNode jsonNode = mapper.readTree(mixedBytes);
    JsonNode pojoNode = jsonNode.get("field");
    assert pojoNode!= null;

    // Deserialize the external type id after the POJO
    byte[] normalBytes = new