java
public void testChiSquare() {
    long[] observed1 = { 500, 623, 72, 70, 31 };
    double[] expected1 = { 485, 541, 82, 61, 37 };
    ChiSquareTestImpl testStatistic = new ChiSquareTestImpl();
    double actualChiSquare = testStatistic.chiSquare(expected1, observed1);
    // Expected chi-square value is obtained by rescaling the expected values
    double sumObserved = Arrays.stream(observed1).sum();
    double sumExpected = Arrays.stream(expected1).sum();
    double[] rescaledExpected = Arrays.stream(expected1).mapToDouble(x -> x * sumObserved / sumExpected).toArray();
    double expectedChiSquare = testStatistic.chiSquare(rescaledExpected, observed1);
    assertEquals("chi-square test statistic", 9.0233, expectedChiSquare, 1E-10);
}
