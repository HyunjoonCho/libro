public void testIllegalArgumentExceptionReadingCpioWithNonZeroFileMode() throws Exception {
    // Create a CPIO file with non-zero file mode
    ByteArrayOutputStream bos = new ByteArrayOutputStream();
    CpioArchiveWriter writer = new CpioArchiveWriter(bos);
    writer.write(new CpioFileHeader("file", 0644));
    writer.write(new CpioFileHeader("file", 0644));
    writer.write(new CpioFileHeader("file", 0644, 0777));
    writer.close();
    
    // Try to read the CPIO file
    CpioArchiveReader reader = new CpioArchiveReader(new ByteArrayInputStream(bos.toByteArray()));
    try {
        while (reader.hasNext()) {
            reader.next();
        }
        fail("Expected IllegalArgumentException");
    } catch (IllegalArgumentException e) {
        // Expected exception
    }
}