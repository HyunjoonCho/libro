public void testToStringStyleMemoryLeak() {
    Thread thread = new Thread(() -> {
        ToStringStyle style = ToStringStyle.SIMPLE_STYLE;
        // Keep a reference to the thread local to prevent it from being garbage collected
        Object o = Thread.currentThread().getThreadLocals().get(ToStringStyle.class);
    });
    thread.start();
    thread.join();
    try {
        thread = new Thread(() -> {
            ToStringStyle style = ToStringStyle.SIMPLE_STYLE;
            // Keep a reference to the thread local to prevent it from being garbage collected
            Object o = Thread.currentThread().getThreadLocals().get(ToStringStyle.class);
        });
        thread.start();
        thread.join();
    } catch (Exception e) {
        // Expected exception
    }
}