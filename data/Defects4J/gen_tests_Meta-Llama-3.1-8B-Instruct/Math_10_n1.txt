public void testAtan2SpecialCases() {
    DerivativeStructure x = new DerivativeStructure(1, 1, 0);
    DerivativeStructure y = new DerivativeStructure(1, 1, 0);
    
    assertEquals(Double.NaN, x.atan2(y), 0.0);
    assertEquals(Double.NaN, y.atan2(x), 0.0);
    assertEquals(Double.NaN, x.atan2(0), 0.0);
    assertEquals(Double.NaN, 0.atan2(x), 0.0);
    assertEquals(0.7853981633974483, x.atan2(x), 1e-12);
    assertEquals(-0.7853981633974483, -x.atan2(x), 1e-12);
    assertEquals(-0.7853981633974483, x.atan2(-x), 1e-12);
    assertEquals(0.7853981633974483, -x.atan2(-x), 1e-12);
}