java
public void testAddAndSubtractWithNaN() {
    Complex c1 = new Complex(1, 2);
    Complex c2 = new Complex(3, 4);
    
    Complex resultAdd = c1.add(c2);
    Complex resultSubtract = c1.subtract(c2);
    
    // Test add with NaN
    Complex c3 = new Complex(Double.NaN, 2);
    Complex resultAddNaN = c1.add(c3);
    assertTrue(resultAddNaN.isNaN());
    
    // Test subtract with NaN
    Complex resultSubtractNaN = c1.subtract(c3);
    assertTrue(resultSubtractNaN.isNaN());
    
    // Test add with both NaN
    Complex resultAddBothNaN = c1.add(c3);
    assertTrue(resultAddBothNaN.isNaN());
    
    // Test subtract with both NaN
    Complex resultSubtractBothNaN = c1.subtract(c3);
    assertTrue(resultSubtractBothNaN.isNaN());
}
