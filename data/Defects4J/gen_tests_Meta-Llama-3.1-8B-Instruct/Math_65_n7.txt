public void testAbstractLeastSquaresWeights() {
    AbstractLeastSquares als = new AbstractLeastSquares();
    als.setWeight(1.0);
    als.addObservation(1.0);
    als.addObservation(2.0);
    als.addObservation(3.0);
    als.calculate();
    double expectedRms = Math.sqrt(als.getChiSquare() / als.getRows());
    double actualRms = als.getRMS();
    assertEquals(expectedRms, actualRms, 0.00001);
}