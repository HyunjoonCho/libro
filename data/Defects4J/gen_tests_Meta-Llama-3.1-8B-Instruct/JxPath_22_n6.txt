public void testResettingDefaultNamespace() throws Exception {
    Document doc = DocumentBuilderFactory.newInstance().newDocumentBuilder().newDocument();
    Element root = doc.createElementNS("test111", "b:foo");
    root.setAttributeNS("http://www.w3.org/2000/xmlns/", "xmlns:b", "bla");
    root.setAttributeNS("http://www.w3.org/2000/xmlns/", "xmlns", "");
    Element bar = doc.createElementNS("bla", "b:bar");
    bar.setTextContent("a");
    root.appendChild(bar);
    Element test = doc.createElement("test");
    root.appendChild(test);
    DocumentBuilderFactory.setNamespaceAware(true);
    DocumentBuilderFactory.setNamespacePrefixMapper(new NamespacePrefixMapper() {
        @Override
        public String getPrefix(String namespaceURI) {
            return null;
        }
    });
    Document newDoc = DocumentBuilderFactory.newInstance().newDocumentBuilder().parse(new InputSource(new StringReader(doc.getDocumentElement().getNode().toString())));
    JXPathContext context = JXPathContext.newContext(newDoc);
    context.setNamespaceContext(new NamespaceContext() {
        @Override
        public String getNamespaceURI(String prefix) {
            return null;
        }
        @Override
        public String getPrefix(String