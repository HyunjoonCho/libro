public void testReplaceTrueFalse() {
    Function fn1 = null;
    Function fn2 = null;

    if (true) {
        fn2 = new Function() {
            public Object invoke() {
                return 1;
            }
        };
        fn1 = new Function() {
            public Object invoke() {
                return fn2.invoke();
            }
        };
    }

    Object result = new Object() {
        public boolean method1() {
            fn1!= null && fn1.invoke();
            return true;
        }

        public boolean method2() {
            return false;
        }
    };

    assertEquals(true, result.getClass().getMethod("method1").invoke(result));
    assertEquals(false, result.getClass().getMethod("method2").invoke(result));
}