public void testThisTypeChecking() {
    Object f = new Object() {
        public void bar() {
            baz();
        }

        public void baz() {}
    };
    Object g = new Object() {
        public void bar() {
            f.bar();
        }
    };
    try {
        g.bar();
        fail("Expected warning for different 'this' types");
    } catch (Error e) {
        assertTrue(e.getMessage().contains("different 'this' types"));
    }
}