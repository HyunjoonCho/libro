public void testCreateArchiveInputStreamDetectsTar() throws IOException {
    File file = File.createTempFile("temp", ".txt");
    file.deleteOnExit();

    FileOutputStream fos = new FileOutputStream(file);
    fos.write("Hello World!".getBytes());
    fos.close();

    // Create a small file that looks like a tar archive
    file = File.createTempFile("temp", ".tar");
    file.deleteOnExit();
    fos = new FileOutputStream(file);
    fos.write(0x1a.toByte()); // magic number for tar archives
    fos.write(0.toByte()); // size of archive
    fos.close();

    ArchiveStreamFactory factory = new ArchiveStreamFactory();
    try (InputStream fis = new FileInputStream(file)) {
        try (ArchiveInputStream ais = factory.createArchiveInputStream(fis)) {
            // Both files should be detected as text files, not tar archives
            assertFalse(ais instanceof TarArchiveInputStream);
        }
    }
}