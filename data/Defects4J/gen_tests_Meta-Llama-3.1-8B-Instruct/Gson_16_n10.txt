public void testTypeVariableRecursion() {
    TypeVariable<?> typeVariable = new TypeVariable<>("X");
    TypeVariable<?> superType = new TypeVariable<>("? super " + typeVariable);
    TestType testType = new TestType(superType);
    try {
        new Gson().getAdapter(TestType.class);
        fail("Expected StackOverflowError");
    } catch (StackOverflowError e) {
        // expected
    }
}

class TestType {
    private TypeVariable<?> superType;
    public TestType(TypeVariable<?> superType) {
        this.superType = superType;
    }
}