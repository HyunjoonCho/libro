public void testRecursiveTypeSerialization() throws JsonProcessingException {
    ObjectMapper mapper = new ObjectMapper();
    TypeFactory typeFactory = mapper.getTypeFactory();
    Class<?> baseClass = typeFactory.constructType(Base.class);
    Class<?> subClass = typeFactory.constructType(Sub.class);
    
    Base base = new Base();
    Sub sub = new Sub();
    
    ObjectWriter writer = mapper.writer();
    String baseJson = writer.writeValueAsString(base);
    String subJson = writer.writeValueAsString(sub);
    
    assertEquals("{\"base\":1,\"sub\":2}", subJson);
}