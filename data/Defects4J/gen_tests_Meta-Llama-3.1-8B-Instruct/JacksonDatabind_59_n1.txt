public void testIssue() throws JsonParseException, JsonMappingException, IOException {
    ObjectMapper mapper = new ObjectMapper().enableDefaultTyping(DefaultTyping.NON_FINAL);
    SimpleModule module = new SimpleModule() {
        private static final long serialVersionUID = 1L;
        @Override
        public void setupModule(SetupContext context) {
            context.addKeyDeserializers(new SimpleKeyDeserializers().addDeserializer(CompoundKey.class, new CompoundKeyDeserializer()));
        }
    };
    ObjectMapper mapperWithModule = new ObjectMapper().enableDefaultTyping(DefaultTyping.NON_FINAL).registerModule(module);
    mapperWithModule.readValue(TEST_INSTANCE_SERIALIZED, TestClass.class);
    try {
        mapper.readValue(TEST_INSTANCE_SERIALIZED, TestClass.class);
        fail("Expected JsonMappingException");
    } catch (JsonMappingException e) {
        // expected
    }
}