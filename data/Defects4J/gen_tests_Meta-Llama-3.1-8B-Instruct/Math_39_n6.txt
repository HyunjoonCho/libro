public void testEmbeddedRKF45TooLargeFirstStep() {
    double[] y = {1.0};
    double[] yDot = {2.0};
    double start = 0.0;
    double end = 1.0;
    double error = 1.0e-12;
    double firstStep = 1.0;
    
    ODEIntegrator integrator = new EmbeddedRungeKuttaFehlberg45();
    integrator.integrate(y, yDot, start, end, error, firstStep);
    
    assertTrue(integrator.getStepCount() > 0);
    assertTrue(integrator.getStepCount() <= (end - start) / firstStep);
}