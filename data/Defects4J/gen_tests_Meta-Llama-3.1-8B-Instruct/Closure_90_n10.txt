public void testThisTypedefWarning() {
    // Create a simple JavaScript compiler
    ClosureCompiler compiler = new ClosureCompiler();

    // Define the code
    String code = "goog.provide('bug');\n" +
            "bug.sharedMethod = function() {};\n" +
            "/**\n" +
            " * @this {bug.Thing}\n" +
            " */\n" +
            "bug.A = function() {};\n" +
            "/**\n" +
            " * @constructor\n" +
            " */\n" +
            "bug.B = function() {};\n" +
            "/**\n" +
            " * @type {bug.A|bug.B}\n" +
            " */\n" +
            "bug.Thing = goog.typedef;";

    // Compile the code
    CompilationResult result = compiler.compile(code);

    // Check for the warning
    assertTrue(result.getWarnings().contains("WARNING - @this type of a function must be an object"));
}