java
public void testJsoupCharsetDetection() {
    String url = "http://www.example.com";
    String html = "<html lang=\"en-US\"><head><meta charset=\"UTF-8\"><meta http-equiv=\"Content-Type\" content=\"text/html; \"></head>";

    Document doc = Jsoup.parse(html);
    assertEquals("UTF-8", doc.charset());

    // Test with invalid content-type
    doc = Jsoup.parse("<html lang=\"en-US\"><head><meta charset=\"UTF-8\"><meta http-equiv=\"Content-Type\" content=\"text/html; \"></head>");
    assertEquals("UTF-8", doc.charset());

    // Test with non-UTF-8 charset
    doc = Jsoup.parse("<html lang=\"en-US\"><head><meta charset=\"ISO-8859-1\"></head>");
    assertEquals("ISO-8859-1", doc.charset());

    // Test with no charset specified
    doc = Jsoup.parse("<html lang=\"en-US\"><head></head>");
    assertEquals("ISO-8859-1", doc.charset());
}
