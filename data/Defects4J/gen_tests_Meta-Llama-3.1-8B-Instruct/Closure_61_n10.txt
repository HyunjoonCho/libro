public void testClosureRemovesNeededCode() {
    final String expected = "Math.blah=function(a){a.a=5};var test={};\n" +
            "Math.blah(test);";
    Compiler compiler = Compiler.compile(
            "Math.blah = function(test) { test.a = 5; };\n" +
            "var test = new Object();\n" +
            "Math.blah(test);");
    String compiledCode = compiler.getCode();
    assertEquals(expected, compiledCode);
}