public void testCSVFormatWithHeader() throws Exception {
    String expected = "x\n42\n";
    try (Writer writer = Files.newBufferedWriter(Paths.get("data.csv"))) {
        CSVPrinter csvPrinter = CSVFormat.TDF.withHeader("x").print(writer);
        csvPrinter.printRecord(42);
        csvPrinter.close();
        String actual = Files.readString(Paths.get("data.csv"));
        assertEquals(expected, actual);
    }
}