public void testExternalTypeIdHandling() {
    ObjectMapper mapper = new ObjectMapper();
    mapper.registerModule(new SimpleModule());
    SimpleBean bean = new SimpleBean();
    bean.id = "someId";
    byte[] bytes = mapper.writeValueAsBytes(bean);
    ObjectReader reader = mapper.readerFor(SimpleBean.class).withType(SimpleBean.class);
    SimpleBean deserialized = reader.readValue(bytes);
    assertEquals("someId", deserialized.id);
    
    // test with External Type Id
    mapper = new ObjectMapper();
    mapper.registerModule(new SimpleModule().addSerializer(new ExternalTypeSerializer()));
    SimpleBeanWithExternalId beanWithExternalId = new SimpleBeanWithExternalId();
    beanWithExternalId.id = "someId";
    beanWithExternalId.typeId = "someTypeId";
    bytes = mapper.writeValueAsBytes(beanWithExternalId);
    reader = mapper.readerFor(SimpleBeanWithExternalId.class).withType(SimpleBeanWithExternalId.class);
    SimpleBeanWithExternalId deserializedWithExternalId = reader.readValue(bytes);
    assertEquals("someTypeId", deserializedWithExternalId.typeId);
}