public void testIssueJsonIdentityReferenceClassOnly() {
    ObjectMapper mapper = new ObjectMapper();
    mapper.setVisibility(mapper.getSerializationConfig().getDefaultVisibilityChecker()
           .withFieldVisibility(JsonAutoDetect.Visibility.ANY)
           .withGetterVisibility(JsonAutoDetect.Visibility.NONE)
           .withIsGetterVisibility(JsonAutoDetect.Visibility.NONE)
           .withConstructorVisibility(JsonAutoDetect.Visibility.NONE));

    ReallyAlwaysContainer container = new ReallyAlwaysContainer();
    String json = mapper.writeValueAsString(container);

    // Expecting the alwaysAsId to be applied to both 'a' and 'b'
    assertEquals("{\"a\":1,\"b\":1}", json);
}