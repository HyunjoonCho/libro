public void testIE8Error() {
    String jsCode = "if (e.onchange) { e.onchange({ _extendedByPrototype: Prototype.emptyFunction, target: e }); }";
    String expectedOutput = "if(b.onchange){b.onchange({_extendedByPrototype:Prototype.emptyFunction,target:b})}";
    String actualOutput = replace(jsCode, "if (", "b.onchange && ");
    assertEquals(expectedOutput, actualOutput);
}

private String replace(String str, String oldString, String newString) {
    int index = str.indexOf(oldString);
    while (index!= -1) {
        str = str.substring(0, index) + newString + str.substring(index + oldString.length());
        index = str.indexOf(oldString);
    }
    return str;
}