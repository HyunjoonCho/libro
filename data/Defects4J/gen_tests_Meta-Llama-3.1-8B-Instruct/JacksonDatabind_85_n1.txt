java
public void testDateTimeSerializerBaseContextualFormat() throws Exception {
    ObjectMapper mapper = new ObjectMapper();
    DateTimeSerializerBase serializer = new DateTimeSerializerBase(mapper, null);
    DateTimeFormatter formatter = DateTimeFormat.forPattern("yyyy-MM-dd");
    mapper.setDateFormat(formatter);

    // Test with no format specified on the object
    DateTime dt = new DateTime(2022, 1, 1, 0, 0, 0);
    String json = mapper.writeValueAsString(dt);
    assertEquals("2022-01-01T00:00:00.000Z", json);

    // Test with format specified on the object
    @JsonFormat(pattern = "yyyy-MM-dd")
    DateTime dtWithFormat = new DateTime(2022, 1, 2, 0, 0, 0);
    json = mapper.writeValueAsString(dtWithFormat);
    assertEquals("2022-01-02", json);

    // Test that the format is reused from the object
    @JsonFormat(pattern = "yyyy-MM-dd")
    DateTime dtWithFormat2 = new DateTime(2022, 1, 3, 0, 0, 0);
    json = mapper.writeValueAsString(dtWithFormat2);
