public void testAtan2SpecialCases() {
    double x = 0;
    double y = 0;
    double expected = Math.atan2(y, x);
    double actual = new DerivativeStructure(1, 1).atan2(y, x).getValue();
    assertEquals(expected, actual, 1e-10);
    
    x = 0;
    y = Double.POSITIVE_INFINITY;
    expected = Math.atan2(y, x);
    actual = new DerivativeStructure(1, 1).atan2(y, x).getValue();
    assertEquals(expected, actual, 1e-10);
    
    x = Double.POSITIVE_INFINITY;
    y = 0;
    expected = Math.atan2(y, x);
    actual = new DerivativeStructure(1, 1).atan2(y, x).getValue();
    assertEquals(expected, actual, 1e-10);
    
    x = Double.POSITIVE_INFINITY;
    y = Double.POSITIVE_INFINITY;
    expected = Math.atan2(y, x);
    actual = new DerivativeStructure(1, 1).atan2(y, x).getValue();
    assertEquals(expected, actual, 1e-10);
}