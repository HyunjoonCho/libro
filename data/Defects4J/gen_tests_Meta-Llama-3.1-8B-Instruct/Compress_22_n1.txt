public void testBZip2CompressorInputStreamReadTruncated() throws IOException {
    byte[] data = new byte[770];
    // Create a truncated bz2 file
    try (BZip2CompressorOutputStream bos = new BZip2CompressorOutputStream(new ByteArrayOutputStream())) {
        bos.write(data);
    }
    try (BZip2CompressorInputStream bis = new BZip2CompressorInputStream(new ByteArrayInputStream(data))) {
        bis.read(data);
        int bytesRead = bis.getReadBytes();
        assertEquals(769, bytesRead);
    }
}