public void testEmbeddedRungeKuttaFirstStep() {
    // Set an extremely short integration range
    double start = 0;
    double end = 1e-30;
    double[] y = new double[] {1.0};
    double[] dydx = new double[] {1.0};
    double[] pars = new double[] {1.0};
    
    ODE ode = new ODE() {
        @Override
        public int getDim() {
            return y.length;
        }
        
        @Override
        public double[] compute(double t, double[] y, double[] dydx) {
            return dydx;
        }
    };
    
    try {
        Integrator integrator = new Integrator(ode, start, end, y, dydx, pars);
        integrator.integrate();
        fail("Expected exception");
    } catch (Exception e) {
        // expected
    }
}