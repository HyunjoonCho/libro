java
public void testChiSquare() {
    double[] expected = {485, 541, 82, 61, 37};
    long[] observed = {500, 623, 72, 70, 31};
    double sumExpected = 0;
    for (double e : expected) {
        sumExpected += e;
    }
    double sumObserved = 0;
    for (long o : observed) {
        sumObserved += o;
    }
    if (sumExpected!= sumObserved) {
        double scalingFactor = sumObserved / sumExpected;
        for (int i = 0; i < expected.length; i++) {
            expected[i] *= scalingFactor;
        }
    }
    double testStatistic = 0;
    for (int i = 0; i < observed.length; i++) {
        double dev = (observed[i] - expected[i]);
        testStatistic += dev * dev / expected[i];
    }
    assertEquals("chi-square test statistic", 9.0233, testStatistic, 1E-5);
}
