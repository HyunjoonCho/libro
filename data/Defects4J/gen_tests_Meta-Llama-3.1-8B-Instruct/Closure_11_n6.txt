javascript
describe('Record type invalid property not reported on function with @this annotation', () => {
    it('should report error on invalid property access', () => {
        function makeClass(protoMethods) {
            var clazz = function() {
                this.initialize.apply(this, arguments);
            };
            for (var i in protoMethods) {
                clazz.prototype[i] = protoMethods[i];
            }
            return clazz;
        }

        var Person = function(options){};
        Person = makeClass({
            initialize: function(options) {
                /**
                 * @type {string}
                 */
                this.name_ = options.thisPropDoesNotExist; // should report error
            },
            say: function(message) {
                window.console.log(this.name_ +'says:'+ message);
            }
        });

        expect(() => {
            new Person({ name: 'joe', height: 300 });
        }).toThrow();
    });
});
