java
public void testToStringNPEForOrphans() {
    Set<String> set = new HashSet<>();
    set.add("element");
    set.remove("element");
    String element = set.iterator().next();
    set.add(element); // element is now in a detached state
    try {
        set.toString();
        fail("Expected NullPointerException");
    } catch (NullPointerException e) {
        // expected
    }
}
