java
import org.junit.Test;
import com.google.javascript.jscomp.CompilationLevel;
import com.google.javascript.jscomp.Compiler;
import com.google.javascript.jscomp.CompilerOptions;
import com.google.javascript.rhino.Node;
import com.google.javascript.rhino.Token;

public class Issue107Test {

    @Test
    public void testIssue107() throws Exception {
        Compiler compiler = new Compiler();
        CompilerOptions options = new CompilerOptions();
        options.setLanguageIn(CompilationLevel.SIMPLE_OPTIMIZATIONS);
        options.setWarningLevel(CompilationLevel.VERBOSE);

        String source = "var test = {}; " +
                "test.T = function() {}; " +
                "test.A = function() {}; " +
                "test.B = function() {}; " +
                "test.X = function() {" +
                "  this.type = test.A;" +
                "  this.t = this.f();" +
                "};" +
                "test.X.prototype.f = function() {" +
                "  if (this.type === test.A) {" +
                "    return new test.A();" +
                "  } else if (this.type === test.B) {" +
