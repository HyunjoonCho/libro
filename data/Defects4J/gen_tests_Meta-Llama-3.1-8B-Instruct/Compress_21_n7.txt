public void testWriting7zEmptyEntries() {
    // Scenario 1: 7 empty files
    File directory = new File("temp");
    directory.mkdir();
    for (int i = 0; i < 7; i++) {
        new File(directory, "empty_file_" + i).createNewFile();
    }
    try {
        Archive archive = new Archive();
        archive.addDirectory(directory);
        archive.save("test.7z");
        assertTrue(new File("test.7z").exists());
        // Check that only one folder entry exists
        int numFolderEntries = 0;
        ArchiveInputStream ais = new ArchiveInputStream(new FileInputStream("test.7z"));
        while (ais.getNextEntry()!= null) {
            if (ais.getNextEntry().isDirectory()) {
                numFolderEntries++;
            }
        }
        assertEquals(1, numFolderEntries);
    } finally {
        deleteDirectory(directory);
    }

    // Scenario 2: 7 files, some empty, some with content
    directory = new File("temp");
    directory.mkdir();
    for (int i = 0; i < 7; i++) {
        File file = new File(directory, "file_" + i);