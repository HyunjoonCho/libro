public void testZipArchiveInputStreamInvalidEntry() throws IOException {
    ByteArrayOutputStream baos = new ByteArrayOutputStream();
    ZipArchiveOutputStream zos = new ZipArchiveOutputStream(baos);
    zos.putArchiveEntry(new ZipArchiveEntry("test"));
    zos.closeEntry();

    ZipArchiveInputStream zis = new ZipArchiveInputStream(new ByteArrayInputStream(baos.toByteArray()));
    ZipArchiveEntry entry = zis.getNextZipEntry();
    assertNull(entry);

    zis = new ZipArchiveInputStream(new ByteArrayInputStream(baos.toByteArray() + "invalid"));
    try {
        zis.getNextZipEntry();
        fail("Expected ZipException");
    } catch (ZipException e) {
        // expected
    }
}