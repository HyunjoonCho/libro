public void testCustomSerializerAttributePassing() throws IOException {
    Data data = new Data();
    data.aStr = "Hello";

    Map<String, Object> mapTest = new HashMap<>();
    mapTest.put("data", data);

    ObjectNode treeTest = mapper.createObjectNode();
    treeTest.putPOJO("data", data);

    String mapOut = mapper.writer().withAttribute("myAttr", "Hello!").writeValueAsString(mapTest);
    System.out.println(mapOut);

    String treeOut = mapper.writer().withAttribute("myAttr", "Hello!").writeValueAsString(treeTest);
    System.out.println(treeOut);

    // Verify that the custom serializer received the attribute in both cases
    assertEquals("Hello!", mapper.writer().withAttribute("myAttr", "Hello!").withRootName("root").forType(Object.class).writeValueAsString(new Object() {
        @JsonSerialize(using = TestCase.CustomSer.class)
        public Data data;
    }));
    assertEquals("Hello!", mapper.writer().withAttribute("myAttr", "Hello!").withRootName("root").forType(Object.class).writeValueAsString(new ObjectNode() {{
        putPOJO("data", new Data());
    }}));
}