public void testAssigningObjectLiteralToPrototype() {
    final Function foo = new Function() {
        public Object run() {
            Object prototype = new Object() {
                public void alert() {
                    System.out.println("hello world");
                }
            };
            return prototype;
        }
    };
    Function anonymous = new Function() {
        public Object run() {
            foo.run();
            return foo.getPrototype();
        }
    };
    Object result = anonymous.run();
    assertEquals("hello world", result.getClass().getMethod("alert").invoke(result));
}