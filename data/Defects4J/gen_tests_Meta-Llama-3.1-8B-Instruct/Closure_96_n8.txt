public void testMissingTypeChecksForVarArgs() {
    JavacCompiler compiler = new JavacCompiler();
    JavaFileObject fooFile = new SimpleJavaFileObject() {
        @Override
        public JavaFileObject createSourceFile(String name) {
            return new SimpleJavaFileObject() {
                @Override
                public CharSequence getCharContent(boolean ignoreEscape) {
                    return "public class Foo {\n" +
                            "    public static void foo(" +
                            "String... var_args) {\n" +
                            "        return arguments.length;\n" +
                            "    }\n" +
                            "}";
                }
            };
        }
    };

    CompilationUnit root = compiler.parse(fooFile, "Foo.java");
    CompilationUnitDeclaration unit = root.getCompilationUnit();
    TypeDeclaration classDecl = (TypeDeclaration) unit.getTypeDeclaration();

    MethodDeclaration method = (MethodDeclaration) classDecl.getMembers().get(0);
    ParameterList parameters = method.getParameters();
    Parameter varArgs = parameters.getParameters().get(parameters.size() - 1);
    ParameterList restParams = (ParameterList) varArgs.getAnnotations().get(0).getAnnotations().get(0);

    try {
        compiler.typeCheck(unit);