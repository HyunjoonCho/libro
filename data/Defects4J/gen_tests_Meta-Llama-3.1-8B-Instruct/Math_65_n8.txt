public void testAbstractLeastSquaresWeights() {
    double[] weights = new double[] {1.0, 2.0, 3.0};
    AbstractLeastSquares als = new AbstractLeastSquares(weights);
    als.setResiduals(new double[] {1.0, 2.0, 3.0});
    als.setRows(3);
    
    double expectedRMS = Math.sqrt(als.getChiSquare() / (weights[0] * weights[1] * weights[2]));
    double actualRMS = als.getRMS();
    
    // The bug is that getRMS() should return the correct value, so we test that
    assertEquals(expectedRMS, actualRMS, 0.0);
}