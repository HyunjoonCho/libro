java
public void testGenericsSelfReference() {
    GenericsSelfReference selfReference = new GenericsSelfReference() {
        @Override
        public GenericsSelfReference self() {
            return this;
        }
    };

    GenericMetadataSupport genericMetadata = new GenericMetadataSupport();
    Class<?> clazz = GenericsSelfReference.class;
    try {
        genericMetadata.inferFrom(clazz).resolveGenericReturnType(clazz.getMethod("self").getGenericReturnType());
        fail("Expected StackOverflowError");
    } catch (StackOverflowError e) {
        // expected
    }
}
