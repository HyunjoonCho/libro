public void testIssueWithCloseEvents() {
    // Create an example switching function
    final double eps = 1e-7;
    final EventDetector detector = new EventDetector() {
        public boolean isEvent(double t, double y) {
            return (t >= 90 - eps && t <= 90 + eps);
        }
    };

    // Create an ODE solver with the detector
    ODE solver = new ODE() {
        public double[] derivative(double t, double[] y) {
            double[] dydt = new double[y.length];
            if (t >= 90 - eps && t <= 90 + eps) {
                // Simulate a switching function
                dydt[0] = 1;
            } else {
                dydt[0] = 0;
            }
            return dydt;
        }
    };
    solver.addEventDetector(detector);

    // Set the initial conditions
    double[] y0 = new double[]{0};
    double t0 = 67.5;

    // Integrate the ODE from 67.5 to 112.5
    solver.integrate(t0, 112.5, y0);

    // Check if the event