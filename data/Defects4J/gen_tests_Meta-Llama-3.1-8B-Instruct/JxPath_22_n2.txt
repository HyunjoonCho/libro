public void testResettingDefaultNamespace() {
    // Create a sample DOM tree
    Document document = DocumentBuilderFactory.newInstance().newDocumentBuilder().newDocument();
    Element root = document.createElementNS("bla", "b:foo");
    root.setAttribute("xmlns:b", "bla");
    root.setAttribute("xmlns", "test111");
    Element bar = document.createElementNS("bla", "b:bar");
    bar.setTextContent("a");
    root.appendChild(bar);
    Element test = document.createElement("test");
    root.appendChild(test);
    document.appendChild(root);

    // Create a JXPathContext
    JXPathContext context = JXPathContext.newContext(document);

    // Get the 'test' node
    Object result = context.getValue("//test");

    // Check that the asPath() method does not cause an endless loop
    try {
        ((DOMNodePointer) result).asPath();
    } catch (Exception e) {
        fail("Expected asPath() to not cause an endless loop");
    }
}