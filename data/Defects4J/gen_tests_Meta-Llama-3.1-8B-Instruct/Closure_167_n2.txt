public void testInLoopExterns() {
    // Test case 1: In a prototype function
    String jsCode = "function ns() { " +
            "this.subthing = { prop: 3 }; " +
            "ns.prototype.doIt = function() { " +
            "var subthing = this.subthing; " +
            "for (var i = 0; i < subthing.noprop; i++) { " +
            "window.console.log(i); " +
            "} " +
            "} " +
            "} " +
            "var thing = { subthing: { prop: 3 } }; " +
            "var c = new ns(); c.doIt();";

    // Test case 2: Outside a prototype function
    String jsCodeOutside = "var thing = { subthing: { prop: 3 } }; " +
            "var subthing = thing.subthing; " +
            "for (var i = 0; i < subthing.noprop; i++) { " +
            "window.console.log(i); " +
            "}";

    // Test case 3: Correctly erroring code
    String jsCodeCorrect = "var thing = { sub