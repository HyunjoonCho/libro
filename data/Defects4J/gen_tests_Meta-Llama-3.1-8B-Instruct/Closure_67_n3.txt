public void testAdvancedCompilation() {
    // Create a simple class to mimic the given JavaScript code
    class A {
        int _x = 1;
    }

    // Save a reference to func1
    A func1 = new A();
    A.prototype = func1.getClass().getDeclaredFields()[0];

    // Define func1
    A.prototype.func1 = new Runnable() {
        public void run() {
            A obj = new A();
            obj._x = 2;
            obj.func2();
        }
    };

    // Define func2
    A.prototype.func2 = new Runnable() {
        public void run() {
            A obj = new A();
            obj._x = 3;
            obj.func3();
        }
    };

    // Test that func1 throws a NullPointerException when called
    try {
        func1.func1.run();
        fail("Expected NullPointerException");
    } catch (NullPointerException e) {
        // Expected
    }
}