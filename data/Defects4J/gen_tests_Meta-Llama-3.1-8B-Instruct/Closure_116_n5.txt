public void testAdvancedOptimizationsIssue() {
    JavaScriptCompiler compiler = new JavaScriptCompiler();
    CompilationLevel compilationLevel = CompilationLevel.ADVANCED_OPTIMIZATIONS;
    String externs = "window['prop'] = 0;";

    CompilationResult result = compiler.compile(
        "window['anchor'] = function (obj, modifiesProp) { " +
        "return (function (saved) { " +
        "return modifiesProp(obj) + saved; " +
        "})(obj['prop']);",
        compilationLevel,
        Collections.singletonList(externs),
        Collections.emptyList(),
        "output.js"
    );

    String output = result.getOutput();
    String expectedOutput = "window.foo=function(a,b){var HOLD=a.prop;return b(a)+HOLD;}";
    Assert.assertNotEquals(expectedOutput, output);
    Assert.assertTrue(output.contains("window.foo=function(a,b){return b(a)+a.prop;}"));
}