public void testInitializeStep() {
    double[] y0 = new double[] {1.0, 2.0, 3.0};
    double[] scalAbsoluteTolerance = new double[] {1.0};
    double[] vecRelativeTolerance = new double[] {0.0};
    double[] vecAbsoluteTolerance = new double[] {1.0};
    
    double[] expectedScale = new double[y0.length];
    if (vecAbsoluteTolerance == null) {
        for (int i = 0; i < expectedScale.length; ++i) {
            final double yi = Math.max(Math.abs(y0[i]), Math.abs(y0[i]));
            expectedScale[i] = scalAbsoluteTolerance[0] + vecRelativeTolerance[0] * yi;
        }
    } else {
        for (int i = 0; i < expectedScale.length; ++i) {
            final double yi = Math.max(Math.abs(y0[i]), Math.abs(y0[i]));
            expectedScale[i] = vecAbsoluteTolerance[i] + vecRelativeTolerance[i] * yi;
        }
    }
    
    double[] actualScale = new double[y0.length];
    if (vecAbsolute