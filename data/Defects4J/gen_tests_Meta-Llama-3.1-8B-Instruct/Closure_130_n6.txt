public void testCollapsePropertiesOnExternTypes() {
    Function function = () -> {
        return () -> {
            Object[] args = new Object[]{1, 2, 3};
            Thread.sleep(100);
            assertEquals(1, args.length);
            assertEquals(3, args[2]);
        };
    };
    Function wrappedFunction = function.apply();
    Thread thread = new Thread(wrappedFunction);
    thread.start();
    try {
        thread.join();
    } catch (InterruptedException e) {
        Thread.currentThread().interrupt();
    }
}