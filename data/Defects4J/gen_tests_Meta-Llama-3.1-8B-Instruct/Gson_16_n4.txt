java
public void testTypeVariableRecursion() {
    Type X = new TypeToken<X>(){}.getType();
    Type Y = new TypeToken<Y>(){}.getType();
    Type Z = new TypeToken<Z>(){}.getType();
    TypeToken<TestType> typeToken = new TypeToken<TestType>() {
        @Override
        protected void addTypeVariables(Type type, TypeToken<?> parent) {
            addTypeVariable("X", X);
            addTypeVariable("Y", Y);
            addTypeVariable("Z", Z);
        }
    }.getType();
    try {
        new Gson().getAdapter(TestType.class);
        fail("Expected StackOverflowError");
    } catch (StackOverflowError e) {
        // expected
    }
}
