java
public void testVersionOption() throws Exception {
    // Run the compiler with the --version option
    Process process = Runtime.getRuntime().exec("java -jar compiler.jar --version");
    BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream()));
    String line = reader.readLine();
    assertEquals("Closure Compiler (http://code.google.com/closure/compiler)", line);
    line = reader.readLine();
    assertEquals("Version: 698", line);
    line = reader.readLine();
    assertEquals("Built on: 2011/01/17 12:16", line);

    // Check for error message
    line = reader.readLine();
    assertEquals("Option '--version' requires operand", line);

    // Check for full list of options
    String actualOutput = readRemainingLines(reader);
    assertTrue(actualOutput.contains("Option '--version' requires operand"));
}

private String readRemainingLines(BufferedReader reader) throws IOException {
    StringBuilder sb = new StringBuilder();
    String line;
    while ((line = reader.readLine())!= null) {
        sb.append(line).append("\n");
    }
    return sb.toString();
}
