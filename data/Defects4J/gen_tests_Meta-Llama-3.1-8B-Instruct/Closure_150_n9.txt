public void testTypeCheckerMissesAnnotationsOnFunctionsDefinedWithinFunctions() {
    // Step 1
    var ns = {};
    ns.a = function(b) {};
    function d() {
        ns.a();
        ns.a(123);
    }
    // Check that the type checker emits one warning for the type error
    try {
        d();
        fail("Expected type error");
    } catch (e) {
        assertEquals(1, e.length); // Check that there's only one warning
    }

    // Step 3
    ns = {};
    (function() {
        ns.a = function(b) {};
    })();
    d = function() {
        ns.a();
        ns.a(123);
    }
    // Check that the type checker emits a warning for calling ns.a with 0 parameters
    try {
        d();
        fail("Expected warning");
    } catch (e) {
        assertEquals(1, e.length); // Check that there's only one warning
    }

    // Step 4
    ns = {};
    (function() {
        ns.a = function(b) {};
    })();
    // Check that no warnings are emitted if the calling code isn't within a function
    d = function()