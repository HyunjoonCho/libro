javascript
// Test case for issue #issue-type-checker-misses-annotations-on-functions-defined-within-functions

describe('issue #issue-type-checker-misses-annotations-on-functions-defined-within-functions', () => {
    it('should emit warning for function defined globally', () => {
        let ns = {};
        ns.a = function(b) {
            /** @param {string=} b */
        };
        function d() {
            ns.a();
            ns.a(123);
        }
        expect(() => d()).not.toThrow();
        expect(console).toHaveWarned('Calling ns.a() with 0 parameters');
        expect(console).toHaveWarned('Calling ns.a(123) with non-string argument');
    });

    it('should emit no warning for function defined globally but called outside function', () => {
        let ns = {};
        (function() {
            ns.a = function(b) {
                /** @param {string=} b */
            };
        })();
        ns.a();
        ns.a(123);
        expect(() => ns.a()).not.toThrow();
        expect(() => ns.a(123)).not.toThrow();
    });

    it('should emit warning for function defined within an