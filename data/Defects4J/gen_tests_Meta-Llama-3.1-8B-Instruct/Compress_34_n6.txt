java
import org.apache.commons.compress.archivers.zip.ZipArchiveEntry;
import org.apache.commons.compress.archivers.zip.ZipArchiveOutputStream;
import org.apache.commons.compress.archivers.zip.ZipFile;
import org.junit.Test;

import java.io.ByteArrayOutputStream;
import java.io.IOException;
import java.io.OutputStream;

import static org.junit.Assert.assertThrows;

public class ZipParsingTest {

    @Test
    public void testZeroSizedUxField() throws IOException {
        ByteArrayOutputStream bos = new ByteArrayOutputStream();
        ZipArchiveOutputStream zos = new ZipArchiveOutputStream(bos);
        ZipArchiveEntry entry = new ZipArchiveEntry("test.txt");
        entry.setMethod(ZipArchiveEntry.STORED);
        entry.setCompressedSize(0);
        entry.setSize(0);
        zos.putArchiveEntry(entry);
        zos.closeEntry();
        zos.close();

        ZipFile zipFile = new ZipFile(bos.toByteArray());
        assertThrows(ArrayIndexOutOfBoundsException.class, () -> zipFile.getEntries()[0].getExtra());
    }
}
