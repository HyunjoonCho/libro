java
public void testClassifyNonRightmostExpressionsAsProblematic() {
    Expression a = new Expression();
    Expression b = new Expression();
    Expression c = new Expression();

    // Test case 1
    Expression sequence1 = new Sequence(new Expression[] { a, b, c });
    Expression modifiedSequence1 = new Sequence(new Expression[] { a, new Constant(3) });
    a.setSideEffectFree(false);
    assertEquals(modifiedSequence1, sequence1.optimize());
    assertEquals(a, modifiedSequence1.getArguments()[0]);

    // Test case 2
    Expression sequence2 = new Sequence(new Expression[] { new FunctionCall("bar"), b, c });
    Expression modifiedSequence2 = new Sequence(new Expression[] { new FunctionCall("bar"), new Constant(3) });
    assertEquals(modifiedSequence2, sequence2.optimize());
    assertEquals(new FunctionCall("bar"), modifiedSequence2.getArguments()[0]);

    // Test case 3
    Expression sequence3 = new Sequence(new Expression[] {
            new Sequence(new Expression[] { a, b, c }),
            new Sequence(new Expression[] { new Constant(4), new Constant(5), c })
    });
    Expression modifiedSequence3 = new Sequence(new Expression[] {
