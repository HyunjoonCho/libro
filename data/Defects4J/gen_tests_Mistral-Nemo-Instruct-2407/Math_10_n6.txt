public void testDerivativeStructureAtan2SpecialCases() {
    DerivativeStructure ds = new DerivativeStructure(1, 1, 0, 0);
    assertEquals(Double.NaN, ds.atan2(0, 0), 0);
    assertEquals(Double.NaN, ds.atan2(0, 1), 0);
    assertEquals(Double.NaN, ds.atan2(1, 0), 0);
    assertEquals(Double.NaN, ds.atan2(1, 1), 0);
}