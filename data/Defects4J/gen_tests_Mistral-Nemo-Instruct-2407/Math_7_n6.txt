public void testEventStateNotUpdated() {
    // Set up initial state and events
    double[] y = {0, 0, 0};
    EventHandler event1 = new EventHandler() {
        public boolean eventOccurred(double t, double[] y) {
            if (t == 1) {
                return true; // trigger reset state
            }
            return false;
        }
    };
    EventHandler event2 = new EventHandler() {
        public boolean eventOccurred(double t, double[] y) {
            if (t == 2) {
                assertTrue(y[0] >= -1 && y[0] <= 1); // expect valid y values
            }
            return false;
        }
    };

    // Integrate with ODE solver and trigger event1, then event2
    ODESolver solver = new ODESolver();
    solver.addEventHandler(event1);
    solver.addEventHandler(event2);
    solver.integrate(y, 0, 3, 0.1);

    // Check if event2 was updated correctly
    assertTrue(event2.getLastTriggerTime() == 2);
}