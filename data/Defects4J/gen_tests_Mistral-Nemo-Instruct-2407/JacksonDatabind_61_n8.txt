public void testPrimitiveLongDeserializationFailure() throws IOException {
    ObjectMapper mapper = new ObjectMapper();
    mapper.registerModule(new JavaTimeModule());
    StdTypeResolverBuilder resolver = new StdTypeResolverBuilder();
    resolver.init(JsonTypeInfo.Id.CLASS, null);
    resolver.inclusion(JsonTypeInfo.As.PROPERTY);
    resolver.typeProperty("__t");
    mapper.setDefaultTyping(resolver);

    Data data = new Data();
    data.key = 1;
    Map<String, Object> mapData = new MapBuilder<String, Object>()
       .put("longInMap", 2L)
       .put("longAsField", data)
       .build();

    String json = mapper.writeValueAsString(mapData);
    Map<String, Object> deserializedData = mapper.readValue(json, Map.class);

    assertEquals(2L, deserializedData.get("longInMap"));
    Data deserializedData = (Data) deserializedData.get("longAsField");
    assertEquals(1L, deserializedData.key);
}