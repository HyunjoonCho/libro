public void testThisWarning() {
    String source =
        "/** @constructor */ function Foo() { this._bar = null; }\n" +
        "/** @this {Foo} */ function writeMethodWithAnnotation() { this._bar = 123; }\n" +
        "/** @this {Foo} */ function readMethodWithAnnotation() { return this._bar; }\n" +
        "function writeMethodWithoutAnnotation() { this._bar = 123; }\n" +
        "function readMethodWithoutAnnotation() { return this._bar; }\n";
    assertTrue(CompilerRunner.compileAndCheck(source, "ADVANCED_OPTIMIZATIONS", warnings -> {
        assertEquals(1, warnings.size());
        assertTrue(warnings.get(0).getMessage().contains("dangerous use of the global this object"));
    }));
}