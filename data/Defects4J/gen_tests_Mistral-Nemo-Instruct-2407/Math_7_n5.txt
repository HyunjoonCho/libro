public void testEventStateReset() {
    double[] y = new double[1];
    EventHandler eventHandler = new EventHandler() {
        @Override
        public void eventOccurred(Event event) {
            if (event.getType() == EventType.RESET_STATE) {
                event.resetIntegrationState();
            }
            event.getSolver().integrate(y, 0, 1, 1e-6);
            if (event.getType()!= EventType.RESET_STATE) {
                assertEquals(0, y[0], 1e-6);
            }
        }
    };
    OdeSolver solver = new OdeSolver() {
        @Override
        public void integrate(double[] y, double t0, double t1, double dt) {
            // Simulate incorrect state update
            y[0] = 1e20;
        }
    };
    solver.setEventHandler(eventHandler);
    solver.integrate(y, 0, 1, 1e-6);
}