public void testZipCorruptionWithHashCollision() throws Exception {
    try (ZipOutputStream zos = new ZipOutputStream(new FileOutputStream("test.zip"))) {
        for (int i = 0; i < 10000; i++) {
            zos.putNextEntry(new ZipArchiveEntry("file" + i + ".txt"));
        }
        zos.closeEntry();
    }

    try (ZipInputStream zis = new ZipInputStream(new FileInputStream("test.zip"))) {
        ZipEntry entry;
        while ((entry = zis.getNextEntry())!= null) {
            // This should throw an exception if the zip file is corrupted
            zis.closeEntry();
        }
    }
}