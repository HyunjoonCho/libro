public void testGenericsSelfReference() {
    interface GenericsSelfReference<T extends GenericsSelfReference<T>> {
        T self();
    }

    GenericsSelfReference<?> genericRef = new GenericsSelfReference<GenericsSelfReference<?>>() {
        public GenericsSelfReference<?> self() {
            return this;
        }
    };

    assertThat(genericRef.self().getClass()).isEqualTo(GenericsSelfReference.class);
}