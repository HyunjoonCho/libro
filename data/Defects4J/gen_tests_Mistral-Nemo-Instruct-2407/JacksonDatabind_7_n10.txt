public void testTokenBufferDelegateDeserialization() {
    ObjectMapper mapper = new ObjectMapper();
    TokenBuffer buffer = new TokenBuffer(mapper);
    buffer.writeStartObject();
    buffer.writeFieldName("a");
    buffer.writeNumber(1);
    buffer.writeFieldName("b");
    buffer.writeNull();
    buffer.writeEndObject();

    Value value = Value.from(buffer);
    assertEquals(1, value.getA());
    assertNull(value.getB());

    assertEquals(START_OBJECT, buffer.nextToken());
    assertEquals(FIELD_NAME, buffer.nextToken());
    assertEquals(VALUE_NUMBER_INT, buffer.nextToken());
    assertEquals(FIELD_NAME, buffer.nextToken());
    assertEquals(VALUE_NULL, buffer.nextToken());
    assertEquals(END_OBJECT, buffer.nextToken());
    assertEquals(END_ARRAY, buffer.nextToken());
}