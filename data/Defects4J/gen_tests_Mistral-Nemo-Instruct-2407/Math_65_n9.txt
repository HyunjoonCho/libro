public void testWeightInChiSquare() {
    // Setup test data
    double[] weights = {1.0, 2.0, 3.0};
    double[] observations = {1.0, 2.0, 3.0};
    double[] residuals = {0.1, 0.2, 0.3};

    // Create AbstractLeastSquares instance
    AbstractLeastSquares als = new AbstractLeastSquares(weights, observations, residuals) {
        @Override
        public double getChiSquare() {
            return super.getChiSquare();
        }
    };

    // Call getChiSquare(), which should now correctly use weights in the denominator
    double chiSquare = als.getChiSquare();

    // Verify that chiSquare is as expected when using weights in the denominator
    assertEquals(0.005, chiSquare, 0.0001);
}