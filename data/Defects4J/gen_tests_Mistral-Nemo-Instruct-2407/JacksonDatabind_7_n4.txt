public void testTokenBufferDelegateSerialization() {
    String json = "{\"a\":1, \"b\":null}";
    TokenBuffer buffer = new TokenBuffer(new JsonFactory());
    buffer.writeStartObject();
    buffer.writeFieldName("a");
    buffer.writeNumber(1);
    buffer.writeFieldName("b");
    buffer.writeNull();
    buffer.writeEndObject();
    buffer.setCurrentToken(TokenBuffer.START_OBJECT);

    Value value = Value.from(buffer);
    assertEquals(1, value.getA().intValue());
    assertNull(value.getB());
    assertEquals(6, buffer.getTokenCount());
    assertEquals(TokenBuffer.START_OBJECT, buffer.nextToken());
    assertEquals(TokenBuffer.FIELD_NAME, buffer.nextToken());
    assertEquals(TokenBuffer.VALUE_NUMBER_INT, buffer.nextToken());
    assertEquals(TokenBuffer.FIELD_NAME, buffer.nextToken());
    assertEquals(TokenBuffer.VALUE_NULL, buffer.nextToken());
    assertEquals(TokenBuffer.END_OBJECT, buffer.nextToken());
}