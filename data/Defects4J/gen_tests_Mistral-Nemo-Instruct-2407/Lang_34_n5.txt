public void testThreadLocalLeak() {
    ToStringStyle style1 = new ToStringStyle();
    ToStringStyle style2 = new ToStringStyle();
    System.gc();
    long memoryBefore = ManagementFactory.getMemoryMXBean().getHeapMemoryUsage().getUsed();
    style1.appendSuper(m -> m.append("style1", style2));
    long memoryAfter = ManagementFactory.getMemoryMXBean().getHeapMemoryUsage().getUsed();
    assertTrue(memoryAfter > memoryBefore);
}