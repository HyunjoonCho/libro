public void testRecursiveTypeSerialization() {
    Base base = new Base() {};
    Sub sub = new Sub();
    base.set(sub);
    ObjectWriter ow = new ObjectMapper().writerWithDefaultPrettyPrinter();
    String json = ow.writeValueAsString(sub);
    assertEquals("{\n    \"sub\": 2\n}", json);
}