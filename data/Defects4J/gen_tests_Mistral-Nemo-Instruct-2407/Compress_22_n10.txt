public void testReadTruncatedFile() throws Exception {
    byte[] data = new byte[770];
    //... fill data with some values...
    try (OutputStream os = new FileOutputStream("test.bz2")) {
        os.write(data);
    }
    try (InputStream is = new BZip2CompressorInputStream(new FileInputStream("test.bz2"))) {
        byte[] buf = new byte[770];
        int read = is.read(buf);
        assertEquals(770, read);
    }
}