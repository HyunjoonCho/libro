public void testToStringStyleThreadLocalLeak() {
    // Arrange
    ToStringStyle style = ToStringStyle.SHORT_PREFIX_STYLE;

    // Act
    Runtime.getRuntime().gc();
    long initialMemory = ManagementFactory.getMemoryMXBean().getHeapMemoryUsage().getUsed();

    // Simulate webapp reload
    style = null;
    System.gc();
    long afterFirstGc = ManagementFactory.getMemoryMXBean().getHeapMemoryUsage().getUsed();

    // Act again
    System.gc();
    long afterSecondGc = ManagementFactory.getMemoryMXBean().getHeapMemoryUsage().getUsed();

    // Assert
    // The memory usage should decrease after the first GC and not increase after the second GC,
    // indicating the thread local was properly cleaned up.
    assertTrue(afterFirstGc < initialMemory);
    assertTrue(afterSecondGc <= afterFirstGc);
}