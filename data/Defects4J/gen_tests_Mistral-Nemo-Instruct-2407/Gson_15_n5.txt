public void testLenientModeForDouble() {
    try (JsonWriter writer = new JsonWriter(new OutputStreamWriter(new ByteArrayOutputStream()))) {
        writer.setLenient(false);
        writer.value(Double.NaN);
    } catch (IllegalArgumentException e) {
        assertEquals("Numeric values must be finite, but was NaN", e.getMessage());
    }
}