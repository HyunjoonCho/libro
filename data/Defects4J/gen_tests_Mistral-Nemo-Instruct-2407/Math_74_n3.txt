public void testWrongStepSizeGuess() {
    DormandPrince853Integrator integrator = new DormandPrince853Integrator();
    double[] y0 = {0, 0, 0};
    double[] yDot0 = {1, 2, 3};
    double[] absoluteTolerance = {1e-6, 1e-6, 1e-6};
    double[] relativeTolerance = {1e-4, 1e-4, 1e-4};
    integrator.setStepController(new FixedStepController(1e-5));
    integrator.setInitialStepSize(0.1);
    integrator.setAbsoluteTolerances(absoluteTolerance);
    integrator.setRelativeTolerances(relativeTolerance);
    integrator.integrate(0, 1, y0, yDot0);
    // assert that an exception was thrown, as the Euler step with the wrong step size should cause the satellite to hit the ground
    assertThrows(IllegalArgumentException.class, () -> integrator.integrate(0, 1, y0, yDot0));
}