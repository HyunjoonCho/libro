public void testTypeCheckerMissesAnnotationsOnFunctionsDefinedWithinFunctions() {
    String code = "var ns = {};\n" +
            "(function() {\n" +
            "  /** @param {string=} b */\n" +
            "  ns.a = function(b) {}\n" +
            "})();\n" +
            "function d() {\n" +
            "  ns.a();\n" +
            "  ns.a(123);\n" +
            "}\n";
    JCompiler compiler = new JCompiler();
    compiler.setWarningLevel(WarningLevel.VERBOSE);
    compiler.compile(code);
    assertTrue(compiler.getWarnings().size() == 1); // only warn about missing param
}