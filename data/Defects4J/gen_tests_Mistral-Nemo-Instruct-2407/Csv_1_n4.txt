public void testEOLHandling() {
    String input = "Hello\nWorld\r\nJava\r";
    ExtendedBufferReader reader = new ExtendedBufferReader(new StringReader(input));
    int lineCount = 0;
    while (reader.read()!= -1) {
        if (reader.getLineEnding() == '\n' || (reader.getLineEnding() == '\r' && reader.peek()!= '\n')) {
            lineCount++;
        }
    }
    assertEquals(4, lineCount);
    reader.close();
}