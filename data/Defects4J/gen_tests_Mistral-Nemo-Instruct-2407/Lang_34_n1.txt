public void testThreadLocalLeak() {
    ToStringStyle style = ToStringStyle.SHORT_PREFIX_STYLE;
    System.gc();
    long memoryBefore = ManagementFactory.getMemoryMXBean().getHeapMemoryUsage().getUsed();
    for (int i = 0; i < 100000; i++) {
        style.toString(new Object());
    }
    System.gc();
    long memoryAfter = ManagementFactory.getMemoryMXBean().getHeapMemoryUsage().getUsed();
    assertTrue(memoryAfter > memoryBefore);
}