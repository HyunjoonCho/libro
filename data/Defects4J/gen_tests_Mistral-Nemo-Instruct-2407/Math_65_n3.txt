public void testWeightInChiSquare() {
    AbstractLeastSquares als = createAbstractLeastSquaresInstance();
    double[] weights = {2.0, 3.0, 4.0};
    als.setResidualsWeights(weights);
    als.setResiduals(new double[]{1.0, 2.0, 3.0});
    als.setRows(3);
    double chiSquare = als.getChiSquare();
    assertEquals(10.0, chiSquare, 0.0); // expected: (2+3+4) * (1^2 + 2^2 + 3^2)
    double rms = als.getRMS();
    assertEquals(Math.sqrt(10.0/3.0), rms, 0.0); // expected: sqrt((2+3+4) * (1^2 + 2^2 + 3^2) / 3)
}