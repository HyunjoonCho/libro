public void testWeightInChiSquare() {
    // Create a mock AbstractLeastSquares object for testing
    AbstractLeastSquares als = mock(AbstractLeastSquares.class);
    when(als.residualsWeights).thenReturn(new double[]{1.0, 2.0, 3.0});
    when(als.rows).thenReturn(3);

    // Test getChiSquare() with weights in denominator
    when(als.getChiSquare()).thenReturn(9.0);
    assertEquals(3.0, als.getRMS(), 0.0);

    // Change weights and test again
    when(als.residualsWeights).thenReturn(new double[]{2.0, 2.0, 2.0});
    assertEquals(Math.sqrt(9.0 / 3.0), als.getRMS(), 0.0);
}