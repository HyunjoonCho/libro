public void testEOLConsistency() throws IOException {
    ExtendedBufferReader reader = new ExtendedBufferReader(new StringReader("\r\nline1\rline2\nline3\r\rline4"));
    assertEquals("line1", reader.readLine());
    assertEquals("line2", reader.readLine());
    assertEquals("line3", reader.readLine());
    assertEquals("line4", reader.readLine());
    assertEquals(4, reader.getLineCount());
}