public void testBugInElementInsertChildren() {
    Document doc = new Document("");
    Element parent = doc.appendElement("parent");
    Element child1 = parent.appendElement("child1");
    Element child2 = parent.appendElement("child2");
    Element child3 = parent.appendElement("child3");
    Element child4 = parent.appendElement("child4");

    List<Element> toMove = Arrays.asList(child3, child4);
    parent.insertChildren(1, toMove);

    String result = doc.toString().replaceAll("\\s+", "");
    assertEquals("<parent><child1></child1><child3></child3><child4></child4><child2></child2></parent>", result);
}