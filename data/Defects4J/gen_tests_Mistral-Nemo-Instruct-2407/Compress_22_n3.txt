public void testReadTruncatedFile() throws Exception {
    byte[] data = "This is a test string to be compressed and then decompressed".getBytes();
    FileOutputStream fos = new FileOutputStream("test.bz2");
    try {
        fos.write(data, 0, data.length - 1); // Truncate the last byte
    } finally {
        fos.close();
    }
    BZip2CompressorInputStream bis = new BZip2CompressorInputStream(new FileInputStream("test.bz2"));
    try {
        byte[] buffer = new byte[8192];
        int bytesRead = bis.read(buffer, 0, buffer.length);
        assertEquals(770, bytesRead); // Expecting 770 bytes under CPython
    } finally {
        bis.close();
    }
}