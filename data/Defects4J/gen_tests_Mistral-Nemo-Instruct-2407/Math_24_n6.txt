public void testBrentOptimizerBestPoint() {
    BrentOptimizer optimizer = new BrentOptimizer();
    double[] points = {1.0, 2.0, 3.0, 2.1};
    double[] results = {3.0, 2.0, 4.0, 1.9};
    for (int i = 0; i < points.length; i++) {
        double result = optimizer.optimize(new Function() {
            @Override
            public double value(double x) {
                return results[i];
            }
        }, points[i], points[i] + 1.0);
        if (i > 0 && results[i] > results[i - 1]) {
            fail("BrentOptimizer did not return the best point");
        }
    }
}