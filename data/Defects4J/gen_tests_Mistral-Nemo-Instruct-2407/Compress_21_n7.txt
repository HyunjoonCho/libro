public void testEmptyFilesArchiveIssue() throws Exception {
    // Scenario 1: 7 empty files
    List<File> files = createEmptyFiles(7);
    try (ArchiveOutputStream out = new ArchiveOutputStream(new FileOutputStream("test.7z"))) {
        out.putArchiveEntry(new ArchiveEntry("folder"));
        for (File file : files) {
            out.putArchiveEntry(new ArchiveEntry(file.getName()));
            out.closeArchiveEntry();
        }
        out.closeArchiveEntry();
    }
    try (ArchiveInputStream in = new ArchiveInputStream(new FileInputStream("test.7z"))) {
        ArchiveEntry entry = in.getNextEntry();
        assertEquals("folder", entry.getName());
    }

    // Scenario 2: 7 files, some empty, some with content
    files = createFilesWithContent(3);
    files.addAll(createEmptyFiles(4));
    try (ArchiveOutputStream out = new ArchiveOutputStream(new FileOutputStream("test.7z"))) {
        out.putArchiveEntry(new ArchiveEntry("folder"));
        for (File file : files) {
            out.putArchiveEntry(new ArchiveEntry(file.getName()));
            out.closeArchiveEntry();
        }
        out