public void testCompilerCrashOnGoogScopeLocals() {
    try {
        String code = "goog.provide(\"main\");\n" +
                "goog.scope (function (){\n" +
                "  var a = foo, b, c = 1;\n" +
                "});";
        JavaFileObject file = new StringInput(StandardCharsets.UTF_8, code);
        compiler.getTask(null, null, null, null, null, Arrays.asList(file)).call();
        fail("Compiler should have crashed");
    } catch(AbortException e) {
        // expected
    }
}