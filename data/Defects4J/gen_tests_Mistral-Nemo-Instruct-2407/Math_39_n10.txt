public void testTooLargeFirstStep() {
    double[] y = {0.0};
    double[] dy = {0.0};
    double t = 0.0;
    double dt = 1.0e-4;
    double tEnd = 1.0e-8;

    ODEIntegrator integrator = new DormandPrince853();
    integrator.setInitialStepSize(dt);
    integrator.setMaxSteps(1000000);

    try {
        integrator.integrate(1, t, tEnd, y, dy);
        fail("Expected an exception");
    } catch (IntegrationException e) {
        // expected
    }

    assertEquals(tEnd, t, 1.0e-10);
}