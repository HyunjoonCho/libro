public void testReadTruncated() throws Exception {
    byte[] data = new byte[770];
    // Fill data with some values
    try (OutputStream os = new FileOutputStream("test.bz2")) {
        os.write(data);
    }
    try (BZip2CompressorInputStream bis = new BZip2CompressorInputStream(new FileInputStream("test.bz2"))) {
        byte[] buffer = new byte[1024];
        int read = bis.read(buffer);
        assertEquals(770, read);
    }
}