public void testArgumentCaptorVarargsFailure() {
    MyClass mock = mock(MyClass.class);
    ArgumentCaptor<String[]> captor = ArgumentCaptor.forClass(String[].class);

    mock.myVarargsMethod("one", "two", "three");

    verify(mock).myVarargsMethod(captor.capture());

    assertEquals(3, captor.getValue().length);
    assertEquals("one", captor.getValue()[0]);
    assertEquals("two", captor.getValue()[1]);
    assertEquals("three", captor.getValue()[2]);
}