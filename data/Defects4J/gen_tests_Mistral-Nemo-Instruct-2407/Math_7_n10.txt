public void testEventStateNotUpdated() {
    // Given
    double[] initialState = {0.0, 0.0};
    double[] eventTimes = {1.0, 2.0, 3.0};
    double[] eventValues = {0.5, -0.5, 0.0};

    // When
    ODESolver solver = new ODESolver() {
        @Override
        public void eventOccurred(double t, double[] y) {
            if (Math.abs(y[0] - eventValues[0]) < 1e-6) {
                resetState();
            }
        }
    };
    solver.solve(initialState, 0.0, 4.0, eventTimes);

    // Then
    // Check that the event state was not updated correctly
    assertEquals(1.0, initialState[0], 1e-6);
    assertEquals(0.0, initialState[1], 1e-6);
}