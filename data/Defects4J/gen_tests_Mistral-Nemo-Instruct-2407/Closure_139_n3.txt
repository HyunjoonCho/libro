public void testRedefinitionBug() {
    String code = "function assert(b) {if (!b) throw 'error'}\n" +
                  "assert(f() === 1)\n" +
                  "var f = function() {return 2;}\n" +
                  "assert(f() === 2)\n" +
                  "function f() {return 1;}\n";
    try {
        // Compile and execute the code
        ScriptEngine engine = new ScriptEngineManager().getEngineByName("nashorn");
        engine.eval(code);
        fail("Expected an error due to redefinition of 'f'");
    } catch (Exception e) {
        // Expected behavior, no need to do anything
    }
}