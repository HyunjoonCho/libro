public void testTruncatedError() throws IOException {
    String fileContent = "alert(foo);\n" +
                         "alert(bar);\n";
    Files.write(Paths.get("test.js"), fileContent.getBytes());
    ProcessBuilder pb = new ProcessBuilder("java", "-jar", "compiler.jar", "--warning_level", "VERBOSE", "--js", "test.js");
    pb.redirectErrorStream(true);
    Process p = pb.start();
    String output = new BufferedReader(new InputStreamReader(p.getInputStream())).lines().collect(Collectors.joining("\n"));
    assertTrue(output.contains("test.js:2: ERROR - variable bar is undefined\nalert(bar);\n ^\n"));
}