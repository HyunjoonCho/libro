public void testJsonIdentityInfoDeserializationFailure() {
    ObjectMapper mapper = new ObjectMapper();
    mapper.setSerializationInclusion(Include.NON_NULL);
    mapper.configure(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES, false);
    mapper.configure(DeserializationFeature.ACCEPT_SINGLE_VALUE_AS_ARRAY, true);

    String json = "{\"a\":{\"b\":{\"c\":1}}}}";
    try {
        A a = mapper.readValue(json, A.class);
        fail("Expected deserialization failure");
    } catch (JsonMappingException e) {
        // expected
    }
}

class A {
    @JsonIdentityInfo(generator = ObjectIdGenerators.PropertyGenerator.class, property = "id")
    B b;
}

class B {
    @JsonIdentityInfo(generator = ObjectIdGenerators.PropertyGenerator.class, property = "id")
    C c;
}

class C {
    int value;
}