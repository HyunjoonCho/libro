public void testTruncatedError() {
    ProcessBuilder pb = new ProcessBuilder("java", "-jar", "compiler.jar", "--warning_level", "VERBOSE", "--js", "test.js");
    pb.redirectErrorStream(true);
    Process p = pb.start();
    try {
        p.waitFor();
        assertTrue(p.getErrorStream().toString().contains("test.js:2: ERROR - variable bar is undefined"));
    } catch (InterruptedException e) {
        e.printStackTrace();
    }
}