public void testInvokerTransformerRCE() throws Exception {
    // Create a serializable collection that executes arbitrary code
    List<String> list = new ArrayList<>();
    InvokerTransformer.transformer = new InvokerTransformer() {
        @Override
        public Object invoke(Object o, Object[] objects) throws Exception {
            return "executed";
        }
    };
    list.add("test");

    // Serialize and deserialize the collection
    try (ByteArrayOutputStream bos = new ByteArrayOutputStream();
         ObjectOutput out = new ObjectOutputStream(bos)) {
        out.writeObject(list);
        ObjectInput in = new ObjectInputStream(new ByteArrayInputStream(bos.toByteArray()));
        List<String> deserialized = (List<String>) in.readObject();
    }

    // The deserialized collection should execute the arbitrary code
    assertEquals("executed", deserialized.get(0));
}