public void testDerivativeStructureAtan2SpecialCases() {
    DerivativeStructure ds = new DerivativeStructure(1, 0, 0.0, 0.0);
    assertTrue(Double.isNaN(ds.atan2(0.0, 0.0)));
    assertTrue(Double.isNaN(ds.atan2(0.0, -0.0)));
    assertTrue(Double.isNaN(ds.atan2(0.0, 0.0)));
    assertTrue(Double.isNaN(ds.atan2(0.0, 1.0)));
}