public void testArgumentCaptorVarargs() {
    List<String> argList = new ArrayList<>();
    ArgumentCaptor<String[]> captor = ArgumentCaptor.forClass(String[].class);
    doAnswer(new Answer<Void>() {
        public Void answer(InvocationOnMock invocation) throws Throwable {
            argList.addAll(Arrays.asList((String[])invocation.getArguments()[0]));
            return null;
        }
    }).when(mock).takeArguments(captor.capture());
    // This will fail if ArgumentCaptor is not working for varargs
    mock.takeArguments("arg1", "arg2");
    assertEquals(Arrays.asList("arg1", "arg2"), argList);
}