public void testEOLHandling() throws IOException {
    ExtendedBufferReader reader = new ExtendedBufferReader(new StringReader("a\rb\nc\r\nd\r\n"));
    assertEquals(1, reader.getLineCount());
    assertEquals("a", reader.readLine());
    assertEquals(2, reader.getLineCount());
    assertEquals("b", reader.readLine());
    assertEquals(3, reader.getLineCount());
    assertEquals("c", reader.readLine());
    assertEquals(4, reader.getLineCount());
    assertEquals("d", reader.readLine());
    assertEquals(5, reader.getLineCount());
}