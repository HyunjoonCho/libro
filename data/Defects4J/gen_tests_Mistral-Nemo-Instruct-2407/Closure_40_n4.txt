public void testSmartNameRemovalCrash() {
    String code = "var goog = {};\n" +
            "goog.inherits = function(x, y) {}\n" +
            "var ns = {};\n" +
            "/** @constructor */ ns.PageSelectionModel = function(){};\n" +
            "/** @constructor */ \n" +
            "ns.PageSelectionModel.FooEvent = function() {}\n" +
            "/** @constructor */ \n" +
            "ns.PageSelectionModel.SelectEvent = function() {}\n" +
            "goog.inherits(ns.PageSelectionModel.ChangeEvent, ns.PageSelectionModel.FooEvent);";
    try {
        compile(code);
        fail("Compiler did not crash");
    } catch (IllegalStateException e) {
        // expected
    }
}