public void testEventHandlingBug() {
    EventSource source = new EventSource();
    EventListener listener = new EventListener() {
        boolean firstEventReceived = false;

        @Override
        public void onEvent(Event event) {
            if (firstEventReceived) {
                assertTrue("Second event should be handled correctly after reinitialization", event.getState().isValid());
            } else {
                firstEventReceived = true;
                // Simulate accepting first event and incomplete reinitialization
                event.accept();
                event.getState().reset();
            }
        }
    };
    source.addListener(listener);
    source.publish(new Event("firstEvent"));
    source.publish(new Event("secondEvent"));
}