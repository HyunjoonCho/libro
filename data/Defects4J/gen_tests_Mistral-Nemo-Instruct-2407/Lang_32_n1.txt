public void testToStringStyleMemoryLeak() {
    ToStringStyle style = ToStringStyle.SHORT_PREFIX_STYLE;
    System.gc();
    long memoryBefore = ManagementFactory.getMemoryMXBean().getHeapMemoryUsage().getUsed();
    // trigger memory leak by using the style
    String testString = new Object() {
        {
            toString();
        }
    }.toString();
    System.gc();
    long memoryAfter = ManagementFactory.getMemoryMXBean().getHeapMemoryUsage().getUsed();
    assertTrue("Memory leak detected, heap usage increased unexpectedly", memoryBefore <= memoryAfter);
}