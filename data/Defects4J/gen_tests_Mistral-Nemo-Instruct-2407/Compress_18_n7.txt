public void testLongDirectoryName() throws IOException {
    String longDirName = "ThisIsAVeryLongDirectoryNameThatExceeds100Bytes";
    File longDir = new File(longDirName);
    longDir.mkdir();

    TarArchiveOutputStream out = new TarArchiveOutputStream(new ByteArrayOutputStream());
    try {
        out.putArchiveEntry(new TarArchiveEntry(longDir));
        fail("Expected IOException was not thrown");
    } catch (IOException e) {
        // expected
    } finally {
        out.close();
    }

    assertTrue(longDir.delete());
}