public void testJsonIdentityInfoForwardReferences() throws Exception {
    ObjectMapper mapper = new ObjectMapper();

    ObjectIdTest.Foo mo = new ObjectIdTest.Foo();
    Bar bar = new Bar();
    mo.bar1 = bar;
    mo.bar2 = bar;

    String json = mapper.writeValueAsString(mo);
    assertEquals("{\"bar1\":1,\"bar2\":1}", json);
}