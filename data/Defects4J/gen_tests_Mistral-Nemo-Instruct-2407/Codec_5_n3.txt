public void testBase64InputStreamNpe() throws Exception {
    byte[] data =...; // the provided malformed input
    ByteArrayInputStream bais = new ByteArrayInputStream(data);
    Base64InputStream bis = new Base64InputStream(bais, true);
    byte[] buf = new byte[1024];
    int read = bis.read(buf);
    assertEquals(1190, read); // first iteration reads all 1190 bytes
    read = bis.read(buf);
    assertEquals(-1, read); // second iteration reaches EOF
}