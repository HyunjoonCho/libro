public void testEmptyFilesInArchive() throws Exception {
    String tmpDir = System.getProperty("java.io.tmpdir");
    File folder = new File(tmpDir, "testFolder");
    folder.mkdir();

    for (int i = 0; i < 8; i++) {
        File file = new File(folder, "file" + i + ".txt");
        if (i < 7 || i == 7) { // Scenario 1 and 3
            file.createNewFile();
        } else { // Scenarios 4.1 and 4.2
            try (PrintWriter out = new PrintWriter(file)) {
                out.print("Content");
            }
        }
    }

    // Archive the folder
    ArchiveFormat SevenZ = ArchiveFormat. SevenZ;
    ArchiveBuilder builder = new ArchiveBuilder().format(SevenZ);
    builder.addFolder(folder);
    File archiveFile = new File(tmpDir, "testArchive.7z");
    builder.build(archiveFile);

    // Verify the archive
    Archive<File> archive = SevenZ.createArchive(archiveFile, null);
    if (archive.getType()!= ArchiveType.CORRUPTED) {
        fail("Archive should