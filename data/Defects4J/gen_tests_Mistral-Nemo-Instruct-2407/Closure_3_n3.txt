public void testOptimizationFailsWithVariableInCatchClause() {
    // Given
    String script = "function getStack() { var getErrorObject = function() { try { throw Error(''); } catch(err) { return err; } }; return getErrorObject().stack; } window['getStackTrace']=getStack;";
    // When
    // Then
    assertThrows(IllegalStateException.class, () -> {
        // Given
        OptimizationService optimizationService = mock(OptimizationService.class);
        when(optimizationService.optimize(ScriptType.JAVASCRIPT, script, Optimization.SIMPLE)).thenCallRealMethod();
        // When
        optimizationService.optimize(ScriptType.JAVASCRIPT, script, Optimization.SIMPLE);
    });
}