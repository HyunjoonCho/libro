public void testDefaultImplSubtypeResolution() {
    SimpleBean superBean = new SimpleBean("super");
    SimpleBeanSub subBean = new SimpleBeanSub("sub", 42);
    ObjectMapper mapper = new ObjectMapper();
    mapper.setSerializationInclusion(Include.NON_DEFAULT);
    try {
        assertEquals("{ \"field\": \"super\"}", mapper.writeValueAsString(superBean));
        assertEquals("{ \"field\": \"sub\", \"subField\": 42 }", mapper.writeValueAsString(subBean));
        assertEquals("{ \"field\": \"super\"}", mapper.writeValueAsString(mapper.readValue(mapper.writeValueAsString(subBean), SimpleBean.class)));
    } catch (JsonProcessingException | JsonMappingException e) {
        e.printStackTrace();
    }
}