public void testEmbeddedRungeKuttaInitialStepSize() {
    DormandPrince853Integrator integrator = new DormandPrince853Integrator();
    double[] y0 = {1.0, 2.0, 3.0};
    double[] yDot = {4.0, 5.0, 6.0};
    double atol = 1.0e-6;
    double rtol = 1.0e-6;
    integrator.setStepController(new FixedStepController(1.0));
    integrator.setAbsoluteTolerance(atol);
    integrator.setRelativeTolerance(rtol);
    integrator.initialize(y0, yDot);
    integrator.integrate(0, 1, y0, y0);
    assertEquals(2.0, y0[0], 1.0e-6);
    assertEquals(3.0, y0[1], 1.0e-6);
    assertEquals(4.0, y0[2], 1.0e-6);
}