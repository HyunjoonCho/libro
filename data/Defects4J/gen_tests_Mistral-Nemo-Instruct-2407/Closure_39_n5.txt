public void testTypedefExternExport() {
    String source = "/** @const */ var myTypeDef = {'foo': 1, 'bar': 2};\n"
            + "var belowTypedef = myTypeDef;\n"
            + "@typedef {({'foo':!number, 'bar':!number})}\n"
            + "var aboveTypedef = myTypeDef;\n";
    try {
        // Run the closure compiler and grab the externExport string
        // Your code to run the compiler and get the externExport string here
        fail("Expected an exception due to invalid externs");
    } catch (AssertionError e) {
        // Expected exception, verify it's due to the truncation issue
        assertTrue(e.getMessage(), e.getMessage().contains("bad type"));
    }
}