public void testUnknownCompressedSize() {
    ZipEntry entry = new ZipEntry("test") {
        @Override
        public int getMethod() {
            return ZipMethod.BZIP2.getCode();
        }

        @Override
        public int getCompressedSize() {
            return ArchiveEntry.SIZE_UNKNOWN;
        }
    };
    ZipArchiveInputStream zis = new ZipArchiveInputStream(new ByteArrayInputStream(new byte[0]));
    try {
        zis.getNextZipEntry(entry);
        fail("Expected IllegalStateException");
    } catch (IllegalStateException e) {
        // expected
    }
}