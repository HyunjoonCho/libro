public void testWeightInChiSquare() {
    // Given
    AbstractLeastSquares als = mock(AbstractLeastSquares.class);
    when(als.residualsWeights()).thenReturn(new double[]{1.0, 2.0, 3.0});
    when(als.getChiSquare()).thenReturn(10.0);
    when(als.rows()).thenReturn(3);

    // When
    double rms = als.getRMS();

    // Then
    assertEquals(3.16227766016838, rms, 0.00001);
}