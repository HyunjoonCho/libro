public void testWeightVsSigma() {
    // Create an AbstractLeastSquares instance with some data
    double[] data = {1, 2, 3, 4, 5};
    double[] weights = {1, 2, 3, 4, 5};
    AbstractLeastSquares als = new AbstractLeastSquares(data, weights);

    // Manually calculate chi2 and compare with getChiSquare()
    double chi2Manual = 0;
    for (int i = 0; i < data.length; i++) {
        chi2Manual += Math.pow(als.residualsWeights[i], 2) / weights[i];
    }
    assertEquals(chi2Manual, als.getChiSquare(), 1e-10);

    // Check that getRMS() behaves as expected
    double rms = Math.sqrt(als.getChiSquare() / als.rows);
    assertEquals(rms, als.getRMS(), 1e-10);
}