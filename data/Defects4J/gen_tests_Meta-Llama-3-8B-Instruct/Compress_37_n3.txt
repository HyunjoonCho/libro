public void testParsingPaxHeadersFailsWithNegativeArraySizeException() {
    byte[] data = new byte[] {
        0x74, 0x61, 0x72, 0x0a,  // tar header
        0x50, 0x61, 0x58, 0x68, 0x65, 0x61, 0x64, 0x65, 0x72, 0x73, 0x0a, // pax header
        0x0a // empty line
    };
    TarArchiveInputStream stream = new TarArchiveInputStream(new ByteArrayInputStream(data));
    try {
        stream.parsePaxHeaders();
        fail("Expected NegativeArraySizeException");
    } catch (NegativeArraySizeException e) {
        // expected
    }
}