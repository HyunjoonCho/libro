java
import org.junit.Test;
import static org.junit.Assert.assertEquals;
import static org.junit.Assert.fail;

public class ChiSquareTest {

    @Test
    public void testChiSquare() {
        long[] observed1 = {500, 623, 72, 70, 31};
        double[] expected1 = {485, 541, 82, 61, 37};

        double result = testStatistic.chiSquare(expected1, observed1);
        assertEquals("chi-square test statistic", 9.0233, result, 1E-10);

        // Check if the expected values are rescaled correctly
        double sumExpected = 0;
        for (int i = 0; i < expected1.length; i++) {
            sumExpected += expected1[i];
        }
        double sumObserved = 0;
        for (int i = 0; i < observed1.length; i++) {
            sumObserved += observed1[i];
        }
        for (int i = 0; i < expected1.length; i++) {
            expected1[i] = (double) observed1[i] * expected1[i] / sumExpected;
        }
        assertEquals("chi-square expected values", new double[]{521.19403, 581.37313, 88.11940, 65.55224, 39.76119}, expected1, 1E-10);
    }
}
