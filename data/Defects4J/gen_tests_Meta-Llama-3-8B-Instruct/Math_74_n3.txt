java
import org.junit.Test;
import org.junit.runner.RunWith;
import org.junit.runners.Parameterized;

import java.util.Arrays;
import java.util.Collection;

import static org.junit.Assert.assertEquals;

@RunWith(Parameterized.class)
public class EmbeddedRungeKuttaIntegratorTest {

    @Parameterized.Parameter(0)
    public double y0;

    @Parameterized.Parameter(1)
    public double Atoli;

    @Parameterized.Parameter(2)
    public double Rtoli;

    @Parameterized.Parameter(3)
    public double scalAbsoluteTolerance;

    @Parameterized.Parameter(4)
    public double scalRelativeTolerance;

    @Parameterized.Parameter(5)
    public double[] vecAbsoluteTolerance;

    @Parameterized.Parameter(6)
    public double[] vecRelativeTolerance;

    @Parameterized.Parameter(7)
    public double expectedScale;

    @Test
    public void testInitializeStep() {
        double[] scale = new double[1];
        scale[0] = expectedScale;
        double hNew = EmbeddedRungeKuttaIntegrator.initializeStep(y0, Atoli, Rtoli, scale, scalAbsoluteTolerance, scalRelativeTolerance, vecAbsoluteTolerance, vecRelativeTolerance);
        assertEquals(expectedScale, scale[0]);
    }

    @Parameterized.Parameters
    public static Collection<Object[]> data() {
        return Arrays.asList(new Object[][]{
            {1.0, 1.0, 0.1, 1.0, 0.1, null, null, 1.1},
            {1.0, 1.0, 0.1, 1.0, 0.1, new double[]{1.0}, new double[]{0.1}, 1.1},
        });
    }
}
