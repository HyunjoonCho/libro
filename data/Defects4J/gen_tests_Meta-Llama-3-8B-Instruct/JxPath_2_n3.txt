java
import org.jaxen.Context;
import org.jaxen.ContextFactory;
import org.jaxen.JaxenException;
import org.jaxen.XPath;
import org.jaxen.function.NodeSetFunction;
import org.jaxen.objects.BeanNodeSet;
import org.jaxen.objects.NodeSet;
import org.jaxen.objects.NodeSetFunctionTest;

import java.util.ArrayList;
import java.util.List;

public class NodeSetFunctionTest extends NodeSetFunctionTest {

    public void testNodeSetFunction() throws JaxenException {
        Context context = ContextFactory.createContext();
        NodeSetFunction function = new NodeSetFunction() {
            @Override
            public NodeSet execute(Context context) {
                List<NodePointer> ptrs = new ArrayList<>();
                // add some pointers to the list
                BasicNodeSet result = new BasicNodeSet();
                for (NodePointer ptr : ptrs) {
                    result.add(ptr);
                }
                return result;
            }
        };

        XPath xpath = context.compileExpression("ems:observations()");
        NodeSet result = (NodeSet) xpath.execute(context, function);
        // assert that the result is correct
    }
}
