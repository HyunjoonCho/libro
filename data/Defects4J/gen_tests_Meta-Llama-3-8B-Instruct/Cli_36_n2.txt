
import org.junit.Test;
import org.junit.runner.RunWith;
import org.junit.runners.JUnit4;

import picocli.CommandLine.HelpFormatter;
import picocli.CommandLine.Option;
import picocli.CommandLine.OptionGroup;
import picocli.CommandLine.Options;

import java.util.ArrayList;
import java.util.List;

import static org.junit.Assert.assertEquals;
import static org.junit.Assert.fail;

@RunWith(JUnit4.class)
public class HelpFormatterTest {

    @Test
    public void testSetOptionComparatorNull() {
        OptionGroup group = new OptionGroup();
        Option h = new Option("h");
        Option s = new Option("s");
        Option b = new Option("b");
        Option t = new Option("t");
        group.addOption(h);
        group.addOption(s);
        group.addOption(b);
        group.addOption(t);

        Options options = new Options();
        options.addOptionGroup(group);
        options.addOption(new Option("o"));

        HelpFormatter formatter = new HelpFormatter();
        formatter.setOptionComparator(null);
        List<String> output = new ArrayList<>();
        formatter.printHelp("cmd", "", options, output::add);

        String result = String.join("\n", output);
        fail("Expected the options to be printed in the order of insertion, but got:\n" + result);
    }
}
