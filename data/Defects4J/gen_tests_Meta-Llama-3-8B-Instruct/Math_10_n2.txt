public void testAtan2SpecialCases() {
    DerivativeStructure ds = new DerivativeStructure(1, 1, 1, 0);
    assertEquals(Double.NaN, ds.atan2(0, 0).doubleValue());
    assertEquals(Double.NaN, ds.atan2(0, 0.1).doubleValue());
    assertEquals(Double.NaN, ds.atan2(0.1, 0).doubleValue());
    assertEquals(Double.NaN, ds.atan2(0.1, 0.1).doubleValue());
}