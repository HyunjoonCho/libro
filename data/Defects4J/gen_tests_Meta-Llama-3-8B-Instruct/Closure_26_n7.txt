public void testProcessCommonJSModules() {
    // Define the module
    String echoJs = "define(function() { return {\n" +
            "  echo: function(val) {\n" +
            "    window.console.log(val);\n" +
            "  }\n" +
            "});\n";

    // Define the entry point
    String echoMainJs = "var echo = require('echo');\n" +
            "echo.echo('hello world');";

    // Compile the code with the specified options
    // This is a simulated compilation process, the actual implementation may vary
    // depending on the specific build tool and configuration
    // For the sake of simplicity, this test just checks the expected error message
    String compilationOutput = compile(echoJs, echoMainJs, true);

    // Verify the error message
    assertTrue(compilationOutput.contains("ERROR - Property module$exports never defined on module$echo_main"));
}