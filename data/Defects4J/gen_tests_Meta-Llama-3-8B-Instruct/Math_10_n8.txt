public void testAtan2SpecialCases() {
    DerivativeStructure ds1 = new DerivativeStructure(1.0, 0.0, 0.0);
    DerivativeStructure ds2 = new DerivativeStructure(0.0, 1.0, 0.0);
    assertEquals(Double.NaN, ds1.atan2(ds2).doubleValue());
    assertEquals(Double.NaN, ds1.atan2(ds1).doubleValue());
    assertEquals(Double.NaN, ds2.atan2(ds2).doubleValue());
    assertEquals(Double.NaN, ds2.atan2(ds1).doubleValue());
}