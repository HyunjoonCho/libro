
@Test
public void testWhitespacePreservationInPreTag() {
    String html = "<pre><code>\n" +
            "  message <span style=\"color:red\"> other   \n    message  with \n" +
            "   whitespaces      </span>\n" +
            "</code></pre>";

    Document doc = Jsoup.parse(html);
    String output = doc.select("pre").first().outerHtml();

    // Expected output:
    String expected = "<pre><code>\n" +
            "  message <span style=\"color:red\"> other   \n    message  with \n" +
            "   whitespaces      </span>\n" +
            "</code></pre>";

    assertEquals(expected, output);
}
