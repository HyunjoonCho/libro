java
import org.junit.Test;
import org.junit.runner.RunWith;
import org.powermock.core.classloader.annotations.PowerMockIgnore;
import org.powermock.core.classloader.annotations.PowerMockito;
import org.powermock.modules.junit4.PowerMockRunner;
import org.powermock.reflect.Whitebox;

import java.io.IOException;
import java.io.InputStream;
import java.util.zip.ZipEntry;

import static org.junit.Assert.fail;
import static org.mockito.Mockito.mock;
import static org.mockito.Mockito.when;

@RunWith(PowerMockRunner.class)
@PowerMockIgnore("javax.crypto.*")
@PowerMockito(method = "getCompressedSize")
public class ZipArchiveInputStreamTest {

    @Test(expected = NullPointerException.class)
    public void testGetNextZipEntryUnknownCompressedSize() throws IOException {
        ZipEntry zipEntry = mock(ZipEntry.class);
        when(zipEntry.getMethod()).thenReturn(ZipMethod.BZIP2.getCode());
        ZipArchiveInputStream zipArchiveInputStream = new ZipArchiveInputStream(mock(InputStream.class));
        zipArchiveInputStream.getNextZipEntry(zipEntry);
        zipArchiveInputStream.read(new byte[1]);
        fail("Expected NullPointerException");
    }
}
