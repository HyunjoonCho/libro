public void testObjectIdSerialization() {
    ObjectMapper mapper = new ObjectMapper();
    mapper.enableDefaultTyping();

    ReallyAlwaysAsId a = new ReallyAlwaysAsId();
    ReallyAlwaysContainer container = new ReallyAlwaysContainer();
    container.a = a;
    container.b = a;

    String json = mapper.writeValueAsString(container);

    assertEquals("{\"a\":{\"$ref\":\"#0\"},\"b\":{\"$ref\":\"#0\"}}", json);
}