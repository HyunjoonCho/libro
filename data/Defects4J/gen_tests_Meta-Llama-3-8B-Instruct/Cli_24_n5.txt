java
import org.junit.Test;
import org.junit.rules.TemporaryFolder;
import org.junit.Rule;
import org.junit.Ignore;

import java.io.ByteArrayOutputStream;
import java.io.PrintStream;
import java.io.UnsupportedEncodingException;

import org.junit.Rule;

import static org.junit.Assert.assertThrows;
import static org.junit.Assert.fail;

public class HelpFormatterTest {

    @Rule
    public TemporaryFolder folder = new TemporaryFolder();

    @Test
    public void testHelpFormatterInfiniteLoop() throws UnsupportedEncodingException {
        ByteArrayOutputStream bos = new ByteArrayOutputStream();
        PrintStream originalOut = System.out;
        System.setOut(new PrintStream(bos));

        Options options = new Options();
        options.addOption("h", "help", false, "This is a looooong description");

        HelpFormatter formatter = new HelpFormatter();
        formatter.setWidth(20);
        formatter.printHelp("app", options);

        System.setOut(originalOut);

        String output = bos.toString("UTF-8");
        fail("Expected an exception, but no exception was thrown. Output: " + output);
    }
}
