public void testInternalCompilerError() {
    Process compiler = new ProcessBuilder("java", "-jar", "april5compiler.jar", "--compilation_level", "ADVANCED_OPTIMIZATIONS", "--variable_map_output_file", "js.vars", "--js_output_file", "bullet_1_1_q1.cc.js")
           .redirectOutput(ProcessBuilder.Redirect.PIPE)
           .redirectError(ProcessBuilder.Redirect.PIPE)
           .start();

    BufferedReader reader = new BufferedReader(new InputStreamReader(compiler.getInputStream()));
    String line;
    while ((line = reader.readLine()) = null) {
        // Read the output line by line
    }

    int exitValue = compiler.waitFor();
    assertEquals(1, exitValue); // Compiler should exit with an error code

    // Check the error output
    reader = new BufferedReader(new InputStreamReader(compiler.getErrorStream()));
    while ((line = reader.readLine())!= null) {
        // Check that the error message matches the expected output
    }
}