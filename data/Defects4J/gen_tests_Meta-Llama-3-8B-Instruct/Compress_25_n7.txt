public void testZipCompressionIssue() {
    byte[] zip = {
        (byte)0x50, (byte)0x4b, (byte)0x03, (byte)0x04, (byte)0x0a, (byte)0x00,
        (byte)0x00, (byte)0x00, (byte)0x00, (byte)0x00, (byte)0x03, (byte)0x7b,
        //... rest of the zip data
    };
    ByteArrayInputStream bin = new ByteArrayInputStream(zip);
    try {
        ZipArchiveInputStream in = new ZipArchiveInputStream(bin);
        try {
            while (true) {
                ZipArchiveEntry entry = in.getNextZipEntry();
                if (entry == null) {
                    break;
                }
                byte[] buf = new byte[(int) entry.getSize()];
                in.read(buf);
                assertEquals("data\n", new String(buf));
            }
        } finally {
            in.close();
        }
    } catch (IOException e) {
        fail("IOException: " + e);
    }
}