public void testCSVFormatWithHeader() {
    CSVPrinter csvPrinter = CSVFormat.TDF.withHeader("x").print(Files.newBufferedWriter(Paths.get("data.csv")));
    csvPrinter.printRecord(42);
    csvPrinter.close();
    // Verify that the file was written correctly
    String expected = "x\n42\n";
    try {
        String actual = Files.readString(Paths.get("data.csv"));
        assertEquals(expected, actual);
    } catch (IOException e) {
        fail("Failed to read file");
    }
}