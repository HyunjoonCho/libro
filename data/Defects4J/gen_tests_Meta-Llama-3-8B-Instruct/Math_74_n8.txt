public void testInitializeStep() {
    // Create a sample system of differential equations
    // Initialize the y0 and yDotK arrays
    double[] y0 = {1.0, 2.0};
    double[] yDotK = {3.0, 4.0};
    double[] yTmp = new double[2];
    double[] scale = new double[2];
    double hNew = 1.0;
    
    // Create a sample integrator
    EmbeddedRungeKuttaIntegrator integrator = new DormandPrince853Integrator();
    
    // Set the parameters
    integrator.initializeStep(y0, yDotK, yTmp, scale, hNew);
    
    // Check if the scale array is initialized correctly
    for (int i = 0; i < scale.length; i++) {
        assertEquals(y0[i] * Math.abs(y0[i]) * integrator.getRelativeTolerance() + integrator.getAbsoluteTolerance(), scale[i], 0.00001);
    }
}