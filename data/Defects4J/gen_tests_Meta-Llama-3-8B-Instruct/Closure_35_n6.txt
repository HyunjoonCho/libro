public void testAssignmentToRecord() {
    Function func = new Function() {
        @Override
        public Object call(Object a, Object b) {
            Object results;
            if (a!= null) {
                results = new Object();
                ((Object) results).setProperty("prop1", new Object() {
                    public Object getA() {
                        return 3;
                    }
                });
            }
            if (b!= null) {
                results = results == null? new Object() : results;
                ((Object) results).setProperty("prop2", "prop2");
            } else {
                results = results == null? new Object() : results;
                ((Object) results).setProperty("prop3", "prop3");
            }
            return results;
        }
    };
    assertEquals("{\"prop1\":{\"a\":3},\"prop2\":\"prop2\"}", func.call(true, true));
    assertEquals("{\"prop1\":{\"a\":3},\"prop2\":\"prop2\",\"prop3\":\"prop3\"}", func.call(true, false));
    assertEquals("{\"prop2\":\"prop2\"}", func.call(false, true));
    assertEquals("{\"prop3\":\"prop3\"}", func.call(false, false));
}