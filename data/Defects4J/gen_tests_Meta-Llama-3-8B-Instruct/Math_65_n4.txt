
public void testAbstractLeastSquares() {
    // Create a sample dataset with weights
    double[] residuals = {1.0, 2.0, 3.0};
    double[] weights = {0.5, 1.0, 2.0};
    AbstractLeastSquares als = new AbstractLeastSquares(residuals, weights);

    // Calculate RMS
    double rms = als.getRMS();

    // Expected result: sqrt((1.0^2 * 0.5 + 2.0^2 * 1.0 + 3.0^2 * 2.0) / 3.0)
    double expectedRMS = Math.sqrt((1.0 * 0.5 * 1.0 + 4.0 * 1.0 + 9.0 * 2.0) / 3.0);
    assertEquals(expectedRMS, rms, 0.01);

    // Calculate ChiSquare
    double chiSquare = als.getChiSquare();

    // Expected result: (1.0^2 * 0.5 + 2.0^2 * 1.0 + 3.0^2 * 2.0) / (0.5 + 1.0 + 2.0)
    double expectedChiSquare = (1.0 * 0.5 + 4.0 + 9.0 * 2.0) / (0.5 + 1.0 + 2.0);
    assertEquals(expectedChiSquare, chiSquare, 0.01);
}
