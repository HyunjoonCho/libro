public void testWeightIssue() {
    AbstractLeastSquares als = new AbstractLeastSquares();
    double[] residuals = new double[] {1.0, 2.0};
    double[] weights = new double[] {2.0, 3.0};
    als.residualsWeights = weights;
    double expectedRMS = Math.sqrt((residuals[0] * residuals[0] * weights[0] + residuals[1] * residuals[1] * weights[1]) / (2.0));
    assertEquals(expectedRMS, als.getRMS(), 0.0);
}