java
import org.junit.Test;
import org.junit.runner.RunWith;
import org.junit.runners.JUnit4;
import org.apache.commons.compress.archivers.zip.ZipArchiveOutputStream;
import org.apache.commons.compress.archivers.zip.ZipArchiveOutputStreamParams;

import java.io.ByteArrayOutputStream;
import java.io.IOException;
import java.util.zip.Zip64Mode;

import static org.junit.Assert.assertArrayEquals;
import static org.junit.Assert.fail;

@RunWith(JUnit4.class)
public class ZipArchiveOutputStreamTest {

    @Test
    public void testVersionNeededToExtract() throws IOException {
        ByteArrayOutputStream bos = new ByteArrayOutputStream();
        ZipArchiveOutputStream zos = new ZipArchiveOutputStream(bos, new ZipArchiveOutputStreamParams());
        zos.putNextEntry("test", "test".getBytes());
        zos.closeEntry();

        byte[] localHeader = bos.toByteArray();
        int localVersionNeeded = ((short) (localHeader[30] << 8 | localHeader[31]));

        bos = new ByteArrayOutputStream();
        zos = new ZipArchiveOutputStream(bos, new ZipArchiveOutputStreamParams());
        zos.putNextEntry("test", "test".getBytes());
        zos.closeEntry();

        byte[] centralDirectory = bos.toByteArray();
        int centralVersionNeeded = centralDirectory[46] << 8 | centralDirectory[47];

        assertNotEquals(localVersionNeeded, centralVersionNeeded);
    }
}
