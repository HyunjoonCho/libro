
public void testCompressorStreamFactory() throws IOException {
    // Create a file with a zlib header
    String fileContent = "some content";
    byte[] fileBytes = fileContent.getBytes();
    byte[] zlibHeader = new byte[] {(byte) 0x78, (byte) 0x01, (byte) 0x00, (byte) 0x0d};
    byte[] fileWithZlibHeader = new byte[zlibHeader.length + fileBytes.length];
    System.arraycopy(zlibHeader, 0, fileWithZlibHeader, 0, zlibHeader.length);
    System.arraycopy(fileBytes, 0, fileWithZlibHeader, zlibHeader.length, fileBytes.length);

    // Try to create a CompressorInputStream
    CompressorStreamFactory factory = new CompressorStreamFactory();
    try {
        factory.createCompressorInputStream(new ByteArrayInputStream(fileWithZlibHeader));
        fail("Expected CompressorException");
    } catch (CompressorException e) {
        // Expected exception
    }
}
