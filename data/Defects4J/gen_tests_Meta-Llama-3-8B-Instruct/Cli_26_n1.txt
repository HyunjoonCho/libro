public void testOptionBuilderResetOnException() {
    OptionBuilder builder = new OptionBuilder();
    try {
        builder.create();
        fail("Expected IAE");
    } catch (IllegalArgumentException e) {
        // verify that OptionBuilder is not reset
        builder.withValue("test");
        assertEquals("test", builder.create().getOptionValue("test"));
    }
}