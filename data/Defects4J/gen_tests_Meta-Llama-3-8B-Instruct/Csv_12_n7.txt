public void testCsvFormatExelIgnoreEmptyHeaderNames() {
    String csv = "A,B,C,,\na,b,c,d,e";
    try {
        CSVFormat.EXCEL.parseAll(new CSVFormat.DefaultCSVFormat().withHeader().withIgnoreHeaderOnEmptyLines(true).withIgnoreEmptyRecords(true), new StringReader(csv));
        fail("Expected java.lang.IllegalArgumentException");
    } catch (IllegalArgumentException e) {
        // expected
    }
}