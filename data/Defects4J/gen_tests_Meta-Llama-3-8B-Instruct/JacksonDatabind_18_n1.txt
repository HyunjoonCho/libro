public void testReadValuesErrorRecovery() {
    ObjectReader reader = new ObjectReader();
    JsonParser jsonParser = new JsonParser();
    jsonParser.reset("{" +
            "{\"a\": [1, 2, " +
            "{\"b\": [3, 4] " +
            "]}");
    MappingIterator<Object> iterator = reader.readValues(jsonParser);
    jsonParser.nextToken();
    try {
        iterator.next();
        fail("Expected JsonProcessingException");
    } catch (JsonProcessingException e) {
        // Check that the parser has recovered to the correct position
        assertEquals(JsonToken.END_ARRAY, jsonParser.getCurrentToken());
    }
}