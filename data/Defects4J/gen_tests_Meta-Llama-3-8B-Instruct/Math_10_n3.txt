public void testAtan2SpecialCases() {
    DerivativeStructure ds = new DerivativeStructure(1e-6, 1e-6, 1e-6);
    assertEquals(Double.NaN, ds.atan2(0, 0).value());
    assertEquals(Double.NaN, ds.atan2(0, Double.POSITIVE_INFINITY).value());
    assertEquals(Double.NaN, ds.atan2(Double.POSITIVE_INFINITY, 0).value());
    assertEquals(0, ds.atan2(Double.POSITIVE_INFINITY, Double.POSITIVE_INFINITY).value());
    assertEquals(Math.PI, ds.atan2(0, Double.NEGATIVE_INFINITY).value());
    assertEquals(Math.PI, ds.atan2(Double.NEGATIVE_INFINITY, 0).value());
    assertEquals(-Math.PI, ds.atan2(Double.NEGATIVE_INFINITY, Double.POSITIVE_INFINITY).value());
}