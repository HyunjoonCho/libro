
public void testSwitchedOrderOfDeleteKeyAndKeyInStatementsChangesSemantic() {
    Map<String, String> customData = new HashMap<>();
    customData.put("key", "value");

    boolean hadKey = "key" in customData;
    String retval = customData.get("key");
    if (customData.containsKey("key")) {
        customData.remove("key");
    }

    assertEquals(retval, testRemoveKey("key"));
    assertFalse("key" in customData);
}

public String testRemoveKey(String key) {
    Map<String, String> dataSlot = customData;
    String retval = dataSlot.get(key);
    boolean hadKey = dataSlot.containsKey(key);

    if (dataSlot.containsKey(key)) {
        dataSlot.remove(key);
    }

    return hadKey? retval : null;
}
