public void testMockingIterable() {
    List<String> mock = mock(List.class);
    when(mock.iterator()).thenReturn(new Iterator<String>() {
        @Override
        public boolean hasNext() {
            return false;
        }

        @Override
        public String next() {
            return null;
        }
    });
    Iterable<String> iterable = mock;
    assertEquals(0, iterable.size());
}