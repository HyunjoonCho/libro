public void testAdvancedCompilationIssue() {
    A a = new A();
    a.prototype['func1'] = a.prototype.func1;
    a.prototype.func1 = function() {
        this._x = 2;
        this.func2();
    };
    a.prototype.func2 = function() {
        this._x = 3;
        this.func3();
    };
    window['A'] = a;
    // Assert that the function call to func2 throws an error
    try {
        a.prototype.func1();
        fail("Expected func2 to be undefined");
    } catch (e) {
        assertEquals("TypeError", e.name);
    }
}