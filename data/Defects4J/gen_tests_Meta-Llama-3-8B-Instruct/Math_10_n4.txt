
public void testAtan2SpecialCases() {
    DerivativeStructure ds1 = new DerivativeStructure(1e-6, 1e-6, 1e-6);
    DerivativeStructure ds2 = new DerivativeStructure(1e-6, 1e-6, 1e-6);

    assertEquals(Math.toRadians(0), ds1.atan2(ds1).getValue());
    assertEquals(Math.toRadians(0), ds2.atan2(ds2).getValue());
    assertEquals(Math.toRadians(0), ds1.atan2(0).getValue());
    assertEquals(Math.toRadians(0), ds2.atan2(0).getValue());
    assertEquals(Math.toRadians(Math.PI/2), ds1.atan2(1).getValue());
    assertEquals(Math.toRadians(Math.PI/2), ds2.atan2(1).getValue());
    assertEquals(Math.toRadians(-Math.PI/2), ds1.atan2(-1).getValue());
    assertEquals(Math.toRadians(-Math.PI/2), ds2.atan2(-1).getValue());
    assertEquals(Double.NaN, ds1.atan2(0).getValue());
    assertEquals(Double.NaN, ds2.atan2(0).getValue());
    assertEquals(Double.NaN, ds1.atan2(0).getValue());
    assertEquals(Double.NaN, ds2.atan2(0).getValue());
}
