public void testExternalTypeIdBeforePojo() {
    // setup
    ObjectMapper mapper = new ObjectMapper();
    mapper.enableDefaultTyping();
    ObjectWriter writer = mapper.writer();

    // serialize
    String json = writer.writeValueAsString(new RootTypePojo(new ExternalTypePojo()));

    // deserialize
    JsonNode node = mapper.readTree(json);
    ExternalTypePojo deserialized = mapper.treeToValue(node, ExternalTypePojo.class);

    // assert
    assertEquals(ExternalTypePojo.class, deserialized.getClass());
}