
public void testDerivativeStructureAtan2SpecialCases() {
    DerivativeStructure ds1 = new DerivativeStructure(0.0, 0.0, 0.0);
    DerivativeStructure ds2 = new DerivativeStructure(0.0, 0.0, 0.0);
    
    assertEquals(Math.toRadians(0.0), ds1.atan2(ds1).getDouble(), 1e-9);
    assertEquals(Math.toRadians(0.0), ds2.atan2(ds2).getDouble(), 1e-9);
    
    assertEquals(Double.NaN, ds1.atan2(0.0).getDouble(), 1e-9);
    assertEquals(Double.NaN, ds2.atan2(0.0).getDouble(), 1e-9);
    
    assertEquals(Math.toRadians(Math.PI/2), ds1.atan2(Double.POSITIVE_INFINITY).getDouble(), 1e-9);
    assertEquals(Math.toRadians(Math.PI/2), ds2.atan2(Double.POSITIVE_INFINITY).getDouble(), 1e-9);
    
    assertEquals(Math.toRadians(3*Math.PI/2), ds1.atan2(Double.NEGATIVE_INFINITY).getDouble(), 1e-9);
    assertEquals(Math.toRadians(3*Math.PI/2), ds2.atan2(Double.NEGATIVE_INFINITY).getDouble(), 1e-9);
}
