java
import org.junit.Test;
import static org.junit.Assert.assertEquals;

public class ODEIntegratorTest {

    @Test
    public void testMissedEvent() throws Exception {
        double t0 = 1878250320.0000029;
        double t = 1878250379.9999986;
        FirstOrderDifferentialEquations ode = new FirstOrderDifferentialEquations() {
            @Override
            public int getDimension() {
                return 1;
            }

            @Override
            public void computeDerivatives(double t, double[] y, double[] yDot) throws DerivativeException {
                yDot[0] = y[0] * 1.0e-6;
            }
        };

        DormandPrince853Integrator integrator = new DormandPrince853Integrator(0.0, 100.0, 1.0e-10, 1.0e-10);

        double[] y = { 1.0 };
        integrator.setInitialStepSize(60.0);
        double finalT = integrator.integrate(ode, t0, y, t, y);
        assertEquals(t, finalT, 1.0e-6);
    }
}
