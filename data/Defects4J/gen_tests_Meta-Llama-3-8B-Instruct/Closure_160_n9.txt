java
import org.junit.Test;
import static org.junit.Assert.assertEquals;
import static org.junit.Assert.assertTrue;

public class CheckVarsUndefinedVarsTest {

    @Test
    public void testCheckVarsUndefinedVars() {
        // Test that checkVars and undefinedVars diagnostics do not work from command line
        // but work when warning_level is set to VERBOSE
        String[] args = new String[] {"--js", "test.js", "--jscomp_warning", "checkVars", "--jscomp_warning", "undefinedVars"};
        Process process = Runtime.getRuntime().exec(args);
        String output = new String(process.getInputStream().readAllBytes());
        assertEquals("0 error(s), 0 warning(s)", output.trim());

        args = new String[] {"--js", "test.js", "--warning_level", "VERBOSE", "--jscomp_warning", "checkVars", "--jscomp_warning", "undefinedVars"};
        process = Runtime.getRuntime().exec(args);
        output = new String(process.getInputStream().readAllBytes());
        assertTrue(output.contains("WARNING - dangerous use of the global this object"));
        assertTrue(output.contains("ERROR - variable foo is undefined"));
    }
}
