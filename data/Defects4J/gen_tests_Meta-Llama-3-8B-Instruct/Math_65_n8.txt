
public void testWeightInRMS() {
    AbstractLeastSquares las = new AbstractLeastSquares() {
        @Override
        public double getRMS() {
            // Simulate the bug
            double chiSquare = getChiSquare() / rows;
            return Math.sqrt(chiSquare);
        }
    };
    las.setResidualsWeights(new double[]{1.0, 2.0, 3.0});
    // Set up other required values
    las.setRows(3);
    // Calculate RMS
    double rms = las.getRMS();
    // Check the result
    assertEquals(Math.sqrt(14.0 / 3.0), rms, 0.0);
}
