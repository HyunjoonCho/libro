
public void testPearsonsCorrelationPValuesPrecisionLimitedByMachineEpsilon() {
    // Create a correlation object with many treatments
    PearsonsCorrelation correlation = new PearsonsCorrelation(new double[][] {{1, 2, 3}, {4, 5, 6}, {7, 8, 9}, {10, 11, 12}, {13, 14, 15}, {16, 17, 18}, {19, 20, 21}, {22, 23, 24}, {25, 26, 27}, {28, 29, 30}});
    
    // Get the p-values
    double[] pValues = correlation.getCorrelationPValues();
    
    // Check that the p-values are continuous down to 2.2e-16 but drop to 0 after that
    for (double pValue : pValues) {
        if (pValue < 2.2e-16) {
            assertEquals(0, pValue, 0);
        }
    }
}
