
import org.junit.Test;
import org.junit.runner.RunWith;
import org.junit.runners.JUnit4;
import org.apache.tika.parser.pkg.ZipContainerDetector;
import org.apache.tika.Tika;
import java.io.ByteArrayInputStream;
import java.io.IOException;

@RunWith(JUnit4.class)
public class ZipContainerDetectorTest {

    @Test(expected = ArrayIndexOutOfBoundsException.class)
    public void testZipContainerDetector() throws IOException {
        byte[] content = new byte[] {(byte) 85, (byte) 84, 5, 0, 7, -112, -108, 51, 85, 117, 120, 0, 0};
        ByteArrayInputStream bais = new ByteArrayInputStream(content);
        Tika tika = new Tika();
        ZipContainerDetector detector = new ZipContainerDetector();
        tika.addDetector(detector);
        tika.detect(bais, "TR_01.ZIP");
    }
}
