
public void testDerivativeStructureAtan2SpecialCases() {
    DerivativeStructure ds1 = new DerivativeStructure(1, 1, 1, 0);
    DerivativeStructure ds2 = new DerivativeStructure(1, 1, 1, Double.POSITIVE_INFINITY);
    assertEquals(Double.NaN, ds1.atan2(ds1).getDoubleValue());
    assertEquals(Double.NaN, ds1.atan2(ds2).getDoubleValue());
    assertEquals(Double.NaN, ds2.atan2(ds1).getDoubleValue());
    assertEquals(Double.NaN, ds2.atan2(ds2).getDoubleValue());
}
