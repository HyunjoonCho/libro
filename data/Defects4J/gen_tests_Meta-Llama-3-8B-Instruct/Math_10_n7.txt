public void testAtan2SpecialCases() {
    DerivativeStructure ds = new DerivativeStructure(1.0, 1.0, 1.0, 0.0);
    assertEquals(Double.NaN, ds.atan2(0.0, 0.0).doubleValue());
    assertEquals(Double.NaN, ds.atan2(0.0, 1.0).doubleValue());
    assertEquals(Double.NaN, ds.atan2(1.0, 0.0).doubleValue());
    assertEquals(Double.NaN, ds.atan2(Double.NaN, 0.0).doubleValue());
    assertEquals(Double.NaN, ds.atan2(0.0, Double.NaN).doubleValue());
}