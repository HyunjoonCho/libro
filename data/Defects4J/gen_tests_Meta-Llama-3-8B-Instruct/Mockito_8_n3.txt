public void testGenericsSelfReference() {
    GenericsSelfReference<?> genericSelfReference = new GenericsSelfReference() {
        @Override
        public GenericsSelfReference<?> self() {
            return this;
        }
    };
    GenericMetadataSupport genericMetadata = inferFrom(GenericsSelfReference.class).resolveGenericReturnType(genericSelfReference.getClass().getMethod("self").getReturnType());
    assertEquals(GenericsSelfReference.class, genericMetadata.rawType());
}