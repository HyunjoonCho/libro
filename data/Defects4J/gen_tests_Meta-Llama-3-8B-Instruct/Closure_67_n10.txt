javascript
function A() {
    this._x = 1;
}

A.prototype['func1'] = // done to save public reference to func1
A.prototype.func1 = function() {
    this._x = 2;
    this.func2();
}

A.prototype.func2 = function() {
    this._x = 3;
    this.func3();
}

window['A'] = A;

describe('Advanced compilation bug', () => {
    it('renames and deletes a function', () => {
        const a = new A();
        a.func1();
        expect(a._x).toBe(3); // should throw an error because func2 is deleted
    });
});
