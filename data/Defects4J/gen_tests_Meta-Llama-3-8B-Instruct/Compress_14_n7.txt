
public void testTarFileWithSymlink() throws Exception {
    // Create a test file
    File testFile = File.createTempFile("test", ".tar");
    testFile.deleteOnExit();

    // Create a tar file with a symlink
    try (FileOutputStream fos = new FileOutputStream(testFile);
         TarArchiveOutputStream taos = new TarArchiveOutputStream(fos)) {
        TarArchiveEntry entry = new TarArchiveEntry("link");
        entry.setSize(0);
        entry.setMode(0120000); // Symbolic link
        taos.putArchiveEntry(entry);
        taos.write("1722000726".getBytes()); // NUL (0x00) followed by the link path
        taos.closeArchiveEntry();
    }

    // Try to read the tar file
    try (TarArchiveInputStream tais = new TarArchiveInputStream(new FileInputStream(testFile))) {
        TarArchiveEntry entry = tais.getNextTarEntry();
        assert entry!= null;
        assertEquals("link", entry.getName());
        assertEquals(0, entry.getSize());
        assertEquals(0120000, entry.getMode()); // Symbolic link
    }
}
