public void testRMSWeights() {
    // Create a test data
    double[] residuals = new double[] {1.0, 2.0, 3.0};
    double[] weights = new double[] {0.5, 1.0, 1.5};
    AbstractLeastSquares als = new AbstractLeastSquares(residuals, weights);

    // Calculate RMS
    double rms = als.getRMS();

    // Calculate expected RMS
    double expectedRMS = Math.sqrt(als.getChiSquare() / als.getRows());

    // Check if the result is correct
    assertEquals(expectedRMS, rms, 0.01);
}