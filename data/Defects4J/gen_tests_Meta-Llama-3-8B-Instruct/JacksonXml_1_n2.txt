public void testNestedNonWrappedLists() {
    List<Record> records = new ArrayList<>();
    records.add(new Record(Arrays.asList(new Field("field1"), new Field("field2"))));
    records.add(new Record(Arrays.asList()));
    records.add(new Record(Arrays.asList(new Field("field3"), new Field("field4"))));

    String json = mapper.writeValueAsString(records);
    List<Record> deserializedRecords = mapper.readValue(json, typeFactory.constructCollectionType(List.class, Record.class));

    assertEquals(3, deserializedRecords.size());
    assertEquals(2, deserializedRecords.get(0).getFields().size());
    assertEquals(0, deserializedRecords.get(1).getFields().size());
    assertEquals(2, deserializedRecords.get(2).getFields().size());
}