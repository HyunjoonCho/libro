public void testMapWithClassAsKey() throws Exception {
    Map<Class<? extends Object>, String> map = new HashMap<>();
    map.put(ArrayList.class, "ArrayList");
    map.put(HashMap.class, "HashMap");

    ObjectMapper mapper = new ObjectMapper();
    String json = mapper.writerWithDefaultPrettyPrinter().writeValueAsString(map);
    System.out.println(json);

    Map<String, String> stringMap = mapper.readValue(json, new TypeReference<Map<String, String>>(){});
    Map<Class<? extends Object>, String> classMap = new HashMap<>();
    for (Map.Entry<String, String> entry : stringMap.entrySet()) {
        try {
            Class<?> clazz = Class.forName(entry.getKey().replace("class ", ""));
            classMap.put((Class<? extends Object>) clazz, entry.getValue());
        } catch (ClassNotFoundException e) {
            fail("Failed to find class: " + entry.getKey());
        }
    }

    assertEquals(map, classMap);
}