
import java.io.*;
import org.apache.commons.compress.compressors.bzip2.BZip2CompressorInputStream;
import org.junit.Test;

import static org.junit.Assert.assertEquals;

public class BZip2CompressorInputStreamTest {
    @Test
    public void testReadTruncated() throws IOException {
        BZip2CompressorInputStream in = new BZip2CompressorInputStream(new ByteArrayInputStream(getTestBytes()));
        int bytesRead = 0;
        while (in.available() > 0) {
            bytesRead += in.read(new byte[1024]);
        }
        assertEquals(769, bytesRead);
    }

    private byte[] getTestBytes() {
        // Create a byte array with 770 bytes
        byte[] bytes = new byte[770];
        // Fill the array with some data
        //...
        return bytes;
    }
}
