
import org.apache.commons.compress.archivers.tar.TarArchiveInputStream;
import org.apache.commons.compress.archivers.tar.TarArchiveEntry;
import org.junit.Test;

import java.io.ByteArrayInputStream;
import java.io.IOException;

public class TarArchiveInputStreamTest {

    @Test(expected = NumberFormatException.class)
    public void testUidGidOverflow() throws IOException {
        TarArchiveInputStream tarArchiveInputStream = new TarArchiveInputStream(new ByteArrayInputStream("uid=4294967294".getBytes()));
        TarArchiveEntry entry = tarArchiveInputStream.getNextTarEntry();
        tarArchiveInputStream.applyPaxHeadersToCurrentEntry(entry);
    }
}
