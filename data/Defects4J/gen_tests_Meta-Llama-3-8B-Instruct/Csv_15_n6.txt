
import org.junit.Test;
import org.apache.commons.csv.CSVFormat;
import org.apache.commons.csv.CSVPrinter;

import java.io.ByteArrayOutputStream;
import java.io.IOException;
import java.io.PrintStream;
import java.util.Arrays;

import static org.junit.Assert.assertEquals;

public class TestCSVFormatExcel {

    @Test
    public void testQuoteCharUsingWithCJKChars() throws IOException {
        ByteArrayOutputStream bos = new ByteArrayOutputStream();
        CSVPrinter printer = new CSVPrinter(new PrintStream(bos), CSVFormat.EXCEL);
        printer.printRecord("あ", "い", "う");
        printer.flush();
        String result = bos.toString();
        assertEquals("\"あ\",\"い\",\"う\"\n", result);
    }
}
