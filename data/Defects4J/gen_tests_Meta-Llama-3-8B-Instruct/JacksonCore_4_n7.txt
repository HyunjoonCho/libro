
import com.fasterxml.jackson.databind.ObjectMapper;
import org.junit.Test;

import static org.junit.Assert.assertThrows;

public class JacksonMaxKeyLengthTest {

    @Test
    public void testMaxKeyLength() {
        ObjectMapper mapper = new ObjectMapper();
        String longKey = new String(new char[262145]).replace("\0", "a"); // create a string with length 262145
        String json = "{\"" + longKey + "\": \"value\"}";
        assertThrows(ArrayIndexOutOfBoundsException.class, () -> mapper.readTree(json));
    }
}
