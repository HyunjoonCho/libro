public void testPreconditionCrash() {
    final ClassLoader classLoader = new ClassLoader() {
        @Override
        protected Class<?> findClass(String name) throws ClassNotFoundException {
            return null;
        }
    };
    final Compiler compiler = new Compiler(classLoader);
    final CompilationLevel compilationLevel = CompilationLevel.SIMPLE_OPTIMIZATIONS;
    final Scope scope = compiler.compile(compilationLevel, "goog = {};goog.scope;\n" +
            "var ns = {};ns.sub = {};/** @constructor */\n" +
            "ns.sub.C = function() {};\n" +
            "goog.scope(function() {\n" +
            " var sub = ns.sub;\n" +
            " /** @type {sub.C} */\n" +
            " var x = null;\n" +
            "});", new SourceMap(), new SourceMap());
    scope.execute();
}