java
import org.junit.Test;
import org.junit.runner.RunWith;
import org.junit.runners.JUnit4;

@RunWith(JUnit4.class)
public class TestAnonymousObjectTypeInference {
    @Test
    public void testAnonymousObjectTypeInference() {
        Object record1 = new Object() {
            String prop = "a";
        };
        Object record2 = "a";

        // Error: actual parameter 1 of func2 does not match formal parameter
        // found : {prop: string}
        // required: (string|{prop: string, prop2: (string|undefined)})
        func2(record1);

        // Expected: "a" to be printed
        func(record2);
    }

    public void func(Object record) {
        System.out.println(record);
    }

    public void func2(Object record) {
        if (record instanceof String) {
            System.out.println(record);
        } else {
            System.out.println(((ObjectWithProp) record).prop);
        }
    }
}

class ObjectWithProp {
    String prop;
}
