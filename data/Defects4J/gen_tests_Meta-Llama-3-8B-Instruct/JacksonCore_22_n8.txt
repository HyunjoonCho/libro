
import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.databind.SerializationFeature;
import com.fasterxml.jackson.databind.SerializationConfig;
import com.fasterxml.jackson.databind.SerializationFeature;
import com.fasterxml.jackson.databind.ser.FilterProvider;
import com.fasterxml.jackson.databind.ser.impl.FilteringSerializerProvider;
import com.fasterxml.jackson.databind.ser.impl.SimpleBeanPropertyFilter;
import org.junit.Test;

import static org.junit.Assert.assertEquals;

public class FilteringParserDelegateTest {

    @Test
    public void testMatchCount() throws Exception {
        ObjectMapper mapper = new ObjectMapper();
        SerializationConfig config = mapper.getSerializationConfig();
        FilterProvider filterProvider = new FilteringSerializerProvider();
        config.setFilterProvider(filterProvider);
        config.enable(SerializationFeature.WRITE_DATES_AS_TIMESTAMPS);

        String json = mapper.writeValueAsString(new TestBean());
        assertEquals("Expected _matchCount to be 1", 1, filterProvider.getMatchCount());
    }
}

class TestBean {
    private String field1;
    private String field2;

    public String getField1() {
        return field1;
    }

    public String getField2() {
        return field2;
    }
}
