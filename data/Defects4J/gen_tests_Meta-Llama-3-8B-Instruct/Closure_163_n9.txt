public void testVarCheckCrashWhenUsingModules() {
    String code = "var jQuery = function() { }; var jQuery$$2 = 1;";
    try {
        Compiler compiler = new Compiler();
        compiler.compile(code);
        fail("Expected VarCheck to crash");
    } catch (RuntimeException e) {
        assertEquals("Unexpected variable jQuery$$2", e.getMessage());
    }
}