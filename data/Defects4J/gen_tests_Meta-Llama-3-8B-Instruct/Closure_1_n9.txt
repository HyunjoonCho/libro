
public void testFunctionArgumentsNotOptimizedAway() {
    // Test setup
    String code = "function foo(bar, baz) { return bar; }";
    Compiler compiler = new Compiler();
    CompilerOptions options = new CompilerOptions();
    options.setCompilationLevel(CompilationLevel.SIMPLE_OPTIMIZATIONS);
    CompilerResult result = compiler.compile(code, options);

    // Test 1
    Function foo = result.getFunctions().get("foo");
    assertEquals(2, foo.getParameterCount());

    // Test 2
    // The function should be recompiled and foo's length should be 1
    result = compiler.compile(code, options);
    foo = result.getFunctions().get("foo");
    assertEquals(1, foo.getParameterCount());
}
