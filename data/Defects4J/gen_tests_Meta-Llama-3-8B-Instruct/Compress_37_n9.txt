java
import org.junit.Test;
import java.io.ByteArrayInputStream;
import java.io.IOException;
import java.util.zip.TarArchiveInputStream;

import static org.junit.Assert.assertThrows;
import static org.junit.Assert.fail;

public class TarArchiveInputStreamTest {

    @Test
    public void testParsingPaxHeadersWithEmptyLineAtTheEnd() throws IOException {
        String paxHeaders = "foo:bar\n" +
                "length:10\n" +
                "content\n" +
                "\n"; // empty line at the end
        ByteArrayInputStream bis = new ByteArrayInputStream(paxHeaders.getBytes());
        TarArchiveInputStream tarIn = new TarArchiveInputStream(bis);

        assertThrows(NegativeArraySizeException.class, () -> tarIn.parsePaxHeaders());
    }
}
