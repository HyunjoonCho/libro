java
import org.junit.Test;
import org.junit.runner.RunWith;
import org.junit.runners.JUnit4;

import java.io.ByteArrayInputStream;
import java.io.IOException;
import java.io.InputStream;

import static org.junit.Assert.assertEquals;

@RunWith(JUnit4.class)
public class BZip2CompressorInputStreamTest {

    @Test
    public void testReadTruncatedFile() throws IOException {
        byte[] data = new byte[771];
        data[0] = 0x42; // BZ file header
        data[1] = 0x5A; // BZ file header
        data[2] = 0x68; // BZ file header
        data[3] = 0x01; // BZ file header
        data[4] = 0x01; // BZ file header
        data[5] = 0x01; // BZ file header
        data[6] = 0x00; // BZ file header
        data[7] = 0x00; // BZ file header
        data[8] = 0x00; // BZ file header
        data[9] = 0x00; // BZ file header
        data[10] = 0x00; // BZ file header
        data[11] = 0x00; // BZ file header
        data[12] = 0x00; // BZ file header
        data[13] = 0x00; // BZ file header
        data[14] = 0x00; // BZ file header
        data[15] = 0x00; // BZ file header
        data[16] = 0x00; // BZ file header
        data[17] = 0x00; // BZ file header
        data[18] = 0x00; // BZ file header
        data[19] = 0x00; // BZ file header
        data[20] = 0x00; // BZ file header
        data[21] = 0x00; // BZ file header
        data[22] = 0x00; // BZ file header
        data[23] = 0x00; // BZ file header
        data[24] = 0x00; // BZ file header
        data[25] = 0x00; // BZ file header
        data[26] = 0x00; // BZ file header
        data[27] = 0x00; // BZ file header
        data[28] = 0x00; // BZ file header
        data[29] = 0x00; // BZ file header
        data[30] = 0x00; // BZ file header
        data[31] = 0x00; // BZ file header
        data[32] = 0x00; // BZ file header
        data[33] = 0x00; // BZ file header
        data[34] = 0x00; // BZ file header
        data[35] = 0x00; // BZ file header
        data[36] = 0x00; // BZ file header
        data[37] = 0x00; // BZ file header
        data[38] = 0x00; // BZ file header
        data[39] = 0x00; // BZ file header
        data[40] = 0x00; // BZ file header
        data[41] = 0x00; // BZ file header
        data[42] = 0x00; // BZ file header
        data[43] = 0x00; // BZ file header
        data[44] = 0x00; // BZ file header
        data[45] = 0x00; // BZ file header
        data[46] = 0x00; // BZ file header
        data[47] = 0x00; // BZ file header
        data[48] = 0x00; // BZ file header
        data[49] = 0x00; // BZ file header
        data[50] = 0x00; // BZ file header
        data[51] = 0x00; // BZ file header
        data[52] = 0x00; // BZ file header
        data[53] = 0x00; // BZ file header
        data[54] = 0x00; // BZ file header
        data[55] = 0x00; // BZ file header
        data[56] = 0x00; // BZ file header
        data[57] = 0x00; // BZ file header
        data[58] = 0x00; // BZ file header
        data[59] = 0x00; // BZ file header
        data[60] = 0x00; // BZ file header
        data[61] = 0x00; // BZ file header
        data[62] = 0x00; // BZ file header
        data[63] = 0x00; // BZ file header
        data[64] = 0x00; // BZ file header
        data[65] = 0x00; // BZ file header
        data[66] = 0x00; // BZ file header
        data[67] = 0x00; // BZ file header
        data[68] = 0x00; // BZ file header
        data[69] = 0x00; // BZ file header
        data[70] = 0x00; // BZ file header
        data[71] = 0x00; // BZ file header
        data[72] = 0x00; // BZ file header
        data[73] = 0x00; // BZ file header
        data[74] = 0x00; // BZ file header
        data[75] = 0x00; // BZ file header
        data[76] = 0x00; // BZ file header
        data[77] = 0x00; // BZ file header
        data[78] = 0x00; // BZ file header
        data[79] = 0x00; // BZ file header
        data[80] = 0x00; // BZ file header
        data[81] = 0x00; // BZ file header
        data[82] = 0x00; // BZ file header
        data[83] = 0x00; // BZ file header
        data[84] = 0x00; // BZ file header
        data[85] = 0x00; // BZ file header
        data[86] = 0x00; // BZ file header
        data[87] = 0x00; // BZ file header
        data[88] = 0x00; // BZ file header
        data[89] = 0x00; // BZ file header
        data[90] = 0x00; // BZ file header
        data[91] = 0x00; // BZ file header
        data[92] = 0x00; // BZ file header
        data[93] = 0x00; // BZ file header
        data[94] = 0x00; // BZ file header
        data[95] = 0x00; // BZ file header
        data[96] = 0x00; // BZ file header
        data[97] = 0x00; // BZ file header
        data[98] = 0x00; // BZ file header
        data[99] = 0x00; // BZ file header
        data[100] = 0x00; // BZ file header
        data[101] = 0x00; // BZ file header
        data[102] = 0x00; // BZ file header
        data[103] = 0x00; // BZ file header
        data[104] = 0x00; // BZ file header
        data[105] = 0x00; // BZ file header
        data[106] = 0x00; // BZ file header
        data[107] = 0x00; // BZ file header
        data[108] = 0x00; // BZ file header
        data[109] = 0x00; // BZ file header
        data[110] = 0x00; // BZ file header
        data[111] = 0x00; // BZ file header
        data[112] = 0x00; // BZ file header
        data[113] = 0x00; // BZ file header
        data[114] = 0x00; // BZ file header
        data[115] = 0x00; // BZ file header
        data[116] = 0x00; // BZ file header
        data[117] = 0x00; // BZ file header
        data[118] = 0x00; // BZ file header
        data[119] = 0x00; // BZ file header
        data[120] = 0x00; // BZ file header
        data[121] = 0x00; // BZ file header
        data[122] = 0x00; // BZ file header
        data[123] = 0x00; // BZ file header
        data[124] = 0x00; // BZ file header
        data[125] = 0x00; // BZ file header
        data[126] = 0x00; // BZ file header
        data[127] = 0x00; // BZ file header
        data[128] = 0x00; // BZ file header
        data[129] = 0x00; // BZ file header
        data[130] = 0x00; // BZ file header
        data[131] = 0x00; // BZ file header
        data[132] = 0x00; // BZ file header
        data[133] = 0x00; // BZ file header
        data[134] = 0x00; // BZ file header
        data[135] = 0x00; // BZ file header
        data[136] = 0x00; // BZ file header
        data[137] = 0x00; // BZ file header
        data[138] = 0x00; // BZ file header
        data[139] = 0x00; // BZ file header
        data[140] = 0x00; // BZ file header
        data[141] = 0x00; // BZ file header
        data[142] = 0x00; // BZ file header
        data[143] = 0x00; // BZ file header
        data[144] = 0x00; // BZ file header
        data[145] = 0x00; // BZ file header
        data[146] = 0x00; // BZ file header
        data[147] = 0x00; // BZ file header
        data[148] = 0x00; // BZ file header
        data[149] = 0x00; // BZ file header
        data[150] = 0x00; // BZ file header
        data[151] = 0x00; // BZ file header
        data[152] = 0x00; // BZ file header
        data[153] = 0x00; // BZ file header
        data[154] = 0x00; // BZ file header
        data[155] = 0x00; // BZ file header
        data[156] = 0x00; // BZ file header
        data[157] = 0x00; // BZ file header
        data[158] = 0x00; // BZ file header
        data[159] = 0x00; // BZ file header
        data[160] = 0x00; // BZ file header
        data[161] = 0x00; // BZ file header
        data[162] = 0x00; // BZ file header
        data[163] = 0x00; // BZ file header
        data[164] = 0x00; // BZ file header
        data[165] = 0x00; // BZ file header
        data[166] = 0x00; // BZ file header
        data[167] = 0x00; // BZ file header
        data[168] = 0x00; // BZ file header
        data[169] = 0x00; // BZ file header
        data[170] = 0x00; // BZ file header
        data[171] = 0x00; // BZ file header
        data[172] = 0x00; // BZ file header
        data[173] = 0x00; // BZ file header
        data[174] = 0x00; // BZ file header
        data[175] = 0x00; // BZ file header
        data[176] = 0x00; // BZ file header
        data[177] = 0x00; // BZ file header
        data[178] = 0x00; // BZ file header
        data[179] = 0x00; // BZ file header
        data[180] = 0x00; // BZ file header
        data[181] = 0x00; // BZ file header
        data[182] = 0x00; // BZ file header
        data[183] = 0x00; // BZ file header
        data[184] = 0x00; // BZ file header
        data[185] = 0x00; // BZ file header
        data[186] = 0x00; // BZ file header
        data[187] = 0x00; // BZ file header
        data[188] = 0x00; // BZ file header
        data[189] = 0x00; // BZ file header
        data[190] = 0x00; // BZ file header
        data[191] = 0x00; // BZ file header
        data[192] = 0x00; // BZ file header
        data[193] = 0x00; // BZ file header
        data[194] = 0x00; // BZ file header
        data[195] = 0x00; // BZ file header
        data[196] = 0x00; // BZ file header
        data[197] = 0x00; // BZ file header
        data