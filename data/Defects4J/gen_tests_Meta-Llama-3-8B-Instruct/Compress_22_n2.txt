
public void testBZip2CompressorInputStreamReadsFewerBytesFromTruncatedFile() throws IOException {
    byte[] data = new byte[770];
    Arrays.fill(data, (byte) 0x01);
    try (BZip2CompressorOutputStream bos = new BZip2CompressorOutputStream(new ByteArrayOutputStream())) {
        bos.write(data);
    }
    try (BZip2CompressorInputStream bis = new BZip2CompressorInputStream(new ByteArrayInputStream(new ByteArrayOutputStream().write(data).toByteArray()))) {
        byte[] readData = new byte[1024];
        int bytesRead = bis.read(readData);
        assertEquals(769, bytesRead);
        // Check if the read data is correct
        //...
    }
}
