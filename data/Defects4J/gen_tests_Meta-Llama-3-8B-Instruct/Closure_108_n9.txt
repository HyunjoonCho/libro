java
import org.junit.Test;
import com.google.javascript.jscomp.CompilationUnit;
import com.google.javascript.jscomp.CompilerOptions;
import com.google.javascript.jscomp.JsException;

public class TestScopedAliases {
    @Test
    public void testPreconditionCrash() throws JsException {
        CompilerOptions options = new CompilerOptions();
        CompilationUnit compilationUnit = new CompilationUnit();
        compilationUnit.addSource("goog = {};");
        compilationUnit.addSource("goog.scope;");
        compilationUnit.addSource("var ns = {};");
        compilationUnit.addSource("ns.sub = {};");
        compilationUnit.addSource("/** @constructor */");
        compilationUnit.addSource("ns.sub.C = function() {};");
        compilationUnit.addSource("goog.scope(function() {");
        compilationUnit.addSource(" var sub = ns.sub;");
        compilationUnit.addSource("/** @type {sub.C} */");
        compilationUnit.addSource(" var x = null;");
        compilationUnit.addSource("});");

        compilationUnit.compile(options);
    }
}
