
import org.junit.Test;
import org.junit.runner.RunWith;
import org.junit.runners.JUnit4;
import org.apache.avro.Schema;
import org.apache.avro.SchemaNormalization;
import org.apache.avro.generic.GenericData;
import org.apache.avro.generic.GenericRecord;

import java.math.BigDecimal;
import java.math.BigInteger;

@RunWith(JUnit4.class)
public class BigDecimalSchemaTest {

    @Test
    public void testBigDecimalSchema() {
        Schema schema = Schema.createRecord("myrecord", "myrecord", "mynamespace", "1.0", false);
        schema.setFields(new Schema.FieldSchema("value", Schema.create("type", "decimal")));

        GenericRecord record = new GenericData.Record(schema);
        record.put("value", new BigDecimal("123.456"));

        byte[] bytes = SchemaNormalization.toString(schema, record).getBytes();
        // Assert the schema type is correctly produced as "decimal" instead of "long"
    }
}
