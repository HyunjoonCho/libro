java
public class ProcessCommonJSModulesTest {
    @Test
    public void testModuleExportsFailureWhenCheckTypesEnabled() throws Exception {
        String[] args = new String[] {
                "--formatting=PRETTY_PRINT",
                "--jscomp_error=checkTypes",
                "--compilation_level=SIMPLE_OPTIMIZATIONS",
                "--transform_amd_modules",
                "--process_common_js_modules",
                "--js=echo.js",
                "--js=echo-main.js",
                "--common_js_entry_module=echo-main.js"
        };
        ProcessBuilder processBuilder = new ProcessBuilder("java", "-jar", "compiler.jar", args);
        Process process = processBuilder.start();
        BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream()));
        String line;
        while ((line = reader.readLine())!= null) {
            System.out.println(line);
        }
        Assert.assertTrue(process.waitFor() == 1, "Expected compilation to fail with error message");
    }
}
