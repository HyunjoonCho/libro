public void testBZip2CompressorInputStreamReadsFewerBytesFromTruncatedFile() throws Exception {
    BZip2CompressorInputStream bis = new BZip2CompressorInputStream(new ByteArrayInputStream(new byte[770]));
    int bytesRead = 0;
    byte[] buffer = new byte[1];
    while ((bytesRead = bis.read(buffer)) > 0) {
        bytesRead += bytesRead;
    }
    assertEquals(769, bytesRead);
}