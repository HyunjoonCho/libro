
import org.junit.Test;
import org.mockito.exceptions.verification.WildcardTypeMismatchException;

import static org.junit.Assert.fail;
import static org.mockito.Mockito.inferFrom;
import static org.mockito.Mockito.resolveGenericReturnType;

public class GenericMetadataSupportTest {

    @Test
    public void typeVariable_of_self_type() {
        try {
            GenericMetadataSupport genericMetadata = inferFrom(GenericsSelfReference.class).resolveGenericReturnType(firstNamedMethod("self", GenericsSelfReference.class));
            fail("Expected StackOverflowError");
        } catch (StackOverflowError e) {
            // expected
        }
    }
}
