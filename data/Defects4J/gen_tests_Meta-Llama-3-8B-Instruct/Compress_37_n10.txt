java
import org.junit.Test;
import java.io.ByteArrayInputStream;
import java.io.IOException;
import java.util.zip.TarArchiveInputStream;

import static org.junit.Assert.assertThrows;
import static org.junit.Assert.fail;

public class TarArchiveInputStreamTest {

    @Test
    public void testParsingPaxHeadersFailsWithNegativeArraySizeException() throws IOException {
        byte[] input = ("pax-header-length-123\n"
                + "content-1\n"
                + "content-2\n"
                + "\n").getBytes();

        ByteArrayInputStream bis = new ByteArrayInputStream(input);
        TarArchiveInputStream tais = new TarArchiveInputStream(bis);

        assertThrows(NegativeArraySizeException.class, () -> {
            tais.parsePaxHeaders();
        });
    }
}
