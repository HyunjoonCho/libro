public void testJsonIdentityInfo() {
    ObjectMapper mapper = new ObjectMapper();
    Foo mo = new Foo();
    mo.bar1 = new Bar();
    mo.bar2 = mo.bar1;

    String result = mapper.writeValueAsString(mo);
    assertEquals("{\"bar1\":{\"@id\":0,\"@class\":\"com.example.ObjectIdTest$Bar\"},\"bar2\":{\"@id\":1,\"@class\":\"com.example.ObjectIdTest$Bar\"}}", result);
}