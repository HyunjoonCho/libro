public void testIssue() {
    Map<String, String> customData = new HashMap<>();
    customData.put("key", "value");

    String result = testRemoveKey("key", customData);

    assertFalse("key".equals(result));
    assertFalse(customData.containsKey("key"));
}

private String testRemoveKey(String key, Map<String, String> data) {
    String retval = data.get(key);
    boolean hadKey = key.equals(data.get(key));
    if (data!= null) {
        data.remove(key);
    }
    return hadKey? retval : null;
}