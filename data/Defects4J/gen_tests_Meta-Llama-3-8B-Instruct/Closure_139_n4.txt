public void testRedefinitionOfFunction() {
    final Object[] obj = new Object[1];
    obj[0] = new Object() {
        public Integer f() {
            return 2;
        }
    };
    assert(obj[0].getClass().getDeclaredMethod("f").getReturnType() == Integer.class);

    obj[0] = new Object() {
        public Integer f() {
            return 1;
        }
    };
    assert(obj[0].getClass().getDeclaredMethod("f").getReturnType() == Integer.class);

    assert(((Object) new Object() {
        public Integer f() {
            return 1;
        }
    }).getClass().getDeclaredMethod("f").getReturnType() == Integer.class);
}