java
public void testIssue() {
    boolean anyExpression = true;
    Object externalRef = new Object();

    Function fn1;
    Function fn2;

    if (anyExpression) {
        fn2 = externalRef;
        fn1 = new Function() {
            public Object invoke(Object[] args) {
                return fn2.invoke();
            }
        };
    }

    Object result = new Object() {
        public boolean method1() {
            if (fn1!= null) {
                fn1.invoke(new Object[0]);
            }
            return true;
        }

        public boolean method2() {
            return false;
        }
    };

    assertEquals(true, result.method1());
    assertEquals(false, result.method2());
}
