public void testReplaceTrueFalse() {
    Function someFunction = new Function() {
        private boolean fn1;
        private boolean fn2;

        if (true) {
            fn2 = true;
            fn1 = new Function() {
                public boolean invoke() {
                    return fn2;
                }
            };
        }

        public Map<String, Function> getMethods() {
            return new HashMap<String, Function>() {
                public boolean method1() {
                    if (fn1) {
                        fn1.invoke();
                    }
                    return true;
                }

                public boolean method2() {
                    return false;
                }
            };
        }
    };

    Map<String, Function> methods = someFunction.getMethods();
    boolean result = methods.get("method1").invoke();
    assertFalse(result);
}