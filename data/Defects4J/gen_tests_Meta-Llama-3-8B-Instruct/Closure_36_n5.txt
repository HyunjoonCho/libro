public void testSingletonGetter() {
    // Create a class that uses goog.addSingletonGetter
    Class<?> fooClass = new SimpleJavaPojo("foo", "function() { this.values = []; }");
    fooClass.getField("prototype").set(null, new Object() {
        public void add(Object value) {
            ((List) get("values")).add(value);
        }
    });
    goog.addSingletonGetter(fooClass);
    
    // Compile the class using Closure Compiler
    byte[] bytecode = compileClass(fooClass);
    
    // Check if the compiled bytecode is correct
    assertEquals("com.google.javascript.jscomp.CompilationError: Unexpectedly removed class 'foo'", new String(bytecode));
}