
import org.junit.Test;
import org.junit.runner.RunWith;
import org.junit.runners.JUnit4;

@RunWith(JUnit4.class)
public class TestClosureCompiler {
    @Test
    public void testCompilerRemovesFunctionProperties() {
        // Arrange
        var map = {};
        var f1 = function() { alert('f1'); };
        f1['alwaysCall'] = true;
        var f2 = function() { alert('f2'); };

        map['f1'] = f1;
        map['f2'] = f2;

        // Act
        var callFunctionByKey = function(key) {
            var f = map[key];
            if (f['alwaysCall']) f();
        };

        // Assert
        callFunctionByKey(Math.random() > 0.5? 'f1' : 'f2');
    }
}
