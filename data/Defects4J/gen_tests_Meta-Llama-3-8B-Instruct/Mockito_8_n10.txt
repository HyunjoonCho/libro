public void testStackOverflowError() {
    GenericsSelfReference selfReference = new GenericsSelfReference() {
        @Override
        public GenericsSelfReference<T> self() {
            return this;
        }
    };

    GenericMetadataSupport genericMetadata = inferFrom(GenericsSelfReference.class).resolveGenericReturnType(selfReference.getClass().getMethod("self").getGenericReturnType());

    assertEquals(GenericsSelfReference.class, genericMetadata.rawType());
}