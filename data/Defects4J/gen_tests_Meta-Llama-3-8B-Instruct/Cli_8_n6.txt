public void testHelpFormatterWrap() {
    HelpFormatter formatter = new HelpFormatter();
    String text = "This is a test option with a very long description that will wrap incorrectly.\n"
            + "This is the second line which should also wrap correctly, but doesn't.\n"
            + "And this is the third line which will also be incorrectly wrapped.\n";
    try {
        formatter.printHelp("test", 80, "This is a test", text);
        fail("Expected HelpFormatter to throw an exception");
    } catch (MessageTooLongException e) {
        // expected
    }
}