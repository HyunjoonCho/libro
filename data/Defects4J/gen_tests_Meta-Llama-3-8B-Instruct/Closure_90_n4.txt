public void testThisTypedefWarning() {
    String code = "goog.provide('bug');\n" +
            "bug.sharedMethod = function() {};\n" +
            "/**\n" +
            " * @this {bug.Thing}\n" +
            " */\n" +
            "bug.Thing = goog.typedef;\n";
    ClosureCompiler compiler = new ClosureCompiler();
    compiler.compile(code);
    String output = compiler.getErrorOutput();
    assertTrue(output.contains("WARNING - @this type of a function must be an object"));
}