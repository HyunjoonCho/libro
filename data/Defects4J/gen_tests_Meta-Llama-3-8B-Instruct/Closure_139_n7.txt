java
import org.junit.Test;
import static org.junit.Assert.*;

public class RedefineFunctionTest {

    @Test
    public void testRedefineFunction() {
        // Step 1: Run the code without compilation
        assertFunction(1, "assert(f() === 1)");
        var f = function() { return 2; };
        assertFunction(2, "assert(f() === 2)");
        function f() { return 1; };

        // Step 3: Compile the code as third-party
        // The following line should raise an error
        assertThrows("error", function() { f(); });
    }

    private void assertFunction(int expected, String assertion) {
        try {
            eval(assertion);
            fail("Expected an error");
        } catch (Error e) {
            assertEquals(expected, 1);
        }
    }
}
