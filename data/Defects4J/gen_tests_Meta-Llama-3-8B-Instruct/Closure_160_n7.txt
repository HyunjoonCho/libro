public void testCheckVarsUndefinedVarsDiagnostics() {
    ProcessBuilder builder = new ProcessBuilder("java", "-jar", "compiler.jar", "--js", "test.js");
    builder.redirectErrorStream(true);
    Process process = builder.start();
    String output = new BufferedReader(new InputStreamReader(process.getInputStream())).lines().collect(Collectors.join());
    assertTrue(output.contains("WARNING - dangerous use of the global this object"));
    assertFalse(output.contains("variable foo is undefined"));
}