
public void testAbstractLeastSquares() {
    AbstractLeastSquares als = new AbstractLeastSquares();
    als.setResidualsWeights(new double[]{1.0, 2.0, 3.0});
    als.setRows(3);
    double rms = als.getRMS();
    // calculate the expected result
    double chiSquare = 0;
    for (double weight : als.getResidualsWeights()) {
        chiSquare += Math.pow(weight, 2);
    }
    double expectedRms = Math.sqrt(chiSquare / als.getRows());
    assertEquals(expectedRms, rms, 0.0001);
}
