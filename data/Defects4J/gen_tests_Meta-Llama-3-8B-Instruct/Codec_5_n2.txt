java
import org.junit.Test;

import java.io.ByteArrayInputStream;
import java.io.IOException;
import java.io.InputStream;

import static org.junit.Assert.assertThrows;
import static org.junit.Assert.assertTrue;

public class Base64InputStreamTest {

    @Test
    public void testBase64InputStreamNullPointerException() throws IOException {
        String base64Data = "..."; // paste the base64 data from the bug report
        byte[] bytes = base64Data.getBytes();
        ByteArrayInputStream inputStream = new ByteArrayInputStream(bytes);
        Base64InputStream base64InputStream = new Base64InputStream(inputStream);

        // Simulate reading 1190 bytes
        byte[] buffer = new byte[1024];
        int bytesRead = base64InputStream.read(buffer);
        assertTrue(bytesRead > 0);

        // Simulate setting buffer to null and modulus to 3
        base64InputStream.setBuffer(null);
        base64InputStream.setModulus(3);

        // Expect a NullPointerException when reading again
        assertThrows(NullPointerException.class, () -> base64InputStream.read(buffer));
    }
}
