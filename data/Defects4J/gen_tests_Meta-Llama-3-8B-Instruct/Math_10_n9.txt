public void testDerivativeStructureAtan2() {
    DerivativeStructure ds1 = new DerivativeStructure(1.0, 1, 1);
    DerivativeStructure ds0 = new DerivativeStructure(0.0, 1, 1);
    assertEquals(Double.NaN, ds1.atan2(ds1).number());
    assertEquals(Double.NaN, ds0.atan2(ds0).number());
    assertEquals(Double.NaN, ds1.atan2(ds0).number());
    assertEquals(Double.NaN, ds0.atan2(ds1).number());
    assertEquals(0.0, ds1.atan2(1.0).number());
    assertEquals(Math.PI, ds1.atan2(-1.0).number());
    assertEquals(Math.PI, ds0.atan2(-1.0).number());
}