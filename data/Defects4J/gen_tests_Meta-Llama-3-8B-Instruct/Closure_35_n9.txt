
public class TestAssignmentToRecord {
    @org.junit.Test
    public void testAssignmentToRecord() {
        class Result {
            Object prop1;
            String prop2;
            String prop3;
        }

        Result func(boolean a, boolean b) {
            Result results;
            if (a) {
                results = new Result();
                results.prop1 = new Result() { {a = 3; } };
            }
            if (b) {
                results = results == null? new Result() : results;
                results.prop2 = "prop2";
            } else {
                results = results == null? new Result() : results;
                results.prop3 = "prop3";
            }
            return results;
        }

        Result result = func(true, false);
        assertNotNull(result);
        assertEquals(3, ((Result) result).prop1.a);
        assertNull(((Result) result).prop2);
        assertNull(((Result) result).prop3);
    }
}
