java
import org.junit.Test;
import org.apache.commons.cli.CommandLine;
import org.apache.commons.cli.GnuParser;
import org.apache.commons.cli.Option;
import org.apache.commons.cli.Options;

import static org.junit.Assert.assertThrows;
import static org.junit.Assert.assertTrue;

public class Bug107Test {

    @Test
    public void testMissingRequiredOption() {
        Options opts = new Options();
        opts.addOption(new Option("v", "required", true, "required option"));

        GnuParser parser = new GnuParser();
        String[] args = {};

        assertThrows(ParseException.class, () -> parser.parse(opts, args));
    }

    @Test
    public void testMissingRequiredOptionAfterParsing() throws ParseException {
        Options opts = new Options();
        opts.addOption(new Option("v", "required", true, "required option"));

        GnuParser parser = new GnuParser();
        String[] firstArgs = { "-v" };
        CommandLine firstCL = parser.parse(opts, firstArgs);

        assertThrows(ParseException.class, () -> parser.parse(opts, new String[0]));
    }
}
