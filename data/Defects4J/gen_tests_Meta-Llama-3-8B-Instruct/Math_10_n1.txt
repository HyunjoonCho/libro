
public void testAtan2SpecialCases() {
    // Test case: atan2(0, 0)
    DerivativeStructure ds = new DerivativeStructure(1, 1, 1);
    assertEquals(Math.PI / 2, ds.atan2(0, 0).doubleValue(), 1e-15);

    // Test case: atan2(0, +inf)
    ds = new DerivativeStructure(1, 1, 1);
    assertEquals(0, ds.atan2(0, 1e10).doubleValue(), 1e-15);

    // Test case: atan2(0, -inf)
    ds = new DerivativeStructure(1, 1, 1);
    assertEquals(Math.PI, ds.atan2(0, -1e10).doubleValue(), 1e-15);

    // Test case: atan2(+inf, 0)
    ds = new DerivativeStructure(1, 1, 1);
    assertEquals(Math.PI / 2, ds.atan2(1e10, 0).doubleValue(), 1e-15);

    // Test case: atan2(-inf, 0)
    ds = new DerivativeStructure(1, 1, 1);
    assertEquals(-Math.PI / 2, ds.atan2(-1e10, 0).doubleValue(), 1e-15);
}
