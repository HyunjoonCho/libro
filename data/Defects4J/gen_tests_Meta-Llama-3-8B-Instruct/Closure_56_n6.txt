public void testLastWarningOrErrorTruncated() {
    String output = new ProcessBuilder("java", "-jar", "compiler.jar", "--warning_level", "VERBOSE", "--js", "test.js").redirectErrorStream(true).start().inputStream().toString();
    assertTrue(output.contains("variable foo is undefined"));
    assertTrue(output.contains("variable bar is undefined"));
    assertFalse(output.endsWith("test.js:2: ERROR - variable bar is undefined"));
}