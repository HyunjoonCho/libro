
import org.jsoup.Jsoup;
import org.jsoup.nodes.Document;
import org.jsoup.nodes.Element;
import org.junit.Test;

import java.util.concurrent.TimeUnit;

public class JsoupPerformanceTest {

    @Test
    public void testQuadraticBehaviour() throws InterruptedException {
        String html = createDeeplyNestedHtml();
        Document doc = Jsoup.parse(html);
        long startTime = System.currentTimeMillis();
        doc.select("body").first().text();
        long endTime = System.currentTimeMillis();
        long duration = endTime - startTime;
        System.out.println("Parsing time: " + duration + " ms");
        // Check if the parsing time exceeds a certain threshold
        if (duration > 1000) { // 1 second
            fail("Parsing time exceeded 1 second");
        }
    }

    private String createDeeplyNestedHtml() {
        StringBuilder html = new StringBuilder();
        for (int i = 0; i < 10000; i++) {
            html.append("<div>");
            for (int j = 0; j < 100; j++) {
                html.append("<div>");
                for (int k = 0; k < 10; k++) {
                    html.append("<div>");
                }
                html.append("</div>");
            }
            html.append("</div>");
        }
        return html.toString();
    }
}
