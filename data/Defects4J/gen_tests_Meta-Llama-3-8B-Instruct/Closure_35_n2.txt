java
public class BugReportTest {
    public static class MyRecord {
        public Object prop1;
        public String prop2;
        public String prop3;
    }

    public void testBugReport() {
        MyRecord result = func(true, true);
        assertEquals(MyRecord.class, result.getClass());
        assertEquals(3, ((MyRecord) result).prop1.a);

        result = func(true, false);
        assertEquals(MyRecord.class, result.getClass());
        assertEquals(3, ((MyRecord) result).prop1.a);
        assertNull(((MyRecord) result).prop2);

        result = func(false, true);
        assertEquals(MyRecord.class, result.getClass());
        assertNull(((MyRecord) result).prop1);
        assertEquals("prop2", ((MyRecord) result).prop2);

        result = func(false, false);
        assertEquals(MyRecord.class, result.getClass());
        assertNull(((MyRecord) result).prop1);
        assertEquals("prop3", ((MyRecord) result).prop3);
    }

    private MyRecord func(boolean a, boolean b) {
        MyRecord results;
        if (a) {
            results = new MyRecord();
            results.prop1 = new MyRecord();
            results.prop1.a = 3;
        }
        if (b) {
            results = results == null? new MyRecord() : results;
            results.prop2 = "prop2";
        } else {
            results = results == null? new MyRecord() : results;
            results.prop3 = "prop3";
        }
        return results;
    }
}
