java
public class JsonValueTest {

    @Test
    public void testJsonValuePolymorphicTypeLoss() throws IOException {
        // Given
        ObjectMapper mapper = new ObjectMapper();
        mapper.configure(SerializationFeature.FAIL_ON_EMPTY_BEANS, false);
        mapper.enableDefaultTyping();

        byte[] apdu = new byte[] {1, 2, 3};
        CommandAPDU commandAPDU = new CommandAPDU(apdu);

        // When
        String json = mapper.writeValueAsString(commandAPDU);
        CommandAPDU deserializedCommandAPDU = mapper.readValue(json, CommandAPDU.class);

        // Then
        assertEquals(apdu, deserializedCommandAPDU.getApdu());
        assertEquals(CommandAPDU.class, deserializedCommandAPDU.getClass());
    }
}
