
public void testJsonIncludeWithNonDefault() throws Exception {
    ObjectWriter ow = new ObjectWriter().withDefaultPrettyPrinter();
    String json = ow.writeValueAsString(new TestClass("default"));
    assertEquals("{\"value\":\"default\"}", json);

    json = ow.writeValueAsString(new TestClass(null));
    assertEquals("{\"value\":null}", json);
}

public class TestClass {
    @JsonInclude(JsonInclude.Include.NON_DEFAULT)
    private String value;

    public TestClass(String value) {
        this.value = value;
    }
}
