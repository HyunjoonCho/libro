
public void testTarArchiveInputStreamLargeUserId() throws IOException {
    // Create a Tar archive with a file entry having a large user-id value
    TarArchiveOutputStream out = new TarArchiveOutputStream(new FileOutputStream("test.tar"));
    TarArchiveEntry entry = new TarArchiveEntry("test.txt");
    entry.setUserId(0x1A000000); // 42,000,000
    out.putArchiveEntry(entry);
    out.close();

    // Try to read the Tar archive
    TarArchiveInputStream in = new TarArchiveInputStream(new FileInputStream("test.tar"));
    TarArchiveEntry entryRead = in.getNextTarEntry();
    // Expect an exception to be thrown
    assertThrows(IllegalArgumentException.class, () -> {
        in.close();
    });
}
