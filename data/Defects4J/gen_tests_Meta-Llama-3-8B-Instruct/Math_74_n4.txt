public void testInitializeStep() {
    // Arrange
    double[] y0 = new double[] {1.0, 2.0};
    double[] scalAbsoluteTolerance = null;
    double[] scalRelativeTolerance = new double[] {0.1};
    double[] vecAbsoluteTolerance = null;
    double[] vecRelativeTolerance = new double[] {0.1};
    double[] scale = new double[y0.length];
    
    // Act
    initializeStep(y0, scalAbsoluteTolerance, scalRelativeTolerance, vecAbsoluteTolerance, vecRelativeTolerance, scale);
    
    // Assert
    for (int i = 0; i < scale.length; i++) {
        assertEquals(scalAbsoluteTolerance[0] + scalRelativeTolerance[0] * Math.max(Math.abs(y0[i]), Math.abs(y0[i])), scale[i], 0.00001);
    }
}