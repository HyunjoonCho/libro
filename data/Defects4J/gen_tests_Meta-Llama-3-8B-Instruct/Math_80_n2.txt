public void testEigenDecompositionImpl() {

    double[] mainTridiagonal = {
            7484.860960227216, 18405.28129035345, 13855.225609560746,
            10016.708722343366, 559.8117399576674, 6750.190788301587,
            71.21428769782159
    };
    double[] secondaryTridiagonal = {
            -4175.088570476366, 1975.7955858241994, 5193.178422374075,
            1995.286659169179, 75.34535882933804, -234.0808002076056
    };

    EigenDecomposition decomposition = new EigenDecompositionImpl(mainTridiagonal, secondaryTridiagonal, MathUtils.SAFE_MIN);

    double[] eigenValues = decomposition.getRealEigenvalues();
    RealVector[] eigenvectors = decomposition.getEigenvectors();

    for (int i = 0; i < eigenValues.length; ++i) {
        double refEigenValue = 20654.744890306974412; // hardcoded value from the bug report
        assertEquals(refEigenValue, eigenValues[i], 1.0e-3);

        // hardcoded eigenvectors from the bug report
        RealVector refEigenvector = new ArrayRealVector(new double[] {-0.270356342026904, 0.852811091326997, 0.399639490702077, 0.198794657813990, 0.019739323307666, 0.000106983022327, -0.000001216636321});
        assertEquals(0, refEigenvector.add(eigenvectors[i]).getNorm(), 1.0e-5);
    }
}