
public class BugTest {
    public static class MyRecord {
        public Object prop1;
        public String prop2;
        public String prop3;
    }

    public static MyRecord func(boolean a, boolean b) {
        MyRecord results = null;
        if (a) {
            results = new MyRecord();
            results.prop1 = new MyRecord().a = 3;
        }
        if (b) {
            results = results!= null? results : new MyRecord();
            results.prop2 = "prop2";
        } else {
            results = results!= null? results : new MyRecord();
            results.prop3 = "prop3";
        }
        return results;
    }

    @Test
    public void testBug() {
        MyRecord result = func(true, true);
        assertEquals(null, result.prop1);
    }
}
