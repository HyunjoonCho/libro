public void testDangerousUseOfThis() {
    ClosureCompiler compiler = new ClosureCompiler();
    String output = compiler.compile(
            "function Foo() {\n" +
            "  this._bar = null;\n" +
            "}\n" +
            "function writeMethodWithAnnotation() {\n" +
            "  @this Foo\n" +
            "  this._bar = 123;\n" +
            "}\n" +
            "function readMethodWithAnnotation() {\n" +
            "  @this Foo\n" +
            "  return this._bar;\n" +
            "}\n" +
            "function writeMethodWithoutAnnotation() {\n" +
            "  this._bar = 123;\n" +
            "}\n" +
            "function readMethodWithoutAnnotation() {\n" +
            "  return this._bar;\n" +
            "}");
    Assert.assertTrue(output.contains("writeMethodWithoutAnnotation")); // expected warning
    Assert.assertFalse(output.contains("readMethodWithAnnotation")); // no warning
}