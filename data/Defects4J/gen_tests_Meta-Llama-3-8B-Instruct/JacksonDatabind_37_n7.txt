java
import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.databind.SerializationFeature;
import com.fasterxml.jackson.databind.SerializationFeature.WRITE_NULL_PROPERTIES;
import org.apache.calcite.model.JsonMapSchema;
import org.apache.calcite.model.JsonSchema;
import org.junit.Test;

import static org.junit.Assert.assertEquals;

public class JsonMapSchemaTest {

    @Test
    public void testReadJsonMapSchema() throws Exception {
        String json = "{\"version\": '1.0', \"schemas\": [{\"name\": \"FoodMart\", \"tables\": [{\"name\": \"time_by_day\", \"columns\": [{\"name\": \"time_id\"}]}, {\"name\": \"sales_fact_1997\", \"columns\": [{\"name\": \"time_id\"}]}]}]}";

        ObjectMapper mapper = new ObjectMapper();
        mapper.enable(SerializationFeature.WRITE_NULL_PROPERTIES);

        JsonMapSchema jsonMapSchema = mapper.readValue(json, JsonMapSchema.class);

        assertEquals("FoodMart", jsonMapSchema.getName());
    }
}
