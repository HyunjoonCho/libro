
public void testTokenBufferDelegateDeserialization() throws Exception {
    TokenBuffer buffer = new TokenBuffer();
    buffer.writeStartObject();
    buffer.writeStringField("a", "1");
    buffer.writeNullField("b");
    buffer.writeEndObject();

    Value value = Value.from(buffer);
    assertEquals("1", value.getA());
    assertNull(value.getB());
    
    // Check the buffer state
    TokenBuffer expected = new TokenBuffer();
    expected.writeStartObject();
    expected.writeStringField("a", "1");
    expected.writeEndObject();
    assertEquals(expected, buffer);
}
