public void testBadVariableInlining() {
    new JavaScriptEngine().executeScript("var arr = [1, 2, 3, 4, 5];" +
            "for (var i = 0, l = arr.length; i < l; i++) {" +
            "var j = arr[i];" +
            "(function() {" +
            "var k = j;" +
            "setTimeout(function() { console.log(k); }, 0);" +
            "})();" +
            "}; foo();");
    // Check that the expected output is not logged
    assertEquals("", System.out.toString());
}