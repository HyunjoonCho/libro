public void testOverzealousOptimization() {
    final double initialUid = Math.random();
    double uid = initialUid;
    try {
        reset();
        double _uid = uid;
        if (uid < 0.5) {
            doStuff();
        }
        if (uid!= _uid) {
            throw new AssertionError("reset() was called");
        }
    } catch (AssertionError e) {
        return;
    }
    fail("Expected'reset() was called' to be thrown");
}

private void reset() {
    uid = Math.random();
}

private void doStuff() {
    reset();
    uid = Math.random();
}