
public class ReferenceChainTest {
    @Test
    public void incorrectReferenceChain() throws IOException {
        ObjectMapper mapper = new ObjectMapper();
        JsonMappingException exception = expectThrows(JsonMappingException.class, () -> {
            mapper.readValue(mapper.writeValueAsBytes(new Outer()), Outer.class);
        });
        JsonMappingException.Reference reference = exception.getPath().get(0);
        String expected = "Outer.Inner[\"inner\"]";
        String actual = reference.toString();
        assertEquals(expected, actual);
    }

    static class Outer {
        public Inner inner = new Inner();
    }

    static class Inner {
        public int x;

        @JsonCreator
        public static Inner create(@JsonProperty("x") int x) {
            throw new RuntimeException("test-exception");
        }
    }
}
