public void testIncompleteNamespaceHandling() {
    DOMConfiguration config = new DOMConfiguration();
    config.setNamespaceAware(true);
    DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
    factory.setFeature("http://xml.org/sax/features/namespaces", true);
    factory.setFeature("http://xml.org/sax/features/namespace-prefixes", true);
    factory.setNamespaceAware(true);
    DocumentBuilder builder = factory.newDocumentBuilder();
    builder.setEntityResolver(new EntityResolver() {
        public InputSource resolveEntity(String publicId, String systemId) throws IOException, SAXException {
            return new InputSource(new StringReader("<root><ElementA A:myAttr=\"Mytype\"><B:ElementB>MY VALUE</B:ElementB></ElementA></root>"));
        }
    });
    Document doc = builder.parse(new InputSource("input.xml"));
    Element element = doc.getDocumentElement();
    assertEquals("Mytype", element.getAttributeNS("http://some.namespace/A", "myAttr"));
}