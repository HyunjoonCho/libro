java
@Test
public void testCSVParserIterator() throws Exception {
    String fiveRows = "1\n2\n3\n4\n5\n";
    CSVParser parser = new CSVParser(new BufferedReader(new StringReader(fiveRows)), CSVFormat.DEFAULT);

    List<CSVRecord> records = new ArrayList<>();
    for (CSVRecord record : parser) {
        records.add(record);
    }

    assertEquals(5, records.size());

    Iterator<CSVRecord> iterator = parser.iterator();
    assertEquals(true, iterator.hasNext());
    iterator.next();
    assertEquals(true, iterator.hasNext());
    iterator.next();
    assertEquals(false, iterator.hasNext());

    // Test that peeking with hasNext() does not advance the iterator
    iterator = parser.iterator();
    assertEquals(true, iterator.hasNext());
    assertEquals(true, iterator.hasNext());
    iterator.next();
    assertEquals(true, iterator.hasNext());
    assertEquals(true, iterator.hasNext());
}
