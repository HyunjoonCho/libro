
public void testBase64InputStreamRead() throws IOException {
    ByteArrayOutputStream bos = new ByteArrayOutputStream();
    bos.write("123".getBytes()); // 3 bytes, should not cause issue
    bos.write("456".getBytes()); // 3 bytes, should not cause issue
    bos.write("789".getBytes()); // 3 bytes, should not cause issue
    bos.write("012".getBytes()); // 3 bytes, should cause issue

    ByteArrayInputStream bis = new ByteArrayInputStream(bos.toByteArray());
    Base64InputStream base64InputStream = new Base64InputStream(bis, true);
    byte[] buffer = new byte[4];
    int bytesRead = base64InputStream.read(buffer);
    assertEquals(0, bytesRead); // expected to return 0
}
