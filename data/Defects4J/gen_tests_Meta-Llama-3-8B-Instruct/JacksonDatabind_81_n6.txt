
public void testIntAndIntegerHandling() {
    ObjectMapper mapper = new ObjectMapper();
    SimpleModule module = new SimpleModule();
    module.addSerializer(Integer.class, new IntegerSerializer());
    module.addDeserializer(Integer.class, new IntegerDeserializer());
    mapper.registerModule(module);

    String json = mapper.writeValueAsString(1);
    assertEquals("{\"value\":1}", json);

    JsonNode node = mapper.readTree(json);
    assertEquals(1, node.get("value").asInt());

    json = mapper.writeValueAsString(new Integer(1));
    assertEquals("{\"value\":1}", json);

    node = mapper.readTree(json);
    assertEquals(1, node.get("value").asInt());
}
