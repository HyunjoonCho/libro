
public void testTarArchiveInputStreamFailsToReadEntryWithBigUserIdValue() throws Exception {
    // Create a test tar archive
    ByteArrayOutputStream bos = new ByteArrayOutputStream();
    TarArchiveOutputStream taos = new TarArchiveOutputStream(bos);
    TarArchiveEntry entry = new TarArchiveEntry("test.tar");
    entry.setUserId(520); // This is a big user-id value
    taos.putArchiveEntry(entry);
    taos.close();

    // Try to read the tar archive
    TarArchiveInputStream tais = new TarArchiveInputStream(new ByteArrayInputStream(bos.toByteArray()));
    TarArchiveEntry tarEntry = tais.getNextTarEntry();
    assert tarEntry == null; // The entry should not be parsed correctly
}
