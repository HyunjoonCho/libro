java
public void testFastDateFormatLocaleChange() {
    Locale originalLocale = Locale.getDefault();
    Locale newLocale = new Locale("fr", "FR");

    FastDateFormat df = FastDateFormat.getInstance();
    df.setLocale(newLocale);

    // Store the date format in the cache
    df.format(new Date());

    Locale.setDefault(originalLocale);

    // Change the locale
    Locale.setDefault(newLocale);

    // Try to get the date format from the cache
    FastDateFormat cachedDf = FastDateFormat.getInstance();

    // Assert that the wrong locale is used
    assertEquals(originalLocale, cachedDf.getLocale());
}
