java
public void testFails() throws JsonParseException, JsonMappingException, IOException {
    ObjectMapper mapper = new ObjectMapper().enableDefaultTyping(DefaultTyping.NON_FINAL);
    TestClass testInstance = mapper.readValue(TEST_INSTANCE_SERIALIZED, TestClass.class);
    String testInstanceSerialized = mapper.writeValueAsString(testInstance);
    assertEquals(TEST_INSTANCE_SERIALIZED, testInstanceSerialized);
}

public void testSucceeds() throws JsonParseException, JsonMappingException, IOException {
    ObjectMapper mapper = new ObjectMapper();
    mapper.registerModule(new SimpleModule() {
        private static final long serialVersionUID = 1L;
        @Override
        public void setupModule(SetupContext context) {
            context.addKeyDeserializers(new SimpleKeyDeserializers().addDeserializer(CompoundKey.class, new CompoundKeyDeserializer()));
        }
    });
    TestClass testInstance = mapper.readValue(TEST_INSTANCE_SERIALIZED, TestClass.class);
    String testInstanceSerialized = mapper.writeValueAsString(testInstance);
    assertEquals(TEST_INSTANCE_SERIALIZED, testInstanceSerialized);
}
