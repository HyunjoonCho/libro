
public void testNestedNonWrappedLists() throws Exception {
    ObjectMapper mapper = new ObjectMapper();

    Root root = new Root();
    root.setRecords(Arrays.asList(new Record(), new Record()));

    Record record = root.getRecords().get(0);
    record.setFields(Arrays.asList(new Field(), new Field()));

    String json = mapper.writeValueAsString(root);
    assertEquals("{\"records\":[{\"fields\":[{},{}]}]}", json);

    Root root2 = mapper.readValue(json, Root.class);
    assertEquals(2, root2.getRecords().size());
    assertEquals(2, root2.getRecords().get(0).getFields().size());
}
