
@Test
public void testBigDecimalSchema() throws Exception {
    GenericRecord record = new GenericRecordBuilder(new Schema.Parser().parse("{
        \"type\": \"record\",
        \"name\": \"Test\",
        \"fields\": [
            {\"name\": \"decimalField\", \"type\": \"decimal\"}
        ]
    }")).build();
    record.put("decimalField", new BigDecimal("123.45"));

    ByteArrayOutputStream out = new ByteArrayOutputStream();
    Encoder encoder = new BinaryEncoder(new Base64OutputStream(out));
    DatumWriter writer = new SpecificDatumWriter(record.getSchema());
    writer.write(record, encoder);
    encoder.flush();

    String schema = new String(out.toByteArray(), StandardCharsets.UTF_8);
    // Assert that the schema is not correctly produced
    // For example, the schema might not be "decimal" but "long"
}
