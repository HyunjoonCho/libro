public void testTarChecksumRightAligned() {
    String tarEntry = "checksum        123456\n";
    assertTrue("Checksum should be valid", isChecksumValid(tarEntry));
}

private boolean isChecksumValid(String tarEntry) {
    String[] lines = tarEntry.split("\n");
    for (String line : lines) {
        if (line.startsWith("checksum")) {
            String checksumLine = line.substring(11).trim();
            String expectedChecksum = checksumLine.substring(0, 6); // Only take first 6 octal digits
            String actualChecksum = calculateTarChecksum(line.substring(0, 11).trim() + "\n");
            return expectedChecksum.equals(actualChecksum);
        }
    }
    return false;
}

private String calculateTarChecksum(String line) {
    int sum = 0;
    for (char c : line.toCharArray()) {
        sum += c;
    }
    int checksum = sum & 0xFF;
    return String.format("%06o", checksum);
}