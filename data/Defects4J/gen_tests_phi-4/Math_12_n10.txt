import static org.junit.Assert.assertEquals;
import org.apache.commons.math3.distribution.GammaDistribution;
import org.apache.commons.math3.random.Well19937c;
import org.junit.Test;

import java.io.*;

public void testGammaDistributionCloning() {
    GammaDistribution originalDist = new GammaDistribution(2.0, 2.0);
    Well19937c rng = new Well19937c(12345);
    originalDist.setRandomGenerator(rng);

    ByteArrayOutputStream byteArrayOutputStream = new ByteArrayOutputStream();
    try (ObjectOutputStream out = new ObjectOutputStream(byteArrayOutputStream)) {
        out.writeObject(originalDist);
    }

    ByteArrayInputStream byteArrayInputStream = new ByteArrayInputStream(byteArrayOutputStream.toByteArray());
    try (ObjectInputStream in = new ObjectInputStream(byteArrayInputStream)) {
        GammaDistribution clonedDist = (GammaDistribution) in.readObject();
        assertEquals(originalDist.getShape(), clonedDist.getShape(), 1e-10);
        assertEquals(originalDist.getScale(), clonedDist.getScale(), 1e-10);
        assertEquals(originalDist.sample(), clonedDist.sample(), 1e-10);
    } catch (IOException | ClassNotFoundException e) {
        e.printStackTrace();
        fail("Serialization/Deserialization failed");
    }
}