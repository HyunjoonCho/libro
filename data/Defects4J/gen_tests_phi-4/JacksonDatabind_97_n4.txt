public void testCustomSerializerWithPOJO() throws IOException {
    ObjectMapper mapper = new ObjectMapper();

    @JsonSerialize(using = CustomSer.class)
    public static class Data {
        public String aStr;
    }

    public static class CustomSer extends StdSerializer<Data> {
        public CustomSer() {
            super(Data.class);
        }

        @Override
        public void serialize(Data value, JsonGenerator gen, SerializerProvider provider) throws IOException {
            String attrStr = (String) provider.getAttribute("myAttr");
            gen.writeStartObject();
            gen.writeStringField("aStr", "The value is: " + (attrStr == null? "NULL" : attrStr));
            gen.writeEndObject();
        }
    }

    Data data = new Data();
    data.aStr = "Hello";

    ObjectNode treeTest = mapper.createObjectNode();
    treeTest.putPOJO("data", data);

    String treeOut = mapper.writer().withAttribute("myAttr", "Hello!").writeValueAsString(treeTest);
    assertEquals("{\"data\":{\"aStr\":\"The value is: NULL\"}}", treeOut);
}