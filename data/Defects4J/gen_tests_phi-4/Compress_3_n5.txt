public void testExternalFinishCall() {
    try (ArchiveOutputStream aos = new ZipArchiveOutputStream(new ByteArrayOutputStream())) {
        // Write some data
        aos.putArchiveEntry(new ZipArchiveEntry("file.txt"));
        aos.write("Hello, World!".getBytes());
        aos.closeArchiveEntry();

        // Directly call finish()
        aos.finish();

        // Close again to simulate user misuse
        aos.close();
    } catch (Exception e) {
        // Expect an exception due to misuse
        fail("finish() should not be safely callable externally without close()");
    }
}