public void testBrentSolverInitialGuessWrongSign() {
    UnivariateRealFunction f = x -> x * x - 4; // f(0) = -4, f(5) = 21, f(2) = 0
    double min = 0;
    double max = 5;
    double initial = 1; // f(1) = -3, same sign as f(min) and f(max)

    IllegalArgumentException exception = assertThrows(IllegalArgumentException.class, () -> {
        new BrentSolver().solve(f, min, max, initial);
    });

    String expectedMessage = "The values of the function at the initial guess and the bounds have the same sign.";
    String actualMessage = exception.getMessage();
    assertTrue(actualMessage.contains(expectedMessage));
}