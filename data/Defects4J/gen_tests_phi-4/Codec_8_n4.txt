public void testBase64InputStreamReads() throws IOException {
    ByteArrayOutputStream byteArrayOutputStream = new ByteArrayOutputStream();
    byteArrayOutputStream.write(new byte[10920 * 3 / 4]); // Approximate size to trigger the bug
    byteArrayOutputStream.flush();

    ByteArrayInputStream byteArrayInputStream = new ByteArrayInputStream(byteArrayOutputStream.toByteArray());
    Base64InputStream b64stream = new Base64InputStream(byteArrayInputStream, true, 0, null);

    int n = 0;
    try {
        while (b64stream.read()!= -1) {
            n++;
        }
    } catch (Exception e) {
        assertEquals(10920, n);
        assertTrue(e instanceof ArrayIndexOutOfBoundsException);
    }
}