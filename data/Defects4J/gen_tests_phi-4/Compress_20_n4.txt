public void testReadCpioWithNonZeroTrailerMode() throws IOException {
    try (InputStream in = getClass().getResourceAsStream("/redline-cpio-test.cpio")) {
        CpioArchive archive = new CpioArchive(in);
        archive.readAllEntries();
    } catch (IllegalArgumentException e) {
        // Expected exception due to non-zero file mode on the trailer
        assertTrue("Expected IllegalArgumentException due to non-zero trailer mode", e.getMessage().contains("non-zero file mode"));
    }
}