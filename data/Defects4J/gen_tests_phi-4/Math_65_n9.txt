public void testWeightVersusSigmaInAbstractLeastSquares() {
    AbstractLeastSquares als = new AbstractLeastSquares(3, 1);
    double[][] data = {
        {1.0, 2.0, 3.0, 4.0},
        {2.0, 3.0, 4.0, 5.0},
        {3.0, 4.0, 5.0, 6.0}
    };
    double[] weights = {1.0, 0.5, 2.0}; // Example weights
    als.setObservedData(data);
    als.setObservationWeights(weights);
    
    double expectedChiSquare = 0.0;
    for (int i = 0; i < data.length; i++) {
        double residual = data[i][3] - (data[i][0] + data[i][1] + data[i][2]); // Assuming a simple model
        expectedChiSquare += Math.pow(residual, 2) * weights[i];
    }
    
    assertEquals(expectedChiSquare, als.getChiSquare(), 1e-9);
    
    double expectedRMS = Math.sqrt(expected