public void testRuntimeExceptionWithExternPrototype() throws Exception {
    ProcessBuilder processBuilder = new ProcessBuilder(
        "java", "-jar", "compiler.jar", "--compilation_level", "ADVANCED_OPTIMIZATIONS",
        "--externs", "prototype.js", "--js", "bootloader.js"
    );
    processBuilder.redirectErrorStream(true);
    
    Process process = processBuilder.start();
    process.waitFor();
    
    String output = new BufferedReader(new InputStreamReader(process.getInputStream()))
                   .lines().collect(Collectors.joining("\n"));
    
    assertTrue(output.contains("INTERNAL COMPILER ERROR"));
    assertTrue(output.contains("Node(FUNCTION ): prototype.js:213:11"));
    assertTrue(output.contains("function Str(key, holder, stack) {"));
    assertTrue(output.contains("Parent(BLOCK): prototype.js:160:12"));
}