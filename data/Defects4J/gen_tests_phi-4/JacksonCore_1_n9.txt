public void testNaNAsBigDecimal() {
    ObjectMapper mapper = new ObjectMapper();
    JsonFactory factory = mapper.getFactory();
    factory.configure(JsonParser.Feature.ALLOW_NON_NUMERIC_NUMBERS, true);

    String json = "NaN";
    try (JsonParser parser = factory.createParser(json)) {
        parser.nextToken();
        assertTrue(parser.isFloatingPointNan());
        
        try {
            parser.getDecimalValue();
            fail("Expected NumberFormatException for NaN");
        } catch (NumberFormatException e) {
            // Expected exception
        } catch (NullPointerException e) {
            // This is the unexpected behavior we want to reproduce
            throw e;
        }
    }
}