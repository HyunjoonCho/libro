import static org.junit.Assert.assertEquals;
import org.junit.Test;

public class InferenceTest {

    @Test
    public void testTypeInferenceInconsistency() {
        interface Record {
            String getProp();
        }

        interface RecordWithOptional {
            String getProp();
            String getProp2();
        }

        Runnable test1 = () -> System.out.println("Record passed");
        Runnable test2 = record -> {
            if (record instanceof String) {
                System.out.println(record);
            } else {
                System.out.println(((Record) record).getProp());
            }
        };

        test1.run();
        try {
            test2.run(new Object() {
                public String getProp() {
                    return "a";
                }
            });
            assertEquals("Should not reach here", null, null); // This line should not be reached
        } catch (ClassCastException e) {
            assertEquals("ClassCastException should be thrown", "class java.lang.Object cannot be cast to interface <lambda>", e.getMessage());
        }
    }
}