public void testEventStateNotUpdated() {
    ODESolver solver = new ODESolver();
    EventHandler event1 = new EventHandler() {
        @Override
        public void eventOccurred(ODEState state) {
            state.resetState();
        }
    };

    EventHandler event2 = new EventHandler() {
        @Override
        public void eventOccurred(ODEState state) {
            // Event logic that relies on correct state
        }
    };

    solver.addEventHandler(event1);
    solver.addEventHandler(event2);

    ODEState initialState = new ODEState(new double[]{0.5, 0.5});
    solver.integrate(initialState);

    // Check if event2's state is incorrectly updated
    double[] stateValues = initialState.getState();
    assertTrue(Arrays.stream(stateValues).allMatch(v -> v >= -1 && v <= 1));
}