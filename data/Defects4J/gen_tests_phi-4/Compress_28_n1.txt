public void testCorruptedTarArchiveInputStream() throws IOException {
    String archivePath = PathUtil.join(testdataDir, "corrupted_test.tar.bz2");
    TarArchiveInputStream input = new TarArchiveInputStream(
            new BZip2CompressorInputStream(GoogleFile.SYSTEM.newInputStream(archivePath), true));
    ArchiveEntry nextMatchedEntry = input.getNextEntry();
    
    try {
        while (nextMatchedEntry!= null) {
            // Expect an IOException to be thrown due to unexpected EOF
            input.getNextEntry();
            fail("IOException expected due to unexpected EOF in corrupted tar file");
        }
    } finally {
        if (input!= null) {
            input.close();
        }
    }
}