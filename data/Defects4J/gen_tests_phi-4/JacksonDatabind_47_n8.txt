import com.fasterxml.jackson.core.JsonProcessingException;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.databind.annotation.JsonSerialize;
import org.junit.jupiter.api.Test;
import static org.junit.jupiter.api.Assertions.assertThrows;

public class JacksonSerializationTest {

    public static class BaseAccessionIdentifier implements AccessionIdentifier {}

    public static class AccessionIdentifier {}

    public static class Foo {
        @JsonSerialize(as = BaseAccessionIdentifier.class)
        @JsonDeserialize(as = BaseAccessionIdentifier.class)
        public AccessionIdentifier getReference() {
            return new AccessionIdentifier();
        }
    }

    @Test
    public void testJsonSerializeAsSuperType() {
        ObjectMapper mapper = new ObjectMapper();
        Foo foo = new Foo();

        JsonProcessingException exception = assertThrows(JsonProcessingException.class, () -> {
            mapper.writeValueAsString(foo);
        });

        String expectedMessage = "Failed to widen type [simple type, class org.pharmgkb.model.AccessionIdentifier] with annotation (value org.pharmgkb.model.BaseAccessionIdentifier), from 'getReference': Class org.pharmgkb.model.BaseAccessionIdentifier not a super-type of [simple type, class org.pharmgkb.model.AccessionIdentifier]";
        
        String actualMessage =