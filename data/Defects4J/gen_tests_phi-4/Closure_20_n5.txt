public void testStringConversionOptimization() {
    Object f = new Object() {
        @Override
        public String toString() {
            return "toString";
        }

        @Override
        public String valueOf() {
            return null;
        }
    };

    assertEquals("[object Object]", f.toString());
    assertEquals("null", f + "");
}