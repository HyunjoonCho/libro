public void testCVE20187489GadgetExploit() {
    try {
        // Simulate the unsafe deserialization scenario
        ObjectMapper mapper = new ObjectMapper();
        String payload = "{\"@type\":\"com.mchange.v2.c3p0.impl.NewPooledConnectionFactory\", \"dataSourceName\":\"dataSource\"}";
        PooledConnectionFactory factory = mapper.readValue(payload, PooledConnectionFactory.class);
        fail("Deserialization should have failed due to blocked gadget");
    } catch (Exception e) {
        // Verify that the appropriate exception is thrown
        assertTrue(e.getMessage().contains("c3p0 vulnerability"));
    }
}