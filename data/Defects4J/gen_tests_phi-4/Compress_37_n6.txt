public void testNegativeArraySizeInPaxHeaders() {
    byte[] tarballWithEmptyLineAtEnd = {/* byte content of the tarball with the issue */};
    ByteArrayInputStream bais = new ByteArrayInputStream(tarballWithEmptyLineAtEnd);
    InputStream is = new GzipCompressorInputStream(bais);
    TarArchiveInputStream tarInputStream = new TarArchiveInputStream(is);

    try {
        tarInputStream.getNextTarEntry(); // Move to the entry with problematic PAX headers
        tarInputStream.parsePaxHeaders();
    } catch (NegativeArraySizeException e) {
        assertTrue(e.getMessage().contains("NegativeArraySizeException"));
    }
}