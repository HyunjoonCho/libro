public void testEscapeSurrogatePairs() throws Exception {
    String input = "\uD83D\uDE30"; // Surrogate pair for a smiley face emoji
    String expected = "\\" + input; // Expected result with CSV escape
    assertEquals(expected, StringEscapeUtils.escapeCsv(input));

    // Verify that the exception is thrown for improper handling
    try {
        CharSequenceTranslator translator = new CharSequenceTranslator() {
            public int translate(CharSequence input, int index, Writer out) throws IOException {
                if (index + 1 < input.length()) {
                    return 2; // Attempt to translate a surrogate pair
                }
                return 0;
            }
        };
        translator.translate(input, new StringWriter());
        fail("Expected StringIndexOutOfBoundsException");
    } catch (StringIndexOutOfBoundsException e) {
        // Expected exception
    }
}