public void testDerivativeStructureAtan2SpecialCases() {
    DerivativeStructure x1 = new DerivativeStructure(1, 0, 0.0);
    DerivativeStructure y1 = new DerivativeStructure(1, 0, 0.0);
    assertEquals(Double.NaN, DerivativeStructure.atan2(y1, x1).getValue(), 1e-15);

    DerivativeStructure x2 = new DerivativeStructure(1, 0, -0.0);
    DerivativeStructure y2 = new DerivativeStructure(1, 0, 0.0);
    assertEquals(Double.NaN, DerivativeStructure.atan2(y2, x2).getValue(), 1e-15);

    DerivativeStructure x3 = new DerivativeStructure(1, 0, 0.0);
    DerivativeStructure y3 = new DerivativeStructure(1, 0, -0.0);
    assertEquals(Double.NaN, DerivativeStructure.atan2(y3, x3).getValue(), 1e-15);

    DerivativeStructure x4 = new DerivativeStructure(1, 0, -0.0);
    DerivativeStructure y4 = new DerivativeStructure(1,