public void testOptionGroupStateNotUpdated() {
    Options options = new Options();
    OptionGroup group = new OptionGroup();
    Option optionA = new Option("a", "alpha", false, "Alpha option");
    Option optionB = new Option("b", "beta", false, "Beta option");
    group.addOption(optionA);
    group.addOption(optionB);
    options.addOptionGroup(group);

    CommandLineParser parser = new DefaultParser();
    Properties defaultOptions = new Properties();
    defaultOptions.setProperty("b", "true");

    try {
        CommandLine cmd = parser.parse(options, new String[]{"-a"}, defaultOptions);
        assertTrue(cmd.hasOption("a"));
        assertTrue(cmd.hasOption("b"));
    } catch (ParseException e) {
        fail("Parsing should not throw an exception");
    }
}