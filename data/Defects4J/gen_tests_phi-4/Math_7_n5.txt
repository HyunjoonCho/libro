public void testUnrelatedEventTriggersResetState() {
    ODESolver solver = new ODESolver();
    MultipleEventHandler handler = new MultipleEventHandler();
    solver.addEventHandler(handler);

    solver.integrate();

    EventState firstEventState = handler.getFirstEventState();
    assertNotEquals("Unexpected state update for unrelated event", firstEventState.getStartDate(), expectedStartDate);

    // Simulate a RESET_STATE from an unrelated event
    handler.handleUnrelatedEvent();

    // Re-run integration
    solver.integrate();

    EventState problematicEventState = handler.getProblematicEventState();
    assertEquals("Event state not correctly updated after RESET_STATE", expectedCorrectStartDate, problematicEventState.getStartDate());

    // Check incorrect y values
    double[] yValues = problematicEventState.getYValues();
    for (double y : yValues) {
        assertTrue("y value out of expected range", y >= -1 && y <= 1);
    }
}