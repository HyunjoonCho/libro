public void testCharsetDetection() {
    String html = "<html lang=\"en-US\">\n" +
                  "<head>\n" +
                  "    <meta charset=\"UTF-8\">\n" +
                  "    <meta http-equiv=\"Content-Type\" content=\"text/html; \" />\n" +
                  "</head>\n";

    try {
        Document doc = Jsoup.parse(html, "http://example.com", html);
        assertNotNull(doc.charset());
    } catch (IllegalCharsetNameException e) {
        fail("Jsoup should not throw IllegalCharsetNameException for this HTML input.");
    }
}