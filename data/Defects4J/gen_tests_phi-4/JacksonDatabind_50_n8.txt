public void testJsonIdentityInfoDeserializationFailure() throws Exception {
    ObjectMapper mapper = new ObjectMapper();
    String json = "{\"id\":\"123\",\"name\":\"Object A\",\"child\":{\"$id\":\"123\",\"name\":\"Object A\"}}";
    
    SimpleBean bean = mapper.readValue(json, SimpleBean.class);
    assertEquals("Object A", bean.getName());
    assertNotNull(bean.getChild());
    assertEquals(bean, bean.getChild());
}

class SimpleBean {
    @JsonIdentityInfo(generator = ObjectIdGenerators.PropertyGenerator.class, property = "id")
    private String id;
    
    private String name;
    
    @JsonCreator
    public SimpleBean(@JsonProperty("id") String id, @JsonProperty("name") String name,
                      @JsonProperty("child") SimpleBean child) {
        this.id = id;
        this.name = name;
        this.child = child;
    }

    public String getName() {
        return name;
    }

    public SimpleBean getChild() {
        return child;
    }

    private SimpleBean child;
}