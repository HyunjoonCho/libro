public void testCastingFunctionBeforeCalling() {
    String originalCode = "console.log( /** @type {function(!string):!string} */ ((new window.ActiveXObject( 'ShockwaveFlash.ShockwaveFlash' ))['GetVariable'])( '$version' ) );";
    String expectedOutput = "'use strict';console.log((0,(new window.ActiveXObject(\"ShockwaveFlash.ShockwaveFlash\")).GetVariable)(\"$version\"));";

    String compiledCode = compileCodeWithAdvancedOptimizations(originalCode);
    assertEquals(expectedOutput, compiledCode);

    String nonCastingCode = "console.log( /** @type {!string} */ ((new window.ActiveXObject( 'ShockwaveFlash.ShockwaveFlash' ))['GetVariable']( '$version' )) )";
    String expectedNonCastingOutput = "'use strict';console.log((new window.ActiveXObject(\"ShockwaveFlash.ShockwaveFlash\")).GetVariable(\"$version\"));";

    String compiledNonCastingCode = compileCodeWithAdvancedOptimizations(nonCastingCode);
    assertEquals(expectedNonCastingOutput, compiledNonCastingCode);
}

// Mock method to simulate code compilation with advanced optimizations
private String compileCodeWithAdvancedOptim