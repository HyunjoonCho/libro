public void testResetDefaultNamespaceLoop() throws Exception {
    // Set up DOM
    DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();
    dbf.setNamespaceAware(true);
    DocumentBuilder db = dbf.newDocumentBuilder();
    Document doc = db.newDocument();

    // Create elements
    Element foo = doc.createElementNS("bla", "b:foo");
    foo.setAttributeNS("bla", "test111:b:foo", "namespaceAttribute");

    Element bar = doc.createElementNS("bla", "b:bar");
    bar.setTextContent("a");
    foo.appendChild(bar);

    Element testElement = doc.createElementNS(null, "test");
    foo.appendChild(testElement);

    doc.appendChild(foo);

    // Create JXPathContext
    JXPathContext context = JXPathContext.newContext(doc);
    context.setNamespaceContext(new SimpleNamespaceContext() {
        public String getNamespaceURI(String prefix) {
            if ("b".equals(prefix)) {
                return "bla";
            } else if (prefix == null || "".equals(prefix)) {
                return "test111";
            }
            return "";
        }

        public String getPrefix(String namespaceURI) {
            if ("bla".equals(namespaceURI)) {
                return "b";
            } else