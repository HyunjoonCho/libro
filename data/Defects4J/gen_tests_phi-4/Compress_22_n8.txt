public void testBZip2ReadTruncated() throws IOException {
    // Create a truncated BZip2 compressed file
    ByteArrayOutputStream byteStream = new ByteArrayOutputStream();
    BZip2CompressorOutputStream bzipOut = new BZip2CompressorOutputStream(byteStream);
    byte[] data = new byte[770];
    new Random().nextBytes(data);
    bzipOut.write(data);
    bzipOut.close();

    // Reset the stream to simulate a truncated file
    byteStream.reset();
    byte[] truncatedData = new byte[769];
    byteStream.read(truncatedData, 0, 769);

    // Decompress using BZip2CompressorInputStream
    ByteArrayInputStream byteInputStream = new ByteArrayInputStream(truncatedData);
    BZip2CompressorInputStream bzipIn = new BZip2CompressorInputStream(byteInputStream);
    ByteArrayOutputStream output = new ByteArrayOutputStream();
    byte[] buffer = new byte[1024];
    int bytesRead;
    while ((bytesRead = bzipIn.read(buffer))!= -1) {
        output.write(buffer, 0, bytesRead);
    }
    bzipIn.close();

    // Compare the length of decompressed data
    byte[] decompressedData = output.toByteArray();
    assertEquals(770, decompressed