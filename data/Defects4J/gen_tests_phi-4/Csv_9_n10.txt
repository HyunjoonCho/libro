public void testToMapThrowsNpeOnFormatsWithNoHeaders() {
    CSVFormat format = CSVFormat.DEFAULT.withHeader().withSkipHeaderRecord();
    try (CSVParser parser = format.parse(new StringReader("value1,value2,value3"))) {
        CSVRecord record = parser.iterator().next();
        assertThrows(NullPointerException.class, () -> record.toMap());
    }
}