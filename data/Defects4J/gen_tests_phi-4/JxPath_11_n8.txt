public void testIncompleteNamespaceHandling() {
    Document document = DocumentBuilderFactory.newInstance().newDocumentBuilder().newDocument();
    
    // Register namespaces
    Namespace nsA = document.createNamespace("http://example.com/a", "A");
    Namespace nsB = document.createNamespace("http://example.com/b", "B");
    document.registerNamespace(nsA);
    document.registerNamespace(nsB);

    // Create root element
    Element elementA = document.createElementNS(nsA.getURI(), "A:ElementA");
    document.appendChild(elementA);

    // Add attribute with namespace
    elementA.setAttributeNS(nsA.getURI(), "A:myAttr", "MyType");

    // Create child element
    Element elementB = document.createElementNS(nsB.getURI(), "B:ElementB");
    elementB.setTextContent("MY VALUE");
    elementA.appendChild(elementB);

    // Attempt to create attribute again to trigger exception
    try {
        elementA.setAttributeNS(nsA.getURI(), "A:unknownAttr", "Value");
    } catch (Exception e) {
        assertEquals("unknown namespace prefix: A", e.getMessage());
    }
}