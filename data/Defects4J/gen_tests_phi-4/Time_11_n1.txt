import org.joda.time.DateTimeZoneBuilder;
import org.joda.time.DateTimeZone;
import org.junit.Test;

public void testDateTimeZoneBuilderNpe() throws Exception {
    final DateTimeZoneBuilder builder = new DateTimeZoneBuilder()
           .addCutover(1601, 'w', 1, 1, 1, false, 7200000)
           .setStandardOffset(3600000)
           .addRecurringSavings("", 3600000, 1601, Integer.MAX_VALUE, 'w', 3, -1, 1, false, 7200000)
           .addRecurringSavings("", 0, 1601, Integer.MAX_VALUE, 'w', 10, -1, 1, false, 10800000);

    DateTimeZone dtz1 = builder.toDateTimeZone("TestDTZ1", true);

    Thread t = new Thread(() -> {
        try {
            DateTimeZone dtz2 = builder.toDateTimeZone("TestDTZ2", true);
        } catch (NullPointerException e) {
            // Expected NPE due to improperly initialized ThreadLocal
            System.out.println("Caught expected NullPointerException");
        }
    });
    t.start();
    t.join();
}