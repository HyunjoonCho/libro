public void testAtan2SpecialCases() {
    DerivativeStructure x1 = new DerivativeStructure(1, 0, 0.0);
    DerivativeStructure y1 = new DerivativeStructure(1, 0, 0.0);
    assertEquals(Double.POSITIVE_INFINITY, Double.isInfinite(0.0 / 0.0)? Double.POSITIVE_INFINITY : Math.atan2(0.0, 0.0), DerivativeStructure.atan2(y1, x1).getValue(), 1e-9);

    DerivativeStructure x2 = new DerivativeStructure(1, 0, -0.0);
    DerivativeStructure y2 = new DerivativeStructure(1, 0, 0.0);
    assertEquals(Math.PI, Math.atan2(0.0, -0.0), DerivativeStructure.atan2(y2, x2).getValue(), 1e-9);

    DerivativeStructure x3 = new DerivativeStructure(1, 0, 0.0);
    DerivativeStructure y3 = new DerivativeStructure(1, 0, -0.0);
    assertEquals(-Math.PI / 2, Math.atan2(-0.