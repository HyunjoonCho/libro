public void testPolymorphicDeserializationCVE201715095() throws Exception {
    ObjectMapper mapper = new ObjectMapper();
    String json = "{\"@type\":\"java.util.regex.Pattern\",\"pattern\":\".*\",\"flags\":64}";

    try {
        mapper.readValue(json, Object.class);
        fail("Expected SecurityException due to blocked type java.util.regex.Pattern");
    } catch (JsonMappingException | JsonParseException e) {
        // Expected
    } catch (SecurityException e) {
        // Expected exception due to blocked type
        assertEquals("Blocking com.fasterxml.jackson.databind.exc.InvalidTypeIdException: "
                + "No suitable constructor/factory method found for type [simple type, class java.util.regex.Pattern]", e.getMessage());
    }
}