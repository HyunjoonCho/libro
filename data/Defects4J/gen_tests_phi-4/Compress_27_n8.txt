import org.apache.commons.compress.archivers.tar.TarArchiveEntry;
import org.apache.commons.compress.archivers.tar.TarArchiveInputStream;
import org.apache.commons.compress.compressors.gzip.GzipCompressorInputStream;
import org.junit.Test;

import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;

public class TestIssueIncorrectHandlingOfNullUsernameAndGroup {

    @Test
    public void testNullUsernameAndGroupHandling() throws IOException {
        TarArchiveInputStream tarInputStream = null;

        try {
            tarInputStream = new TarArchiveInputStream(
                new GzipCompressorInputStream(
                    new FileInputStream(new File("/home/pknobel/redis-dist-2.8.3_1-linux.tar.gz"))
                )
            );

            TarArchiveEntry entry;
            while ((entry = tarInputStream.getNextTarEntry())!= null) {
                System.out.println(entry.getName());
                System.out.println(entry.getUserName() + "/" + entry.getGroupName());

                // This is where the failure will occur if the entry has a null username or group
                if (entry.getUserName() == null || entry.getGroupName() == null) {
                    throw new IllegalArgumentException("Encountered entry with null username or group");
                }
            }

        } catch (IOException e) {