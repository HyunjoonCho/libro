public void testNodeSetHandling() {
    ExpressionContext context = new ExpressionContext();
    // Assuming setup of context and necessary environment for the test
    NodeSet actualNodeSet = observations(context);

    // Simulate XPath selection that should return the node set
    JXPathContext jPathContext = JXPathContext.newContext(context.getContextNode());
    Object result = jPathContext.selectNodes("ems:observations()");

    // Verify that the result is indeed a BasicNodeSet, not a single node containing it
    assertTrue(result instanceof BasicNodeSet);
    BasicNodeSet expectedNodeSet = (BasicNodeSet) result;

    // Check that the contents of the node set are as expected
    assertEquals(actualNodeSet.size(), expectedNodeSet.size());
    for (NodePointer ptr : actualNodeSet) {
        assertTrue(expectedNodeSet.contains(ptr));
    }
}