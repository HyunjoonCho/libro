public void testJsonWriterValueLeniency() {
    JsonWriter writer = Json.createWriterFactory(new JsonWriterFactory()).createWriter(new ByteArrayOutputStream());
    writer.setLenient(true);
    
    try {
        writer.value(Double.NaN);
        fail("Expected IllegalArgumentException when value is NaN in double format");
    } catch (IllegalArgumentException e) {
        // Expected
    }
    
    writer.value((Number) Double.valueOf(Double.NaN)); // This should not throw an exception
    writer.close();
}