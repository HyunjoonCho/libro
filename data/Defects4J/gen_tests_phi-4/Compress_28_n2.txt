public void testCorruptedTarBzip2SilentlyFails() throws IOException {
    String archivePath = PathUtil.join(testdataDir, "test.tar.bz2");
    TarArchiveInputStream input = null;

    try {
        input = new TarArchiveInputStream(new BZip2CompressorInputStream(
                GoogleFile.SYSTEM.newInputStream(archivePath), true));

        ArchiveEntry nextMatchedEntry = input.getNextEntry();
        while (nextMatchedEntry!= null) {
            ByteArrayOutputStream outContent = new ByteArrayOutputStream();
            ByteStreams.copy(input, outContent);
            nextMatchedEntry = input.getNextEntry();
        }
    } catch (Exception e) {
        fail("Expected IOException on unexpected EOF, but no exception was thrown");
    }
}