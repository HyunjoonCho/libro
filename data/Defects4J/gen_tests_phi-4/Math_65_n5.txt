public void testWeightVersusSigmaInAbstractLeastSquares() {
    double[] residuals = {1.0, 2.0, 3.0};
    double[] residualsWeights = {0.5, 0.5, 0.5}; // Example weights
    int rows = 3;

    AbstractLeastSquares leastSquares = new AbstractLeastSquares() {
        @Override
        public double getChiSquare() {
            double chiSquare = 0.0;
            for (int i = 0; i < residuals.length; i++) {
                chiSquare += Math.pow(residuals[i], 2) * residualsWeights[i];
            }
            return chiSquare;
        }

        @Override
        public int getRows() {
            return rows;
        }
    };

    double expectedChiSquare = (1.0 * 1.0 * 0.5) + (2.0 * 2.0 * 0.5) + (3.0 * 3.0 * 0.5);
    double expectedRMS = Math.sqrt(expectedChiSquare / rows);

    assertEquals(expectedChiSquare, leastSquares.getChiSquare(), 1e-9