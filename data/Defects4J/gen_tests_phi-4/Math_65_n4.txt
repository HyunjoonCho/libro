public void testChiSquareWeightHandling() {
    AbstractLeastSquares leastSquares = new AbstractLeastSquares() {
        @Override
        public void compute() {
            // Mocked data setup
            residuals = new double[]{1.0, 2.0, 3.0};
            residualsWeights = new double[]{0.5, 0.5, 0.5}; // Example weights
            variances = new double[]{1.0, 1.0, 1.0};
            rows = 3;
            columns = 1;
        }
    };
    leastSquares.compute();
    
    double expectedChiSquare = 0.5 * (1.0 * 1.0) + 0.5 * (2.0 * 2.0) + 0.5 * (3.0 * 3.0);
    assertEquals(expectedChiSquare, leastSquares.getChiSquare(), 0.001);
    
    double expectedRMS = Math.sqrt(expectedChiSquare / 3);
    assertEquals(expectedRMS, leastSquares.getRMS(), 0.001);
}