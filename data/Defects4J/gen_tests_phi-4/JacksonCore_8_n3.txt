public void testTextBufferInconsistency() {
    TextBuffer buffer = new TextBuffer(new BufferRecycler());
    buffer.resetWithEmpty();
    
    Object firstCallResult = buffer.getTextBuffer();
    assertEquals(null, firstCallResult);
    
    buffer.contentsAsString(); // Ensures buffer is reset/modified in a way that affects subsequent getTextBuffer call
    
    Object secondCallResult = buffer.getTextBuffer();
    assertTrue(secondCallResult instanceof char[]); // Ensures it's an empty array
    assertEquals(0, ((char[]) secondCallResult).length);
}