public void testIssueWithCjkCharsInExcelFormat() {
    try (StringWriter writer = new StringWriter()) {
        List<String[]> data = new ArrayList<>();
        data.add(new String[] { "あ", "い", "う" });

        CSVPrinter printer = CSVFormat.EXCEL.withHeader().print(writer);
        for (String[] record : data) {
            printer.printRecord(record);
        }
        printer.flush();

        String output = writer.toString();
        assertEquals("\"あ\",\"い\",\"う\"\n", output);
    } catch (IOException e) {
        fail("IOException should not be thrown");
    }
}