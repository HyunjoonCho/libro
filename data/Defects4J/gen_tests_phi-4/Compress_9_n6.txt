public void testTarArchiveOutputStreamBytesWritten() throws Exception {
    File outputFile = new File("C:/temp/tartest.tar");
    FileOutputStream fileOutputStream = new FileOutputStream(outputFile);
    ArchiveOutputStream tarOutputStream = new ArchiveStreamFactory().createArchiveOutputStream(ArchiveStreamFactory.TAR, fileOutputStream);

    File inputFile = new File("C:/share/od_l.txt");
    TarArchiveEntry archiveEntry = new TarArchiveEntry(inputFile);
    tarOutputStream.putArchiveEntry(archiveEntry);

    FileInputStream fileInputStream = new FileInputStream(inputFile);
    byte[] buffer = new byte[8192];
    int bytesRead;
    while ((bytesRead = fileInputStream.read(buffer)) > 0) {
        tarOutputStream.write(buffer, 0, bytesRead);
    }

    tarOutputStream.closeArchiveEntry();
    fileInputStream.close();
    tarOutputStream.close();

    long bytesWritten = tarOutputStream.getBytesWritten();
    long expectedBytes = inputFile.length() + archiveEntry.getSize(); // Include the file size and tar header size

    assertEquals("Bytes written should include file size and tar header size.", expectedBytes, bytesWritten);
}