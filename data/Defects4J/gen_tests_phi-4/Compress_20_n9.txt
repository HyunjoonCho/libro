import java.io.ByteArrayInputStream;
import java.io.IOException;
import java.nio.file.Files;
import java.nio.file.Path;
import java.nio.file.Paths;

import static org.junit.Assert.assertThrows;

public void testRedlineCPIOException() {
    Path testArchivePath = Paths.get("redline-cpio-test-archive.cpio");
    try {
        byte[] cpioData = Files.readAllBytes(testArchivePath);
        CPIOArchiveReader reader = new CPIOArchiveReader(new ByteArrayInputStream(cpioData));
        reader.read();
    } catch (IOException e) {
        assertThrows(IllegalArgumentException.class, () -> {
            CPIOArchiveReader reader = new CPIOArchiveReader(new ByteArrayInputStream(cpioData));
            reader.read();
        });
    }
}