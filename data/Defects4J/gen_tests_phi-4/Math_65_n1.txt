public void testWeightVsSigmaInAbstractLeastSquares() {
    AbstractLeastSquares leastSquares = new AbstractLeastSquares() {
        @Override
        protected void initialize() {
            // Assuming some initialization here
        }

        @Override
        protected void computeResiduals() {
            // Assuming computation of residuals and weights here
        }
    };

    double[] residuals = {1.0, 2.0, 3.0};
    double[] weights = {0.5, 1.0, 2.0};
    leastSquares.setResiduals(residuals);
    leastSquares.setWeights(weights);
    leastSquares.computeResiduals();

    double expectedChiSquare = 0.5 * Math.pow(1.0, 2) + 1.0 * Math.pow(2.0, 2) + 2.0 * Math.pow(3.0, 2);
    double expectedRMS = Math.sqrt(expectedChiSquare / residuals.length);

    assertEquals(expectedChiSquare, leastSquares.getChiSquare(), 0.0001);
    assertEquals(expectedRMS, leastSquares.getRMS(), 0.0001);
}