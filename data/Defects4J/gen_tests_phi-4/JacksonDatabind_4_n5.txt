public void testInvalidFormatExceptionIndex() {
    ObjectNode node = new ObjectMapper().createObjectNode();
    node.putArray("array").add("value1").add("value2");

    List<Object> result = new ArrayList<>();
    try {
        node.get("array").traverse(new JsonNodeIterator() {
            @Override
            public JsonNode next() {
                return node.get("array").get(0);
            }

            @Override
            public boolean hasNext() {
                return false;
            }

            @Override
            public boolean hasCurrent() {
                return false;
            }

            @Override
            public JsonNode current() {
                return null;
            }

            @Override
            public int getIndex() {
                return 0;
            }

            @Override
            public JsonNode getParent() {
                return null;
            }
        });
    } catch (InvalidFormatException e) {
        assertEquals(0, e.getIndex());
    }
}