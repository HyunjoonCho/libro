public void testChiSquareWeightHandling() {
    AbstractLeastSquares leastSquares = new ExampleLeastSquares();
    double[] observations = {1.0, 2.0, 3.0};
    double[] residuals = {0.1, 0.2, 0.3};
    double[] weights = {0.5, 1.0, 2.0}; // Example weights

    for (int i = 0; i < observations.length; i++) {
        leastSquares.addRow(observations[i], residuals[i], weights[i]);
    }

    double expectedChiSquare = 0.0;
    for (int i = 0; i < residuals.length; i++) {
        expectedChiSquare += Math.pow(residuals[i], 2) * weights[i]; // Corrected calculation
    }

    double actualChiSquare = leastSquares.getChiSquare();
    assertEquals(expectedChiSquare, actualChiSquare, 1e-9);

    double expectedRMS = Math.sqrt(expectedChiSquare / observations.length);
    double actualRMS = leastSquares.getRMS();
    assertEquals(expectedRMS, actualRMS, 1e-9);
}

**