public void testVarArgArgumentCaptor() {
    ArgumentCaptor<String[]> stringArrayCaptor = ArgumentCaptor.forClass(String[].class);

    List<String> list = mock(List.class);
    when(list.containsAll(stringArrayCaptor.capture())).
        thenAnswer(invocation -> {
            String[] args = invocation.getArgument(0);
            return Arrays.asList(args).containsAll(Arrays.asList("test1", "test2"));
        });

    list.containsAll(new String[]{"test1", "test2", "test3"});
    verify(list).containsAll(stringArrayCaptor.capture());

    String[] capturedArgs = stringArrayCaptor.getValue();
    assertEquals(3, capturedArgs.length);
    assertTrue(Arrays.asList(capturedArgs).containsAll(Arrays.asList("test1", "test2", "test3")));
}