import org.apache.commons.compress.archivers.tar.TarArchiveInputStream;
import org.junit.Test;

import java.io.ByteArrayInputStream;
import java.io.IOException;

import static org.junit.Assert.fail;

public class TarArchiveInputStreamTest {

    @Test
    public void testSymlinkInTarFile() {
        // Simulate the header of a tar file containing a symlink as created by AIX native tar
        // The header is corrupted for the purpose of this test to reproduce the failure
        byte[] corruptedTarHeader = new byte[] {
            0x00, // Invalid byte 0 (NUL) as mentioned in the stack trace
            0x17, 0x22, 0x00, 0x07