public void testDOP853ScalingIssue() {
    // Setup for the test
    OrdinaryDifferentialEquations equations =...; // Initialize properly
    double[] y0 = { /* initial conditions for the ODE */ };
    double[] vecAbsoluteTolerance = { /* absolute tolerances */ };
    double[] vecRelativeTolerance = { /* relative tolerances */ };
    double stepStart = 0.0; // Starting step

    // Incorrect scale initialization using only atol
    DormandPrince853Integrator integrator = new DormandPrince853Integrator();
    DormandPrince853Integrator.ScaleVector scaleIncorrect = integrator.createScaleVector(vecAbsoluteTolerance, vecRelativeTolerance, y0);

    // Correct scale initialization using atol + |y0| * rtol
    double[] scaleCorrect = new double[y0.length];
    for (int i = 0; i < y0.length; ++i) {
        scaleCorrect[i] = vecAbsoluteTolerance[i] + vecRelativeTolerance[i] * Math.abs(y0[i]);
    }

    // Perform integration with incorrect scaling
    double[] y = Arrays.copyOf(y0, y0.length);
    double[] yDotK = new