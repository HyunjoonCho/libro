public void testJsonIdentityReferenceClassOnly() throws Exception {
    ObjectMapper mapper = new ObjectMapper();

    @JsonIdentityInfo(generator = ObjectIdGenerators.PropertyGenerator.class, property = "id")
    static class BaseEntity {
        public int id;
        public String name;

        public BaseEntity() {}

        public BaseEntity(int id, String name) {
            this.id = id;
            this.name = name;
        }
    }

    @JsonIdentityInfo
    static class Parent {
        public int id;
        public String name;
        public Child child;

        public Parent() {}

        public Parent(int id, String name, Child child) {
            this.id = id;
            this.name = name;
            this.child = child;
        }
    }

    @JsonIdentityReference(alwaysAsId = true)
    static class Child {
        public int id;
        public String name;

        public Child() {}

        public Child(int id, String name) {
            this.id = id;
            this.name = name;
        }
    }

    Child child = new Child(2, "Child");
    Parent parent = new Parent(1, "Parent", child);

    String json = mapper.writeValueAsString(parent);
    assertEquals("{\"id\":1,\"name\":\"Parent\",\"