public void testBrentSolverInitialGuessWrongSign() {
    UnivariateRealFunction f = x -> Math.pow(x, 2) - 4;
    double min = 0.0;
    double max = 2.0;
    double initial = -1.0; // initial guess has the wrong sign

    Exception exception = assertThrows(IllegalArgumentException.class, () -> {
        BrentSolver.solve(f, min, max, initial);
    });

    String expectedMessage = "The values of the function at the three points have the same sign";
    String actualMessage = exception.getMessage();

    assertTrue(actualMessage.contains(expectedMessage));
}