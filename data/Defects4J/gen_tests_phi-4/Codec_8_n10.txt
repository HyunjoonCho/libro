public void testBase64InputStreamArrayIndexOutOfBoundsException() {
    try (ByteArrayInputStream input = new ByteArrayInputStream(createData(10920))) {
        Base64InputStream b64stream = new Base64InputStream(input, true, 0, null);
        for (int i = 0; i < 10921; i++) {
            b64stream.read();
        }
    } catch (Exception e) {
        assertTrue(e instanceof ArrayIndexOutOfBoundsException);
    }
}

private byte[] createData(int length) {
    byte[] data = new byte[length];
    for (int i = 0; i < length; i++) {
        data[i] = (byte) 'A'; // Use a single character to simplify encoding
    }
    return data;
}