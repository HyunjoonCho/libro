public void testCloseEventsDetection() {
    ODESolver solver = new ODESolver();
    solver.setInitialStep(67.5);
    solver.setFinalStep(112.5);
    solver.addEvent(90.0);
    solver.addEvent(135.0);

    solver.integrate();

    List<Event> detectedEvents = solver.getDetectedEvents();
    assertEquals(1, detectedEvents.size());
    assertEquals(90.0, detectedEvents.get(0).getTime(), 1e-7);

    solver.setInitialStep(89.9999999);
    solver.setFinalStep(153.0);

    solver.integrate();
    detectedEvents = solver.getDetectedEvents();
    assertEquals(1, detectedEvents.size());
    assertTrue(detectedEvents.get(0).getTime() < 135.0); // Second event should not be detected
}