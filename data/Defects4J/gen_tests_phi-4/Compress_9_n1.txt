import org.junit.Test;
import org.apache.commons.compress.archivers.ArchiveStreamFactory;
import org.apache.commons.compress.archivers.tar.TarArchiveEntry;
import org.apache.commons.compress.archivers.ArchiveOutputStream;
import org.apache.commons.compress.utils.IOUtils;

import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.IOException;

import static org.junit.Assert.assertEquals;

public class TarArchiveOutputStreamTest {

    @Test
    public void testGetBytesWritten() throws IOException {
        File tempFile = File.createTempFile("testfile", ".txt");
        try (FileOutputStream myOutputStream = new FileOutputStream(tempFile)) {
            ArchiveOutputStream sTarOut = new ArchiveStreamFactory().createArchiveOutputStream(ArchiveStreamFactory.TAR, myOutputStream);
            
            // Create a test file to add to the tar archive
            File testSource = new File("path/to/large/testfile.txt");
            if (!testSource.exists()) {
                throw new AssertionError("Test file does not exist.");
            }

            TarArchiveEntry sEntry = new TarArchiveEntry(testSource);
            sTarOut.putArchiveEntry(sEntry);

            try (FileInputStream sInput = new FileInputStream(testSource)) {
                byte[] buffer = new byte[8192