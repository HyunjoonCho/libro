public void testChiSquareCalculation() {
    double[] expected = {485, 541, 82, 61, 37};
    long[] observed = {500, 623, 72, 70, 31};

    double rescalingFactor = sum(observed) / sum(expected);
    double[] rescaledExpected = new double[expected.length];
    for (int i = 0; i < expected.length; i++) {
        rescaledExpected[i] = expected[i] * rescalingFactor;
    }

    ChiSquareTestImpl testStatistic = new ChiSquareTestImpl();
    double chiSquareValue = testStatistic.chiSquare(rescaledExpected, observed);
    assertEquals("chi-square test statistic", 9.0233, chiSquareValue, 1E-4);
}

private double sum(double[] array) {
    double sum = 0;
    for (double value : array) {
        sum += value;
    }
    return sum;
}

private long sum(long[] array) {
    long sum = 0;
    for (long value : array) {
        sum += value;
    }
    return sum;
}