public void testDerivativeStructureAtan2SpecialCases() {
    DerivativeStructure x1 = new DerivativeStructure(1, 0, 0.0);
    DerivativeStructure x2 = new DerivativeStructure(1, 0, -0.0);
    DerivativeStructure y1 = new DerivativeStructure(1, 0, 0.0);
    DerivativeStructure y2 = new DerivativeStructure(1, 0, -0.0);

    assertEquals(Math.atan2(0.0, 0.0), DerivativeStructure.atan2(y1, x1).getValue(), 1e-10);
    assertEquals(Math.atan2(0.0, -0.0), DerivativeStructure.atan2(y1, x2).getValue(), 1e-10);
    assertEquals(Math.atan2(-0.0, 0.0), DerivativeStructure.atan2(y2, x1).getValue(), 1e-10);
    assertEquals(Math.atan2(-0.0, -0.0), DerivativeStructure.atan2(y2, x2).getValue(), 1e-10);
}