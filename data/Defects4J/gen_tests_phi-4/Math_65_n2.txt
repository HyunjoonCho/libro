public void testWeightVersusSigmaInAbstractLeastSquares() {
    AbstractLeastSquares las = new AbstractLeastSquares() {
        @Override
        public int getRows() {
            return 2;
        }

        @Override
        public int getColumns() {
            return 1;
        }

        @Override
        public double[] computeResiduals() {
            return new double[] {1.0, 1.0};
        }

        @Override
        public double[] computeResidualsWeights() {
            return new double[] {0.5, 0.5};
        }
    };

    double expectedChiSquare = 0.5 * 1.0 * 1.0 + 0.5 * 1.0 * 1.0; // Corrected calculation
    double expectedRMS = Math.sqrt(expectedChiSquare / las.getRows());

    assertEquals(expectedChiSquare, las.getChiSquare(), 0.0001);
    assertEquals(expectedRMS, las.getRMS(), 0.0001);
}