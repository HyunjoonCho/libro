public void testCheckVarsUndefinedVarsDiagnostics() {
    String testJs = "foo = {};\nfoo.bar = function() { alert(this.baz); };";
    
    String[] commandCheckVars = {
        "java", "-jar", "compiler.jar", "--js", "test.js", "--jscomp_warning", "checkVars"
    };
    
    String[] commandUndefinedVars = {
        "java", "-jar", "compiler.jar", "--js", "test.js", "--jscomp_warning", "undefinedVars"
    };
    
    ProcessBuilder pbCheckVars = new ProcessBuilder(commandCheckVars);
    ProcessBuilder pbUndefinedVars = new ProcessBuilder(commandUndefinedVars);

    try {
        Process processCheckVars = pbCheckVars.start();
        Process processUndefinedVars = pbUndefinedVars.start();

        String outputCheckVars = new String(processCheckVars.getInputStream().readAllBytes());
        String outputUndefinedVars = new String(processUndefinedVars.getInputStream().readAllBytes());

        assertFalse("CheckVars diagnostics should have reported an error", outputCheckVars.contains("ERROR"));
        assertFalse("UndefinedVars diagnostics should have reported an error", outputUndefinedVars.contains("ERROR"));
    } catch (IOException e) {
        fail("Failed to execute process: