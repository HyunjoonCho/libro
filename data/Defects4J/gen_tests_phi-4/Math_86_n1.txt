public void testCholeskyDecompositionFailure() {
    double[][] cv = {
        {0.40434286, -0.09376327, 0.30328980, 0.04909388},
        {-0.09376327, 0.10400408, 0.07137959, 0.04762857},
        {0.30328980, 0.07137959, 0.30458776, 0.04882449},
        {0.04909388, 0.04762857, 0.04882449, 0.07543265}
    };

    try {
        org.apache.commons.math3.linear.Array2DRowRealMatrix matrix = new org.apache.commons.math3.linear.Array2DRowRealMatrix(cv);
        org.apache.commons.math3.linear.DecompositionSolver solver = new org.apache.commons.math3.linear.CholeskyDecomposition(matrix).getSolver();
        solver.solve(new double[]{1, 0, 0, 0}); // This should throw an exception
        fail("Expected an exception due to non-positive definite matrix");
    } catch (org.apache.commons.math3.exception.NonPositiveDefiniteMatrixException