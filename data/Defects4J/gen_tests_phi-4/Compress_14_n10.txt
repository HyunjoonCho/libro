import java.io.ByteArrayInputStream;
import java.io.IOException;

import org.apache.commons.compress.archivers.tar.TarArchiveInputStream;
import org.junit.jupiter.api.Test;

import static org.junit.jupiter.api.Assertions.assertThrows;

public class TarArchiveInputStreamTest {

    @Test
    public void testInvalidTarFileWithSymlink() {
        // This is a mock-up byte array to simulate the tar file created on AIX with a symlink.
        // The actual byte array should be replaced with the one from the real tar file.
        byte[] mockTarFileWithSymlink = new byte[]{0x00, 0x17, 0x22, 0x00, 0x07, 0x26, 0x20,'', 0x00, 0x00, 0x00, 0x00};

        ByteArrayInputStream byteArrayInputStream = new ByteArrayInputStream(mockTarFileWithSymlink);
        TarArchiveInputStream tarArchiveInputStream = new TarArchiveInputStream(byteArrayInputStream);

        // Expect an IOException due to the invalid header as described in the bug report.
        assertThrows(IOException.class, () -> {
            tarArchiveInputStream.getNextTarEntry();
        });
    }
}