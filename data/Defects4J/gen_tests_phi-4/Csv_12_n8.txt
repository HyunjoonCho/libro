public void testExcelFormatIgnoreEmptyHeaders() {
    String csvData = "A,B,C,,\na,b,c,d,e\n";
    CSVFormat format = CSVFormat.EXCEL.withHeader("A", "B", "C", "");
    try (Reader reader = new StringReader(csvData)) {
        CSVParser parser = format.parse(reader);
        List<String> headers = parser.getHeaderNames();
        assertEquals(3, headers.size());
        assertEquals("A", headers.get(0));
        assertEquals("B", headers.get(1));
        assertEquals("C", headers.get(2));
    } catch (IllegalArgumentException e) {
        fail("Expected no IllegalArgumentException to be thrown");
    }
}