public void testLastWarningOrErrorTruncation() {
    String[] command = {"java", "-jar", "compiler.jar", "--warning_level", "VERBOSE", "--js", "test.js"};
    Process process = Runtime.getRuntime().exec(command);
    BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream()));
    String line;
    boolean lastLineHasError = false;
    boolean lastLineHasCarat = false;
    while ((line = reader.readLine())!= null) {
        if (line.contains("ERROR")) {
            lastLineHasError = true;
        }
        if (line.contains("^")) {
            lastLineHasCarat = true;
        }
    }
    assertTrue("Last error line should have a caret indicating the position.", lastLineHasError && lastLineHasCarat);
}