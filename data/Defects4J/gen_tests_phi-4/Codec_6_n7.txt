public void testBase64InputStreamReadFailure() throws IOException {
    byte[] input = Base64.getEncoder().encode("ABC"); // 3 bytes
    ByteArrayInputStream byteArrayInputStream = new ByteArrayInputStream(input);
    Base64InputStream base64InputStream = new Base64InputStream(byteArrayInputStream, true);

    byte[] buffer = new byte[4];
    int bytesRead = base64InputStream.read(buffer);

    assertFalse("Expected non-zero read at end of 3-byte stream", bytesRead == 0);
}