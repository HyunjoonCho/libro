public void testDuplicateHeaderColumns() throws IOException {
    String csvData = "Col1,Col2,Col2,Col3,Col4\n1,2,3,4,5\n4,5,6,7,8";
    Reader reader = new StringReader(csvData);

    CSVFormat myFormat = CSVFormat.RFC4180.withDelimiter(',').withQuoteChar('"')
           .withQuotePolicy(Quote.MINIMAL).withIgnoreSurroundingSpaces(true)
           .withHeader().withSkipHeaderRecord(true);

    Iterable<CSVRecord> records = myFormat.parse(reader);
    CSVRecord headerRecord = myFormat.getHeaderMap().entrySet().iterator().next().getValue();

    assertEquals(3, headerRecord.size()); // Expecting only 3 unique headers
    assertTrue(headerRecord.containsKey("Col1"));
    assertTrue(headerRecord.containsKey("Col2"));
    assertTrue(headerRecord.containsKey("Col3"));
    assertFalse(headerRecord.containsKey("Col4"));
}