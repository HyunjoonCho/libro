public void testTokenBufferDeserialization() {
    ObjectMapper mapper = new ObjectMapper();
    String json = "{ \"a\":1, \"b\":null }";

    JsonNode node = mapper.readTree(json);
    TokenBuffer buffer = new TokenBuffer(mapper.getFactory());

    try {
        buffer.writeStartObject();
        buffer.writeFieldName("a");
        buffer.writeNumber(1);
        buffer.writeFieldName("b");
        buffer.writeNull();
        buffer.writeEndObject();
        buffer.copyCurrentStructure();

        Value value = mapper.treeToValue(buffer, Value.class);

        assertEquals(1, value.getA());
        assertNull(value.getB());
    } catch (IOException e) {
        fail("Deserialization failed with exception: " + e.getMessage());
    }
}