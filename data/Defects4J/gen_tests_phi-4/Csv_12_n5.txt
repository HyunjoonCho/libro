public void testExcelFormatIgnoreEmptyHeaders() {
    String csvData = "A,B,C,,\na,b,c,d,e";
    try (Reader in = new StringReader(csvData)) {
        CSVFormat format = CSVFormat.EXCEL.withHeader();
        CSVParser parser = new CSVParser(in, format);
        parser.getRecords().forEach(record -> {
            // Accessing headers should not cause an exception
            record.getRecordNumber();
        });
    } catch (IllegalArgumentException e) {
        fail("IllegalArgumentException expected: " + e.getMessage());
    }
}