public void testBase64InputStreamReads() {
    Base64InputStream b64stream = new Base64InputStream(new ByteArrayInputStream(createInputBytes()), true, 0, null);
    int n = 0;
    try {
        for (int i = 0; i < 10920; i++) {
            b64stream.read();
            n++;
        }
    } catch (ArrayIndexOutOfBoundsException e) {
        assertEquals(10920, n);
    }
}

private byte[] createInputBytes() {
    StringBuilder sb = new StringBuilder();
    for (int i = 0; i < 10920; i++) {
        sb.append("A");  // 'A' is base64 encoded as 'QQ=='
    }
    return sb.toString().getBytes();
}