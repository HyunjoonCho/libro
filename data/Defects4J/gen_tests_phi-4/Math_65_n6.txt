public void testWeightVsSigmaInAbstractLeastSquares() {
    AbstractLeastSquares leastSquares = createTestLeastSquaresInstance();
    double[] residuals = {1.0, 2.0, 3.0};
    double[] weights = {1.0, 0.5, 2.0};
    leastSquares.setResidualsWeights(weights);
    leastSquares.setResiduals(residuals);

    double chiSquare = leastSquares.getChiSquare();
    double expectedChiSquare = 0;
    for (int i = 0; i < residuals.length; i++) {
        expectedChiSquare += Math.pow(residuals[i], 2) * weights[i];
    }
    assertEquals(expectedChiSquare, chiSquare, 0.001);

    double rms = leastSquares.getRMS();
    double expectedRMS = Math.sqrt(expectedChiSquare / residuals.length);
    assertEquals(expectedRMS, rms, 0.001);
}

private AbstractLeastSquares createTestLeastSquaresInstance() {
    // Mock or create an instance of AbstractLeastSquares with necessary setup
    return new MockAbstractLeastSquares();
}

// Mock class for testing purposes
private static