public void testIllegalStateExceptionInFunctionType() {
    String crashJs = 
        "var test = {};\n" +
        "/**\n" +
        " * @interface\n" +
        " */\n" +
        "test.T = function() {};\n" +
        "/**\n" +
        " * @constructor\n" +
        " * @implements {test.T}\n" +
        " */\n" +
        "test.A = function() {};\n" +
        "/**\n" +
        " * @constructor\n" +
        " * @implements {test.T}\n" +
        " */\n" +
        "test.B = function() {};\n" +
        "/**\n" +
        " * @constructor\n" +
        " */\n" +
        "test.X = function() {\n" +
        " this.type = test.A;\n" +
        " this.t = this.f();\n" +
        "};\n" +
        "/**\n" +
        " * @return {test.T}\n" +
        " */\n" +
        "test.X.prototype.f = function() {\n"