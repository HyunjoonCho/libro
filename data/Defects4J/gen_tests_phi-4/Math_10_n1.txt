public void testDerivativeStructureAtan2SpecialCases() {
    DerivativeStructure oneDx = new DerivativeStructure(1, 0, 1.0);
    DerivativeStructure zeroDx = new DerivativeStructure(1, 0, 0.0);

    DerivativeStructure oneDy = new DerivativeStructure(1, 0, 1.0);
    DerivativeStructure zeroDy = new DerivativeStructure(1, 0, 0.0);

    // Test NaN for (x=0, y=0)
    assertEquals(Double.NaN, DerivativeStructure.atan2(zeroDy, zeroDx).getValue(), 0.0);

    // Test NaN for (x=0, y=1)
    assertEquals(Math.PI / 2, DerivativeStructure.atan2(oneDy, zeroDx).getValue(), 0.0);

    // Test NaN for (x=1, y=0)
    assertEquals(0.0, DerivativeStructure.atan2(zeroDy, oneDx).getValue(), 0.0);

    // Test NaN for (x=-1, y=0)
    assertEquals(Math.PI, DerivativeStructure.atan2