public void testClosureCompilerUnusedClassRemoval() {
    String inputCode = 
        "// ==ClosureCompiler==\n" +
        "// @compilation_level ADVANCED_OPTIMIZATIONS\n" +
        "// @output_file_name default.js\n" +
        "// @use_closure_library true\n" +
        "// @formatting pretty_print,print_input_delimiter\n" +
        "// @warning_level VERBOSE\n" +
        "// @debug true\n" +
        "// ==/ClosureCompiler==\n\n" +
        "goog.provide('foo');\n\n" +
        "var foo = function() { this.values = []; };\n" +
        "goog.addSingletonGetter(foo);\n\n" +
        "foo.prototype.add = function(value) {this.values.push(value)};";

    String expectedOutput = "(function($ctor$$) {\n" +
                            " $ctor$$.$getInstance$ = function $$ctor$$$$getInstance$$() {\n" +
                            " return $ctor$$.$instance\\_$ || ($ctor$$.$instance\\_$ = new $ctor$$)\n" +
                            " }\n" +
                            "})((function() {\n" +
                            "});";

    String actualOutput =