public void testAtan2SpecialCases() {
    DerivativeStructure x = new DerivativeStructure(1, 0, 0.0);
    DerivativeStructure y = new DerivativeStructure(1, 0, 0.0);

    assertEquals(Math.atan2(0.0, 0.0), DerivativeStructure.atan2(y, x), 1e-10);
    assertEquals(Math.atan2(0.0, -0.0), DerivativeStructure.atan2(y, new DerivativeStructure(1, 0, -0.0)), 1e-10);
    assertEquals(Math.atan2(-0.0, 0.0), DerivativeStructure.atan2(new DerivativeStructure(1, 0, -0.0), x), 1e-10);
    assertEquals(Math.atan2(-0.0, -0.0), DerivativeStructure.atan2(new DerivativeStructure(1, 0, -0.0), new DerivativeStructure(1, 0, -0.0)), 1e-10);
}