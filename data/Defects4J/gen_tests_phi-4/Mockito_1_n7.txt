public void testArgumentCaptorVarargs() {
    List<String> mockedList = mock(List.class);
    doAnswer(invocation -> {
        String[] args = invocation.getArgument(0);
        Arrays.asList(args).forEach(arg -> assertTrue(arg.startsWith("test")));
        return null;
    }).when(mockedList).addVarargs((String...) args);

    mockedList.addVarargs("test1", "test2", "test3");

    ArgumentCaptor<String[]> captor = ArgumentCaptor.forClass(String[].class);
    verify(mockedList).addVarargs(captor.capture());

    String[] capturedArgs = captor.getValue();
    assertEquals(3, capturedArgs.length);
    assertTrue(Arrays.asList(capturedArgs).stream().allMatch(arg -> arg.startsWith("test")));
}