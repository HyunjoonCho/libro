public void testWhitespaceCompression() {
    String before = 
        "contactcenter.screenpop.updatePopStatus = function(stamp, status) {\n" +
        "for each ( var curTiming in this.timeLog.timings ) {\n" +
        "if ( curTiming.callId == stamp ) {\n" +
        "curTiming.flag = status;\n" +
        "break;\n" +
        "}\n" +
        "}\n" +
        "};";

    String after = 
        "contactcenter.screenpop.updatePopStatus=function(stamp,status){for(var curTiming in this.timeLog.timings)if(curTiming.callId==stamp){curTiming.flag=status;break}};";

    assertEquals("for each ( var curTiming in this.timeLog.timings )", 
                 extractForEachLoop(before));
    assertEquals("for(var curTiming in this.timeLog.timings)", 
                 extractForEachLoop(after));
}

private String extractForEachLoop(String code) {
    int start = code.indexOf("for each (");
    int end = code.indexOf(")", start) + 1;
    return code.substring(start, end);
}