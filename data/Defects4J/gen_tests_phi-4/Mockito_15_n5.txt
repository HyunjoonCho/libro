public void testArgumentCaptorVarargsFailure() {
    List<String> arguments = new ArrayList<>();
    arguments.add("arg1");
    arguments.add("arg2");

    ArgumentCaptor<String[]> captor = ArgumentCaptor.forClass(String[].class);
    Mockito.doNothing().when(mockObject).someMethod(captor.capture());

    mockObject.someMethod(arguments.toArray(new String[0]));

    String[] capturedArguments = captor.getValue();
    assertEquals(2, capturedArguments.length);
    assertEquals("arg1", capturedArguments[0]);
    assertEquals("arg2", capturedArguments[1]);
}