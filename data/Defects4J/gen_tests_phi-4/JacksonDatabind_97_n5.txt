import org.junit.jupiter.api.Test;
import static org.junit.jupiter.api.Assertions.assertEquals;

public class TestCaseTest {

  @Test
  public void testContextAttributesWithCustomSerializer() throws Exception {
    String mapOutput = "{\"data\":{\"aStr\":\"The value is: Hello!\"}}";
    String treeOutput = "{\"data\":{\"aStr\":\"The value is: Hello!\"}}";

    String actualMapOutput = new ObjectMapper().writer().withAttribute("myAttr", "Hello!")
       .writeValueAsString(new HashMap<String, Object>() {{
          put("data", new Data() {{ aStr = "Hello"; }});
        }});

    String actualTreeOutput = new ObjectMapper().writer().withAttribute("myAttr", "Hello!")
       .writeValueAsString(new ObjectNode(new ObjectMapper().getFactory()).putPOJO("data", new Data() {{ aStr = "Hello"; }}));

    assertEquals(mapOutput, actualMapOutput, "HashMap serialization does not include custom serializer attribute");
    assertEquals(treeOutput, actualTreeOutput, "ObjectNode serialization does not include custom serializer attribute");
  }
}