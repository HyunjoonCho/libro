public void testUndefinedNamespaceHandling() {
    DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
    factory.setNamespaceAware(true);
    DocumentBuilder builder = factory.newDocumentBuilder();
    
    try {
        Document doc = builder.newDocument();
        
        // Register namespaces
        doc.setDocumentURI("dummyURI");
        doc.createRootElement().setPrefix("A");
        doc.createRootElement().setAttribute("xmlns:A", "http://example.com/A");
        doc.createRootElement().setPrefix("B");
        doc.createRootElement().setAttribute("xmlns:B", "http://example.com/B");
        
        // Create elements with namespaces
        Element elementA = doc.createElementNS("http://example.com/A", "A:ElementA");
        elementA.setAttributeNS("http://example.com/A", "A:myAttr", "Mytype");
        doc.appendChild(elementA);
        
        Element elementB = doc.createElementNS("http://example.com/B", "B:ElementB");
        elementB.setTextContent("MY VALUE");
        elementA.appendChild(elementB);
        
        // Simulate the issue by trying to create an attribute with an undefined namespace
        try {
            elementA.setAttributeNS("http://unknown.com", "xsi:unknownAttr", "value");