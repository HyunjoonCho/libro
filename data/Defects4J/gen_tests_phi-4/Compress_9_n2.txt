public void testTarArchiveOutputStreamBytesWritten() throws Exception {
    File tempFile = File.createTempFile("input", ".txt");
    try (FileOutputStream myOutputStream = new FileOutputStream("C:/temp/tartest.tar");
         FileOutputStream tempOutputStream = new FileOutputStream(tempFile)) {
        
        // Create a file of significant size
        byte[] data = new byte[8192];
        for (int i = 0; i < 10000; i++) {
            tempOutputStream.write(data);
        }
    }
    
    try (FileOutputStream myOutputStream = new FileOutputStream("C:/temp/tartest.tar")) {
        ArchiveOutputStream sTarOut = new ArchiveStreamFactory().createArchiveOutputStream(ArchiveStreamFactory.TAR, myOutputStream);
        
        File sSource = tempFile;
        TarArchiveEntry sEntry = new TarArchiveEntry(sSource);
        sTarOut.putArchiveEntry(sEntry);
        
        try (FileInputStream sInput = new FileInputStream(sSource)) {
            byte[] cpRead = new byte[8192];
            int iRead = 0;
            while ((iRead = sInput.read(cpRead)) > 0) {
                sTarOut.write(cpRead, 0, iRead);
            }