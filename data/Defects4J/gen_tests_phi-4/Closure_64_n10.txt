public void testStrictPerFile() throws Exception {
    String getNumJs = "var getNum = function() { return 5; };";
    String alertJs = "alert(getNum());";
    
    // Simulate the command line compilation
    String[] command = {
        "java", "-jar", "compiler.jar",
        "--language_in=ECMASCRIPT5_STRICT",
        "--compilation_level=ADVANCED_OPTIMIZATIONS",
        "--warning_level=VERBOSE",
        "--js", "-",
        "--js", "-"
    };

    ProcessBuilder pb = new ProcessBuilder(command);
    pb.redirectErrorStream(true);

    Process process = pb.start();
    try (BufferedWriter writer = new BufferedWriter(new OutputStreamWriter(process.getOutputStream()))) {
        writer.write(getNumJs);
        writer.newLine();
        writer.write(alertJs);
        writer.newLine();
    }

    // Capture the output
    StringBuilder output = new StringBuilder();
    try (BufferedReader reader = new BufferedReader(new InputStreamReader(process.getInputStream()))) {
        String line;
        while ((line = reader.readLine())!= null) {
            output.append(line).append("\n");
        }
    }

    process.waitFor();

    // Assert the expected output
    String expectedOutput = "'use