public void testCSVFormatWithHeader() throws IOException {
    Path path = Paths.get("data.csv");
    if (Files.exists(path)) {
        Files.delete(path);
    }

    StringWriter writer = new StringWriter();
    CSVPrinter csvPrinter = CSVFormat.TDF
       .withHeader("x")
       .print(writer);

    csvPrinter.printRecord(42);
    csvPrinter.close();

    String content = writer.toString();
    String expectedContent = "x\n42\n";
    assertEquals(expectedContent, content);
}