public void testDerivativeStructureAtan2SpecialCases() {
    DerivativeStructure xPos0 = new DerivativeStructure(1, 0, 0.0);
    DerivativeStructure xNeg0 = new DerivativeStructure(1, 0, -0.0);
    DerivativeStructure yPos0 = new DerivativeStructure(1, 0, 0.0);
    DerivativeStructure yNeg0 = new DerivativeStructure(1, 0, -0.0);

    assertEquals(Math.atan2(yPos0.getValue(), xPos0.getValue()), DerivativeStructure.atan2(yPos0, xPos0).getValue(), 1e-15);
    assertEquals(Math.atan2(yPos0.getValue(), xNeg0.getValue()), DerivativeStructure.atan2(yPos0, xNeg0).getValue(), 1e-15);
    assertEquals(Math.atan2(yNeg0.getValue(), xPos0.getValue()), DerivativeStructure.atan2(yNeg0, xPos0).getValue(), 1e-15);
    assertEquals(Math.atan2(yNeg0.getValue(), xNeg0.getValue()), DerivativeStructure.atan2(yNeg0, xNeg0).getValue(), 1e-15);
}