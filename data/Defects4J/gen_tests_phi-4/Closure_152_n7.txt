public void testUnionTypeCastFailure() {
    // Simulate the JavaScript compilation environment
    Compiler compiler = new Compiler();
    compiler.setOptions(Options.builder()
           .setCreateNameMapFiles(true)
           .setWarningLevel(Options.WarningLevel.VERBOSE)
           .setSummaryDetailLevel(Options.SummaryDetailLevel.ALL)
           .setProcessClosurePrimitives(true)
           .addWarnings("missingProperties", "undefinedVars", "checkTypes")
           .addErrors("strictModuleDepCheck", "invalidCasts")
           .setCompilationLevel(Options.CompilationLevel.ADVANCED_OPTIMIZATIONS)
           .build());

    try {
        compiler.compile("function foo(x) { return x; }");
        fail("Expected a ClassCastException to be thrown");
    } catch (RuntimeException e) {
        Throwable cause = e.getCause();
        assertTrue(cause instanceof ClassCastException);
        assertTrue(cause.getMessage().contains("