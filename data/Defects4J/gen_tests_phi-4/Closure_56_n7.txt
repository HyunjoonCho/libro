public void testLastWarningOrErrorTruncation() throws Exception {
    ByteArrayOutputStream output = new ByteArrayOutputStream();
    PrintStream original = System.out;
    System.setOut(new PrintStream(output));

    try {
        // Simulate the command execution
        String[] command = new String[]{"java", "-jar", "compiler.jar", "--warning_level", "VERBOSE", "--js", "test.js"};

        // Mock the external compiler behavior
        String compilerOutput = 
            "test.js:1: ERROR - variable foo is undefined\n" +
            "alert(foo);\n" +
            " ^\n" +
            "test.js:2: ERROR - variable bar is undefined\n\n" +
            "2 error(s), 0 warning(s)\n";

        System.out.print(compilerOutput);

        // Validate the output
        String outputContent = output.toString();
        assertTrue(outputContent.contains("test.js:1: ERROR - variable foo is undefined"));
        assertTrue(outputContent.contains("alert(foo);"));
        assertTrue(outputContent.contains("^"));
        assertTrue(outputContent.contains("test.js:2: ERROR - variable bar is undefined"));
        assertTrue(outputContent.contains("2 error(s), 0 warning(s)"));

        // Specifically check for truncation