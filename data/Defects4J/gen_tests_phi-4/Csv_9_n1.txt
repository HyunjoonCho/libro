public void testCsvRecordToMapWithNoHeaders() {
    CSVFormat format = CSVFormat.DEFAULT.withHeader().withFirstRecordAsHeader();
    Reader reader = new StringReader("col1,col2\nval1,val2");
    Iterable<CSVRecord> records = CSVFormat.DEFAULT.withHeader().parse(reader);
    
    for (CSVRecord record : records) {
        Map<String, String> map = record.toMap();
        assertNotNull(map);
    }
    
    // Test with no headers
    reader = new StringReader("val1,val2");
    records = CSVFormat.DEFAULT.parse(reader);
    
    for (CSVRecord record : records) {
        // Using reflection to verify the expected behavior of returning null
        try {
            Method toMapMethod = CSVRecord.class.getDeclaredMethod("toMap");
            toMapMethod.setAccessible(true);
            Object result = toMapMethod.invoke(record);
            assertNull(result);
        } catch (Exception e) {
            fail("Reflection failed: " + e.getMessage());
        }
    }
}