public void testCloseEventDetection() {
    OdeSolver solver = new OdeSolver();
    solver.setIntegrationStep(67.5, 112.5); // First step

    // Simulate event detection at the first step
    solver.integrate();
    assertEquals(90.0, solver.getLastEventTime(), 1e-9);

    // Reset solver for second step
    solver.setIntegrationStep(90.0, 153.0);
    solver.integrate();

    // Check if the second event is detected
    double[] events = solver.getDetectedEvents();
    assertTrue(Arrays.stream(events).anyMatch(event -> Math.abs(event - 135.0) < 1e-9));
}