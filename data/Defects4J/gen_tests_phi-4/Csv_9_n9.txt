public void testCsvRecordToMapWithoutHeaders() {
    Format<CSVRecord> format = FormatBuilder.csv()
                                         .withHeader()
                                         .build();
    try {
        CSVParser parser = CSVParser.parse(new StringReader("field1,field2"), format);
        CSVRecord record = parser.getRecords().get(0);
        Map<String, String> resultMap = record.toMap();
        assertNull(resultMap);
    } catch (NullPointerException e) {
        fail("Expected null map instead of NullPointerException");
    }
}