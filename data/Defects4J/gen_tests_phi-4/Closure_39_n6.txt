public void testExternExportWithTypedef() {
    String source = 
        "var x; " +
        "@typedef {Object} MyType = { " +
        "  longName: string, " +
        "  anotherLongName: string, " +
        "  optionalLongName?: string " +
        "}; " +
        "x = {longName: 'test'}; " +  // References before typedef, expected to work.
        "function useTypeDef(y?: MyType) { " +  // Optional parameter after typedef.
        "  console.log(y); " +
        "}";

    String expectedExtern =
        "var x; " +
        "function useTypeDef(y) { }";

    String actualExtern = getExternExport(source); // Assume this method exists and mimics the behavior described.
    assertEquals(expectedExtern, actualExtern);
}