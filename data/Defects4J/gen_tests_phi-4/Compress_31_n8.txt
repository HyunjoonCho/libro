public void testIllegalArgumentWhenExtractingTgz() {
    File tempDir = new File("testTempDir");
    tempDir.mkdirs();
    String tempDirPath = tempDir.getAbsolutePath() + File.separator;
    String fileName = "invalid.tgz";

    // Simulate the creation of an invalid.tgz file
    try (FileOutputStream fos = new FileOutputStream(tempDirPath + fileName)) {
        fos.write(54);
        fos.write(49);
        fos.write(50);
        fos.write((byte) 0); // NUL byte
        fos.write(49);
        fos.write(49);
    }

    // Attempt to unpack the.tgz file
    try (TarArchiveInputStream tarIn = new TarArchiveInputStream(
            new GZIPInputStream(
                    new BufferedInputStream(
                            new FileInputStream(tempDirPath + fileName))))) {
        TarArchiveEntry entry = tarIn.getNextTarEntry();
        while (entry!= null) {
            // This should throw an IllegalArgumentException
            File path = new File(tempDirPath, entry.getName());
            if (entry.isDirectory()) {
                path.mkdirs();
            } else {
                path.createNewFile();
                byte[] read = new byte[2048];
                try (BufferedOutputStream