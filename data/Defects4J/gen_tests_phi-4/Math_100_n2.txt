public void testCovariancesAndErrorsWithBoundParameters() {
    Problem problem = new Problem() {
        @Override
        public int getParameterCount() {
            return 3;
        }

        @Override
        public List<RealParameter> getParameters() {
            return Arrays.asList(new RealParameter(0, 1), new RealParameter(1, 2), new BoundParameter(2, 3, 2, 4));
        }

        @Override
        public int getUnboundParameters() {
            return 2;
        }

        @Override
        public List<RealParameter> getUnboundParametersList() {
            return Arrays.asList(new RealParameter(0, 1), new RealParameter(1, 2));
        }
    };

    AbstractEstimator estimator = new AbstractEstimator(problem) {
        @Override
        protected void calculateCovariances() {
            final int cols = problem.getAllParameters().length;
            final double[][] covariances = new double[cols][cols];
            // Simulate the logic that leads to ArrayIndexOutOfBoundsException
            for (int i = 0; i <= cols; i++) {
                for (int j = 0; j < cols; j