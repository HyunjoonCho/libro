public void testChiSquareIncorrectStatistic() {
    double[] expected = {485, 541, 82, 61, 37};
    long[] observed = {500, 623, 72, 70, 31};

    // Calculate expected sum
    double expectedSum = 0;
    for (double value : expected) {
        expectedSum += value;
    }

    // Calculate observed sum
    long observedSum = 0;
    for (long value : observed) {
        observedSum += value;
    }

    // Rescale expected values if needed
    if (expectedSum!= observedSum) {
        double rescaleFactor = (double) observedSum / expectedSum;
        for (int i = 0; i < expected.length; i++) {
            expected[i] *= rescaleFactor;
        }
    }

    // Calculate chi-squared value
    double chiSquare = 0;
    for (int i = 0; i < observed.length; i++) {
        double dev = (double) observed[i] - expected[i];
        chiSquare += dev * dev / expected[i];
    }

    assertEquals("chi-square test statistic", 9.0233, chiSquare,